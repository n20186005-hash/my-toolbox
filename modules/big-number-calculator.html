<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Big Number Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="big_number_calc">
    <meta name="category" content="math">
    <meta name="icon" content="ğŸ”¢">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Big Number Calculator">
    <meta name="description" content="Perform arithmetic operations with very large numbers.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="å¤§æ•°è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="å¯¹æå¤§çš„æ•°å­—è¿›è¡Œç®—æœ¯è¿ç®—ã€‚">
    
    <meta name="lang-title-zh-TW" content="å¤§æ•¸è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="å°æ¥µå¤§çš„æ•¸å­—é€²è¡Œç®—è¡“é‹ç®—ã€‚">
    
    <meta name="lang-title-ja" content="å¤§ããªæ•°å€¤è¨ˆç®—ãƒ„ãƒ¼ãƒ«">
    <meta name="lang-description-ja" content="éå¸¸ã«å¤§ããªæ•°å€¤ã§ç®—è¡“æ¼”ç®—ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ‡Ğ¸ÑĞµĞ»">
    <meta name="lang-description-ru" content="Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞ¹Ñ‚Ğµ Ğ°Ñ€Ğ¸Ñ„Ğ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼Ğ¸ Ñ‡Ğ¸ÑĞ»Ğ°Ğ¼Ğ¸.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .operation-btn { width: 60px; height: 60px; font-size: 20px; }
        .result-container { word-break: break-all; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="big_number_calc" 
         data-category="math" 
         data-title="Big Number Calculator" 
         data-icon="ğŸ”¢">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="big-lang" onchange="BigNumberCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ğŸ”¢ Big Number Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="number_a">Number A</label>
                <input type="text" id="big-num-a" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. 12345678901234567890">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="operation">Operation</label>
                <div class="flex justify-center gap-2">
                    <button onclick="BigNumberCalc.setOperation('add')" class="operation-btn bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition" data-i18n="add">+</button>
                    <button onclick="BigNumberCalc.setOperation('subtract')" class="operation-btn bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition" data-i18n="subtract">âˆ’</button>
                    <button onclick="BigNumberCalc.setOperation('multiply')" class="operation-btn bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition" data-i18n="multiply">Ã—</button>
                    <button onclick="BigNumberCalc.setOperation('divide')" class="operation-btn bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition" data-i18n="divide">Ã·</button>
                    <button onclick="BigNumberCalc.setOperation('power')" class="operation-btn bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition" data-i18n="power">^</button>
                </div>
                <div id="selected-operation" class="text-center mt-2 text-gray-600" data-i18n="select_operation">Select an operation</div>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="number_b">Number B</label>
                <input type="text" id="big-num-b" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. 98765432109876543210">
            </div>
            
            <button onclick="BigNumberCalc.calc()" class="w-full bg-green-600 text-white py-3 rounded font-bold hover:bg-green-700 transition" data-i18n="calculate">Calculate Result</button>
        </div>

        <div class="bg-blue-50 p-6 rounded-lg border border-blue-100">
            <div class="text-sm text-gray-500 mb-2" data-i18n="result">Result</div>
            <div id="big-result" class="text-lg font-bold text-blue-800 min-h-[60px] result-container">--</div>
            <div id="big-error" class="text-sm text-red-600 mt-2 hidden"></div>
        </div>

        <div class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600">
            <p data-i18n="notes">Notes:</p>
            <ul class="list-disc list-inside mt-2 space-y-1" data-i18n="notes_list">
                <li>Supports very large integers beyond standard JavaScript number limits</li>
                <li>Division returns integer result with remainder</li>
                <li>Exponentiation (^) calculates A raised to the power of B</li>
            </ul>
        </div>
    </div>

    <script>
        const BigNumberCalc = {
            i18n: {
                'en': {
                    title: 'ğŸ”¢ Big Number Calculator',
                    number_a: 'Number A',
                    number_b: 'Number B',
                    operation: 'Operation',
                    add: '+',
                    subtract: 'âˆ’',
                    multiply: 'Ã—',
                    divide: 'Ã·',
                    power: '^',
                    calculate: 'Calculate Result',
                    result: 'Result',
                    select_operation: 'Select an operation',
                    err_invalid: 'Invalid number format',
                    err_negative: 'Subtraction result cannot be negative',
                    err_divide_zero: 'Cannot divide by zero',
                    err_power: 'Exponent must be a non-negative integer',
                    notes: 'Notes:',
                    notes_list: `
                        <li>Supports very large integers beyond standard JavaScript number limits</li>
                        <li>Division returns integer result with remainder</li>
                        <li>Exponentiation (^) calculates A raised to the power of B</li>
                    `,
                    division_result: 'Result: {quotient}, Remainder: {remainder}'
                },
                'zh-CN': {
                    title: 'ğŸ”¢ å¤§æ•°è®¡ç®—å™¨',
                    number_a: 'æ•°å­— A',
                    number_b: 'æ•°å­— B',
                    operation: 'è¿ç®—',
                    add: '+',
                    subtract: 'âˆ’',
                    multiply: 'Ã—',
                    divide: 'Ã·',
                    power: '^',
                    calculate: 'è®¡ç®—ç»“æœ',
                    result: 'ç»“æœ',
                    select_operation: 'é€‰æ‹©ä¸€ä¸ªè¿ç®—',
                    err_invalid: 'æ— æ•ˆçš„æ•°å­—æ ¼å¼',
                    err_negative: 'å‡æ³•ç»“æœä¸èƒ½ä¸ºè´Ÿæ•°',
                    err_divide_zero: 'ä¸èƒ½é™¤ä»¥é›¶',
                    err_power: 'æŒ‡æ•°å¿…é¡»æ˜¯éè´Ÿæ•´æ•°',
                    notes: 'æ³¨æ„ï¼š',
                    notes_list: `
                        <li>æ”¯æŒè¶…å‡ºæ ‡å‡†JavaScriptæ•°å­—é™åˆ¶çš„æå¤§æ•´æ•°</li>
                        <li>é™¤æ³•è¿”å›æ•´æ•°ç»“æœå’Œä½™æ•°</li>
                        <li>å¹‚è¿ç®—ï¼ˆ^ï¼‰è®¡ç®—Açš„Bæ¬¡æ–¹</li>
                    `,
                    division_result: 'ç»“æœï¼š{quotient}ï¼Œä½™æ•°ï¼š{remainder}'
                },
                'zh-TW': {
                    title: 'ğŸ”¢ å¤§æ•¸è¨ˆç®—å™¨',
                    number_a: 'æ•¸å­— A',
                    number_b: 'æ•¸å­— B',
                    operation: 'é‹ç®—',
                    add: '+',
                    subtract: 'âˆ’',
                    multiply: 'Ã—',
                    divide: 'Ã·',
                    power: '^',
                    calculate: 'è¨ˆç®—çµæœ',
                    result: 'çµæœ',
                    select_operation: 'é¸æ“‡ä¸€å€‹é‹ç®—',
                    err_invalid: 'ç„¡æ•ˆçš„æ•¸å­—æ ¼å¼',
                    err_negative: 'æ¸›æ³•çµæœä¸èƒ½ç‚ºè² æ•¸',
                    err_divide_zero: 'ä¸èƒ½é™¤ä»¥é›¶',
                    err_power: 'æŒ‡æ•¸å¿…é ˆæ˜¯éè² æ•´æ•¸',
                    notes: 'æ³¨æ„ï¼š',
                    notes_list: `
                        <li>æ”¯æ´è¶…å‡ºæ¨™æº–JavaScriptæ•¸å­—é™åˆ¶çš„æ¥µå¤§æ•´æ•¸</li>
                        <li>é™¤æ³•è¿”å›æ•´æ•¸çµæœå’Œé¤˜æ•¸</li>
                        <li>å†ªé‹ç®—ï¼ˆ^ï¼‰è¨ˆç®—Açš„Bæ¬¡æ–¹</li>
                    `,
                    division_result: 'çµæœï¼š{quotient}ï¼Œé¤˜æ•¸ï¼š{remainder}'
                },
                'ja': {
                    title: 'ğŸ”¢ å¤§ããªæ•°å€¤è¨ˆç®—ãƒ„ãƒ¼ãƒ«',
                    number_a: 'æ•°å€¤ A',
                    number_b: 'æ•°å€¤ B',
                    operation: 'æ¼”ç®—',
                    add: '+',
                    subtract: 'âˆ’',
                    multiply: 'Ã—',
                    divide: 'Ã·',
                    power: '^',
                    calculate: 'çµæœã‚’è¨ˆç®—',
                    result: 'çµæœ',
                    select_operation: 'æ¼”ç®—ã‚’é¸æŠ',
                    err_invalid: 'ç„¡åŠ¹ãªæ•°å€¤å½¢å¼',
                    err_negative: 'æ¸›ç®—çµæœã¯è² ã®æ•°ã«ã§ãã¾ã›ã‚“',
                    err_divide_zero: 'ã‚¼ãƒ­ã§é™¤ç®—ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“',
                    err_power: 'æŒ‡æ•°ã¯éè² ã®æ•´æ•°ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“',
                    notes: 'æ³¨æ„ï¼š',
                    notes_list: `
                        <li>æ¨™æº–çš„ãªJavaScriptã®æ•°å€¤åˆ¶é™ã‚’è¶…ãˆã‚‹éå¸¸ã«å¤§ããªæ•´æ•°ã‚’ã‚µãƒãƒ¼ãƒˆ</li>
                        <li>é™¤ç®—ã¯æ•´æ•°çµæœã¨ä½™ã‚Šã‚’è¿”ã—ã¾ã™</li>
                        <li>ã¹ãä¹—ï¼ˆ^ï¼‰ã¯Aã®Bä¹—ã‚’è¨ˆç®—ã—ã¾ã™</li>
                    `,
                    division_result: 'çµæœï¼š{quotient}ï¼Œä½™ã‚Šï¼š{remainder}'
                },
                'ru': {
                    title: 'ğŸ”¢ ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ‡Ğ¸ÑĞµĞ»',
                    number_a: 'Ğ§Ğ¸ÑĞ»Ğ¾ A',
                    number_b: 'Ğ§Ğ¸ÑĞ»Ğ¾ B',
                    operation: 'ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ',
                    add: '+',
                    subtract: 'âˆ’',
                    multiply: 'Ã—',
                    divide: 'Ã·',
                    power: '^',
                    calculate: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                    result: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                    select_operation: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ',
                    err_invalid: 'ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ‡Ğ¸ÑĞ»Ğ°',
                    err_negative: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ²Ñ‹Ñ‡Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼',
                    err_divide_zero: 'Ğ”ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ½Ğ¾Ğ»ÑŒ Ğ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾',
                    err_power: 'ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒ ÑÑ‚ĞµĞ¿ĞµĞ½Ğ¸ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ½ĞµĞ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼ Ñ†ĞµĞ»Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼',
                    notes: 'ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ:',
                    notes_list: `
                        <li>ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğµ Ñ†ĞµĞ»Ñ‹Ğµ Ñ‡Ğ¸ÑĞ»Ğ°, Ğ²Ñ‹Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ·Ğ° Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‹ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğ¹ JavaScript</li>
                        <li>Ğ”ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ñ†ĞµĞ»Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ñ Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¾Ğ¼</li>
                        <li>Ğ’Ğ¾Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ² ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ (^) Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ A, Ğ²Ğ¾Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ½Ğ¾Ğµ Ğ² ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ B</li>
                    `,
                    division_result: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: {quotient}, ĞÑÑ‚Ğ°Ñ‚Ğ¾Ğº: {remainder}'
                }
            },

            selectedOperation: null,

            init: () => {
                // è®¾ç½®é»˜è®¤å€¼
                document.getElementById('big-num-a').value = '123456789012345678901234567890';
                document.getElementById('big-num-b').value = '987654321098765432109876543210';
            },

            setOperation: (op) => {
                BigNumberCalc.selectedOperation = op;
                const lang = document.getElementById('big-lang').value;
                const texts = BigNumberCalc.i18n[lang];
                
                // æ›´æ–°é€‰ä¸­çš„è¿ç®—æ˜¾ç¤º
                const opNames = {
                    'add': texts.add,
                    'subtract': texts.subtract,
                    'multiply': texts.multiply,
                    'divide': texts.divide,
                    'power': texts.power
                };
                
                document.getElementById('selected-operation').innerText = opNames[op];
                BigNumberCalc.clearError();
            },

            changeLang: () => {
                const lang = document.getElementById('big-lang').value;
                const texts = BigNumberCalc.i18n[lang];
                
                // æ›´æ–°æ™®é€šæ–‡æœ¬
                document.querySelectorAll('[data-id="big_number_calc"] [data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) {
                        if (key === 'notes_list') {
                            el.innerHTML = texts[key];
                        } else {
                            el.innerText = texts[key];
                        }
                    }
                });
                
                // æ›´æ–°é€‰ä¸­çš„è¿ç®—æ˜¾ç¤º
                if (BigNumberCalc.selectedOperation) {
                    BigNumberCalc.setOperation(BigNumberCalc.selectedOperation);
                }
            },

            showError: (message) => {
                const resultEl = document.getElementById('big-result');
                const errorEl = document.getElementById('big-error');
                
                resultEl.innerText = '';
                errorEl.innerText = message;
                errorEl.classList.remove('hidden');
            },

            clearError: () => {
                const errorEl = document.getElementById('big-error');
                errorEl.classList.add('hidden');
                errorEl.innerText = '';
            },

            // éªŒè¯å¹¶è§£æå¤§æ•°å­—ï¼ˆä½œä¸ºå­—ç¬¦ä¸²å¤„ç†ï¼‰
            parseBigNumber: (str) => {
                // ç§»é™¤æ‰€æœ‰å¯èƒ½çš„åƒä½åˆ†éš”ç¬¦
                str = str.replace(/,/g, '').trim();
                
                // éªŒè¯æ ¼å¼
                if (!/^\d+$/.test(str)) {
                    return null;
                }
                
                // ç§»é™¤å‰å¯¼é›¶
                str = str.replace(/^0+/, '');
                return str || '0'; // å¦‚æœå…¨æ˜¯é›¶ï¼Œè¿”å›'0'
            },

            // å¤§æ•°å­—åŠ æ³•
            add: (a, b) => {
                // ç¡®ä¿aæ˜¯è¾ƒé•¿çš„æ•°å­—
                if (a.length < b.length) [a, b] = [b, a];
                
                let result = '';
                let carry = 0;
                let i = a.length - 1;
                let j = b.length - 1;
                
                while (i >= 0 || j >= 0 || carry > 0) {
                    const digitA = i >= 0 ? parseInt(a[i]) : 0;
                    const digitB = j >= 0 ? parseInt(b[j]) : 0;
                    
                    const sum = digitA + digitB + carry;
                    carry = Math.floor(sum / 10);
                    result = (sum % 10) + result;
                    
                    i--;
                    j--;
                }
                
                return result;
            },

            // å¤§æ•°å­—å‡æ³• (å‡è®¾a >= b)
            subtract: (a, b) => {
                // ç¡®ä¿a >= b
                if (BigNumberCalc.compare(a, b) < 0) {
                    return null;
                }
                
                let result = '';
                let borrow = 0;
                let i = a.length - 1;
                let j = b.length - 1;
                
                while (i >= 0 || j >= 0) {
                    const digitA = i >= 0 ? parseInt(a[i]) : 0;
                    const digitB = j >= 0 ? parseInt(b[j]) : 0;
                    
                    let diff = digitA - digitB - borrow;
                    if (diff < 0) {
                        diff += 10;
                        borrow = 1;
                    } else {
                        borrow = 0;
                    }
                    
                    result = diff + result;
                    
                    i--;
                    j--;
                }
                
                // ç§»é™¤å‰å¯¼é›¶
                return result.replace(/^0+/, '') || '0';
            },

            // å¤§æ•°å­—ä¹˜æ³•
            multiply: (a, b) => {
                if (a === '0' || b === '0') return '0';
                
                // åˆå§‹åŒ–ç»“æœæ•°ç»„
                const result = new Array(a.length + b.length).fill(0);
                
                // é€ä½ç›¸ä¹˜
                for (let i = a.length - 1; i >= 0; i--) {
                    const digitA = parseInt(a[i]);
                    
                    for (let j = b.length - 1; j >= 0; j--) {
                        const digitB = parseInt(b[j]);
                        const product = digitA * digitB;
                        const sum = product + result[i + j + 1];
                        
                        result[i + j + 1] = sum % 10;
                        result[i + j] += Math.floor(sum / 10);
                    }
                }
                
                // è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶ç§»é™¤å‰å¯¼é›¶
                return result.join('').replace(/^0+/, '') || '0';
            },

            // å¤§æ•°å­—é™¤æ³• (è¿”å›å•†å’Œä½™æ•°)
            divide: (a, b) => {
                if (b === '0') return null;
                if (BigNumberCalc.compare(a, b) < 0) return { quotient: '0', remainder: a };
                
                let quotient = '';
                let remainder = '';
                let i = 0;
                
                while (i < a.length) {
                    // ä»è¢«é™¤æ•°ä¸­å–ä¸€ä½æˆ–å¤šä½å½¢æˆä¸´æ—¶ä½™æ•°
                    remainder += a[i];
                    remainder = remainder.replace(/^0+/, '') || '0'; // ç§»é™¤å‰å¯¼é›¶
                    i++;
                    
                    // è®¡ç®—å½“å‰ä½çš„å•†
                    let count = 0;
                    while (BigNumberCalc.compare(remainder, b) >= 0) {
                        remainder = BigNumberCalc.subtract(remainder, b);
                        count++;
                    }
                    
                    quotient += count.toString();
                }
                
                // ç§»é™¤å•†çš„å‰å¯¼é›¶
                quotient = quotient.replace(/^0+/, '') || '0';
                
                return { quotient, remainder };
            },

            // å¤§æ•°å­—å¹‚è¿ç®— (a^b)
            power: (a, b) => {
                // å¤„ç†ç‰¹æ®Šæƒ…å†µ
                if (b === '0') return '1';
                if (a === '0') return '0';
                if (b === '1') return a;
                
                // è½¬æ¢bä¸ºæ•´æ•°
                const exponent = parseInt(b, 10);
                if (isNaN(exponent) || exponent < 0) return null;
                
                // ä½¿ç”¨å¿«é€Ÿå¹‚ç®—æ³•
                let result = '1';
                let base = a;
                let exp = exponent;
                
                while (exp > 0) {
                    if (exp % 2 === 1) {
                        result = BigNumberCalc.multiply(result, base);
                    }
                    base = BigNumberCalc.multiply(base, base);
                    exp = Math.floor(exp / 2);
                }
                
                return result;
            },

            // æ¯”è¾ƒä¸¤ä¸ªå¤§æ•°å­—
            compare: (a, b) => {
                if (a.length > b.length) return 1;
                if (a.length < b.length) return -1;
                
                for (let i = 0; i < a.length; i++) {
                    if (a[i] > b[i]) return 1;
                    if (a[i] < b[i]) return -1;
                }
                
                return 0; // ç›¸ç­‰
            },

            calc: () => {
                const lang = document.getElementById('big-lang').value;
                const texts = BigNumberCalc.i18n[lang];
                const resultEl = document.getElementById('big-result');
                
                BigNumberCalc.clearError();
                
                // éªŒè¯è¿ç®—æ˜¯å¦å·²é€‰æ‹©
                if (!BigNumberCalc.selectedOperation) {
                    return BigNumberCalc.showError(texts.select_operation);
                }
                
                // è·å–å¹¶è§£æè¾“å…¥çš„æ•°å­—
                const numA = BigNumberCalc.parseBigNumber(document.getElementById('big-num-a').value);
                const numB = BigNumberCalc.parseBigNumber(document.getElementById('big-num-b').value);
                
                // éªŒè¯æ•°å­—æ ¼å¼
                if (numA === null || numB === null) {
                    return BigNumberCalc.showError(texts.err_invalid);
                }
                
                let result;
                try {
                    switch (BigNumberCalc.selectedOperation) {
                        case 'add':
                            result = BigNumberCalc.add(numA, numB);
                            break;
                        case 'subtract':
                            result = BigNumberCalc.subtract(numA, numB);
                            if (result === null) {
                                return BigNumberCalc.showError(texts.err_negative);
                            }
                            break;
                        case 'multiply':
                            result = BigNumberCalc.multiply(numA, numB);
                            break;
                        case 'divide':
                            if (numB === '0') {
                                return BigNumberCalc.showError(texts.err_divide_zero);
                            }
                            const division = BigNumberCalc.divide(numA, numB);
                            result = texts.division_result
                                .replace('{quotient}', division.quotient)
                                .replace('{remainder}', division.remainder);
                            break;
                        case 'power':
                            result = BigNumberCalc.power(numA, numB);
                            if (result === null) {
                                return BigNumberCalc.showError(texts.err_power);
                            }
                            break;
                    }
                } catch (e) {
                    return BigNumberCalc.showError(texts.err_invalid);
                }
                
                resultEl.innerText = result;
            }
        };

        document.addEventListener('DOMContentLoaded', BigNumberCalc.init);
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // è‡ªåŠ¨åŒ¹é…æµè§ˆå™¨è¯­è¨€
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            }
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('big-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    BigNumberCalc.changeLang();
                }
            }
        });
    </script>

</body>
</html>