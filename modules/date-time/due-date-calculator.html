<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Due Date Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="due_date_calculator">
    <meta name="category" content="Date & Time">
    <meta name="icon" content="ğŸ“…">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Due Date Calculator">
    <meta name="description" content="Calculate due dates by adding or subtracting days, weeks, months or years from a start date.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="æˆªæ­¢æ—¥æœŸè®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="é€šè¿‡ä»èµ·å§‹æ—¥æœŸæ·»åŠ æˆ–å‡å»å¤©æ•°ã€å‘¨æ•°ã€æœˆæ•°æˆ–å¹´æ•°æ¥è®¡ç®—æˆªæ­¢æ—¥æœŸã€‚">
    
    <meta name="lang-title-zh-TW" content="æˆªæ­¢æ—¥æœŸè¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="é€šéå¾èµ·å§‹æ—¥æœŸæ·»åŠ æˆ–æ¸›å»å¤©æ•¸ã€é€±æ•¸ã€æœˆæ•¸æˆ–å¹´æ•¸ä¾†è¨ˆç®—æˆªæ­¢æ—¥æœŸã€‚">
    
    <meta name="lang-title-ja" content="æœŸé™è¨ˆç®—ãƒ„ãƒ¼ãƒ«">
    <meta name="lang-description-ja" content="é–‹å§‹æ—¥ã‹ã‚‰æ—¥æ•°ã€é€±æ•°ã€æœˆæ•°ã€ã¾ãŸã¯å¹´æ•°ã‚’åŠ ç®—ã¾ãŸã¯æ¸›ç®—ã—ã¦æœŸé™ã‚’è¨ˆç®—ã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ ÑÑ€Ğ¾ĞºĞ¾Ğ² Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ">
    <meta name="lang-description-ru" content="Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞ¹Ñ‚Ğµ ÑÑ€Ğ¾ĞºĞ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ, Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸Ñ‚Ğ°Ñ Ğ´Ğ½Ğ¸, Ğ½ĞµĞ´ĞµĞ»Ğ¸, Ğ¼ĞµÑÑÑ†Ñ‹ Ğ¸Ğ»Ğ¸ Ğ³Ğ¾Ğ´Ñ‹ Ğ¾Ñ‚ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ´Ğ°Ñ‚Ñ‹.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .result-section { margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 8px; }
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .form-group { flex: 1; min-width: 150px; }
        .period-inputs { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 15px; }
        .period-group { display: flex; align-items: center; gap: 5px; }
        select, input[type="date"], input[type="number"] { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .result-item { background: white; padding: 10px; border-radius: 4px; margin-bottom: 10px; }
        .result-label { font-size: 0.8rem; color: #666; }
        .result-value { font-size: 1.2rem; font-weight: 500; }
        .date-diff { margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ccc; font-size: 0.9rem; }
    </style>
    <link rel="canonical" href="https://toolboxpro.top/modules/date-time/due-date-calculator.html" />
</head>
<body>

    <div class="tool-module active" 
         data-id="due_date_calculator" 
         data-category="calculators" 
         data-title="Due Date Calculator" 
         data-icon="ğŸ“…">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="due-date-lang" onchange="DueDateCalculator.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ğŸ“… Due Date Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <!-- èµ·å§‹æ—¥æœŸ -->
            <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="start_date">Start Date</label>
                <input type="date" id="start-date" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
            </div>
            
            <!-- æ“ä½œç±»å‹ -->
            <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="operation">Operation</label>
                <select id="operation" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                    <option value="add" selected data-i18n="add">Add</option>
                    <option value="subtract" data-i18n="subtract">Subtract</option>
                </select>
            </div>
            
            <!-- æ—¶é—´å‘¨æœŸè¾“å…¥ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="period">Time Period</label>
                <div class="period-inputs">
                    <div class="period-group">
                        <input type="number" id="years" min="0" value="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                        <label class="text-sm text-gray-600" data-i18n="years">years</label>
                    </div>
                    <div class="period-group">
                        <input type="number" id="months" min="0" max="11" value="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                        <label class="text-sm text-gray-600" data-i18n="months">months</label>
                    </div>
                    <div class="period-group">
                        <input type="number" id="weeks" min="0" value="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                        <label class="text-sm text-gray-600" data-i18n="weeks">weeks</label>
                    </div>
                    <div class="period-group">
                        <input type="number" id="days" min="0" value="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                        <label class="text-sm text-gray-600" data-i18n="days">days</label>
                    </div>
                </div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="flex gap-2">
                <button onclick="DueDateCalculator.clearValue()" class="flex-1 bg-gray-600 text-white py-2 rounded font-bold hover:bg-gray-700 transition" data-i18n="clear">Clear</button>
                <button onclick="DueDateCalculator.calculate()" class="flex-2 bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition" data-i18n="calculate">Calculate Due Date</button>
            </div>
        </div>

        <!-- é”™è¯¯æç¤º -->
        <div id="due-date-error" class="text-sm text-red-600 mt-2 hidden mb-4"></div>
        
        <!-- ç»“æœå±•ç¤º -->
        <div id="due-date-results" class="hidden">
            <div class="text-sm text-gray-500 mb-2" data-i18n="result">Result</div>
            <div class="result-section">
                <div class="result-item">
                    <div class="result-label" data-i18n="due_date">Due Date</div>
                    <div class="result-value" id="calculated-due-date">-</div>
                    <div class="date-diff" id="date-diff-from-today">-</div>
                </div>
                
                <div class="result-item">
                    <div class="result-label" data-i18n="date_breakdown">Date Breakdown</div>
                    <div class="result-value" id="date-breakdown">-</div>
                </div>
                
                <div class="result-item">
                    <div class="result-label" data-i18n="day_of_week">Day of the Week</div>
                    <div class="result-value" id="day-of-week">-</div>
                </div>
            </div>
        </div>

        <!-- è¯´æ˜ä¿¡æ¯ -->
        <div class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600">
            <p data-i18n="notes">Notes:</p>
            <ul class="list-disc list-inside mt-2 space-y-1" id="notes-list">
                <li data-i18n="note1">This calculator adds or subtracts the specified time period from the start date</li>
                <li data-i18n="note2">Month calculations are approximate and based on calendar months</li>
                <li data-i18n="note3">1 week = 7 days, 1 year is considered as 365 days</li>
            </ul>
        </div>
    </div>

    <script>
        const DueDateCalculator = {
            i18n: {
                'en': {
                    title: 'ğŸ“… Due Date Calculator',
                    start_date: 'Start Date',
                    operation: 'Operation',
                    add: 'Add',
                    subtract: 'Subtract',
                    period: 'Time Period',
                    years: 'years',
                    months: 'months',
                    weeks: 'weeks',
                    days: 'days',
                    clear: 'Clear',
                    calculate: 'Calculate Due Date',
                    result: 'Result',
                    due_date: 'Due Date',
                    date_breakdown: 'Date Breakdown',
                    day_of_week: 'Day of the Week',
                    notes: 'Notes:',
                    note1: 'This calculator adds or subtracts the specified time period from the start date',
                    note2: 'Month calculations are approximate and based on calendar months',
                    note3: '1 week = 7 days, 1 year is considered as 365 days',
                    err_invalid_date: 'Please select a valid start date',
                    err_no_period: 'Please enter at least one time period value',
                    days_from_today: 'Days from today: ',
                    days_ago: 'days ago',
                    days_from_now: 'days from now'
                },
                'zh-CN': {
                    title: 'ğŸ“… æˆªæ­¢æ—¥æœŸè®¡ç®—å™¨',
                    start_date: 'èµ·å§‹æ—¥æœŸ',
                    operation: 'æ“ä½œ',
                    add: 'æ·»åŠ ',
                    subtract: 'å‡å»',
                    period: 'æ—¶é—´å‘¨æœŸ',
                    years: 'å¹´',
                    months: 'æœˆ',
                    weeks: 'å‘¨',
                    days: 'å¤©',
                    clear: 'æ¸…é™¤',
                    calculate: 'è®¡ç®—æˆªæ­¢æ—¥æœŸ',
                    result: 'ç»“æœ',
                    due_date: 'æˆªæ­¢æ—¥æœŸ',
                    date_breakdown: 'æ—¥æœŸåˆ†è§£',
                    day_of_week: 'æ˜ŸæœŸå‡ ',
                    notes: 'è¯´æ˜ï¼š',
                    note1: 'æ­¤è®¡ç®—å™¨ä»èµ·å§‹æ—¥æœŸæ·»åŠ æˆ–å‡å»æŒ‡å®šçš„æ—¶é—´æ®µ',
                    note2: 'æœˆä»½è®¡ç®—æ˜¯è¿‘ä¼¼å€¼ï¼ŒåŸºäºæ—¥å†æœˆä»½',
                    note3: '1å‘¨ = 7å¤©ï¼Œ1å¹´æŒ‰365å¤©è®¡ç®—',
                    err_invalid_date: 'è¯·é€‰æ‹©æœ‰æ•ˆçš„èµ·å§‹æ—¥æœŸ',
                    err_no_period: 'è¯·è‡³å°‘è¾“å…¥ä¸€ä¸ªæ—¶é—´æ®µå€¼',
                    days_from_today: 'ä¸ä»Šå¤©ç›¸å·®ï¼š',
                    days_ago: 'å¤©å‰',
                    days_from_now: 'å¤©å'
                },
                'zh-TW': {
                    title: 'ğŸ“… æˆªæ­¢æ—¥æœŸè¨ˆç®—å™¨',
                    start_date: 'èµ·å§‹æ—¥æœŸ',
                    operation: 'æ“ä½œ',
                    add: 'æ·»åŠ ',
                    subtract: 'æ¸›å»',
                    period: 'æ™‚é–“å‘¨æœŸ',
                    years: 'å¹´',
                    months: 'æœˆ',
                    weeks: 'é€±',
                    days: 'å¤©',
                    clear: 'æ¸…é™¤',
                    calculate: 'è¨ˆç®—æˆªæ­¢æ—¥æœŸ',
                    result: 'çµæœ',
                    due_date: 'æˆªæ­¢æ—¥æœŸ',
                    date_breakdown: 'æ—¥æœŸåˆ†è§£',
                    day_of_week: 'æ˜ŸæœŸå¹¾',
                    notes: 'èªªæ˜ï¼š',
                    note1: 'æ­¤è¨ˆç®—å™¨å¾èµ·å§‹æ—¥æœŸæ·»åŠ æˆ–æ¸›å»æŒ‡å®šçš„æ™‚é–“æ®µ',
                    note2: 'æœˆä»½è¨ˆç®—æ˜¯è¿‘ä¼¼å€¼ï¼ŒåŸºæ–¼æ—¥æ›†æœˆä»½',
                    note3: '1é€± = 7å¤©ï¼Œ1å¹´æŒ‰365å¤©è¨ˆç®—',
                    err_invalid_date: 'è«‹é¸æ“‡æœ‰æ•ˆçš„èµ·å§‹æ—¥æœŸ',
                    err_no_period: 'è«‹è‡³å°‘è¼¸å…¥ä¸€å€‹æ™‚é–“æ®µå€¼',
                    days_from_today: 'èˆ‡ä»Šå¤©ç›¸å·®ï¼š',
                    days_ago: 'å¤©å‰',
                    days_from_now: 'å¤©å'
                },
                'ja': {
                    title: 'ğŸ“… æœŸé™è¨ˆç®—ãƒ„ãƒ¼ãƒ«',
                    start_date: 'é–‹å§‹æ—¥',
                    operation: 'æ“ä½œ',
                    add: 'åŠ ç®—',
                    subtract: 'æ¸›ç®—',
                    period: 'æ™‚é–“æœŸé–“',
                    years: 'å¹´',
                    months: 'æœˆ',
                    weeks: 'é€±',
                    days: 'æ—¥',
                    clear: 'ã‚¯ãƒªã‚¢',
                    calculate: 'æœŸé™ã‚’è¨ˆç®—',
                    result: 'çµæœ',
                    due_date: 'æœŸé™æ—¥',
                    date_breakdown: 'æ—¥ä»˜ã®å†…è¨³',
                    day_of_week: 'æ›œæ—¥',
                    notes: 'æ³¨é‡ˆï¼š',
                    note1: 'ã“ã®è¨ˆç®—æ©Ÿã¯ã€é–‹å§‹æ—¥ã«æŒ‡å®šã•ã‚ŒãŸæ™‚é–“æœŸé–“ã‚’åŠ ç®—ã¾ãŸã¯æ¸›ç®—ã—ã¾ã™',
                    note2: 'æœˆã®è¨ˆç®—ã¯æ¦‚ç®—ã§ã‚ã‚Šã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æœˆã«åŸºã¥ã„ã¦ã„ã¾ã™',
                    note3: '1é€±é–“ = 7æ—¥ã€1å¹´ã¯365æ—¥ã¨è¦‹ãªã•ã‚Œã¾ã™',
                    err_invalid_date: 'æœ‰åŠ¹ãªé–‹å§‹æ—¥ã‚’é¸æŠã—ã¦ãã ã•ã„',
                    err_no_period: 'å°‘ãªãã¨ã‚‚1ã¤ã®æ™‚é–“æœŸé–“ã®å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
                    days_from_today: 'ä»Šæ—¥ã‹ã‚‰ã®æ—¥æ•°ï¼š',
                    days_ago: 'æ—¥å‰',
                    days_from_now: 'æ—¥å¾Œ'
                },
                'ru': {
                    title: 'ğŸ“… ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ ÑÑ€Ğ¾ĞºĞ¾Ğ² Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ',
                    start_date: 'ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ´Ğ°Ñ‚Ğ°',
                    operation: 'ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ',
                    add: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ',
                    subtract: 'Ğ’Ñ‹Ñ‡ĞµÑÑ‚ÑŒ',
                    period: 'Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´',
                    years: 'Ğ»ĞµÑ‚',
                    months: 'Ğ¼ĞµÑÑÑ†ĞµĞ²',
                    weeks: 'Ğ½ĞµĞ´ĞµĞ»ÑŒ',
                    days: 'Ğ´Ğ½ĞµĞ¹',
                    clear: 'ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ',
                    calculate: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ ÑÑ€Ğ¾Ğº',
                    result: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                    due_date: 'Ğ¡Ñ€Ğ¾Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ',
                    date_breakdown: 'Ğ Ğ°Ğ·Ğ±Ğ¾Ñ€ Ğ´Ğ°Ñ‚Ñ‹',
                    day_of_week: 'Ğ”ĞµĞ½ÑŒ Ğ½ĞµĞ´ĞµĞ»Ğ¸',
                    notes: 'ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ:',
                    note1: 'Ğ­Ñ‚Ğ¾Ñ‚ ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´ Ğ¸Ğ· Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ´Ğ°Ñ‚Ñ‹',
                    note2: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ Ğ¼ĞµÑÑÑ†ĞµĞ² ÑĞ²Ğ»ÑÑÑ‚ÑÑ Ğ¿Ñ€Ğ¸Ğ±Ğ»Ğ¸Ğ·Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¸ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ½Ğ° ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑÑ†Ğ°Ñ…',
                    note3: '1 Ğ½ĞµĞ´ĞµĞ»Ñ = 7 Ğ´Ğ½ĞµĞ¹, 1 Ğ³Ğ¾Ğ´ ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ·Ğ° 365 Ğ´Ğ½ĞµĞ¹',
                    err_invalid_date: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ´Ğ°Ñ‚Ñƒ',
                    err_no_period: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ½Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ°',
                    days_from_today: 'Ğ”Ğ½ĞµĞ¹ Ğ¾Ñ‚ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ: ',
                    days_ago: 'Ğ´Ğ½ĞµĞ¹ Ğ½Ğ°Ğ·Ğ°Ğ´',
                    days_from_now: 'Ğ´Ğ½ĞµĞ¹ Ğ¸Ğ· Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ³Ğ¾'
                }
            },
            
            // åˆå§‹åŒ–
            init: function() {
                const params = new URLSearchParams(window.location.search);
                const lang = params.get('lang');
                if (lang && this.i18n[lang]) {
                    document.getElementById('lang-selector').value = lang;
                    this.changeLang();
                    return;
                }
                // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('start-date').value = today;
            },
            
            // æ—¥æœŸè®¡ç®—è¾…åŠ©å‡½æ•°
            addPeriodToDate: function(date, years, months, weeks, days) {
                let result = new Date(date);
                
                // æ·»åŠ å¹´
                result.setFullYear(result.getFullYear() + years);
                
                // æ·»åŠ æœˆï¼ˆéœ€è¦å¤„ç†æœˆä»½æº¢å‡ºï¼‰
                let newMonth = result.getMonth() + months;
                let yearOffset = Math.floor(newMonth / 12);
                newMonth = newMonth % 12;
                if (newMonth < 0) {
                    newMonth += 12;
                    yearOffset -= 1;
                }
                result.setFullYear(result.getFullYear() + yearOffset);
                result.setMonth(newMonth);
                
                // æ·»åŠ å‘¨å’Œå¤©ï¼ˆ1å‘¨=7å¤©ï¼‰
                const totalDays = weeks * 7 + days;
                result.setDate(result.getDate() + totalDays);
                
                return result;
            },
            
            // è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å·®
            daysBetween: function(date1, date2) {
                const oneDay = 24 * 60 * 60 * 1000; // æ¯«ç§’
                const firstDate = new Date(date1);
                const secondDate = new Date(date2);
                return Math.round((secondDate - firstDate) / oneDay);
            },
            
            // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
            formatDate: function(date) {
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return new Date(date).toLocaleDateString(this.getCurrentLang(), options);
            },
            
            // æ ¼å¼åŒ–æ—¥æœŸåˆ†è§£
            formatDateBreakdown: function(date) {
                const d = new Date(date);
                const year = d.getFullYear();
                const month = d.getMonth() + 1; // æœˆä»½ä»0å¼€å§‹
                const day = d.getDate();
                
                return `${year} ${this.i18n[this.getCurrentLang()].years}, ${month} ${this.i18n[this.getCurrentLang()].months}, ${day} ${this.i18n[this.getCurrentLang()].days}`;
            },
            
            // è·å–æ˜ŸæœŸå‡ 
            getDayOfWeek: function(date) {
                const options = { weekday: 'long' };
                return new Date(date).toLocaleDateString(this.getCurrentLang(), options);
            },
            
            // è®¡ç®—æˆªæ­¢æ—¥æœŸ
            calculate: function() {
                const startDate = document.getElementById('start-date').value;
                const operation = document.getElementById('operation').value;
                const years = parseInt(document.getElementById('years').value) || 0;
                const months = parseInt(document.getElementById('months').value) || 0;
                const weeks = parseInt(document.getElementById('weeks').value) || 0;
                const days = parseInt(document.getElementById('days').value) || 0;
                
                const errorEl = document.getElementById('due-date-error');
                const resultsEl = document.getElementById('due-date-results');
                const today = new Date();
                
                // éªŒè¯è¾“å…¥
                if (!startDate) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_invalid_date;
                    errorEl.classList.remove('hidden');
                    resultsEl.classList.add('hidden');
                    return;
                }
                
                if (years === 0 && months === 0 && weeks === 0 && days === 0) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_no_period;
                    errorEl.classList.remove('hidden');
                    resultsEl.classList.add('hidden');
                    return;
                }
                
                // æ¸…é™¤é”™è¯¯
                errorEl.classList.add('hidden');
                
                // æ ¹æ®æ“ä½œç±»å‹è®¡ç®—æ—¥æœŸ
                let dueDate;
                if (operation === 'add') {
                    dueDate = this.addPeriodToDate(startDate, years, months, weeks, days);
                } else {
                    // å‡æ³•å°±æ˜¯æ·»åŠ è´Ÿå€¼
                    dueDate = this.addPeriodToDate(startDate, -years, -months, -weeks, -days);
                }
                
                // è®¡ç®—ä¸ä»Šå¤©çš„å·®å€¼
                const daysDiff = this.daysBetween(today, dueDate);
                let daysDiffText;
                if (daysDiff === 0) {
                    daysDiffText = this.i18n[this.getCurrentLang()].days_from_today + '0 ' + this.i18n[this.getCurrentLang()].days;
                } else if (daysDiff > 0) {
                    daysDiffText = this.i18n[this.getCurrentLang()].days_from_today + daysDiff + ' ' + this.i18n[this.getCurrentLang()].days_from_now;
                } else {
                    daysDiffText = this.i18n[this.getCurrentLang()].days_from_today + Math.abs(daysDiff) + ' ' + this.i18n[this.getCurrentLang()].days_ago;
                }
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('calculated-due-date').textContent = this.formatDate(dueDate);
                document.getElementById('date-diff-from-today').textContent = daysDiffText;
                document.getElementById('date-breakdown').textContent = this.formatDateBreakdown(dueDate);
                document.getElementById('day-of-week').textContent = this.getDayOfWeek(dueDate);
                
                // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                resultsEl.classList.remove('hidden');
            },
            
            // æ¸…é™¤è¾“å…¥
            clearValue: function() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('start-date').value = today;
                document.getElementById('years').value = '0';
                document.getElementById('months').value = '0';
                document.getElementById('weeks').value = '0';
                document.getElementById('days').value = '0';
                document.getElementById('due-date-results').classList.add('hidden');
                document.getElementById('due-date-error').classList.add('hidden');
            },
            
            // åˆ‡æ¢è¯­è¨€
            changeLang: function() {
                const lang = this.getCurrentLang();
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang][key]) {
                        el.textContent = this.i18n[lang][key];
                    }
                });
                
                // æ›´æ–°æ“ä½œä¸‹æ‹‰èœå•é€‰é¡¹
                const operationSelect = document.getElementById('operation');
                operationSelect.options[0].textContent = this.i18n[lang].add;
                operationSelect.options[1].textContent = this.i18n[lang].subtract;
                
                // å¦‚æœæœ‰ç»“æœï¼Œé‡æ–°è®¡ç®—ä»¥æ›´æ–°æ—¥æœŸæ ¼å¼å’Œæ–‡æœ¬
                if (!document.getElementById('due-date-results').classList.contains('hidden')) {
                    this.calculate();
                }
            },
            
            // è·å–å½“å‰è¯­è¨€
            getCurrentLang: function() {
                return document.getElementById('due-date-lang').value;
            }
        };
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            DueDateCalculator.init();
        });
    </script>

    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
    
</body>
</html>