<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="tool-id" content="multi-language">
    <meta name="category" content="date-time">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Scientific Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—ä½“ */
        body { font-family: 'Inter', sans-serif; background: #f3f4f6; padding: 20px; }
        .tool-module { 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 10px 15px rgba(0,0,0,0.1); 
            max-width: 700px; 
            margin: 0 auto; 
            padding: 24px; 
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        .calculator {
            background-color: #1f2937; /* æ·±è‰²èƒŒæ™¯ */
            padding: 16px;
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .display {
            background-color: #0d121c; /* æ›´æ·±çš„æ˜¾ç¤ºå±èƒŒæ™¯ */
            color: #d1fa1e; /* éœ“è™¹ç»¿å­—ä½“ */
            font-size: 2.5rem;
            text-align: right;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            overflow-x: auto;
            white-space: nowrap;
            height: 70px;
            line-height: 40px;
            font-family: monospace;
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr); /* 6åˆ—å¸ƒå±€ */
            gap: 10px;
        }
        .btn {
            @apply p-4 rounded-lg text-white font-semibold shadow-md transition-all duration-150 ease-in-out;
            min-width: 40px;
            line-height: 1;
            /* å¢åŠ æŒ‰é’®çš„ç‚¹å‡»åé¦ˆ */
            transition: transform 0.1s ease-in-out;
        }
        .btn:active {
            transform: scale(0.95);
        }
        .btn-num {
            background-color: #4b5563; /* ç°è‰²æ•°å­—é”® */
        }
        .btn-op {
            background-color: #f59e0b; /* æ©™è‰²æ“ä½œç¬¦ */
        }
        .btn-sci {
            background-color: #374151; /* æ·±ç°è‰²ç§‘å­¦é”® */
            font-size: 0.8rem;
        }
        .btn-clear {
            background-color: #dc2626; /* çº¢è‰²æ¸…é™¤é”® */
        }
        .btn-mode {
            background-color: #10b981; /* ç»¿è‰²æ¨¡å¼é”® */
            font-size: 0.75rem;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 640px) {
            .button-grid {
                grid-template-columns: repeat(5, 1fr); /* ç§»åŠ¨ç«¯è°ƒæ•´ä¸º 5 åˆ— */
            }
            .btn {
                padding: 12px;
                font-size: 0.9rem;
            }
            .display {
                font-size: 2rem;
            }
            .btn-sci {
                font-size: 0.7rem;
            }
            /* éšè—ä¸€åˆ—åœ¨å°å±å¹•ä¸Š */
            .hidden-sm {
                display: none;
            }
        }
    </style>
    <link rel="canonical" href="https://toolboxpro.top/modules/date-time/multi-language.html" />
</head>
<body>

    <div class="tool-module"
         data-id="sci_calc"
         data-category="math"
         data-title="Scientific Calculator"
         data-icon="ğŸ§®">

        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="sc-lang" onchange="SciCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">ç°¡é«”ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <!-- ä»‹ç»éƒ¨åˆ† -->
        <div class="description-section">
            <h1 class="text-3xl font-bold text-gray-800 mb-4" data-i18n="description_h1">Scientific Calculator</h1>
            <p class="text-gray-600 mb-2" data-i18n="description_p1">This calculator supports basic arithmetic along with advanced scientific functions like trigonometry, logarithms, powers, and constants.</p>
            <p class="text-gray-600" data-i18n="description_p2">Use the DEG/RAD button to switch between degree mode and radian mode for trigonometric functions.</p>
        </div>

        <!-- è®¡ç®—å™¨ç•Œé¢ -->
        <div class="calculator">
            <!-- æ˜¾ç¤ºå± -->
            <div id="sc-display" class="display">0</div>

            <!-- æŒ‰é’®ç½‘æ ¼ -->
            <div class="button-grid">
                
                <!-- ç§‘å­¦å‡½æ•° - æ¨¡å¼/å¸¸æ•° -->
                <button class="btn btn-mode" data-i18n="mode_deg" id="mode-toggle" onclick="SciCalc.toggleMode()">DEG</button>
                <button class="btn btn-sci hidden-sm" onclick="SciCalc.handleConstant('pi')">Ï€</button>
                <button class="btn btn-sci hidden-sm" onclick="SciCalc.handleConstant('e')">e</button>

                <!-- æ¸…é™¤/å›é€€/æ­£è´Ÿå· -->
                <button class="btn btn-clear" onclick="SciCalc.clearAll()">C</button>
                <button class="btn btn-clear" onclick="SciCalc.deleteLast()">&larr;</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('neg')">Â±</button>
                <button class="btn btn-op" onclick="SciCalc.handleOperator('/')">/</button>

                <!-- ç¬¬äºŒè¡Œ ç§‘å­¦å‡½æ•°/æ•°å­— -->
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('sin')">sin</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('cos')">cos</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('tan')">tan</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('7')">7</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('8')">8</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('9')">9</button>
                <button class="btn btn-op" onclick="SciCalc.handleOperator('*')">Ã—</button>

                <!-- ç¬¬ä¸‰è¡Œ ç§‘å­¦å‡½æ•°/æ•°å­— -->
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('log')">log</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('ln')">ln</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('fact')">x!</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('4')">4</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('5')">5</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('6')">6</button>
                <button class="btn btn-op" onclick="SciCalc.handleOperator('-')">âˆ’</button>

                <!-- ç¬¬å››è¡Œ ç§‘å­¦å‡½æ•°/æ•°å­— -->
                <button class="btn btn-sci" onclick="SciCalc.handleBinaryOp('pow')">xÊ¸</button>
                <button class="btn btn-sci" onclick="SciCalc.handleBinaryOp('sqr')">xÂ²</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('sqrt')">âˆš</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('1')">1</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('2')">2</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('3')">3</button>
                <button class="btn btn-op" onclick="SciCalc.handleOperator('+')">+</button>

                <!-- ç¬¬äº”è¡Œ ç§‘å­¦å‡½æ•°/æ•°å­—/ç­‰äº -->
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('inv')">1/x</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('exp')">eË£</button>
                <button class="btn btn-sci" onclick="SciCalc.handleUnaryOp('tenpow')">10Ë£</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('0')">0</button>
                <button class="btn btn-num" onclick="SciCalc.handleNumber('.')">.</button>
                <button class="btn btn-op col-span-2" onclick="SciCalc.calculate()">=</button>
            </div>
        </div>
    </div>

    <script>
        const SciCalc = {
            // å›½é™…åŒ–æ–‡æœ¬å®šä¹‰
            i18n: {
                'en': {
                    title: 'Scientific Calculator',
                    description_h1: 'Scientific Calculator',
                    description_p1: 'This calculator supports basic arithmetic along with advanced scientific functions like trigonometry, logarithms, powers, and constants.',
                    description_p2: 'Use the DEG/RAD button to switch between degree mode and radian mode for trigonometric functions.',
                    mode_deg: 'DEG',
                    mode_rad: 'RAD',
                    err_invalid: 'Error',
                    err_domain: 'Domain Error',
                    label_result: 'Result',
                },
                'zh-CN': {
                    title: 'ç§‘å­¦è®¡ç®—å™¨',
                    description_h1: 'ç§‘å­¦è®¡ç®—å™¨',
                    description_p1: 'æœ¬è®¡ç®—å™¨æ”¯æŒåŸºæœ¬ç®—æœ¯è¿ç®—ä»¥åŠä¸‰è§’å‡½æ•°ã€å¯¹æ•°ã€å¹‚ã€æ ¹å·å’Œå¸¸æ•°ç­‰é«˜çº§ç§‘å­¦åŠŸèƒ½ã€‚',
                    description_p2: 'ä½¿ç”¨ DEG/RAD æŒ‰é’®å¯ä»¥åœ¨ä¸‰è§’å‡½æ•°è®¡ç®—ä¸­åˆ‡æ¢è§’åº¦æ¨¡å¼å’Œå¼§åº¦æ¨¡å¼ã€‚',
                    mode_deg: 'è§’åº¦(DEG)',
                    mode_rad: 'å¼§åº¦(RAD)',
                    err_invalid: 'é”™è¯¯',
                    err_domain: 'å®šä¹‰åŸŸé”™è¯¯',
                    label_result: 'ç»“æœ',
                },
                'zh-TW': {
                    title: 'ç§‘å­¸è¨ˆç®—æ©Ÿ',
                    description_h1: 'ç§‘å­¸è¨ˆç®—æ©Ÿ',
                    description_p1: 'æœ¬è¨ˆç®—æ©Ÿæ”¯æ´åŸºæœ¬ç®—è¡“é‹ç®—ä»¥åŠä¸‰è§’å‡½æ•¸ã€å°æ•¸ã€å†ªã€æ ¹è™Ÿå’Œå¸¸æ•¸ç­‰é«˜ç´šç§‘å­¸åŠŸèƒ½ã€‚',
                    description_p2: 'ä½¿ç”¨ DEG/RAD æŒ‰éˆ•å¯ä»¥åœ¨ä¸‰è§’å‡½æ•¸è¨ˆç®—ä¸­åˆ‡æ›è§’åº¦æ¨¡å¼å’Œå¼§åº¦æ¨¡å¼ã€‚',
                    mode_deg: 'è§’åº¦(DEG)',
                    mode_rad: 'å¼§åº¦(RAD)',
                    err_invalid: 'éŒ¯èª¤',
                    err_domain: 'å®šç¾©åŸŸéŒ¯èª¤',
                    label_result: 'çµæœ',
                },
                'ja': {
                    title: 'é–¢æ•°é›»å“',
                    description_h1: 'é–¢æ•°é›»å“',
                    description_p1: 'ã“ã®é›»å“ã¯ã€ä¸‰è§’é–¢æ•°ã€å¯¾æ•°ã€ã¹ãä¹—ã€å®šæ•°ãªã©ã®é«˜åº¦ãªç§‘å­¦æ©Ÿèƒ½ã¨ã¨ã‚‚ã«ã€åŸºæœ¬çš„ãªç®—è¡“æ¼”ç®—ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚',
                    description_p2: 'ä¸‰è§’é–¢æ•°ã«ã¯ã€DEG/RADãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦åº¦ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¸ã‚¢ãƒ³ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚',
                    mode_deg: 'åº¦(DEG)',
                    mode_rad: 'ãƒ©ã‚¸ã‚¢ãƒ³(RAD)',
                    err_invalid: 'ã‚¨ãƒ©ãƒ¼',
                    err_domain: 'å®šç¾©åŸŸã‚¨ãƒ©ãƒ¼',
                    label_result: 'çµæœ',
                },
                'ru': {
                    title: 'ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€',
                    description_h1: 'ĞĞ°ÑƒÑ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€',
                    description_p1: 'Ğ­Ñ‚Ğ¾Ñ‚ ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ°Ñ€Ğ¸Ñ„Ğ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸, Ğ° Ñ‚Ğ°ĞºĞ¶Ğµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğµ Ğ½Ğ°ÑƒÑ‡Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸, Ñ‚Ğ°ĞºĞ¸Ğµ ĞºĞ°Ğº Ñ‚Ñ€Ğ¸Ğ³Ğ¾Ğ½Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ, Ğ»Ğ¾Ğ³Ğ°Ñ€Ğ¸Ñ„Ğ¼Ñ‹, ÑÑ‚ĞµĞ¿ĞµĞ½Ğ¸ Ğ¸ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹.',
                    description_p2: 'DEG/RAD ĞºĞ½Ğ¾Ğ¿ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ³Ñ€Ğ°Ğ´ÑƒÑĞ½Ñ‹Ğ¼ Ğ¸ Ñ€Ğ°Ğ´Ğ¸Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°Ğ¼Ğ¸ Ğ´Ğ»Ñ Ñ‚Ñ€Ğ¸Ğ³Ğ¾Ğ½Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹.',
                    mode_deg: 'Ğ“Ğ ĞĞ”',
                    mode_rad: 'Ğ ĞĞ”',
                    err_invalid: 'ĞÑˆĞ¸Ğ±ĞºĞ°',
                    err_domain: 'ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ',
                    label_result: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                }
            },

            currentLang: 'en', // é»˜è®¤è®¾ç½®ä¸ºè‹±æ–‡ (en)
            display: document.getElementById('sc-display'),

            // è®¡ç®—çŠ¶æ€
            currentInput: '0', 
            operator: null, 
            previousValue: null, 
            isNewNumber: true, 
            mode: 'DEG', // 'DEG' or 'RAD'

            /**
             * æ ¼å¼åŒ–æ•°å­—ï¼Œå¤„ç†ç§‘å­¦è®¡æ•°æ³•å’Œé”™è¯¯
             * @param {number} n - è¦æ ¼å¼åŒ–çš„æ•°å­—
             * @returns {string} - æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²
             */
            format: (n) => {
                const texts = SciCalc.i18n[SciCalc.currentLang];
                if (n === Infinity || n === -Infinity) return texts.err_invalid;
                if (isNaN(n)) return texts.err_invalid;
                
                // ç¡®ä¿ç»“æœä¸ä¼šæœ‰å¤ªå¤šå°æ•°ä½ï¼Œä½¿ç”¨ toPrecision é¿å…æµ®ç‚¹é”™è¯¯
                let result = n.toPrecision(10); 
                
                // ç§»é™¤ä¸å¿…è¦çš„å°æ•°ç‚¹å’Œå°¾éšé›¶
                return parseFloat(result).toString();
            },

            /**
             * ç»Ÿä¸€çš„æ˜¾ç¤ºæ›´æ–°å‡½æ•°
             */
            updateDisplay: () => {
                SciCalc.display.textContent = SciCalc.currentInput;
            },

            /**
             * å¤„ç†æ•°å­—å’Œç‚¹ (0-9, .)
             * @param {string} val - æŒ‰ä¸‹çš„æ•°å­—æˆ–ç‚¹
             */
            handleNumber: (val) => {
                if (SciCalc.isNewNumber) {
                    if (val === '.') {
                        SciCalc.currentInput = '0.';
                    } else {
                        SciCalc.currentInput = val;
                    }
                    SciCalc.isNewNumber = false;
                } else {
                    if (val === '.') {
                        if (SciCalc.currentInput.indexOf('.') === -1) {
                            SciCalc.currentInput += '.';
                        }
                    } else if (SciCalc.currentInput === '0') {
                        SciCalc.currentInput = val;
                    } else {
                        SciCalc.currentInput += val;
                    }
                }
                SciCalc.updateDisplay();
            },

            /**
             * æ‰§è¡Œç­‰å¾…ä¸­çš„äºŒå…ƒæ“ä½œ
             */
            executePendingOperation: () => {
                if (SciCalc.operator === null || SciCalc.previousValue === null) return;

                const currentValue = parseFloat(SciCalc.currentInput);
                const prevValue = parseFloat(SciCalc.previousValue);
                let result;
                const texts = SciCalc.i18n[SciCalc.currentLang];

                try {
                    switch (SciCalc.operator) {
                        case '+':
                            result = prevValue + currentValue;
                            break;
                        case '-':
                            result = prevValue - currentValue;
                            break;
                        case '*':
                            result = prevValue * currentValue;
                            break;
                        case '/':
                            if (currentValue === 0) throw new Error("Division by zero");
                            result = prevValue / currentValue;
                            break;
                        case 'pow': // x^y
                            result = Math.pow(prevValue, currentValue);
                            break;
                        default:
                            return;
                    }

                    SciCalc.currentInput = SciCalc.format(result);
                    SciCalc.previousValue = result; // ä¸ºè¿ç»­è®¡ç®—æ›´æ–° previousValue
                    SciCalc.operator = null;
                } catch (e) {
                    SciCalc.currentInput = texts.err_invalid;
                    SciCalc.clearState();
                }
            },

            /**
             * å¤„ç†äºŒå…ƒæ“ä½œç¬¦ (+, -, *, /, x^y)
             * @param {string} op - æ“ä½œç¬¦
             */
            handleOperator: (op) => {
                if (SciCalc.previousValue === null) {
                    SciCalc.previousValue = parseFloat(SciCalc.currentInput);
                } else if (!SciCalc.isNewNumber) {
                    // å¦‚æœä¸æ˜¯æ–°æ•°å­—ï¼Œè¯´æ˜æ˜¯è¿ç»­æ“ä½œï¼Œå…ˆæ‰§è¡Œä¸Šä¸€ä¸ªæ“ä½œ
                    SciCalc.executePendingOperation();
                    SciCalc.previousValue = parseFloat(SciCalc.currentInput); // ç¡®ä¿ previousValue è¢«æ›´æ–°ä¸ºæ‰§è¡Œç»“æœ
                }

                SciCalc.operator = op;
                SciCalc.isNewNumber = true; // ä¸‹ä¸€æ¬¡è¾“å…¥æ˜¯æ–°æ•°å­—
                SciCalc.updateDisplay();
            },
            
            /**
             * å¤„ç†ç‰¹å®šçš„äºŒå…ƒæ“ä½œï¼Œä¾‹å¦‚ x^y
             * @param {string} op - æ“ä½œç¬¦ (ç›®å‰åªæœ‰ 'pow' å’Œ 'sqr')
             */
            handleBinaryOp: (op) => {
                if (op === 'sqr') {
                    // xÂ² æ˜¯ä¸€ä¸ªä¸€å…ƒæ“ä½œï¼Œä½†ä¸ºäº†ç®€æ´æ”¾åœ¨è¿™é‡Œå¤„ç†
                    SciCalc.handleUnaryOp('sqr');
                    return;
                }

                SciCalc.handleOperator(op);
                SciCalc.updateDisplay();
            },

            /**
             * æœ€ç»ˆè®¡ç®—ç»“æœ (æŒ‰ä¸‹ '=')
             */
            calculate: () => {
                if (SciCalc.operator === null) return;
                
                SciCalc.executePendingOperation();
                SciCalc.operator = null;
                SciCalc.isNewNumber = true; // ç»“æœæ˜¾ç¤ºåï¼Œä¸‹æ¬¡æŒ‰æ•°å­—é”®å¼€å§‹æ–°è¾“å…¥
                SciCalc.previousValue = null; // æ¸…é™¤ previousValue ä»¥å¼€å§‹æ–°çš„è¡¨è¾¾å¼
                SciCalc.updateDisplay();
            },

            /**
             * è§’åº¦è½¬å¼§åº¦
             * @param {number} deg - è§’åº¦å€¼
             * @returns {number} - å¼§åº¦å€¼
             */
            toRad: (deg) => deg * (Math.PI / 180),

            /**
             * å¤„ç†ä¸€å…ƒæ“ä½œ (sin, cos, log, sqrt, 1/x, x!)
             * @param {string} op - æ“ä½œç¬¦
             */
            handleUnaryOp: (op) => {
                let value = parseFloat(SciCalc.currentInput);
                let result;
                const texts = SciCalc.i18n[SciCalc.currentLang];

                try {
                    if (isNaN(value)) throw new Error("Invalid input");

                    switch (op) {
                        case 'neg': // ç¬¦å·åˆ‡æ¢
                            result = -value;
                            break;
                        case 'sin':
                            let radSin = SciCalc.mode === 'DEG' ? SciCalc.toRad(value) : value;
                            result = Math.sin(radSin);
                            // ä¿®æ­£æµ®ç‚¹è¯¯å·®ï¼Œä¾‹å¦‚ sin(180 deg) åº”è¯¥æ˜¯ 0
                            if (Math.abs(result) < 1e-10) result = 0; 
                            break;
                        case 'cos':
                            let radCos = SciCalc.mode === 'DEG' ? SciCalc.toRad(value) : value;
                            result = Math.cos(radCos);
                            // ä¿®æ­£æµ®ç‚¹è¯¯å·®ï¼Œä¾‹å¦‚ cos(90 deg) åº”è¯¥æ˜¯ 0
                            if (Math.abs(result) < 1e-10) result = 0; 
                            break;
                        case 'tan':
                            let radTan = SciCalc.mode === 'DEG' ? SciCalc.toRad(value) : value;
                            result = Math.tan(radTan);
                            if (SciCalc.mode === 'DEG' && (Math.abs(value % 90) < 1e-10) && (value % 180 !== 0)) {
                                // 90, 270 åº¦ç­‰ tan ä¸ºæ— ç©·å¤§
                                throw new Error("Domain Error");
                            }
                            break;
                        case 'log': // log10
                            if (value <= 0) throw new Error("Domain Error");
                            result = Math.log10(value);
                            break;
                        case 'ln': // log e
                            if (value <= 0) throw new Error("Domain Error");
                            result = Math.log(value);
                            break;
                        case 'sqrt':
                            if (value < 0) throw new Error("Domain Error");
                            result = Math.sqrt(value);
                            break;
                        case 'inv': // 1/x
                            if (value === 0) throw new Error("Division by zero");
                            result = 1 / value;
                            break;
                        case 'sqr': // xÂ²
                            result = Math.pow(value, 2);
                            break;
                        case 'exp': // e^x
                            result = Math.exp(value);
                            break;
                        case 'tenpow': // 10^x
                            result = Math.pow(10, value);
                            break;
                        case 'fact': // é˜¶ä¹˜ (åªæ”¯æŒæ•´æ•°)
                            if (value < 0 || value !== Math.floor(value)) throw new Error("Domain Error");
                            if (value > 20) throw new Error("Too large"); // é™åˆ¶å¤§å°ä»¥é¿å…æº¢å‡º
                            result = SciCalc.factorial(value);
                            break;
                        default:
                            return;
                    }

                    SciCalc.currentInput = SciCalc.format(result);
                    SciCalc.isNewNumber = true; // ç»“æœæ˜¾ç¤ºåï¼Œä¸‹æ¬¡æŒ‰æ•°å­—é”®å¼€å§‹æ–°è¾“å…¥
                    SciCalc.previousValue = null; // æ¸…é™¤çŠ¶æ€
                    SciCalc.operator = null;

                } catch (e) {
                    if (e.message === "Domain Error") {
                        SciCalc.currentInput = texts.err_domain;
                    } else {
                        SciCalc.currentInput = texts.err_invalid;
                    }
                    SciCalc.clearState();
                }
                SciCalc.updateDisplay();
            },

            /**
             * é˜¶ä¹˜è®¡ç®—è¾…åŠ©å‡½æ•°
             * @param {number} n - éè´Ÿæ•´æ•°
             * @returns {number} - é˜¶ä¹˜ç»“æœ
             */
            factorial: (n) => {
                if (n === 0) return 1;
                let res = 1;
                for (let i = 1; i <= n; i++) {
                    res *= i;
                }
                return res;
            },

            /**
             * å¤„ç†å¸¸æ•° (Ï€, e)
             * @param {string} constant - å¸¸æ•°åç§°
             */
            handleConstant: (constant) => {
                if (constant === 'pi') {
                    SciCalc.currentInput = SciCalc.format(Math.PI);
                } else if (constant === 'e') {
                    SciCalc.currentInput = SciCalc.format(Math.E);
                }
                SciCalc.isNewNumber = true; // å¸¸æ•°è¢«è§†ä¸ºä¸€ä¸ªå®Œæ•´çš„æ•°å­—
                SciCalc.updateDisplay();
            },

            /**
             * åˆ‡æ¢è§’åº¦/å¼§åº¦æ¨¡å¼
             */
            toggleMode: () => {
                if (SciCalc.mode === 'DEG') {
                    SciCalc.mode = 'RAD';
                } else {
                    SciCalc.mode = 'DEG';
                }
                SciCalc.changeLang(); // åˆ·æ–°æŒ‰é’®æ–‡æœ¬
            },

            /**
             * æ¸…é™¤æ‰€æœ‰çŠ¶æ€
             */
            clearAll: () => {
                SciCalc.currentInput = '0';
                SciCalc.operator = null;
                SciCalc.previousValue = null;
                SciCalc.isNewNumber = true;
                SciCalc.updateDisplay();
            },

            /**
             * æ¸…é™¤è®¡ç®—çŠ¶æ€ (ä¿ç•™æ˜¾ç¤ºå†…å®¹)
             */
            clearState: () => {
                SciCalc.operator = null;
                SciCalc.previousValue = null;
                SciCalc.isNewNumber = true;
            },

            /**
             * åˆ é™¤æœ€åä¸€ä¸ªè¾“å…¥å­—ç¬¦
             */
            deleteLast: () => {
                const texts = SciCalc.i18n[SciCalc.currentLang];
                if (SciCalc.isNewNumber && SciCalc.currentInput !== '0') return; // å¦‚æœæ˜¯ç»“æœï¼Œä¸åˆ é™¤
                if (SciCalc.currentInput === texts.err_invalid || SciCalc.currentInput === texts.err_domain) {
                     SciCalc.clearAll();
                     return;
                }

                if (SciCalc.currentInput.length > 1) {
                    SciCalc.currentInput = SciCalc.currentInput.slice(0, -1);
                } else {
                    SciCalc.currentInput = '0';
                    SciCalc.isNewNumber = true;
                }
                SciCalc.updateDisplay();
            },

            /**
             * åˆ‡æ¢è¯­è¨€
             */
            changeLang: () => {
                const langSelect = document.getElementById('sc-lang');
                const lang = langSelect.value;
                SciCalc.currentLang = lang;
                const texts = SciCalc.i18n[lang];
                
                // æ›´æ–° data-i18n æ–‡æœ¬
                const elements = document.querySelectorAll('[data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });

                // æ›´æ–° DEG/RAD æŒ‰é’®æ–‡æœ¬
                const modeBtn = document.getElementById('mode-toggle');
                modeBtn.innerText = SciCalc.mode === 'DEG' ? texts.mode_deg : texts.mode_rad;

                // é‡æ–°æ¸²æŸ“æ˜¾ç¤ºå±ï¼ˆä»¥é˜²æ˜¾ç¤ºçš„æ˜¯é”™è¯¯ä¿¡æ¯ï¼‰
                SciCalc.updateDisplay();
            },

            /**
             * åˆå§‹åŒ–
             */
            init: () => {
                // åˆå§‹è®¾ç½®è¯­è¨€ä¸º 'en'
                document.getElementById('sc-lang').value = 'en';
                SciCalc.changeLang();

                // ç›‘å¬é”®ç›˜è¾“å…¥
                document.addEventListener('keydown', (e) => {
                    const key = e.key;
                    if (/[0-9]/.test(key)) {
                        SciCalc.handleNumber(key);
                    } else if (key === '.') {
                        SciCalc.handleNumber('.');
                    } else if (key === '+' || key === '-' || key === '*' || key === '/') {
                        SciCalc.handleOperator(key);
                    } else if (key === 'Enter' || key === '=') {
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤çš„è¡¨å•æäº¤è¡Œä¸º
                        SciCalc.calculate();
                    } else if (key === 'Backspace') {
                        SciCalc.deleteLast();
                    } else if (key === 'Delete') {
                        SciCalc.clearAll();
                    }
                });
            }
        };

        window.onload = SciCalc.init;
    </script>

    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
    

    <div id="toolbox-seo-wrapper-unique-id" class="max-w-4xl mx-auto px-4"></div>
    <script src="/scripts/seo-loader.js"></script>

</body>
</html>