<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daylight Saving Time Schedule</title>
    
    <!-- Meta Info -->
    <meta name="tool-id" content="daylight_saving_time">
    <meta name="category" content="date-time">
    <meta name="icon" content="â°">
    <meta name="title" content="Daylight Saving Time Schedule">
    <meta name="description" content="Check Daylight Saving Time (DST) schedules, start and end dates worldwide with automatic yearly updates.">

    <!-- Multilingual Meta -->
    <meta name="lang-title-zh-CN" content="å¤ä»¤æ—¶/å†¬ä»¤æ—¶æŸ¥è¯¢å·¥å…·">
    <meta name="lang-description-zh-CN" content="è‡ªåŠ¨æŸ¥è¯¢å…¨çƒä¸»è¦å›½å®¶å’Œåœ°åŒºçš„å¤ä»¤æ—¶ï¼ˆDSTï¼‰å¼€å§‹ä¸ç»“æŸæ—¶é—´ï¼Œæ”¯æŒå¤šè¯­è¨€æœç´¢åŠè·¨å¹´æ˜¾ç¤ºã€‚">
    <meta name="lang-title-zh-TW" content="å¤ä»¤æ™‚/å†¬ä»¤æ™‚æŸ¥è©¢å·¥å…·">
    <meta name="lang-title-es" content="Horario de Verano Mundial">
    <meta name="lang-title-ru" content="Ğ›ĞµÑ‚Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ² Ğ¼Ğ¸Ñ€Ğµ">
    <meta name="lang-title-hi" content="à¤¡à¥‡à¤²à¤¾à¤‡à¤Ÿ à¤¸à¥‡à¤µà¤¿à¤‚à¤— à¤Ÿà¤¾à¤‡à¤® à¤¶à¥‡à¤¡à¥à¤¯à¥‚à¤²">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        :root {
            /* Dark Mode (Default) */
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --bg-header: #0f172a; 
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --accent: #38bdf8; /* Sky Blue */
            --accent-hover: #0ea5e9;
            --border: #334155;
            --row-hover: #263346;
            --input-bg: #0f172a;
            --tag-bg: rgba(56, 189, 248, 0.1);
            --tag-text: #38bdf8;
            --scrollbar-thumb: #334155;
        }

        /* Light Mode */
        :root[data-theme="light"] {
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --bg-header: #f8fafc;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --accent: #0284c7; 
            --accent-hover: #0369a1;
            --border: #e2e8f0;
            --row-hover: #f8fafc;
            --input-bg: #ffffff;
            --tag-bg: #e0f2fe;
            --tag-text: #0284c7;
            --scrollbar-thumb: #cbd5e1;
        }

        body { 
            background: var(--bg-body); 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            color: var(--text-main);
            transition: background-color 0.3s, color 0.3s;
        }

        .tool-container {
            background: var(--bg-card);
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            min-height: 85vh;
            transition: all 0.3s ease;
        }

        /* Header */
        .header-title { text-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        /* Table Container */
        .table-wrapper {
            flex: 1;
            overflow: auto;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-top: 20px;
            position: relative;
            max-height: 60vh;
        }

        /* Custom Scrollbar */
        .table-wrapper::-webkit-scrollbar { width: 8px; height: 8px; }
        .table-wrapper::-webkit-scrollbar-track { background: transparent; }
        .table-wrapper::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 4px; }
        
        table {
            width: 100%;
            border-collapse: separate; 
            border-spacing: 0;
            text-align: left;
            font-size: 14px;
        }

        thead {
            position: sticky;
            top: 0;
            z-index: 20;
        }

        th {
            background: var(--bg-header);
            padding: 16px;
            font-weight: 600;
            color: var(--text-sub);
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
            transition: background-color 0.3s;
        }

        td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
            color: var(--text-main);
            transition: border-color 0.3s;
            vertical-align: middle;
        }

        tr:last-child td { border-bottom: none; }
        tbody tr { transition: background-color 0.2s; }
        tbody tr:hover { background-color: var(--row-hover); }

        /* Status Tags */
        .status-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            background: var(--tag-bg);
            color: var(--tag-text);
        }

        /* Search & Inputs */
        .search-box {
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 10px 16px;
            border-radius: 8px;
            width: 100%;
            max-width: 300px;
            transition: all 0.2s;
        }
        .search-box:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.15);
        }

        select, .icon-btn {
            background-color: var(--input-bg);
            color: var(--text-main);
            border: 1px solid var(--border);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            height: 42px;
        }
        .icon-btn:hover, select:hover {
            border-color: var(--accent);
            background-color: var(--row-hover);
        }

        /* Features Section */
        .features-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            color: var(--text-sub);
        }
        .features-title {
            color: var(--text-main);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .features-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }
        .features-list li {
            background: var(--input-bg);
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid var(--border);
            font-size: 0.9em;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        .feature-icon { color: var(--accent); }

        .no-results {
            text-align: center;
            padding: 40px;
            color: var(--text-sub);
            font-style: italic;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .tool-container { padding: 16px; min-height: auto; }
            .header-flex { flex-direction: column; align-items: flex-start; }
            .controls-row { flex-direction: column; width: 100%; margin-top: 10px; }
            .search-box { max-width: 100%; }
            .action-group { width: 100%; display: flex; justify-content: space-between; gap: 10px; }
            .action-group select { flex: 1; }
        }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body>

<div class="tool-container">
    
    <!-- Top Header -->
    <div class="flex justify-between items-center mb-6 header-flex">
        <div>
            <h2 class="text-2xl font-bold flex items-center gap-3 header-title" style="color: var(--text-main)">
                <span class="text-3xl filter drop-shadow-lg">â°</span>
                <span data-i18n="title">Daylight Saving Time Schedule</span>
            </h2>
            <p class="text-sm mt-2 intro-text" style="color: var(--text-sub)">
                <span data-i18n="subtitle">Find out when DST starts and ends worldwide.</span>
                <span id="current-year-display" class="ml-1 px-2 py-0.5 rounded bg-[rgba(56,189,248,0.1)] text-[var(--accent)] font-mono text-xs"></span>
            </p>
        </div>
        
        <div class="flex items-center gap-3 controls-row">
            <input type="text" id="search-input" class="search-box" placeholder="Search country or city..." onkeyup="DSTTool.filter()">
            
            <div class="action-group flex gap-2">
                <!-- Theme Toggle -->
                <button onclick="DSTTool.toggleTheme()" class="icon-btn flex items-center justify-center w-[42px]" title="Toggle Theme">
                    <span id="theme-icon" style="font-size: 1.2rem;">ğŸŒ™</span>
                </button>

                <!-- Language Selector -->
                <select id="lang-select" onchange="DSTTool.changeLang()" class="focus:outline-none">
                    <option value="en">English</option>
                    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                    <option value="es">EspaÃ±ol</option>
                    <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                    <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Data Table -->
    <div class="table-wrapper">
        <table id="dst-table">
            <thead>
                <tr>
                    <th width="30%" data-i18n="th_region">Region / Country</th>
                    <th width="25%" id="th-start">DST Start</th>
                    <th width="25%" id="th-end">DST End</th>
                    <th width="20%" data-i18n="th_status">Status</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- JavaScript will populate this -->
            </tbody>
        </table>
    </div>

    <!-- Features Section -->
    <div class="features-section">
        <h3 class="features-title"><span class="feature-icon">â˜…</span> <span data-i18n="feat_title">Features</span></h3>
        <ul class="features-list">
            <li>
                <span class="feature-icon">âœ“</span>
                <span data-i18n="feat_1">Check DST start and end dates for major countries worldwide.</span>
            </li>
            <li>
                <span class="feature-icon">âœ“</span>
                <span data-i18n="feat_2">Automatically calculate upcoming time changes for current/next year.</span>
            </li>
            <li>
                <span class="feature-icon">âœ“</span>
                <span data-i18n="feat_3">Supports multilingual search for countries and cities.</span>
            </li>
            <li>
                <span class="feature-icon">âœ“</span>
                <span data-i18n="feat_4">Dark mode support for comfortable viewing at night.</span>
            </li>
        </ul>
    </div>

</div>

<script>
// --- Helper Functions for Date Calculation ---

// Get nth weekday of month (e.g., 2nd Sunday of March)
// n: 1 (1st), 2 (2nd), ... -1 (last)
// weekday: 0 (Sun) to 6 (Sat)
function getNthWeekday(year, month, weekday, n) {
    const date = new Date(year, month, 1);
    const days = [];
    while (date.getMonth() === month) {
        if (date.getDay() === weekday) {
            days.push(new Date(date));
        }
        date.setDate(date.getDate() + 1);
    }
    if (n > 0) return days[n - 1];
    return days[days.length + n]; // Handles negative (last)
}

function formatDate(date) {
    if (!date) return '-';
    // Format: YYYY-MM-DD
    const y = date.getFullYear();
    const m = String(date.getMonth() + 1).padStart(2, '0');
    const d = String(date.getDate()).padStart(2, '0');
    return `${y}-${m}-${d}`;
}

// Rules for specific regions
const DSTRules = {
    // US: Start 2nd Sun March, End 1st Sun Nov
    us: (year) => ({
        start: getNthWeekday(year, 2, 0, 2), // March is index 2
        end: getNthWeekday(year, 10, 0, 1)   // Nov is index 10
    }),
    // EU: Start last Sun March, End last Sun Oct
    eu: (year) => ({
        start: getNthWeekday(year, 2, 0, -1),
        end: getNthWeekday(year, 9, 0, -1)
    }),
    // AU (South): Start 1st Sun Oct (Year), End 1st Sun April (Year + 1)
    au: (year) => ({
        start: getNthWeekday(year, 9, 0, 1),
        end: getNthWeekday(year + 1, 3, 0, 1) // April is index 3
    }),
    // NZ (South): Start last Sun Sept (Year), End 1st Sun April (Year + 1)
    nz: (year) => ({
        start: getNthWeekday(year, 8, 0, -1), // Sept index 8
        end: getNthWeekday(year + 1, 3, 0, 1)
    }),
    // Chile (Approx): Start 1st Sat Sept, End 1st Sat April (next year)
    // Note: Chile rules fluctuate, this is the most common recent rule
    cl: (year) => ({
        start: getNthWeekday(year, 8, 6, 1), // Sept, Saturday
        end: getNthWeekday(year + 1, 3, 6, 1) // April, Saturday
    }),
    // Egypt: Last Fri April to Last Thu Oct
    eg: (year) => ({
        start: getNthWeekday(year, 3, 5, -1), // April, Friday
        end: getNthWeekday(year, 9, 4, -1)    // Oct, Thursday
    }),
    // Mexico Border (Same as US)
    mx: (year) => ({
        start: getNthWeekday(year, 2, 0, 2),
        end: getNthWeekday(year, 10, 0, 1)
    })
};

// --- Data Source ---
const currentYear = new Date().getFullYear();

// Build the data dynamically based on the current year
const generateData = (year) => [
    {
        id: "us",
        names: { en: "USA & Canada", "zh-CN": "ç¾å›½ & åŠ æ‹¿å¤§", "zh-TW": "ç¾åœ‹ & åŠ æ‹¿å¤§", es: "EE.UU. y CanadÃ¡", ru: "Ğ¡Ğ¨Ğ Ğ¸ ĞšĞ°Ğ½Ğ°Ğ´Ğ°", hi: "à¤¸à¤‚à¤¯à¥à¤•à¥à¤¤ à¤°à¤¾à¤œà¥à¤¯ à¤…à¤®à¥‡à¤°à¤¿à¤•à¤¾ à¤”à¤° à¤•à¤¨à¤¾à¤¡à¤¾", ja: "ç±³å›½ & ã‚«ãƒŠãƒ€" },
        rule: "us",
        hemisphere: "north"
    },
    {
        id: "eu",
        names: { en: "European Union (UK, France, Germany...)", "zh-CN": "æ¬§ç›Ÿ (è‹±å›½, æ³•å›½, å¾·å›½...)", "zh-TW": "æ­ç›Ÿ (è‹±åœ‹, æ³•åœ‹, å¾·åœ‹...)", es: "UniÃ³n Europea (Reino Unido, Francia...)", ru: "Ğ•Ğ²Ñ€Ğ¾ÑĞ¾ÑĞ· (Ğ’ĞµĞ»Ğ¸ĞºĞ¾Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ, Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ...)", hi: "à¤¯à¥‚à¤°à¥‹à¤ªà¥€à¤¯ à¤¸à¤‚à¤˜ (à¤¯à¥‚à¤•à¥‡, à¤«à¥à¤°à¤¾à¤‚à¤¸...)", ja: "æ¬§å·é€£åˆ (è‹±å›½, ä», ç‹¬...)" },
        rule: "eu",
        hemisphere: "north"
    },
    {
        id: "au",
        names: { en: "Australia (SE states)", "zh-CN": "æ¾³å¤§åˆ©äºš (ä¸œå—å·)", "zh-TW": "æ¾³æ´² (æ±å—å·)", es: "Australia (Sureste)", ru: "ĞĞ²ÑÑ‚Ñ€Ğ°Ğ»Ğ¸Ñ (Ğ®Ğ’)", hi: "à¤‘à¤¸à¥à¤Ÿà¥à¤°à¥‡à¤²à¤¿à¤¯à¤¾ (à¤¦à¤•à¥à¤·à¤¿à¤£ à¤ªà¥‚à¤°à¥à¤µ)", ja: "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ (å—æ±éƒ¨)" },
        rule: "au",
        hemisphere: "south"
    },
    {
        id: "nz",
        names: { en: "New Zealand", "zh-CN": "æ–°è¥¿å…°", "zh-TW": "ç´è¥¿è˜­", es: "Nueva Zelanda", ru: "ĞĞ¾Ğ²Ğ°Ñ Ğ—ĞµĞ»Ğ°Ğ½Ğ´Ğ¸Ñ", hi: "à¤¨à¥à¤¯à¥‚à¤œà¥€à¤²à¥ˆà¤‚à¤¡", ja: "ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰" },
        rule: "nz",
        hemisphere: "south"
    },
    {
        id: "mx",
        names: { en: "Mexico (Border Cities)", "zh-CN": "å¢¨è¥¿å“¥ (è¾¹å¢ƒåŸå¸‚)", "zh-TW": "å¢¨è¥¿å“¥ (é‚Šå¢ƒåŸå¸‚)", es: "MÃ©xico (Ciudades Fronterizas)", ru: "ĞœĞµĞºÑĞ¸ĞºĞ° (ĞŸÑ€Ğ¸Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ°)", hi: "à¤®à¥‡à¤•à¥à¤¸à¤¿à¤•à¥‹ (à¤¸à¥€à¤®à¤¾à¤µà¤°à¥à¤¤à¥€ à¤¶à¤¹à¤°)", ja: "ãƒ¡ã‚­ã‚·ã‚³ (å›½å¢ƒéƒ½å¸‚)" },
        rule: "mx",
        hemisphere: "north"
    },
    {
        id: "cl",
        names: { en: "Chile", "zh-CN": "æ™ºåˆ©", "zh-TW": "æ™ºåˆ©", es: "Chile", ru: "Ğ§Ğ¸Ğ»Ğ¸", hi: "à¤šà¤¿à¤²à¥€", ja: "ãƒãƒª" },
        rule: "cl",
        hemisphere: "south"
    },
    {
        id: "eg",
        names: { en: "Egypt", "zh-CN": "åŸƒåŠ", "zh-TW": "åŸƒåŠ", es: "Egipto", ru: "Ğ•Ğ³Ğ¸Ğ¿ĞµÑ‚", hi: "à¤®à¤¿à¤¸à¥à¤°", ja: "ã‚¨ã‚¸ãƒ—ãƒˆ" },
        rule: "eg",
        hemisphere: "north"
    },
    // Countries with NO DST (Static)
    {
        id: "jp",
        names: { en: "Japan", "zh-CN": "æ—¥æœ¬", "zh-TW": "æ—¥æœ¬", es: "JapÃ³n", ru: "Ğ¯Ğ¿Ğ¾Ğ½Ğ¸Ñ", hi: "à¤œà¤¾à¤ªà¤¾à¤¨", ja: "æ—¥æœ¬" },
        active: false
    },
    {
        id: "cn",
        names: { en: "China", "zh-CN": "ä¸­å›½", "zh-TW": "ä¸­åœ‹", es: "China", ru: "ĞšĞ¸Ñ‚Ğ°Ğ¹", hi: "à¤šà¥€à¤¨", ja: "ä¸­å›½" },
        active: false
    },
    {
        id: "in",
        names: { en: "India", "zh-CN": "å°åº¦", "zh-TW": "å°åº¦", es: "India", ru: "Ğ˜Ğ½Ğ´Ğ¸Ñ", hi: "à¤­à¤¾à¤°à¤¤", ja: "ã‚¤ãƒ³ãƒ‰" },
        active: false
    },
    {
        id: "ru",
        names: { en: "Russia", "zh-CN": "ä¿„ç½—æ–¯", "zh-TW": "ä¿„ç¾…æ–¯", es: "Rusia", ru: "Ğ Ğ¾ÑÑĞ¸Ñ", hi: "à¤°à¥‚à¤¸", ja: "ãƒ­ã‚·ã‚¢" },
        active: false
    },
    {
        id: "sg",
        names: { en: "Singapore", "zh-CN": "æ–°åŠ å¡", "zh-TW": "æ–°åŠ å¡", es: "Singapur", ru: "Ğ¡Ğ¸Ğ½Ğ³Ğ°Ğ¿ÑƒÑ€", hi: "à¤¸à¤¿à¤‚à¤—à¤¾à¤ªà¥à¤°", ja: "ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«" },
        active: false
    }
];

// Calculate dates and inject into data
const processedData = generateData(currentYear).map(item => {
    if (item.active === false) {
        return { ...item, startStr: '-', endStr: '-', active: false };
    }
    
    // Calculate based on rule
    const dates = DSTRules[item.rule](currentYear);
    return {
        ...item,
        startStr: formatDate(dates.start),
        endStr: formatDate(dates.end),
        active: true
    };
});


// --- Translations ---
const i18n = {
    "en": {
        title: "Daylight Saving Time Schedule",
        subtitle: "Check worldwide DST start and end dates.",
        th_region: "Region / Country",
        th_start: `DST Start`,
        th_end: `DST End`,
        th_status: "Status",
        status_observed: "Observed",
        status_none: "Not Observed",
        search_ph: "Search country...",
        feat_title: "Features",
        feat_1: "Check DST start and end dates for major countries worldwide.",
        feat_2: "Automatically calculate upcoming time changes for current/next year.",
        feat_3: "Supports multilingual search for countries and cities.",
        feat_4: "Dark mode support for comfortable viewing at night.",
        no_results: "No matching regions found."
    },
    "zh-CN": {
        title: "å¤ä»¤æ—¶/å†¬ä»¤æ—¶æŸ¥è¯¢å·¥å…·",
        subtitle: "æŸ¥è¯¢å…¨çƒä¸»è¦åœ°åŒºçš„å¤ä»¤æ—¶å¼€å§‹ä¸ç»“æŸæ—¶é—´ã€‚",
        th_region: "å›½å®¶ / åœ°åŒº",
        th_start: `å¤ä»¤æ—¶å¼€å§‹ (æ‹¨å¿«1å°æ—¶)`,
        th_end: `å¤ä»¤æ—¶ç»“æŸ (æ‹¨æ…¢1å°æ—¶)`,
        th_status: "å®è¡ŒçŠ¶æ€",
        status_observed: "å®è¡Œå¤ä»¤æ—¶",
        status_none: "ä¸å®è¡Œ",
        search_ph: "æœç´¢å›½å®¶æˆ–åœ°åŒº...",
        feat_title: "åŠŸèƒ½ç‰¹ç‚¹",
        feat_1: "æŸ¥è¯¢å…¨çƒä¸»è¦å›½å®¶çš„å¤ä»¤æ—¶å¼€å§‹å’Œç»“æŸæ—¥æœŸã€‚",
        feat_2: "è‡ªåŠ¨æ ¹æ®å½“å‰å¹´ä»½è®¡ç®—æ—¶é—´å˜æ›´ï¼ˆæ”¯æŒè·¨å¹´ï¼‰ã€‚",
        feat_3: "æ”¯æŒä½¿ç”¨å¤šç§è¯­è¨€æœç´¢å›½å®¶å’ŒåŸå¸‚ã€‚",
        feat_4: "æ”¯æŒæ·±è‰²æ¨¡å¼ï¼Œå¤œé—´æŸ¥è¯¢æ›´æŠ¤çœ¼ã€‚",
        no_results: "æœªæ‰¾åˆ°åŒ¹é…çš„åœ°åŒºã€‚"
    },
    "zh-TW": {
        title: "å¤ä»¤æ™‚/å†¬ä»¤æ™‚æŸ¥è©¢å·¥å…·",
        subtitle: "æŸ¥è©¢å…¨çƒä¸»è¦åœ°å€çš„å¤ä»¤æ™‚é–‹å§‹èˆ‡çµæŸæ™‚é–“ã€‚",
        th_region: "åœ‹å®¶ / åœ°å€",
        th_start: `å¤ä»¤æ™‚é–‹å§‹ (æ’¥å¿«1å°æ™‚)`,
        th_end: `å¤ä»¤æ™‚çµæŸ (æ’¥æ…¢1å°æ™‚)`,
        th_status: "å¯¦è¡Œç‹€æ…‹",
        status_observed: "å¯¦è¡Œå¤ä»¤æ™‚",
        status_none: "ä¸å¯¦è¡Œ",
        search_ph: "æœç´¢åœ‹å®¶æˆ–åœ°å€...",
        feat_title: "åŠŸèƒ½ç‰¹é»",
        feat_1: "æŸ¥è©¢å…¨çƒä¸»è¦åœ‹å®¶çš„å¤ä»¤æ™‚é–‹å§‹å’ŒçµæŸæ—¥æœŸã€‚",
        feat_2: "è‡ªå‹•æ ¹æ“šç•¶å‰å¹´ä»½è¨ˆç®—æ™‚é–“è®Šæ›´ï¼ˆæ”¯æŒè·¨å¹´ï¼‰ã€‚",
        feat_3: "æ”¯æŒä½¿ç”¨å¤šç¨®èªè¨€æœç´¢åœ‹å®¶å’ŒåŸå¸‚ã€‚",
        feat_4: "æ”¯æŒæ·±è‰²æ¨¡å¼ï¼Œå¤œé–“æŸ¥è©¢æ›´è­·çœ¼ã€‚",
        no_results: "æœªæ‰¾åˆ°åŒ¹é…çš„åœ°å€ã€‚"
    },
    "es": {
        title: "Horario de Verano Mundial",
        subtitle: "Consulte las fechas de inicio y fin del horario de verano.",
        th_region: "PaÃ­s / RegiÃ³n",
        th_start: `Inicio (Adelantar reloj)`,
        th_end: `Fin (Atrasar reloj)`,
        th_status: "Estado",
        status_observed: "Se observa",
        status_none: "No se observa",
        search_ph: "Buscar paÃ­s...",
        feat_title: "CaracterÃ­sticas",
        feat_1: "Consulte fechas de horario de verano de los principales paÃ­ses.",
        feat_2: "Calcula automÃ¡ticamente los cambios de hora para el aÃ±o actual.",
        feat_3: "BÃºsqueda multilingÃ¼e de paÃ­ses y ciudades.",
        feat_4: "Modo oscuro para una visualizaciÃ³n cÃ³moda.",
        no_results: "No se encontraron resultados."
    },
    "ru": {
        title: "Ğ›ĞµÑ‚Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ² Ğ¼Ğ¸Ñ€Ğµ",
        subtitle: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ´Ğ°Ñ‚Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ¸ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ»ĞµÑ‚Ğ½ĞµĞ³Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸.",
        th_region: "Ğ ĞµĞ³Ğ¸Ğ¾Ğ½ / Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ°",
        th_start: `ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ (Ğ§Ğ°ÑÑ‹ Ğ²Ğ¿ĞµÑ€ĞµĞ´)`,
        th_end: `ĞšĞ¾Ğ½ĞµÑ† (Ğ§Ğ°ÑÑ‹ Ğ½Ğ°Ğ·Ğ°Ğ´)`,
        th_status: "Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ",
        status_observed: "Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ",
        status_none: "ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ",
        search_ph: "ĞŸĞ¾Ğ¸ÑĞº ÑÑ‚Ñ€Ğ°Ğ½Ñ‹...",
        feat_title: "Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸",
        feat_1: "Ğ”Ğ°Ñ‚Ñ‹ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ° Ğ½Ğ° Ğ»ĞµÑ‚Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ»Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ñ… ÑÑ‚Ñ€Ğ°Ğ½.",
        feat_2: "ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ½Ğ° Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ³Ğ¾Ğ´.",
        feat_3: "ĞœĞ½Ğ¾Ğ³Ğ¾ÑĞ·Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº ÑÑ‚Ñ€Ğ°Ğ½ Ğ¸ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ².",
        feat_4: "Ğ¢ĞµĞ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ Ğ´Ğ»Ñ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ°.",
        no_results: "Ğ¡Ğ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾."
    },
    "hi": {
        title: "à¤¡à¥‡à¤²à¤¾à¤‡à¤Ÿ à¤¸à¥‡à¤µà¤¿à¤‚à¤— à¤Ÿà¤¾à¤‡à¤® à¤¶à¥‡à¤¡à¥à¤¯à¥‚à¤²",
        subtitle: "à¤¦à¥à¤¨à¤¿à¤¯à¤¾ à¤­à¤° à¤®à¥‡à¤‚ à¤¡à¥€à¤à¤¸à¤Ÿà¥€ à¤¶à¥à¤°à¥‚ à¤”à¤° à¤¸à¤®à¤¾à¤ªà¥à¤¤ à¤¹à¥‹à¤¨à¥‡ à¤•à¥€ à¤¤à¤¾à¤°à¥€à¤–à¥‡à¤‚ à¤¦à¥‡à¤–à¥‡à¤‚à¥¤",
        th_region: "à¤•à¥à¤·à¥‡à¤¤à¥à¤° / à¤¦à¥‡à¤¶",
        th_start: `à¤†à¤°à¤‚à¤­ (à¤˜à¤¡à¤¼à¥€ à¤†à¤—à¥‡)`,
        th_end: `à¤¸à¤®à¤¾à¤ªà¥à¤¤ (à¤˜à¤¡à¤¼à¥€ à¤ªà¥€à¤›à¥‡)`,
        th_status: "à¤¸à¥à¤¥à¤¿à¤¤à¤¿",
        status_observed: "à¤²à¤¾à¤—à¥‚ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ",
        status_none: "à¤²à¤¾à¤—à¥‚ à¤¨à¤¹à¥€à¤‚",
        search_ph: "à¤¦à¥‡à¤¶ à¤–à¥‹à¤œà¥‡à¤‚...",
        feat_title: "à¤µà¤¿à¤¶à¥‡à¤·à¤¤à¤¾à¤à¤",
        feat_1: "à¤ªà¥à¤°à¤®à¥à¤– à¤¦à¥‡à¤¶à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ DST à¤¤à¤¿à¤¥à¤¿à¤¯à¤¾à¤‚ à¤œà¤¾à¤‚à¤šà¥‡à¤‚à¥¤",
        feat_2: "à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤µà¤°à¥à¤· à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¥à¤µà¤šà¤¾à¤²à¤¿à¤¤ à¤°à¥‚à¤ª à¤¸à¥‡ à¤¸à¤®à¤¯ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨ à¤•à¥€ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¥‡à¤‚à¥¤",
        feat_3: "à¤¦à¥‡à¤¶à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤¬à¤¹à¥à¤­à¤¾à¤·à¥€ à¤–à¥‹à¤œ à¤•à¤¾ à¤¸à¤®à¤°à¥à¤¥à¤¨ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
        feat_4: "à¤°à¤¾à¤¤ à¤®à¥‡à¤‚ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¡à¤¾à¤°à¥à¤• à¤®à¥‹à¤¡à¥¤",
        no_results: "à¤•à¥‹à¤ˆ à¤®à¥‡à¤² à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾à¥¤"
    },
    "ja": {
        title: "ã‚µãƒãƒ¼ã‚¿ã‚¤ãƒ  (DST) äºˆå®šè¡¨",
        subtitle: "ä¸–ç•Œå„åœ°ã®ã‚µãƒãƒ¼ã‚¿ã‚¤ãƒ é–‹å§‹ãƒ»çµ‚äº†æ—¥ã‚’ç¢ºèªã§ãã¾ã™ã€‚",
        th_region: "å›½ / åœ°åŸŸ",
        th_start: `é–‹å§‹æ—¥ (æ™‚è¨ˆã‚’é€²ã‚ã‚‹)`,
        th_end: `çµ‚äº†æ—¥ (æ™‚è¨ˆã‚’æˆ»ã™)`,
        th_status: "å®Ÿæ–½çŠ¶æ³",
        status_observed: "å®Ÿæ–½ã‚ã‚Š",
        status_none: "å®Ÿæ–½ãªã—",
        search_ph: "å›½åã§æ¤œç´¢...",
        feat_title: "ç‰¹å¾´",
        feat_1: "ä¸»è¦å›½ã®ã‚µãƒãƒ¼ã‚¿ã‚¤ãƒ é–‹å§‹ãƒ»çµ‚äº†æ—¥ã‚’ç¢ºèªã€‚",
        feat_2: "ä»Šå¹´åº¦ã®æ™‚é–“å¤‰æ›´ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è‡ªå‹•è¨ˆç®—ã€‚",
        feat_3: "å¤šè¨€èªã§ã®å›½åãƒ»éƒ½å¸‚åæ¤œç´¢ã«å¯¾å¿œã€‚",
        feat_4: "ç›®ã«å„ªã—ã„ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ­è¼‰ã€‚",
        no_results: "ä¸€è‡´ã™ã‚‹åœ°åŸŸãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"
    }
};

const DSTTool = {
    currentLang: 'en',
    currentTheme: 'dark',

    init() {
        // 1. Theme
        const savedTheme = localStorage.getItem('dst_theme') || 'dark';
        this.setTheme(savedTheme);

        // 2. Language
        const urlParams = new URLSearchParams(window.location.search);
        const urlLang = urlParams.get('lang');
        const savedLang = localStorage.getItem('dst_lang');

        // Check if lang exists in i18n
        if (urlLang && i18n[urlLang]) {
            this.currentLang = urlLang;
        } else if (savedLang && i18n[savedLang]) {
            this.currentLang = savedLang;
        } else {
            this.currentLang = 'en';
        }

        // 3. UI Update
        document.getElementById('lang-select').value = this.currentLang;
        
        // Show current year context in UI
        const nextYear = currentYear + 1;
        document.getElementById('current-year-display').textContent = `${currentYear}-${nextYear}`;

        this.updateTexts();
        this.render(processedData);
    },

    render(data) {
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = '';
        const texts = i18n[this.currentLang];

        if (data.length === 0) {
            tbody.innerHTML = `<tr><td colspan="4" class="no-results">${texts.no_results}</td></tr>`;
            return;
        }

        // Use the exact currentLang to fetch the name
        // The data keys (zh-CN, etc) now match i18n keys exactly
        const langKey = this.currentLang;

        data.forEach(item => {
            // Get localized name or fallback to English
            let name = item.names[langKey];
            if (!name) name = item.names['en'];

            const activeText = item.active ? texts.status_observed : texts.status_none;
            const activeClass = item.active 
                ? 'background:rgba(16, 185, 129, 0.1); color:#10b981;' // Greenish for Active
                : 'background:rgba(100, 116, 139, 0.1); color:#94a3b8;'; // Grey for Inactive
            
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>
                    <div class="font-bold text-lg mb-1">${name}</div>
                </td>
                <td style="color:var(--accent)">${item.startStr}</td>
                <td style="color:var(--text-sub)">${item.endStr}</td>
                <td><span class="status-tag" style="${activeClass}">${activeText}</span></td>
            `;
            tbody.appendChild(tr);
        });
    },

    filter() {
        const query = document.getElementById('search-input').value.toLowerCase();
        
        const filtered = processedData.filter(item => {
            // Search in ALL name translations (values of the names object)
            // This ensures searching "Meiguo" or "United States" both work regardless of current interface language
            const nameMatch = Object.values(item.names).some(val => val && val.toLowerCase().includes(query));
            return nameMatch;
        });
        
        this.render(filtered);
    },

    toggleTheme() {
        const newTheme = this.currentTheme === 'dark' ? 'light' : 'dark';
        this.setTheme(newTheme);
    },

    setTheme(theme) {
        this.currentTheme = theme;
        const icon = document.getElementById('theme-icon');
        
        if (theme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
            icon.textContent = 'â˜€ï¸';
        } else {
            document.documentElement.removeAttribute('data-theme');
            icon.textContent = 'ğŸŒ™';
        }
        localStorage.setItem('dst_theme', theme);
    },

    changeLang() {
        this.currentLang = document.getElementById('lang-select').value;
        localStorage.setItem('dst_lang', this.currentLang);
        
        // Update URL Parameter
        try {
            const url = new URL(window.location);
            url.searchParams.set('lang', this.currentLang);
            window.history.pushState({}, '', url);
        } catch (e) {
            console.warn('URL update not supported');
        }

        this.updateTexts();
        this.filter(); // Re-render table to update names
    },

    updateTexts() {
        const texts = i18n[this.currentLang];
        
        // Update elements with data-i18n
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (texts[key]) el.textContent = texts[key];
        });

        // Update headers dynamically with year
        // We append the year to the translated header text for clarity
        // Northern Hemisphere usually fits in currentYear. Southern splits. 
        // For simplicity, we just put (Year) or (Year/Year+1) in the header is tricky via generic text.
        // Instead, we just use the localized headers from i18n which are generic "Start" and "End"
        // And the rows show the specific dates (YYYY-MM-DD).

        // Update placeholder
        document.getElementById('search-input').placeholder = texts.search_ph;
        
        // Update Page Title
        document.title = texts.title;
    }
};

window.onload = () => DSTTool.init();

</script>

<div id="related-tools-container"></div>
<script src="/scripts/related.js"></script>
</body>
</html>