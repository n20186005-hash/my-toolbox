<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Category Meta Tag -->
    <meta name="category" content="finance">
    <meta name="icon" content="ğŸ’°">
    <meta name="description" content="Advanced Salary Sacrifice Calculator - Calculate take home pay, pension, student loan savings with regional tax bands. è–ªèµ„ç‰ºç‰²è®¡ç®—å™¨ï¼Œæ”¯æŒè‹æ ¼å…°ç¨ç‡ã€å­¦ç”Ÿè´·æ¬¾åŠå¤šå‘¨æœŸè´¢åŠ¡åˆ†æã€‚">
    <title>Salary Sacrifice Calculator Pro | è–ªèµ„ç‰ºç‰²è®¡ç®—å™¨ä¸“ä¸šç‰ˆ</title>
    <!-- SEO Canonical Tag -->
    <link rel="canonical" href="https://toolboxpro.top/modules/finance/salary-sacrifice-pro.html" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: { DEFAULT: '#10b981', hover: '#059669' }, /* Emerald Green */
                        secondary: { DEFAULT: '#6366f1', hover: '#4f46e5' }, /* Indigo for Analysis */
                        surface: { light: '#ffffff', dark: '#1e293b' },
                        bg: { light: '#f0fdf4', dark: '#0f172a' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .scrollbar-hide::-webkit-scrollbar { display: none; }
            .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
            
            .glass {
                @apply bg-white/90 dark:bg-slate-800/90 backdrop-blur-lg border border-slate-200 dark:border-slate-700;
            }
            
            .input-field {
                @apply w-full px-4 py-2.5 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all text-sm;
            }
            
            .label-text {
                @apply text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1.5 block uppercase tracking-wide;
            }

            .result-row {
                @apply flex justify-between items-center py-2 border-b border-slate-100 dark:border-slate-700/50 last:border-0;
            }
            
            .tab-btn {
                @apply px-4 py-1.5 rounded-full text-xs font-bold transition-all border;
            }
            .tab-btn.active {
                @apply bg-secondary text-white border-secondary;
            }
            .tab-btn.inactive {
                @apply bg-transparent text-slate-500 border-transparent hover:bg-slate-100 dark:hover:bg-slate-800;
            }
        }

        .currency-input-wrapper { position: relative; }
        .currency-input-wrapper::before {
            content: 'Â£';
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            font-family: 'JetBrains Mono', monospace;
        }
        .currency-input-wrapper input { padding-left: 28px; }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body class="bg-bg-light dark:bg-bg-dark min-h-screen font-sans text-slate-800 dark:text-slate-200 transition-colors duration-300 overflow-x-hidden">

    <!-- Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0 opacity-40 dark:opacity-20">
        <div class="absolute top-[-10%] left-[-10%] w-[600px] h-[600px] bg-green-200 rounded-full blur-[120px] mix-blend-multiply dark:mix-blend-screen"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-indigo-300 rounded-full blur-[100px] mix-blend-multiply dark:mix-blend-screen"></div>
    </div>

    <div class="container mx-auto px-4 py-6 max-w-6xl relative z-10 flex flex-col min-h-screen">
        
        <!-- Header -->
        <header class="flex flex-col md:flex-row items-center justify-between gap-4 mb-8">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-emerald-500 to-teal-700 text-white flex items-center justify-center text-2xl shadow-lg shadow-emerald-500/20">
                    <i class="fa fa-line-chart"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold tracking-tight text-slate-900 dark:text-white" data-i18n="title">Salary Sacrifice Pro</h1>
                    <p class="text-xs text-slate-500 font-medium" data-i18n="subtitle">è–ªèµ„ç‰ºç‰² & è´¢åŠ¡åˆ†æä¸“ä¸šç‰ˆ</p>
                </div>
            </div>

            <div class="flex items-center gap-2 bg-white dark:bg-slate-800 p-1.5 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm">
                <select id="lang-selector" class="bg-transparent text-sm font-medium px-2 py-1 rounded focus:outline-none cursor-pointer text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700">
                    <option value="zh-CN">ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (ç®€ä½“)</option>
                    <option value="zh-TW">ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (ç¹é«”)</option>
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    <option value="pl">ğŸ‡µğŸ‡± Polski</option>
                </select>
                <div class="w-px h-5 bg-slate-300 dark:bg-slate-600 mx-1"></div>
                <button id="mode-toggle" class="w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:text-primary hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                    <i class="fa fa-moon-o dark:hidden"></i>
                    <i class="fa fa-sun-o hidden dark:inline"></i>
                </button>
            </div>
        </header>

        <!-- Main Tool Area -->
        <div class="grid lg:grid-cols-12 gap-6 mb-12">
            
            <!-- Left Column: Inputs -->
            <main class="lg:col-span-4 flex flex-col gap-6">
                <div class="glass rounded-3xl shadow-lg overflow-hidden border-t-4 border-t-emerald-500 p-6 space-y-5">
                    <h2 class="text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-white">
                        <i class="fa fa-sliders text-emerald-500"></i> <span data-i18n="h2_config">é…ç½®è¯¦æƒ…</span>
                    </h2>

                    <!-- 1. Salary & Region -->
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="label-text" data-i18n="lbl_salary">å¹´è–ª</label>
                            <div class="currency-input-wrapper">
                                <input type="number" id="input-salary" class="input-field font-mono" value="55000" placeholder="50000" oninput="Calculator.calculate()">
                            </div>
                        </div>
                        <div>
                            <label class="label-text" data-i18n="lbl_region">åœ°åŒº</label>
                            <select id="input-region" class="input-field" onchange="Calculator.calculate()">
                                <option value="uk" data-i18n="opt_uk">è‹±æ ¼å…°/å¨å°”å£«/åŒ—çˆ±</option>
                                <option value="scot" data-i18n="opt_scot">è‹æ ¼å…°</option>
                            </select>
                        </div>
                    </div>

                    <!-- 2. Sacrifice -->
                    <div>
                        <label class="label-text" data-i18n="lbl_sacrifice_config">çŒ®ç¥­é…ç½®</label>
                        <div class="grid grid-cols-1 gap-2 mb-2">
                            <select id="input-type" class="input-field" onchange="Calculator.calculate()">
                                <option value="pension" data-i18n="type_pension">ğŸ’¼ å…»è€é‡‘ (Pension)</option>
                                <option value="cycle" data-i18n="type_cycle">ğŸš² è‡ªè¡Œè½¦ (Cycle to Work)</option>
                                <option value="ev" data-i18n="type_ev">ğŸš— ç”µåŠ¨è½¦ (EV Scheme)</option>
                                <option value="other" data-i18n="type_other">ğŸ“¦ å…¶ä»– (General)</option>
                            </select>
                        </div>
                        <div class="flex gap-2">
                            <div class="currency-input-wrapper flex-grow">
                                <input type="number" id="input-sacrifice" class="input-field font-mono" value="2000" placeholder="Amount" oninput="Calculator.calculate()">
                            </div>
                            <select id="input-freq" class="input-field w-24" onchange="Calculator.calculate()">
                                <option value="monthly" data-i18n="opt_monthly">æœˆåº¦</option>
                                <option value="yearly" data-i18n="opt_yearly">å¹´åº¦</option>
                            </select>
                        </div>
                    </div>

                    <!-- 3. Student Loan -->
                    <div>
                        <label class="label-text" data-i18n="lbl_student_loan">å­¦ç”Ÿè´·æ¬¾</label>
                        <select id="input-student-loan" class="input-field" onchange="Calculator.calculate()">
                            <option value="none" data-i18n="loan_none">æ—  (None)</option>
                            <option value="plan1" data-i18n="loan_plan1">Plan 1</option>
                            <option value="plan2" data-i18n="loan_plan2">Plan 2</option>
                            <option value="plan4" data-i18n="loan_plan4">Plan 4 (Scotland)</option>
                            <option value="plan5" data-i18n="loan_plan5">Plan 5</option>
                            <option value="postgrad" data-i18n="loan_postgrad">Postgraduate</option>
                        </select>
                    </div>

                    <!-- 4. Other -->
                    <div class="grid grid-cols-2 gap-3">
                         <div>
                            <label class="label-text" data-i18n="lbl_pension_pct">åŸæœ‰å…»è€é‡‘%</label>
                            <input type="number" id="input-pension" class="input-field font-mono" value="5" oninput="Calculator.calculate()">
                        </div>
                        <div>
                            <label class="label-text" data-i18n="lbl_age">å¹´é¾„</label>
                            <select id="input-age" class="input-field" onchange="Calculator.calculate()">
                                <option value="standard" data-i18n="opt_under_state">&lt; é€€ä¼‘</option>
                                <option value="over" data-i18n="opt_over_state">&gt; é€€ä¼‘</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Info Box based on Type -->
                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-4 border border-blue-100 dark:border-blue-800/30 text-sm text-blue-800 dark:text-blue-300">
                    <i class="fa fa-info-circle mr-1"></i> <span id="type-hint">...</span>
                </div>
            </main>

            <!-- Right Column: Results -->
            <main class="lg:col-span-8 flex flex-col gap-6">
                <div class="glass rounded-3xl shadow-xl overflow-hidden min-h-[500px] flex flex-col">
                    
                    <!-- Timeframe Tabs -->
                    <div class="bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 p-4 flex justify-between items-center flex-wrap gap-4">
                        <h2 class="font-bold text-slate-700 dark:text-slate-200" data-i18n="h2_analysis">è´¢åŠ¡åˆ†æ</h2>
                        <div class="flex bg-slate-200 dark:bg-slate-800 rounded-full p-1" id="timeframe-selector">
                            <button class="tab-btn active" onclick="App.setTimeframe('yearly')" data-i18n="tf_year">å¹´</button>
                            <button class="tab-btn inactive" onclick="App.setTimeframe('quarterly')" data-i18n="tf_quarter">å­£</button>
                            <button class="tab-btn inactive" onclick="App.setTimeframe('monthly')" data-i18n="tf_month">æœˆ</button>
                            <button class="tab-btn inactive" onclick="App.setTimeframe('weekly')" data-i18n="tf_week">å‘¨</button>
                        </div>
                    </div>

                    <div class="p-6 md:p-8 flex-grow flex flex-col gap-8 animate-fade-in">
                        
                        <!-- Main Comparison Cards -->
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- Before -->
                            <div class="rounded-2xl border border-slate-200 dark:border-slate-700 p-5 space-y-4 bg-slate-50/50 dark:bg-slate-800/30">
                                <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider text-center" data-i18n="h4_before">åŸå§‹æƒ…å†µ (Standard)</h4>
                                
                                <div class="space-y-2">
                                    <div class="result-row">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_gross">ç¨å‰æ”¶å…¥</span>
                                        <span class="font-mono font-bold" id="res-gross-old">Â£0</span>
                                    </div>
                                    <div class="result-row">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_tax">æ‰€å¾—ç¨</span>
                                        <span class="font-mono text-red-500" id="res-tax-old">Â£0</span>
                                    </div>
                                    <div class="result-row">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_ni">å›½æ°‘ä¿é™© (NI)</span>
                                        <span class="font-mono text-red-500" id="res-ni-old">Â£0</span>
                                    </div>
                                    <div class="result-row" id="row-loan-old">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_loan">å­¦ç”Ÿè´·æ¬¾</span>
                                        <span class="font-mono text-red-500" id="res-loan-old">Â£0</span>
                                    </div>
                                </div>

                                <div class="pt-4 border-t border-slate-200 dark:border-slate-700">
                                    <div class="flex justify-between items-end">
                                        <span class="text-sm font-bold text-slate-700 dark:text-slate-300" data-i18n="res_takehome">åˆ°æ‰‹è–ªèµ„</span>
                                        <span class="text-2xl font-bold font-mono text-slate-800 dark:text-white" id="res-net-old">Â£0</span>
                                    </div>
                                </div>
                            </div>

                            <!-- After -->
                            <div class="rounded-2xl border-2 border-emerald-500/30 p-5 space-y-4 bg-emerald-50/30 dark:bg-emerald-900/10 relative overflow-hidden">
                                <div class="absolute top-0 right-0 bg-emerald-500 text-white text-[10px] px-3 py-1 rounded-bl-lg font-bold" data-i18n="badge_optimized">OPTIMIZED</div>
                                <h4 class="text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-wider text-center" data-i18n="h4_after">çŒ®ç¥­å (Sacrificed)</h4>
                                
                                <div class="space-y-2">
                                    <div class="result-row border-emerald-100 dark:border-emerald-800/30">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_gross">ç¨å‰æ”¶å…¥</span>
                                        <span class="font-mono font-bold text-slate-700 dark:text-slate-200" id="res-gross-new">Â£0</span>
                                    </div>
                                    <div class="result-row border-emerald-100 dark:border-emerald-800/30">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_tax">æ‰€å¾—ç¨</span>
                                        <span class="font-mono text-emerald-600" id="res-tax-new">Â£0</span>
                                    </div>
                                    <div class="result-row border-emerald-100 dark:border-emerald-800/30">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_ni">å›½æ°‘ä¿é™© (NI)</span>
                                        <span class="font-mono text-emerald-600" id="res-ni-new">Â£0</span>
                                    </div>
                                    <div class="result-row border-emerald-100 dark:border-emerald-800/30" id="row-loan-new">
                                        <span class="text-sm text-slate-600 dark:text-slate-400" data-i18n="res_loan">å­¦ç”Ÿè´·æ¬¾</span>
                                        <span class="font-mono text-emerald-600" id="res-loan-new">Â£0</span>
                                    </div>
                                </div>

                                <div class="pt-4 border-t border-emerald-200 dark:border-emerald-800/50">
                                    <div class="flex justify-between items-end">
                                        <span class="text-sm font-bold text-emerald-800 dark:text-emerald-300" data-i18n="res_takehome">åˆ°æ‰‹è–ªèµ„</span>
                                        <span class="text-2xl font-bold font-mono text-emerald-700 dark:text-emerald-400" id="res-net-new">Â£0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Highlights -->
                        <div class="grid grid-cols-3 gap-4">
                             <div class="bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-3 md:p-4 text-center border border-yellow-100 dark:border-yellow-800/30">
                                <div class="text-xs text-yellow-600 dark:text-yellow-400 uppercase tracking-wide mb-1" data-i18n="stat_tax_saved">èŠ‚çœæ€»ç¨æ¬¾</div>
                                <div class="text-xl md:text-2xl font-bold text-yellow-700 dark:text-yellow-400 font-mono" id="stat-tax-saved">Â£0</div>
                            </div>
                            <div class="bg-indigo-50 dark:bg-indigo-900/20 rounded-xl p-3 md:p-4 text-center border border-indigo-100 dark:border-indigo-800/30">
                                <div class="text-xs text-indigo-600 dark:text-indigo-400 uppercase tracking-wide mb-1" data-i18n="stat_effective_cost">å®é™…æˆæœ¬</div>
                                <div class="text-xl md:text-2xl font-bold text-indigo-700 dark:text-indigo-400 font-mono" id="stat-real-cost">Â£0</div>
                            </div>
                            <div class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-3 md:p-4 text-center border border-blue-100 dark:border-blue-800/30">
                                <div class="text-xs text-blue-600 dark:text-blue-400 uppercase tracking-wide mb-1" data-i18n="stat_value">ä»·å€¼/å‚¨è“„</div>
                                <div class="text-xl md:text-2xl font-bold text-blue-700 dark:text-blue-400 font-mono" id="stat-value">Â£0</div>
                            </div>
                        </div>
                        
                        <!-- Disclaimer -->
                         <p class="text-center text-xs text-slate-400" data-i18n="disclaimer_calc">*è®¡ç®—ç»“æœåŸºäº2024/25å¹´ç¨ç‡ï¼ˆåŒ…å« NI 8% è°ƒæ•´ï¼‰ã€‚æœªåŒ…å«å¤æ‚çš„ BiK è®¡ç®—ï¼Œä»…ä¾›ä¼°ç®—ã€‚</p>

                    </div>
                </div>
            </main>
        </div>

        <!-- Comprehensive Guide Section -->
        <section class="mb-12">
            <div class="glass rounded-2xl p-8 shadow-xl">
                <div class="grid md:grid-cols-2 gap-12">
                    <!-- Feature Introduction -->
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2">
                            <i class="fa fa-book text-primary"></i> <span data-i18n="guide_title">è–ªèµ„ç‰ºç‰²æŒ‡å—</span>
                        </h2>
                        <div class="space-y-6 text-slate-600 dark:text-slate-300 leading-relaxed">
                            <div>
                                <h3 class="font-bold text-lg text-slate-800 dark:text-slate-100 mb-2" data-i18n="guide_h_what">ä»€ä¹ˆæ˜¯è–ªèµ„ç‰ºç‰²ï¼Ÿ</h3>
                                <p data-i18n="guide_p_what">è–ªèµ„ç‰ºç‰²ï¼ˆSalary Sacrificeï¼‰æ˜¯æ‚¨ä¸é›‡ä¸»ä¹‹é—´çš„ä¸€é¡¹åè®®ã€‚æ‚¨åŒæ„æ”¾å¼ƒéƒ¨åˆ†åˆåŒè–ªæ°´ï¼Œä»¥æ¢å–é›‡ä¸»æä¾›çš„éç°é‡‘ç¦åˆ©ã€‚æœ€å¸¸è§çš„ç”¨é€”æ˜¯å¢åŠ å…»è€é‡‘ä¾›æ¬¾ã€‚</p>
                            </div>
                            
                            <div>
                                <h3 class="font-bold text-lg text-slate-800 dark:text-slate-100 mb-2" data-i18n="guide_h_why">ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</h3>
                                <p data-i18n="guide_p_why">
                                    ä¸»è¦ä¼˜åŠ¿åœ¨äº<strong>ç¨åŠ¡èŠ‚çœ</strong>ã€‚ç”±äºæ‚¨çš„åä¹‰æ€»æ”¶å…¥å‡å°‘äº†ï¼Œæ‚¨éœ€è¦ç¼´çº³çš„æ‰€å¾—ç¨ã€å›½æ°‘ä¿é™©ï¼ˆNIï¼‰ä»¥åŠå­¦ç”Ÿè´·æ¬¾ä¹Ÿä¼šç›¸åº”å‡å°‘ã€‚è¿™éƒ¨åˆ†èŠ‚çœä¸‹æ¥çš„é’±å¯ä»¥ç›´æ¥è¿›å…¥æ‚¨çš„å…»è€é‡‘è´¦æˆ·ï¼Œå®ç°å¤åˆ©å¢é•¿ã€‚
                                </p>
                            </div>

                            <div>
                                <h3 class="font-bold text-lg text-slate-800 dark:text-slate-100 mb-2" data-i18n="guide_h_student">å­¦ç”Ÿè´·æ¬¾çš„å½±å“</h3>
                                <p data-i18n="guide_p_student">å¦‚æœä½ æœ‰ Plan 1/2/4/5 æˆ–ç ”ç©¶ç”Ÿè´·æ¬¾ï¼Œè–ªèµ„ç‰ºç‰²å¯ä»¥<strong>å¤§å¹…å‡å°‘</strong>ä½ çš„è¿˜æ¬¾é¢ï¼Œå› ä¸ºè¿˜æ¬¾æ˜¯åŸºäºâ€œç‰ºç‰²åâ€çš„æ¯›æ”¶å…¥è®¡ç®—çš„ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¸¸è¢«å¿½è§†çš„éšè—ç¦åˆ©ï¼</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ -->
                    <div>
                        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2">
                            <i class="fa fa-question-circle text-primary"></i> <span data-i18n="faq_title">å¸¸è§é—®é¢˜ (FAQ)</span>
                        </h2>
                        <div class="space-y-4">
                            <div class="bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-700">
                                <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2" data-i18n="faq_q1">è¿™ä¼šå½±å“æˆ‘çš„è´·æ¬¾èƒ½åŠ›å—ï¼Ÿ</h4>
                                <p class="text-sm text-slate-600 dark:text-slate-400" data-i18n="faq_a1">å¯èƒ½ä¼šã€‚å› ä¸ºæ‚¨çš„åˆåŒè–ªèµ„é™ä½äº†ï¼ŒæŠµæŠ¼è´·æ¬¾æœºæ„åœ¨è®¡ç®—æ‚¨å¯ä»¥å€Ÿè´·çš„å€æ•°æ—¶ï¼Œå¯èƒ½ä¼šåŸºäºè¾ƒä½çš„è–ªèµ„è®¡ç®—ã€‚å»ºè®®åœ¨ç”³è¯·æˆ¿è´·å‰å’¨è¯¢ä¸“ä¸šé¡¾é—®ã€‚</p>
                            </div>

                            <div class="bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-700">
                                <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2" data-i18n="faq_q2">æœ‰æœ€ä½è–ªèµ„é™åˆ¶å—ï¼Ÿ</h4>
                                <p class="text-sm text-slate-600 dark:text-slate-400" data-i18n="faq_a2">æ˜¯çš„ã€‚è–ªèµ„ç‰ºç‰²ä¸èƒ½ä½¿æ‚¨çš„æ—¶è–ªä½äºå›½å®¶æœ€ä½å·¥èµ„æ ‡å‡†ï¼ˆNational Minimum Wageï¼‰ã€‚</p>
                            </div>

                            <div class="bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-700">
                                <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2" data-i18n="faq_q3">è‹æ ¼å…°çš„ç¨ç‡æœ‰ä½•ä¸åŒï¼Ÿ</h4>
                                <p class="text-sm text-slate-600 dark:text-slate-400" data-i18n="faq_a4">è‹æ ¼å…°æœ‰è‡ªå·±ç‹¬ç«‹çš„æ‰€å¾—ç¨é˜¶æ¢¯ï¼ˆç›®å‰ä¸º 6 çº§ï¼‰ï¼Œé€šå¸¸å¯¹é«˜æ”¶å…¥è€…çš„å¾ç¨ç•¥é«˜äºè‹±æ ¼å…°ã€‚æœ¬è®¡ç®—å™¨æ”¯æŒè‡ªåŠ¨åˆ‡æ¢åˆ°è‹æ ¼å…°ç¨åˆ¶ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="text-center text-xs text-slate-400 py-6">
            <p>&copy; <span id="year"></span> Salary Sacrifice Pro. <span data-i18n="footer_text">Figures are estimates for illustration only.</span></p>
        </footer>

    </div>

    <!-- Required Footer Code -->
    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>

    <script>
        // --- Localization Data ---
        const i18nData = {
            'zh-CN': {
                title: "è–ªèµ„ç‰ºç‰²è®¡ç®—å™¨ Pro", subtitle: "è‹±å›½å…»è€é‡‘ã€ç¨æ”¶ä¸å­¦è´·ä¼˜åŒ–",
                h2_config: "é…ç½®è¯¦æƒ…",
                lbl_salary: "å¹´è–ª (Gross Salary)", lbl_region: "çº³ç¨åœ°åŒº",
                opt_uk: "è‹±æ ¼å…°/å¨å°”å£«/åŒ—çˆ±", opt_scot: "è‹æ ¼å…°",
                lbl_sacrifice_config: "çŒ®ç¥­é…ç½® (Sacrifice)",
                type_pension: "ğŸ’¼ å…»è€é‡‘ (Pension)", type_cycle: "ğŸš² è‡ªè¡Œè½¦ (Cycle Scheme)", 
                type_ev: "ğŸš— ç”µåŠ¨è½¦ (EV Scheme)", type_other: "ğŸ“¦ å…¶ä»– (General)",
                opt_monthly: "æœˆåº¦", opt_yearly: "å¹´åº¦",
                lbl_student_loan: "å­¦ç”Ÿè´·æ¬¾ (Student Loan)",
                loan_none: "æ—  (None)", loan_plan1: "Plan 1", loan_plan2: "Plan 2", loan_plan4: "Plan 4 (Scotland)", loan_plan5: "Plan 5", loan_postgrad: "Postgraduate",
                lbl_pension_pct: "åŸæœ‰å…»è€é‡‘%", lbl_age: "å¹´é¾„",
                opt_under_state: "< é€€ä¼‘å¹´é¾„", opt_over_state: "> é€€ä¼‘å¹´é¾„",
                h2_analysis: "è´¢åŠ¡åˆ†æ",
                tf_year: "å¹´", tf_quarter: "å­£", tf_month: "æœˆ", tf_week: "å‘¨",
                h4_before: "åŸå§‹æƒ…å†µ (Standard)", h4_after: "çŒ®ç¥­å (Sacrificed)",
                res_gross: "ç¨å‰æ”¶å…¥", res_tax: "æ‰€å¾—ç¨", res_ni: "å›½æ°‘ä¿é™© (NI)", res_loan: "å­¦ç”Ÿè´·æ¬¾", res_takehome: "åˆ°æ‰‹è–ªèµ„",
                badge_optimized: "å·²ä¼˜åŒ–",
                stat_tax_saved: "èŠ‚çœç¨æ¬¾ & NI", stat_effective_cost: "å®é™…æˆæœ¬", stat_value: "è¿›å…¥è´¦æˆ·/ä»·å€¼",
                disclaimer_calc: "*è®¡ç®—ç»“æœåŸºäº2024/25å¹´ç¨ç‡ï¼ˆåŒ…å« NI 8% è°ƒæ•´ï¼‰ã€‚ä¸åŒ…å«å¤æ‚çš„ BiK è®¡ç®—ï¼Œä»…ä¾›ä¼°ç®—ã€‚",
                guide_title: "è–ªèµ„ç‰ºç‰²æŒ‡å—",
                guide_h_what: "ä»€ä¹ˆæ˜¯è–ªèµ„ç‰ºç‰²ï¼Ÿ", guide_p_what: "è–ªèµ„ç‰ºç‰²ï¼ˆSalary Sacrificeï¼‰æ˜¯æ‚¨ä¸é›‡ä¸»ä¹‹é—´çš„ä¸€é¡¹åè®®ã€‚æ‚¨åŒæ„æ”¾å¼ƒéƒ¨åˆ†åˆåŒè–ªæ°´ï¼Œä»¥æ¢å–é›‡ä¸»æä¾›çš„éç°é‡‘ç¦åˆ©ã€‚æœ€å¸¸è§çš„ç”¨é€”æ˜¯å¢åŠ å…»è€é‡‘ä¾›æ¬¾ã€‚",
                guide_h_why: "ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ", guide_p_why: "ä¸»è¦ä¼˜åŠ¿åœ¨äº<strong>ç¨åŠ¡èŠ‚çœ</strong>ã€‚ç”±äºæ‚¨çš„åä¹‰æ€»æ”¶å…¥å‡å°‘äº†ï¼Œæ‚¨éœ€è¦ç¼´çº³çš„æ‰€å¾—ç¨ã€å›½æ°‘ä¿é™©ï¼ˆNIï¼‰ä»¥åŠå­¦ç”Ÿè´·æ¬¾ä¹Ÿä¼šç›¸åº”å‡å°‘ã€‚",
                guide_h_student: "å­¦ç”Ÿè´·æ¬¾çš„å½±å“", guide_p_student: "å¦‚æœä½ æœ‰ Plan 1/2/4/5 æˆ–ç ”ç©¶ç”Ÿè´·æ¬¾ï¼Œè–ªèµ„ç‰ºç‰²å¯ä»¥<strong>å¤§å¹…å‡å°‘</strong>ä½ çš„è¿˜æ¬¾é¢ï¼Œå› ä¸ºè¿˜æ¬¾æ˜¯åŸºäºâ€œç‰ºç‰²åâ€çš„æ¯›æ”¶å…¥è®¡ç®—çš„ã€‚",
                faq_title: "å¸¸è§é—®é¢˜ (FAQ)",
                faq_q1: "è¿™ä¼šå½±å“æˆ‘çš„è´·æ¬¾èƒ½åŠ›å—ï¼Ÿ", faq_a1: "å¯èƒ½ä¼šã€‚å› ä¸ºæ‚¨çš„åˆåŒè–ªèµ„é™ä½äº†ï¼ŒæŠµæŠ¼è´·æ¬¾æœºæ„åœ¨è®¡ç®—æ‚¨å¯ä»¥å€Ÿè´·çš„å€æ•°æ—¶ï¼Œå¯èƒ½ä¼šåŸºäºè¾ƒä½çš„è–ªèµ„è®¡ç®—ã€‚",
                faq_q2: "æœ‰æœ€ä½è–ªèµ„é™åˆ¶å—ï¼Ÿ", faq_a2: "æ˜¯çš„ã€‚è–ªèµ„ç‰ºç‰²ä¸èƒ½ä½¿æ‚¨çš„æ—¶è–ªä½äºå›½å®¶æœ€ä½å·¥èµ„æ ‡å‡†ï¼ˆNational Minimum Wageï¼‰ã€‚",
                faq_q3: "è‹æ ¼å…°çš„ç¨ç‡æœ‰ä½•ä¸åŒï¼Ÿ", faq_a4: "è‹æ ¼å…°æœ‰è‡ªå·±ç‹¬ç«‹çš„æ‰€å¾—ç¨é˜¶æ¢¯ï¼ˆç›®å‰ä¸º 6 çº§ï¼‰ï¼Œé€šå¸¸å¯¹é«˜æ”¶å…¥è€…çš„å¾ç¨ç•¥é«˜äºè‹±æ ¼å…°ã€‚æœ¬è®¡ç®—å™¨æ”¯æŒè‡ªåŠ¨åˆ‡æ¢åˆ°è‹æ ¼å…°ç¨åˆ¶ã€‚",
                footer_text: "è®¡ç®—ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆè´¢åŠ¡å»ºè®®ã€‚",
                hint_pension: "å…»è€é‡‘æ˜¯æœ€å¸¸è§çš„ç‰ºç‰²ç±»å‹ã€‚è¿™éƒ¨åˆ†é’±å°†å…ç¨è¿›å…¥æ‚¨çš„å…»è€é‡‘è´¦æˆ·ï¼Œäº«å—å¤åˆ©å¢é•¿ã€‚",
                hint_cycle: "è‡ªè¡Œè½¦é€šå‹¤è®¡åˆ’å…è®¸æ‚¨ä»ç¨å‰è–ªèµ„ä¸­æ”¯ä»˜è‡ªè¡Œè½¦å’Œè£…å¤‡è´¹ç”¨ï¼ŒèŠ‚çœ30%-40%çš„æˆæœ¬ã€‚",
                hint_ev: "ç”µåŠ¨è½¦è®¡åˆ’éå¸¸åˆ’ç®—ï¼Œä½†è¯·æ³¨æ„ï¼Œä½œä¸ºå®ç‰©ç¦åˆ©ï¼ˆBiKï¼‰ï¼Œæ‚¨å¯èƒ½éœ€è¦ç¼´çº³å°‘é‡ç¨æ¬¾ï¼ˆç›®å‰çº¦ä¸º2%ï¼‰ï¼Œæœ¬è®¡ç®—å™¨æš‚æœªæ‰£é™¤BiKç¨ã€‚",
                hint_other: "ä¸€èˆ¬è–ªèµ„ç‰ºç‰²é¡¹ç›®ã€‚è¯·ç¡®ä¿æ‚¨çš„ç‰ºç‰²åè–ªèµ„ä¸ä½äºæœ€ä½å·¥èµ„æ ‡å‡†ã€‚"
            },
            'en': {
                title: "Salary Sacrifice Pro", subtitle: "UK Pension, Tax & Loan Optimization",
                h2_config: "Configuration",
                lbl_salary: "Gross Salary", lbl_region: "Tax Region",
                opt_uk: "England/Wales/NI", opt_scot: "Scotland",
                lbl_sacrifice_config: "Sacrifice Config",
                type_pension: "ğŸ’¼ Pension", type_cycle: "ğŸš² Cycle to Work", 
                type_ev: "ğŸš— EV Car Scheme", type_other: "ğŸ“¦ General",
                opt_monthly: "Monthly", opt_yearly: "Yearly",
                lbl_student_loan: "Student Loan",
                loan_none: "None", loan_plan1: "Plan 1", loan_plan2: "Plan 2", loan_plan4: "Plan 4 (Scotland)", loan_plan5: "Plan 5", loan_postgrad: "Postgraduate",
                lbl_pension_pct: "Existing Pension %", lbl_age: "Age",
                opt_under_state: "Under Retirement", opt_over_state: "Over Retirement",
                h2_analysis: "Financial Analysis",
                tf_year: "Year", tf_quarter: "Quarter", tf_month: "Month", tf_week: "Week",
                h4_before: "Standard (Before)", h4_after: "Sacrificed (After)",
                res_gross: "Gross Pay", res_tax: "Income Tax", res_ni: "National Insurance", res_loan: "Student Loan", res_takehome: "Take Home Pay",
                badge_optimized: "OPTIMIZED",
                stat_tax_saved: "Total Tax Saved", stat_effective_cost: "Effective Cost", stat_value: "Value Added",
                disclaimer_calc: "*Based on 2024/25 tax rates (incl 8% NI). Does not calculate BiK for cars.",
                guide_title: "Salary Sacrifice Guide",
                guide_h_what: "What is Salary Sacrifice?", guide_p_what: "An agreement to reduce your contractual salary in exchange for a non-cash benefit, most commonly increased pension contributions.",
                guide_h_why: "Why do it?", guide_p_why: "The main benefit is <strong>Tax Efficiency</strong>. You pay less Income Tax and National Insurance. Student loan repayments also decrease as they are calculated on gross pay.",
                guide_h_student: "Student Loans", guide_p_student: "If you have student loans (Plan 1/2/4/5/PG), salary sacrifice reduces your repayment obligations, adding another ~9% to your savings efficiency!",
                faq_title: "FAQ",
                faq_q1: "Affects mortgages?", faq_a1: "It can. Lenders typically apply multipliers to your contractual salary. Lower salary = lower borrowing limit.",
                faq_q2: "Minimum wage limit?", faq_a2: "Yes. You cannot sacrifice your salary below the National Minimum Wage rates.",
                faq_q3: "Scottish Tax?", faq_a4: "Scotland has distinct tax bands (6 tiers). This calculator supports Scottish tax logic.",
                footer_text: "Figures are estimates only.",
                hint_pension: "Pension contributions are the most common form. 100% tax efficient and grows compound interest.",
                hint_cycle: "Cycle to Work allows you to pay for bikes/gear from gross pay, saving 30-47%.",
                hint_ev: "EV Schemes are great, but remember they incur Benefit in Kind (BiK) tax (currently ~2%). This calculator assumes gross deduction only.",
                hint_other: "General sacrifice. Ensure you don't drop below minimum wage."
            }
            // Add other languages similarly if needed...
        };

        // --- Core Calculator Engine (2024/25) ---
        const Calculator = {
            // Tax Bands 2024/25
            TAX_BANDS_UK: [
                { limit: 12570, rate: 0 },
                { limit: 50270, rate: 0.20 },
                { limit: 125140, rate: 0.40 },
                { limit: Infinity, rate: 0.45 }
            ],
            TAX_BANDS_SCOT: [
                { limit: 12570, rate: 0 },
                { limit: 14876, rate: 0.19 }, // Starter
                { limit: 26561, rate: 0.20 }, // Basic
                { limit: 43662, rate: 0.21 }, // Intermediate
                { limit: 75000, rate: 0.42 }, // Higher
                { limit: 125140, rate: 0.45 }, // Advanced
                { limit: Infinity, rate: 0.48 } // Top
            ],

            // Student Loan Thresholds 2024/25 (Annual)
            LOAN_PLANS: {
                'none': { threshold: 0, rate: 0 },
                'plan1': { threshold: 24990, rate: 0.09 },
                'plan2': { threshold: 27295, rate: 0.09 },
                'plan4': { threshold: 31395, rate: 0.09 }, // Scotland
                'plan5': { threshold: 25000, rate: 0.09 }, // New
                'postgrad': { threshold: 21000, rate: 0.06 }
            },

            NI: { threshold: 12570, upper: 50270, rateMain: 0.08, rateUpper: 0.02 },

            calculate() {
                // Inputs
                const salary = parseFloat(document.getElementById('input-salary').value) || 0;
                let sacrifice = parseFloat(document.getElementById('input-sacrifice').value) || 0;
                const freq = document.getElementById('input-freq').value;
                const region = document.getElementById('input-region').value;
                const loanType = document.getElementById('input-student-loan').value;
                const ageType = document.getElementById('input-age').value;
                const sacType = document.getElementById('input-type').value;

                // Normalize to Annual
                if (freq === 'monthly') sacrifice *= 12;
                
                // Ensure sacrifice doesn't exceed salary (basic validation)
                if (sacrifice >= salary) sacrifice = salary - 1000; // safety

                // Calculate Before & After
                const before = this.computeAll(salary, region, loanType, ageType);
                const after = this.computeAll(salary - sacrifice, region, loanType, ageType);

                // Determine Divider for Analysis View
                let divider = 1;
                switch(App.currentTimeframe) {
                    case 'monthly': divider = 12; break;
                    case 'weekly': divider = 52; break;
                    case 'quarterly': divider = 4; break;
                }

                // Update UI
                this.updateUI('res-gross-old', before.gross, divider);
                this.updateUI('res-tax-old', before.tax, divider);
                this.updateUI('res-ni-old', before.ni, divider);
                this.updateUI('res-loan-old', before.loan, divider);
                this.updateUI('res-net-old', before.net, divider);

                this.updateUI('res-gross-new', after.gross, divider);
                this.updateUI('res-tax-new', after.tax, divider);
                this.updateUI('res-ni-new', after.ni, divider);
                this.updateUI('res-loan-new', after.loan, divider);
                this.updateUI('res-net-new', after.net, divider);

                // Hints update
                const hints = i18nData[App.currentLang] || i18nData['en'];
                document.getElementById('type-hint').textContent = hints[`hint_${sacType}`] || "";

                // Stats Calculation (Always Annual for logic, displayed maybe annual?)
                // Let's keep stats annual for big impact numbers, or match timeframe? Match timeframe is better.
                const taxSaved = (before.tax + before.ni + before.loan) - (after.tax + after.ni + after.loan);
                const effectiveCost = (before.net - after.net); // How much takehome you actually lost
                // Value is what you got (Sacrifice amount)
                const value = sacrifice; 

                this.updateUI('stat-tax-saved', taxSaved, divider);
                this.updateUI('stat-real-cost', effectiveCost, divider);
                this.updateUI('stat-value', value, divider);
            },

            computeAll(gross, region, loanType, ageType) {
                const tax = this.calcTax(gross, region);
                const ni = this.calcNI(gross, ageType);
                const loan = this.calcLoan(gross, loanType);
                return {
                    gross: gross,
                    tax: tax,
                    ni: ni,
                    loan: loan,
                    net: gross - tax - ni - loan
                };
            },

            calcTax(gross, region) {
                // Personal Allowance logic
                let allowance = 12570;
                if (gross > 100000) {
                    allowance = Math.max(0, 12570 - (gross - 100000) / 2);
                }

                const bands = (region === 'scot') ? this.TAX_BANDS_SCOT : this.TAX_BANDS_UK;
                let tax = 0;
                let taxableIncome = Math.max(0, gross - allowance); // This is a simplification. 
                // In reality, bands apply to income above allowance. 
                // The bands array structure assumes 0-start numbers match the "Taxable Income" buckets or "Total Income"?
                // UK bands usually quoted as "Income between X and Y".
                // Let's use a robust "Bucket" approach.

                // Logic: 
                // 1. Determine "Taxable Income" = Gross - Allowance (if +ve).
                // 2. Apply bands to Taxable Income.
                // Note: Scot/UK bands in array are "Total Income" thresholds usually, but standard calculator logic 
                // applies bands to taxable income starting at 0.
                // Actually, the bands I defined: 12570 is the 0% limit.
                // So I can iterate through the bands based on Gross.
                
                // Adjusted Bands for Allowance Taper:
                // If allowance reduces, the 0% band shrinks.
                // Effectively, we calculate tax on (Gross).
                
                let previousLimit = 0;
                
                // Special handling for Allowance Taper in Loop is hard.
                // Simpler: Calculate "Taxable Income" then map to bands widths.
                // UK Basic: 37700 width. Higher: starts after basic.
                // Scot Starter: 2306 width (14876 - 12570).
                
                // Let's stick to the Iterative "Tax on Gross" method respecting the 0% band which is the allowance.
                let remaining = gross;
                
                // Band 0: Personal Allowance
                let band0Width = allowance;
                let band0Tax = 0;
                remaining -= Math.min(remaining, band0Width);
                
                if (region === 'scot') {
                    // Scot Bands on Taxable Income
                    // Starter (19%): 14876 - 12570 = 2306
                    let w1 = 2306; 
                    let t1 = Math.min(remaining, w1) * 0.19; remaining -= Math.min(remaining, w1);
                    // Basic (20%): 26561 - 14876 = 11685
                    let w2 = 11685;
                    let t2 = Math.min(remaining, w2) * 0.20; remaining -= Math.min(remaining, w2);
                    // Inter (21%): 43662 - 26561 = 17101
                    let w3 = 17101;
                    let t3 = Math.min(remaining, w3) * 0.21; remaining -= Math.min(remaining, w3);
                    // Higher (42%): 75000 - 43662 = 31338
                    let w4 = 31338;
                    let t4 = Math.min(remaining, w4) * 0.42; remaining -= Math.min(remaining, w4);
                    // Advanced (45%): 125140 - 75000 = 50140
                    let w5 = 50140;
                    let t5 = Math.min(remaining, w5) * 0.45; remaining -= Math.min(remaining, w5);
                    // Top (48%): Rest
                    let t6 = remaining * 0.48;
                    
                    tax = t1 + t2 + t3 + t4 + t5 + t6;
                } else {
                    // UK Bands on Taxable Income
                    // Basic (20%): 50270 - 12570 = 37700
                    let w1 = 37700;
                    let t1 = Math.min(remaining, w1) * 0.20; remaining -= Math.min(remaining, w1);
                    // Higher (40%): 125140 - 50270 = 74870
                    let w2 = 74870;
                    let t2 = Math.min(remaining, w2) * 0.40; remaining -= Math.min(remaining, w2);
                    // Additional (45%): Rest
                    let t3 = remaining * 0.45;
                    
                    tax = t1 + t2 + t3;
                }
                
                return tax;
            },

            calcNI(gross, ageType) {
                if (ageType === 'over') return 0;
                
                let ni = 0;
                // Primary Threshold: 12570
                // Upper Earnings Limit: 50270
                if (gross > 12570) {
                    let mainChunk = Math.min(gross, 50270) - 12570;
                    ni += mainChunk * 0.08;
                }
                if (gross > 50270) {
                    ni += (gross - 50270) * 0.02;
                }
                return ni;
            },

            calcLoan(gross, plan) {
                const p = this.LOAN_PLANS[plan];
                if (!p || p.threshold === 0) return 0;
                
                if (gross > p.threshold) {
                    return (gross - p.threshold) * p.rate;
                }
                return 0;
            },

            updateUI(id, val, divider) {
                const el = document.getElementById(id);
                if(el) {
                    el.textContent = 'Â£' + (val / divider).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
                }
            }
        };

        // --- App Logic ---
        const App = {
            currentLang: 'zh-CN',
            currentTimeframe: 'yearly',

            init() {
                const urlParams = new URLSearchParams(window.location.search);
                const langParam = urlParams.get('lang');
                const savedLang = localStorage.getItem('app_lang_salary');
                
                this.currentLang = (langParam && i18nData[langParam]) ? langParam : (savedLang || 'zh-CN');
                
                if (!langParam) this.updateUrl(this.currentLang);

                document.getElementById('lang-selector').value = this.currentLang;

                this.handleTheme();
                this.setupLanguage();
                this.updateYear();
                this.translateUI(this.currentLang);
                
                Calculator.calculate();
            },

            updateYear() {
                document.getElementById('year').textContent = new Date().getFullYear();
            },

            updateUrl(lang) {
                try {
                    const newUrl = new URL(window.location);
                    newUrl.searchParams.set('lang', lang);
                    window.history.pushState({}, '', newUrl);
                } catch (e) {}
            },

            setupLanguage() {
                const selector = document.getElementById('lang-selector');
                selector.addEventListener('change', (e) => {
                    const lang = e.target.value;
                    this.currentLang = lang;
                    localStorage.setItem('app_lang_salary', lang);
                    this.updateUrl(lang);
                    this.translateUI(lang);
                    Calculator.calculate();
                });
            },

            setTimeframe(tf) {
                this.currentTimeframe = tf;
                // Update Buttons
                const btns = document.getElementById('timeframe-selector').children;
                for(let btn of btns) {
                    btn.classList.remove('active');
                    btn.classList.add('inactive');
                }
                event.target.classList.remove('inactive');
                event.target.classList.add('active');
                
                Calculator.calculate();
            },

            translateUI(lang) {
                const data = i18nData[lang] || i18nData['en']; // fallback to zh-CN if en missing? No, structure implies en fallback
                document.documentElement.lang = lang;
                
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(data[key]) {
                        el.innerHTML = data[key];
                    }
                });
            },

            handleTheme() {
                const toggle = document.getElementById('mode-toggle');
                const html = document.documentElement;
                
                if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    html.classList.add('dark');
                }

                toggle.addEventListener('click', () => {
                    html.classList.toggle('dark');
                    localStorage.theme = html.classList.contains('dark') ? 'dark' : 'light';
                });
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
<div id="related-tools-container"></div>
<script src="/scripts/related.js"></script>
</body>
</html>