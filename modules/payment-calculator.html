<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="payment_calculator">
    <meta name="category" content="financial">
    <meta name="icon" content="ğŸ’°">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Payment Calculator">
    <meta name="description" content="Calculate your monthly payment for loans or mortgages based on principal, interest rate and term.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="ä»˜æ¬¾è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="æ ¹æ®æœ¬é‡‘ã€åˆ©ç‡å’ŒæœŸé™è®¡ç®—è´·æ¬¾æˆ–æŠµæŠ¼è´·æ¬¾çš„æœˆä»˜æ¬¾é¢ã€‚">
    
    <meta name="lang-title-zh-TW" content="ä»˜æ¬¾è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="æ ¹æ“šæœ¬é‡‘ã€åˆ©ç‡å’ŒæœŸé™è¨ˆç®—è²¸æ¬¾æˆ–æŠµæŠ¼è²¸æ¬¾çš„æœˆä»˜æ¬¾é¡ã€‚">
    
    <meta name="lang-title-ja" content="æ”¯æ‰•ã„è¨ˆç®—ãƒ„ãƒ¼ãƒ«">
    <meta name="lang-description-ja" content="å…ƒæœ¬ã€é‡‘åˆ©ã€æœŸé–“ã«åŸºã¥ã„ã¦ãƒ­ãƒ¼ãƒ³ã‚„ä½å®…ãƒ­ãƒ¼ãƒ³ã®æœˆã€…ã®æ”¯æ‰•é¡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹">
    <meta name="lang-description-ru" content="Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ¹Ñ‚Ğµ ĞµĞ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ Ğ¿Ğ¾ ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ñƒ Ğ¸Ğ»Ğ¸ Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞºĞµ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾Ğ»Ğ³Ğ°, Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ½Ğ¾Ğ¹ ÑÑ‚Ğ°Ğ²ĞºĞ¸ Ğ¸ ÑÑ€Ğ¾ĞºĞ°.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .result-section { margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 8px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; text-sm font-medium text-gray-700 mb-1; }
        select, input[type="number"] { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .result-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
        .result-item { background: white; padding: 10px; border-radius: 4px; }
        .result-label { font-size: 0.85rem; color: gray; }
        .result-value { font-size: 1.1rem; font-weight: 600; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="payment_calculator" 
         data-category="financial" 
         data-title="Payment Calculator" 
         data-icon="ğŸ’°">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="payment-lang" onchange="PaymentCalculator.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ğŸ’° Payment Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <!-- è´·æ¬¾é‡‘é¢ -->
            <div class="form-group">
                <label data-i18n="loan_amount">Loan Amount</label>
                <input type="number" id="loan-amount" step="any" min="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="0.00">
            </div>
            
            <!-- å¹´åˆ©ç‡ -->
            <div class="form-group">
                <label data-i18n="interest_rate">Annual Interest Rate (%)</label>
                <input type="number" id="interest-rate" step="0.01" min="0" max="100" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="0.00">
            </div>
            
            <!-- è´·æ¬¾æœŸé™ -->
            <div class="form-group">
                <div class="flex gap-3">
                    <div class="flex-1">
                        <label data-i18n="loan_term">Loan Term</label>
                        <input type="number" id="loan-term" min="1" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="0">
                    </div>
                    <div class="flex-1">
                        <label data-i18n="term_unit">Term Unit</label>
                        <select id="term-unit" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                            <option value="years" selected data-i18n="years">Years</option>
                            <option value="months" data-i18n="months">Months</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- ç²¾åº¦é€‰æ‹© -->
            <div class="form-group">
                <label data-i18n="precision">Precision (decimal places)</label>
                <input type="number" id="payment-precision" min="0" max="6" value="2" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="flex gap-2">
                <button onclick="PaymentCalculator.clearForm()" class="flex-1 bg-gray-600 text-white py-2 rounded font-bold hover:bg-gray-700 transition" data-i18n="clear">Clear</button>
                <button onclick="PaymentCalculator.calculate()" class="flex-1 bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition" data-i18n="calculate">Calculate</button>
            </div>
        </div>

        <!-- é”™è¯¯æç¤º -->
        <div id="payment-error" class="text-sm text-red-600 mt-2 hidden mb-4"></div>
        
        <!-- ç»“æœå±•ç¤º -->
        <div id="payment-results" class="hidden">
            <div class="text-sm text-gray-500 mb-2" data-i18n="calculation_results">Calculation Results</div>
            <div class="result-section">
                <div class="result-grid">
                    <div class="result-item">
                        <div class="result-label" data-i18n="monthly_payment">Monthly Payment</div>
                        <div class="result-value" id="monthly-payment">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label" data-i18n="total_payment">Total Payment</div>
                        <div class="result-value" id="total-payment">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label" data-i18n="total_interest">Total Interest</div>
                        <div class="result-value" id="total-interest">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label" data-i18n="number_of_payments">Number of Payments</div>
                        <div class="result-value" id="number-of-payments">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¯´æ˜ä¿¡æ¯ -->
        <div class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600">
            <p data-i18n="notes">Notes:</p>
            <ul class="list-disc list-inside mt-2 space-y-1" id="notes-list">
                <li data-i18n="note1">This calculator uses the standard loan payment formula: M = P * (r(1+r)^n) / ((1+r)^n - 1)</li>
                <li data-i18n="note2">Where: M = monthly payment, P = principal loan amount, r = monthly interest rate (annual rate/12), n = number of payments</li>
            </ul>
        </div>
    </div>

    <script>
        const PaymentCalculator = {
            // å¤šè¯­è¨€æ–‡æœ¬
            i18n: {
                'en': {
                    title: 'ğŸ’° Payment Calculator',
                    loan_amount: 'Loan Amount',
                    interest_rate: 'Annual Interest Rate (%)',
                    loan_term: 'Loan Term',
                    term_unit: 'Term Unit',
                    years: 'Years',
                    months: 'Months',
                    precision: 'Precision (decimal places)',
                    clear: 'Clear',
                    calculate: 'Calculate',
                    calculation_results: 'Calculation Results',
                    monthly_payment: 'Monthly Payment',
                    total_payment: 'Total Payment',
                    total_interest: 'Total Interest',
                    number_of_payments: 'Number of Payments',
                    notes: 'Notes:',
                    note1: 'This calculator uses the standard loan payment formula: M = P * (r(1+r)^n) / ((1+r)^n - 1)',
                    note2: 'Where: M = monthly payment, P = principal loan amount, r = monthly interest rate (annual rate/12), n = number of payments',
                    err_invalid_input: 'Please enter valid positive numbers for all fields'
                },
                'zh-CN': {
                    title: 'ğŸ’° ä»˜æ¬¾è®¡ç®—å™¨',
                    loan_amount: 'è´·æ¬¾é‡‘é¢',
                    interest_rate: 'å¹´åˆ©ç‡ (%)',
                    loan_term: 'è´·æ¬¾æœŸé™',
                    term_unit: 'æœŸé™å•ä½',
                    years: 'å¹´',
                    months: 'æœˆ',
                    precision: 'ç²¾åº¦ï¼ˆå°æ•°ä½æ•°ï¼‰',
                    clear: 'æ¸…é™¤',
                    calculate: 'è®¡ç®—',
                    calculation_results: 'è®¡ç®—ç»“æœ',
                    monthly_payment: 'æœˆä»˜æ¬¾é¢',
                    total_payment: 'æ€»ä»˜æ¬¾é¢',
                    total_interest: 'æ€»åˆ©æ¯',
                    number_of_payments: 'ä»˜æ¬¾æ¬¡æ•°',
                    notes: 'è¯´æ˜ï¼š',
                    note1: 'æœ¬è®¡ç®—å™¨ä½¿ç”¨æ ‡å‡†è´·æ¬¾ä»˜æ¬¾å…¬å¼ï¼šæœˆä»˜æ¬¾ = æœ¬é‡‘ Ã— [æœˆåˆ©ç‡Ã—(1+æœˆåˆ©ç‡)^è¿˜æ¬¾æœˆæ•°] / [(1+æœˆåˆ©ç‡)^è¿˜æ¬¾æœˆæ•° - 1]',
                    note2: 'å…¶ä¸­ï¼šæœˆåˆ©ç‡ = å¹´åˆ©ç‡/12ï¼Œè¿˜æ¬¾æœˆæ•° = è´·æ¬¾æœŸé™ï¼ˆå¹´ï¼‰Ã—12 æˆ–ç›´æ¥è¾“å…¥æœˆæ•°',
                    err_invalid_input: 'è¯·ä¸ºæ‰€æœ‰å­—æ®µè¾“å…¥æœ‰æ•ˆçš„æ­£æ•°'
                },
                'zh-TW': {
                    title: 'ğŸ’° ä»˜æ¬¾è¨ˆç®—å™¨',
                    loan_amount: 'è²¸æ¬¾é‡‘é¡',
                    interest_rate: 'å¹´åˆ©ç‡ (%)',
                    loan_term: 'è²¸æ¬¾æœŸé™',
                    term_unit: 'æœŸé™å–®ä½',
                    years: 'å¹´',
                    months: 'æœˆ',
                    precision: 'ç²¾åº¦ï¼ˆå°æ•¸ä½æ•¸ï¼‰',
                    clear: 'æ¸…é™¤',
                    calculate: 'è¨ˆç®—',
                    calculation_results: 'è¨ˆç®—çµæœ',
                    monthly_payment: 'æœˆä»˜æ¬¾é¡',
                    total_payment: 'ç¸½ä»˜æ¬¾é¡',
                    total_interest: 'ç¸½åˆ©æ¯',
                    number_of_payments: 'ä»˜æ¬¾æ¬¡æ•¸',
                    notes: 'èªªæ˜ï¼š',
                    note1: 'æœ¬è¨ˆç®—å™¨ä½¿ç”¨æ¨™æº–è²¸æ¬¾ä»˜æ¬¾å…¬å¼ï¼šæœˆä»˜æ¬¾ = æœ¬é‡‘ Ã— [æœˆåˆ©ç‡Ã—(1+æœˆåˆ©ç‡)^é‚„æ¬¾æœˆæ•¸] / [(1+æœˆåˆ©ç‡)^é‚„æ¬¾æœˆæ•¸ - 1]',
                    note2: 'å…¶ä¸­ï¼šæœˆåˆ©ç‡ = å¹´åˆ©ç‡/12ï¼Œé‚„æ¬¾æœˆæ•¸ = è²¸æ¬¾æœŸé™ï¼ˆå¹´ï¼‰Ã—12 æˆ–ç›´æ¥è¼¸å…¥æœˆæ•¸',
                    err_invalid_input: 'è«‹ç‚ºæ‰€æœ‰æ¬„ä½è¼¸å…¥æœ‰æ•ˆçš„æ­£æ•¸'
                },
                'ja': {
                    title: 'ğŸ’° æ”¯æ‰•ã„è¨ˆç®—ãƒ„ãƒ¼ãƒ«',
                    loan_amount: 'ãƒ­ãƒ¼ãƒ³é‡‘é¡',
                    interest_rate: 'å¹´åˆ© (%)',
                    loan_term: 'ãƒ­ãƒ¼ãƒ³æœŸé–“',
                    term_unit: 'æœŸé–“å˜ä½',
                    years: 'å¹´',
                    months: 'æœˆ',
                    precision: 'ç²¾åº¦ï¼ˆå°æ•°æ¡æ•°ï¼‰',
                    clear: 'ã‚¯ãƒªã‚¢',
                    calculate: 'è¨ˆç®—',
                    calculation_results: 'è¨ˆç®—çµæœ',
                    monthly_payment: 'æœˆã€…ã®æ”¯æ‰•é¡',
                    total_payment: 'ç·æ”¯æ‰•é¡',
                    total_interest: 'ç·åˆ©æ¯',
                    number_of_payments: 'æ”¯æ‰•å›æ•°',
                    notes: 'æ³¨é‡ˆï¼š',
                    note1: 'ã“ã®è¨ˆç®—æ©Ÿã¯æ¨™æº–çš„ãªãƒ­ãƒ¼ãƒ³æ”¯æ‰•ã„å…¬å¼ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼šæœˆã€…ã®æ”¯æ‰•é¡ = å…ƒæœ¬ Ã— [æœˆåˆ©ç‡Ã—(1+æœˆåˆ©ç‡)^æ”¯æ‰•å›æ•°] / [(1+æœˆåˆ©ç‡)^æ”¯æ‰•å›æ•° - 1]',
                    note2: 'ã“ã“ã§ï¼šæœˆåˆ©ç‡ = å¹´åˆ©/12ã€æ”¯æ‰•å›æ•° = ãƒ­ãƒ¼ãƒ³æœŸé–“ï¼ˆå¹´ï¼‰Ã—12 ã¾ãŸã¯ç›´æ¥æœˆæ•°ã‚’å…¥åŠ›',
                    err_invalid_input: 'ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æœ‰åŠ¹ãªæ­£æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'
                },
                'ru': {
                    title: 'ğŸ’° ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹',
                    loan_amount: 'Ğ¡ÑƒĞ¼Ğ¼Ğ° ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ°',
                    interest_rate: 'Ğ“Ğ¾Ğ´Ğ¾Ğ²Ğ°Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ° (%)',
                    loan_term: 'Ğ¡Ñ€Ğ¾Ğº ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ°',
                    term_unit: 'Ğ•Ğ´Ğ¸Ğ½Ğ¸Ñ†Ğ° ÑÑ€Ğ¾ĞºĞ°',
                    years: 'Ğ›ĞµÑ‚',
                    months: 'ĞœĞµÑÑÑ†ĞµĞ²',
                    precision: 'Ğ¢Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ·Ğ½Ğ°ĞºĞ¾Ğ² Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿ÑÑ‚Ğ¾Ğ¹)',
                    clear: 'ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ',
                    calculate: 'Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ',
                    calculation_results: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ°',
                    monthly_payment: 'Ğ•Ğ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶',
                    total_payment: 'ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶',
                    total_interest: 'ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚',
                    number_of_payments: 'ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹',
                    notes: 'ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ:',
                    note1: 'Ğ­Ñ‚Ğ¾Ñ‚ ĞºĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½ÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹: Ğ•Ğ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ = Ğ¡ÑƒĞ¼Ğ¼Ğ° Ã— [Ğ¼ĞµÑÑÑ‡Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ°Ã—(1+Ğ¼ĞµÑÑÑ‡Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ°)^ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹] / [(1+Ğ¼ĞµÑÑÑ‡Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ°)^ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ - 1]',
                    note2: 'Ğ“Ğ´Ğµ: Ğ¼ĞµÑÑÑ‡Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ° = Ğ³Ğ¾Ğ´Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ°/12, ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ = ÑÑ€Ğ¾Ğº ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ° (Ğ»ĞµÑ‚)Ã—12 Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑÑ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¼ĞµÑÑÑ†ĞµĞ²',
                    err_invalid_input: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‡Ğ¸ÑĞ»Ğ° Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ĞµĞ¹'
                }
            },
            
            // åˆå§‹åŒ–
            init: function() {
                this.updateLanguageElements();
            },
            
            // è®¡ç®—ä»˜æ¬¾
            calculate: function() {
                const loanAmount = parseFloat(document.getElementById('loan-amount').value);
                const interestRate = parseFloat(document.getElementById('interest-rate').value);
                const loanTerm = parseInt(document.getElementById('loan-term').value);
                const termUnit = document.getElementById('term-unit').value;
                const precision = parseInt(document.getElementById('payment-precision').value) || 2;
                
                const errorEl = document.getElementById('payment-error');
                const resultsEl = document.getElementById('payment-results');
                
                // éªŒè¯è¾“å…¥
                if (isNaN(loanAmount) || loanAmount <= 0 || 
                    isNaN(interestRate) || interestRate < 0 || 
                    isNaN(loanTerm) || loanTerm <= 0) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_invalid_input;
                    errorEl.classList.remove('hidden');
                    resultsEl.classList.add('hidden');
                    return;
                }
                
                // æ¸…é™¤é”™è¯¯
                errorEl.classList.add('hidden');
                
                // è®¡ç®—æœˆæ•°
                const months = termUnit === 'years' ? loanTerm * 12 : loanTerm;
                // æœˆåˆ©ç‡ (ç™¾åˆ†æ¯”è½¬æ¢ä¸ºå°æ•°)
                const monthlyRate = (interestRate / 100) / 12;
                
                // è®¡ç®—æœˆä»˜æ¬¾é¢ (ä½¿ç”¨è´·æ¬¾å…¬å¼)
                let monthlyPayment;
                if (monthlyRate === 0) {
                    monthlyPayment = loanAmount / months;
                } else {
                    const factor = Math.pow(1 + monthlyRate, months);
                    monthlyPayment = loanAmount * (monthlyRate * factor) / (factor - 1);
                }
                
                // è®¡ç®—æ€»ä»˜æ¬¾å’Œæ€»åˆ©æ¯
                const totalPayment = monthlyPayment * months;
                const totalInterest = totalPayment - loanAmount;
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('monthly-payment').textContent = this.formatCurrency(monthlyPayment, precision);
                document.getElementById('total-payment').textContent = this.formatCurrency(totalPayment, precision);
                document.getElementById('total-interest').textContent = this.formatCurrency(totalInterest, precision);
                document.getElementById('number-of-payments').textContent = months;
                
                // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                resultsEl.classList.remove('hidden');
            },
            
            // æ ¼å¼åŒ–è´§å¸æ˜¾ç¤º
            formatCurrency: function(value, precision) {
                return value.toFixed(precision);
            },
            
            // æ¸…é™¤è¡¨å•
            clearForm: function() {
                document.getElementById('loan-amount').value = '';
                document.getElementById('interest-rate').value = '';
                document.getElementById('loan-term').value = '';
                document.getElementById('payment-results').classList.add('hidden');
                document.getElementById('payment-error').classList.add('hidden');
            },
            
            // åˆ‡æ¢è¯­è¨€
            changeLang: function() {
                this.updateLanguageElements();
                
                // å¦‚æœæœ‰ç»“æœï¼Œé‡æ–°è®¡ç®—ä»¥æ›´æ–°æ˜¾ç¤º
                if (!document.getElementById('payment-results').classList.contains('hidden')) {
                    this.calculate();
                }
            },
            
            // æ›´æ–°è¯­è¨€å…ƒç´ 
            updateLanguageElements: function() {
                const lang = this.getCurrentLang();
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang][key]) {
                        el.textContent = this.i18n[lang][key];
                    }
                });
            },
            
            // è·å–å½“å‰è¯­è¨€
            getCurrentLang: function() {
                return document.getElementById('payment-lang').value;
            }
        };
        
        // åˆå§‹åŒ–è®¡ç®—å™¨
        document.addEventListener('DOMContentLoaded', function() {
            PaymentCalculator.init();
        });
    </script>
</body>
</html>