<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Category Meta Tag -->
    <meta name="category" content="engineering">
    <meta name="icon" content="⚡">
    <meta name="description" content="BJT Bias Calculator - Calculate DC Bias point, AC Gain (CE/CC), and Frequency Response.">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><path d=%22M30,30 L30,70 M70,30 L70,70 M30,50 L70,50%22 stroke=%22%236366f1%22 stroke-width=%228%22 fill=%22none%22/></svg>">
    
    <title>三极管偏置电压计算器 | BJT Bias Pro</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: { DEFAULT: '#6366f1', hover: '#4f46e5' }, /* Indigo */
                        secondary: { DEFAULT: '#f43f5e', hover: '#e11d48' }, /* Rose */
                        accent: { DEFAULT: '#f59e0b', hover: '#d97706' }, /* Amber */
                        bg: { light: '#f5f3ff', dark: '#0f172a' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .scrollbar-hide::-webkit-scrollbar { display: none; }
            .glass {
                @apply bg-white/90 dark:bg-slate-800/90 backdrop-blur-lg border border-indigo-200 dark:border-slate-700;
            }
            .input-group {
                @apply relative flex items-center;
            }
            .input-field {
                @apply w-full pl-2 pr-10 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all text-xs font-mono placeholder:text-slate-400 text-right;
            }
            .unit-label {
                @apply absolute right-3 text-slate-400 text-[10px] font-bold pointer-events-none;
            }
            .section-title {
                @apply text-xs font-bold text-slate-500 uppercase mb-3 flex items-center gap-2;
            }
            .btn-primary {
                @apply bg-gradient-to-r from-indigo-500 to-violet-600 hover:from-indigo-600 hover:to-violet-700 text-white font-bold py-2 px-4 rounded-xl shadow-lg shadow-indigo-500/20 transition-all active:scale-95 flex items-center justify-center gap-2 text-sm;
            }
            .btn-secondary {
                @apply bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 font-medium py-2 px-4 rounded-xl transition-all text-sm;
            }
            .result-row {
                @apply flex justify-between items-center text-xs py-1 border-b border-slate-100 dark:border-slate-700/50 last:border-0;
            }
            .result-val {
                @apply font-mono font-bold text-slate-700 dark:text-slate-200;
            }
            .tab-btn {
                @apply flex-1 py-1.5 text-xs font-bold rounded-lg transition-colors text-center cursor-pointer select-none border border-transparent;
            }
            .tab-btn.active {
                @apply bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-700/50;
            }
            .tab-btn.inactive {
                @apply text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800;
            }
        }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body class="bg-bg-light dark:bg-bg-dark min-h-screen font-sans text-slate-800 dark:text-slate-200 transition-colors duration-300 overflow-x-hidden">

    <!-- Header -->
    <header class="bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-violet-600 text-white flex items-center justify-center font-bold text-xs shadow-md">
                    BJT
                </div>
                <div>
                    <h1 class="text-lg font-bold text-slate-900 dark:text-white leading-tight" data-i18n="title">三极管偏置电压计算器</h1>
                    <p class="text-[10px] text-slate-500 font-medium" data-i18n="subtitle">BJT Bias & AC Analysis</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2">
                <select id="lang-selector" class="bg-slate-100 dark:bg-slate-700 text-xs font-bold px-2 py-1.5 rounded-lg border-none focus:ring-0 cursor-pointer text-slate-600 dark:text-slate-300">
                    <option value="zh-CN">中文</option>
                    <option value="en">EN</option>
                </select>
                <button id="mode-toggle" class="w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-500 hover:text-primary transition-colors">
                    <i class="fa fa-moon-o dark:hidden"></i>
                    <i class="fa fa-sun-o hidden dark:inline"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-6 max-w-6xl grid lg:grid-cols-12 gap-6">
        
        <!-- Input Panel -->
        <div class="lg:col-span-4 space-y-4">
            <div class="glass rounded-2xl p-5 shadow-sm space-y-4 border-t-4 border-t-indigo-500">
                
                <!-- Resistors -->
                <div>
                    <h3 class="section-title"><i class="fa fa-microchip"></i> <span data-i18n="h_resistors">偏置电阻 (Bias Resistors)</span></h3>
                    <div class="grid grid-cols-2 gap-x-3 gap-y-2">
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">R1 (Upper)</label>
                            <div class="input-group">
                                <input type="number" id="inp-r1" class="input-field" value="20" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">R2 (Lower)</label>
                            <div class="input-group">
                                <input type="number" id="inp-r2" class="input-field" value="2.2" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">RC (Collector)</label>
                            <div class="input-group">
                                <input type="number" id="inp-rc" class="input-field" value="1" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                         <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">RL (Load)</label>
                            <div class="input-group">
                                <input type="number" id="inp-rl" class="input-field" value="50" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5" title="Unbypassed Emitter Resistor">RE1 (AC)</label>
                            <div class="input-group">
                                <input type="number" id="inp-re1" class="input-field" value="0.24" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5" title="Bypassed Emitter Resistor">RE2 (DC only)</label>
                            <div class="input-group">
                                <input type="number" id="inp-re2" class="input-field" value="0" oninput="App.calculate()">
                                <span class="unit-label">KΩ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Parameters -->
                <div>
                    <h3 class="section-title"><i class="fa fa-sliders"></i> <span data-i18n="h_params">系统参数 (Parameters)</span></h3>
                    <div class="grid grid-cols-2 gap-x-3 gap-y-2">
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">VP (Vcc)</label>
                            <div class="input-group">
                                <input type="number" id="inp-vp" class="input-field" value="10" oninput="App.calculate()">
                                <span class="unit-label">V</span>
                            </div>
                        </div>
                         <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">Rs (Source)</label>
                            <div class="input-group">
                                <input type="number" id="inp-rs" class="input-field" value="50" oninput="App.calculate()">
                                <span class="unit-label">Ω</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">Beta (β)</label>
                            <div class="input-group">
                                <input type="number" id="inp-beta" class="input-field" value="100" oninput="App.calculate()">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] font-bold text-slate-400 block mb-0.5">VBE</label>
                            <div class="input-group">
                                <input type="number" id="inp-vbe" class="input-field" value="0.6" step="0.1" oninput="App.calculate()">
                                <span class="unit-label">V</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AC Params -->
                <div class="bg-indigo-50 dark:bg-indigo-900/20 p-3 rounded-lg border border-indigo-100 dark:border-indigo-800/30">
                    <h3 class="section-title text-indigo-500 mb-2"><i class="fa fa-wave-square"></i> <span data-i18n="h_ac_params">高频参数 (High Freq)</span></h3>
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="text-[9px] font-bold text-indigo-400 block mb-0.5">fT</label>
                            <input type="number" id="inp-ft" class="input-field h-7 text-[10px]" value="650" oninput="App.calculate()">
                            <div class="text-[9px] text-right text-slate-400 mt-0.5">MHz</div>
                        </div>
                        <div>
                            <label class="text-[9px] font-bold text-indigo-400 block mb-0.5">CCB</label>
                            <input type="number" id="inp-ccb" class="input-field h-7 text-[10px]" value="1" oninput="App.calculate()">
                            <div class="text-[9px] text-right text-slate-400 mt-0.5">pF</div>
                        </div>
                         <div>
                            <label class="text-[9px] font-bold text-indigo-400 block mb-0.5">CBE</label>
                            <input type="number" id="inp-cbe" class="input-field h-7 text-[10px]" placeholder="Auto" oninput="App.calculate()">
                            <div class="text-[9px] text-right text-slate-400 mt-0.5">pF</div>
                        </div>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button onclick="App.calculate()" class="btn-primary flex-1">
                        <span data-i18n="btn_calc">计算</span>
                    </button>
                    <button onclick="App.reset()" class="btn-secondary text-red-500">
                        <i class="fa fa-refresh"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Output Panel -->
        <div class="lg:col-span-8 space-y-4">
            
            <div class="grid md:grid-cols-2 gap-4 h-full">
                <!-- Left: Results -->
                <div class="flex flex-col gap-4">
                    
                    <!-- DC Results -->
                    <div class="glass rounded-2xl shadow-sm border-t-4 border-t-amber-500 overflow-hidden">
                        <div class="bg-slate-50 dark:bg-slate-800/50 p-3 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
                            <h3 class="font-bold text-slate-700 dark:text-slate-200 text-xs uppercase" data-i18n="h_dc_res">直流工作点 (DC Bias)</h3>
                            <span id="status-badge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-emerald-100 text-emerald-700">Active</span>
                        </div>
                        <div class="p-3 grid grid-cols-2 gap-x-6 gap-y-1">
                            <div class="result-row"><span class="text-slate-500">VB (Base)</span> <span id="res-vb" class="result-val">- V</span></div>
                            <div class="result-row"><span class="text-slate-500">VE (Emitter)</span> <span id="res-ve" class="result-val">- V</span></div>
                            <div class="result-row"><span class="text-slate-500">VC (Collector)</span> <span id="res-vc" class="result-val">- V</span></div>
                            <div class="result-row"><span class="text-slate-500">RB (Thevenin)</span> <span id="res-rb" class="result-val">- KΩ</span></div>
                            <div class="result-row"><span class="text-slate-500">IC (Collector)</span> <span id="res-ic" class="result-val">- mA</span></div>
                            <div class="result-row"><span class="text-slate-500">IB (Base)</span> <span id="res-ib" class="result-val">- mA</span></div>
                        </div>
                    </div>

                    <!-- AC Model -->
                    <div class="glass rounded-2xl shadow-sm border-t-4 border-t-rose-500 overflow-hidden">
                        <div class="bg-slate-50 dark:bg-slate-800/50 p-3 border-b border-slate-200 dark:border-slate-700">
                            <h3 class="font-bold text-slate-700 dark:text-slate-200 text-xs uppercase" data-i18n="h_ac_res">微变等效参数 (Small Signal)</h3>
                        </div>
                        <div class="p-3 grid grid-cols-2 gap-x-6 gap-y-1">
                            <div class="result-row"><span class="text-slate-500">gm (Transcond.)</span> <span id="res-gm" class="result-val">- mS</span></div>
                            <div class="result-row"><span class="text-slate-500">rπ (Input Res)</span> <span id="res-rpi" class="result-val">- KΩ</span></div>
                            <div class="result-row"><span class="text-slate-500">re (Intrinsic)</span> <span id="res-re" class="result-val">- Ω</span></div>
                            <div class="result-row"><span class="text-slate-500">CBE (Derived)</span> <span id="res-cbe-calc" class="result-val">- pF</span></div>
                        </div>
                    </div>

                    <!-- Config Analysis -->
                    <div class="glass rounded-2xl shadow-sm border-t-4 border-t-indigo-500 overflow-hidden">
                        <div class="flex p-1 bg-slate-100 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700">
                            <div class="tab-btn active" id="tab-ce" onclick="App.setTab('ce')">CE 共发射极</div>
                            <div class="tab-btn inactive" id="tab-cc" onclick="App.setTab('cc')">CC 共集电极</div>
                        </div>
                        
                        <!-- CE Results -->
                        <div id="panel-ce" class="p-4 space-y-2">
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">电压增益 (Voltage Gain, Av)</span>
                                <span id="res-ce-av" class="text-xl font-bold text-indigo-600 dark:text-indigo-400 font-mono">-</span>
                            </div>
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">米勒电容 (Miller Cap, CM)</span>
                                <span id="res-ce-cm" class="text-sm font-bold text-slate-700 dark:text-slate-300 font-mono">- pF</span>
                            </div>
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">带宽 (Bandwidth, BW)</span>
                                <span id="res-ce-bw" class="text-sm font-bold text-rose-600 dark:text-rose-400 font-mono">- MHz</span>
                            </div>
                        </div>

                        <!-- CC Results -->
                        <div id="panel-cc" class="p-4 space-y-2 hidden">
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">电压增益 (Voltage Gain, Av)</span>
                                <span id="res-cc-av" class="text-xl font-bold text-indigo-600 dark:text-indigo-400 font-mono">-</span>
                            </div>
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">输入阻抗 (Input Rin)</span>
                                <span id="res-cc-rin" class="text-sm font-bold text-slate-700 dark:text-slate-300 font-mono">- KΩ</span>
                            </div>
                            <div class="flex justify-between items-end">
                                <span class="text-xs text-slate-500">带宽 (Bandwidth, BW)</span>
                                <span id="res-cc-bw" class="text-sm font-bold text-rose-600 dark:text-rose-400 font-mono">- MHz</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Right: Circuit Diagram -->
                <div class="glass rounded-2xl p-4 flex items-center justify-center bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 min-h-[300px]">
                    <svg viewBox="0 0 280 340" class="w-full h-full text-slate-600 dark:text-slate-300">
                        <!-- Vcc Line -->
                        <line x1="60" y1="20" x2="220" y2="20" class="circuit-line"/>
                        <circle cx="140" cy="20" r="3" class="component-fill"/>
                        <text x="140" y="15" class="circuit-text font-bold" text-anchor="middle">VP (Vcc)</text>

                        <!-- R1 -->
                        <line x1="100" y1="20" x2="100" y2="50" class="circuit-line"/>
                        <rect x="90" y="50" width="20" height="40" class="circuit-line bg-white fill-white dark:fill-slate-800"/>
                        <text x="85" y="75" class="circuit-text" text-anchor="end">R1</text>
                        <line x1="100" y1="90" x2="100" y2="140" class="circuit-line"/>

                        <!-- R2 -->
                        <line x1="100" y1="140" x2="100" y2="170" class="circuit-line"/>
                        <rect x="90" y="170" width="20" height="40" class="circuit-line bg-white fill-white dark:fill-slate-800"/>
                        <text x="85" y="195" class="circuit-text" text-anchor="end">R2</text>
                        <line x1="100" y1="210" x2="100" y2="260" class="circuit-line"/>

                        <!-- RC -->
                        <line x1="180" y1="20" x2="180" y2="50" class="circuit-line"/>
                        <rect x="170" y="50" width="20" height="40" class="circuit-line bg-white fill-white dark:fill-slate-800"/>
                        <text x="195" y="75" class="circuit-text text-indigo-500 font-bold" text-anchor="start">RC</text>
                        <line x1="180" y1="90" x2="180" y2="120" class="circuit-line"/>

                        <!-- Transistor -->
                        <circle cx="165" cy="140" r="18" class="circuit-line opacity-20"/>
                        <line x1="180" y1="120" x2="180" y2="130" class="circuit-line"/> <!-- C -->
                        <line x1="180" y1="130" x2="190" y2="125" class="circuit-line"/> 
                        <line x1="150" y1="125" x2="150" y2="155" class="circuit-line" stroke-width="3"/> <!-- Base Plate -->
                        <line x1="150" y1="140" x2="100" y2="140" class="circuit-line"/> <!-- Base Leg -->
                        <line x1="180" y1="150" x2="180" y2="160" class="circuit-line"/> <!-- E -->
                        <line x1="180" y1="150" x2="175" y2="153" class="circuit-line"/> <!-- Arrow -->
                        <line x1="180" y1="150" x2="183" y2="145" class="circuit-line"/>

                        <!-- RE1 -->
                        <line x1="180" y1="160" x2="180" y2="170" class="circuit-line"/>
                        <rect x="170" y="170" width="20" height="30" class="circuit-line bg-white fill-white dark:fill-slate-800"/>
                        <text x="195" y="185" class="circuit-text font-bold" text-anchor="start">RE1</text>
                        <line x1="180" y1="200" x2="180" y2="210" class="circuit-line"/>

                        <!-- RE2 -->
                        <rect x="170" y="210" width="20" height="30" class="circuit-line bg-white fill-white dark:fill-slate-800"/>
                        <text x="195" y="225" class="circuit-text" text-anchor="start">RE2</text>
                        <line x1="180" y1="240" x2="180" y2="260" class="circuit-line"/>

                        <!-- Ground -->
                        <line x1="80" y1="260" x2="200" y2="260" class="circuit-line"/>
                        <line x1="130" y1="260" x2="150" y2="260" class="circuit-line"/>
                        <line x1="140" y1="260" x2="140" y2="270" class="circuit-line"/>
                        <line x1="130" y1="270" x2="150" y2="270" class="circuit-line"/>
                        <line x1="135" y1="275" x2="145" y2="275" class="circuit-line"/>
                        <text x="140" y="290" class="circuit-text" text-anchor="middle">GND</text>

                        <!-- Input Source -->
                        <line x1="40" y1="140" x2="60" y2="140" class="circuit-line"/> <!-- Cap -->
                        <line x1="60" y1="130" x2="60" y2="150" class="circuit-line"/>
                        <line x1="65" y1="130" x2="65" y2="150" class="circuit-line"/>
                        <line x1="65" y1="140" x2="100" y2="140" class="circuit-line"/>
                        <circle cx="30" cy="140" r="3" class="component-fill"/>
                        <text x="30" y="130" class="circuit-text" text-anchor="middle">In</text>
                        <text x="50" y="125" class="circuit-text text-[8px]" text-anchor="middle">Rs</text>
                        <rect x="35" y="138" width="10" height="4" class="circuit-line fill-slate-400"/>

                        <!-- Output CE -->
                        <line x1="180" y1="100" x2="220" y2="100" class="circuit-line"/>
                        <circle cx="220" cy="100" r="3" class="component-fill"/>
                        <text x="240" y="105" class="circuit-text font-bold text-indigo-500">Out(CE)</text>

                         <!-- Output CC -->
                        <line x1="180" y1="160" x2="220" y2="160" class="circuit-line" stroke-dasharray="2"/>
                        <circle cx="220" cy="160" r="3" class="component-fill" opacity="0.5"/>
                        <text x="240" y="165" class="circuit-text text-xs text-slate-400">Out(CC)</text>

                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Guide Section -->
    <section class="container mx-auto px-4 mb-12 max-w-6xl">
        <div class="glass rounded-2xl p-8 shadow-xl">
            <h2 class="text-xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-2">
                <i class="fa fa-graduation-cap text-primary"></i> <span data-i18n="guide_title">设计指南与公式</span>
            </h2>
            
            <div class="grid md:grid-cols-2 gap-12">
                <div class="space-y-6 text-slate-600 dark:text-slate-300 leading-relaxed text-sm">
                    <div class="bg-indigo-50 dark:bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
                        <h3 class="font-bold text-indigo-800 dark:text-indigo-200 mb-2 text-sm uppercase" data-i18n="h_dc_bias">直流偏置 (DC Bias)</h3>
                        <div class="font-mono text-indigo-700 dark:text-indigo-300 text-xs space-y-1">
                            <p>V<sub>BB</sub> = V<sub>P</sub> × R2 / (R1 + R2)</p>
                            <p>R<sub>B</sub> = R1 || R2</p>
                            <p>I<sub>B</sub> = (V<sub>BB</sub> - V<sub>BE</sub>) / (R<sub>B</sub> + (β+1)×R<sub>E</sub>)</p>
                            <p>V<sub>C</sub> = V<sub>P</sub> - I<sub>C</sub>×R<sub>C</sub></p>
                        </div>
                    </div>

                    <div class="bg-rose-50 dark:bg-rose-900/20 border-l-4 border-rose-500 p-4 rounded-r-lg">
                        <h3 class="font-bold text-rose-800 dark:text-rose-200 mb-2 text-sm uppercase" data-i18n="h_ce_gain">CE 电压增益</h3>
                        <p class="text-xs mb-2" data-i18n="p_ce_gain_note">假设 RE2 被旁路电容短路，交流增益由 RE1 决定。</p>
                        <div class="font-mono text-rose-700 dark:text-rose-300 text-xs space-y-1">
                            <p>A<sub>v</sub> ≈ - (R<sub>C</sub> || R<sub>L</sub>) / (r<sub>e</sub> + R<sub>E1</sub>)</p>
                            <p>r<sub>e</sub> ≈ 26mV / I<sub>E</sub></p>
                        </div>
                    </div>
                </div>

                <div class="space-y-4 text-slate-600 dark:text-slate-300 text-sm">
                    <h3 class="font-bold text-slate-800 dark:text-slate-200 mb-2 uppercase" data-i18n="h_notes">注意事项</h3>
                    <ul class="list-disc list-inside space-y-2 text-xs">
                        <li data-i18n="note_1"><strong>RE1 vs RE2:</strong> RE1 通常较小，不加旁路电容，用于稳定增益（负反馈）和改善线性度。RE2 通常较大，并联大电容以提高直流稳定性而不牺牲交流增益。</li>
                        <li data-i18n="note_2"><strong>Miller 效应:</strong> 在共发射极 (CE) 组态中，集电结电容 CCB 会被放大 (1+|Av|) 倍，显著降低输入带宽。</li>
                        <li data-i18n="note_3"><strong>射极跟随器 (CC):</strong> 电压增益略小于1，主要用于阻抗匹配（高输入阻抗，低输出阻抗）。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <footer class="text-center text-xs text-slate-400 py-6">
        <p>&copy; <span id="year"></span> BJT Bias Calculator. Generated for Educational Purposes.</p>
    </footer>

    <script>
        const i18nData = {
            'zh-CN': {
                title: "三极管偏置电压计算器", subtitle: "BJT偏置、增益与频响分析",
                h_resistors: "偏置电阻 (Bias Resistors)", h_params: "系统参数 (Parameters)", h_ac_params: "高频参数 (High Freq)",
                btn_calc: "计算",
                h_dc_res: "直流工作点 (DC Bias)", h_ac_res: "微变等效参数 (Small Signal)",
                
                guide_title: "设计指南与公式",
                h_dc_bias: "直流偏置 (DC Bias)", h_ce_gain: "CE 电压增益",
                p_ce_gain_note: "假设 RE2 被旁路电容短路，交流增益由 RE1 决定。",
                h_notes: "注意事项",
                note_1: "<strong>RE1 vs RE2:</strong> RE1 通常较小且不旁路，用于稳定增益。RE2 用于直流偏置稳定性。",
                note_2: "<strong>Miller 效应:</strong> 在 CE 组态中，CCB 电容会被放大，限制高频响应。",
                note_3: "<strong>射极跟随器 (CC):</strong> 主要用于阻抗变换，电压增益接近 1。"
            },
            'en': {
                title: "BJT Bias Voltage Calculator", subtitle: "BJT Bias, Gain & Freq Analysis",
                h_resistors: "Bias Resistors", h_params: "System Parameters", h_ac_params: "High Freq Parameters",
                btn_calc: "Calculate",
                h_dc_res: "DC Operating Point", h_ac_res: "Small Signal Model",
                
                guide_title: "Design Guide & Formulas",
                h_dc_bias: "DC Bias Calculation", h_ce_gain: "CE Voltage Gain",
                p_ce_gain_note: "Assuming RE2 is bypassed by a capacitor, AC gain is determined by RE1.",
                h_notes: "Design Notes",
                note_1: "<strong>RE1 vs RE2:</strong> RE1 is unbypassed for gain stability (swamping). RE2 sets DC bias.",
                note_2: "<strong>Miller Effect:</strong> In CE mode, CCB is multiplied by (1+|Av|), limiting bandwidth.",
                note_3: "<strong>Emitter Follower (CC):</strong> Used for impedance matching, Av is approx 1."
            }
        };

        const App = {
            lang: 'zh-CN',
            tab: 'ce',
            
            init() {
                this.setupLang();
                this.handleTheme();
                this.updateYear();
                this.calculate();
            },

            updateYear() {
                document.getElementById('year').textContent = new Date().getFullYear();
            },

            setupLang() {
                const sel = document.getElementById('lang-selector');
                const urlParams = new URLSearchParams(window.location.search);
                this.lang = urlParams.get('lang') || 'zh-CN';
                sel.value = this.lang;
                this.updateText();
                sel.addEventListener('change', (e) => {
                    this.lang = e.target.value;
                    try {
                        const newUrl = new URL(window.location);
                        newUrl.searchParams.set('lang', this.lang);
                        window.history.pushState({}, '', newUrl);
                    } catch (e) {}
                    this.updateText();
                });
            },

            updateText() {
                const dict = i18nData[this.lang];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(dict[key]) el.innerHTML = dict[key];
                });
            },

            setTab(t) {
                this.tab = t;
                document.getElementById('tab-ce').className = t === 'ce' ? 'tab-btn active' : 'tab-btn inactive';
                document.getElementById('tab-cc').className = t === 'cc' ? 'tab-btn active' : 'tab-btn inactive';
                
                if (t === 'ce') {
                    document.getElementById('panel-ce').classList.remove('hidden');
                    document.getElementById('panel-cc').classList.add('hidden');
                } else {
                    document.getElementById('panel-ce').classList.add('hidden');
                    document.getElementById('panel-cc').classList.remove('hidden');
                }
            },

            calculate() {
                const get = (id) => parseFloat(document.getElementById(id).value) || 0;
                
                const R1 = get('inp-r1') * 1e3;
                const R2 = get('inp-r2') * 1e3;
                const RC = get('inp-rc') * 1e3;
                const RL = get('inp-rl') * 1e3;
                const RE1 = get('inp-re1') * 1e3;
                const RE2 = get('inp-re2') * 1e3;
                const RE_total = RE1 + RE2;
                
                const VP = get('inp-vp');
                const RS = get('inp-rs');
                const Beta = get('inp-beta');
                const VBE = get('inp-vbe');
                
                const fT = get('inp-ft') * 1e6;
                const CCB = get('inp-ccb') * 1e-12;
                const inpCBE = document.getElementById('inp-cbe').value;

                // --- DC Analysis ---
                // Thevenin Equivalent for Base
                const RB = (R1 * R2) / (R1 + R2);
                const VBB = VP * (R2 / (R1 + R2));
                
                // IB = (VBB - VBE) / (RB + (Beta+1)*RE_total)
                const IB = (VBB - VBE) / (RB + (Beta + 1) * RE_total);
                
                const IC = Beta * IB;
                const IE = (Beta + 1) * IB;
                
                const VB = VBB - IB * RB; // Actual Base Voltage
                const VE = IE * RE_total;
                const VC = VP - IC * RC;

                // Status Check
                const badge = document.getElementById('status-badge');
                if (IB <= 0) {
                    badge.textContent = "Cutoff";
                    badge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-slate-200 text-slate-600";
                } else if (VC <= VE + 0.2) {
                    badge.textContent = "Saturation";
                    badge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-red-100 text-red-700";
                } else {
                    badge.textContent = "Active";
                    badge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-emerald-100 text-emerald-700";
                }

                // --- AC Small Signal ---
                const VT = 0.026; // 26mV
                const gm = IC / VT; // Transconductance
                const rpi = Beta / gm;
                const re = VT / IE;

                // --- Capacitance ---
                let CBE = 0;
                if (inpCBE && !isNaN(parseFloat(inpCBE))) {
                    CBE = parseFloat(inpCBE) * 1e-12;
                } else if (gm > 0 && fT > 0) {
                    // Estimate from fT: fT = gm / (2pi(Cbe + Ccb))
                    const C_total = gm / (2 * Math.PI * fT);
                    CBE = C_total - CCB;
                    if (CBE < 0) CBE = 0;
                }

                // --- CE Configuration ---
                // Load = RC || RL
                const R_load_ac_ce = (RC * RL) / (RC + RL);
                // Gain Av = - (Beta * R_load) / (rpi + (Beta+1)*RE1)  [Approx -R_load / (re + RE1)]
                // Using rpi model:
                // Rib = rpi + (Beta+1)*RE1
                // Av = - (gm * R_load_ac_ce * rpi) / Rib  ... simplifying -> - R_load / (1/gm + RE1)
                const Av_ce = - R_load_ac_ce / (re + RE1);
                
                // Input Impedance Zin_base = rpi + (Beta+1)RE1
                const Zin_base_ce = rpi + (Beta + 1) * RE1;
                const Zin_stage_ce = (RB * Zin_base_ce) / (RB + Zin_base_ce);
                
                // Bandwidth CE (Miller)
                const Cm = CCB * (1 + Math.abs(Av_ce));
                const C_in_total = CBE + Cm;
                const R_sig_eff = (RS * Zin_stage_ce) / (RS + Zin_stage_ce); // Source || Zin
                const f_pole_in = 1 / (2 * Math.PI * R_sig_eff * C_in_total);

                // --- CC Configuration ---
                // Load = RE_total || RL (Assuming output at Emitter, total RE matters for bias but usually only RE1 or RL is load. 
                // Let's assume Output is across RE_total || RL.
                // Wait, RE2 is bypassed for DC but here we talk about AC config.
                // If CC, usually we don't bypass RE fully or we take output from Emitter.
                // Let's assume standard CC: Output at Emitter. Load is RE_total || RL.
                const R_load_ac_cc = (RE_total * RL) / (RE_total + RL);
                
                // Av = R_load / (R_load + re)
                const Av_cc = R_load_ac_cc / (R_load_ac_cc + re);
                
                // Rin
                const Zin_base_cc = rpi + (Beta + 1) * R_load_ac_cc;
                const Zin_stage_cc = (RB * Zin_base_cc) / (RB + Zin_base_cc);
                
                // Bandwidth CC (Less Miller)
                // C_in approx CBE / (1 + gm*Re) ? No, simple pole
                // Effective Cin = CCB + CBE * (1 - Av_cc) [Bootstrapped]
                const C_in_cc = CCB + CBE * (1 - Av_cc);
                const f_pole_cc = 1 / (2 * Math.PI * (RS * Zin_stage_cc)/(RS+Zin_stage_cc) * C_in_cc);


                // --- Rendering ---
                const txt = (id, val, u, fix=2) => {
                    document.getElementById(id).textContent = isNaN(val) ? '-' : (val.toFixed(fix) + ' ' + u);
                };

                txt('res-vb', VB, 'V');
                txt('res-ve', VE, 'V');
                txt('res-vc', VC, 'V');
                txt('res-ic', IC * 1000, 'mA');
                txt('res-ib', IB * 1000, 'mA', 3);
                txt('res-rb', RB / 1000, 'KΩ');

                txt('res-gm', gm * 1000, 'mS');
                txt('res-rpi', rpi / 1000, 'KΩ');
                txt('res-re', re, 'Ω');
                txt('res-cbe-calc', CBE * 1e12, 'pF');

                // CE
                txt('res-ce-av', Av_ce, 'V/V');
                txt('res-ce-cm', Cm * 1e12, 'pF');
                txt('res-ce-bw', f_pole_in / 1e6, 'MHz');

                // CC
                txt('res-cc-av', Av_cc, 'V/V', 3);
                txt('res-cc-rin', Zin_stage_cc / 1000, 'KΩ');
                txt('res-cc-bw', f_pole_cc / 1e6, 'MHz');
            },

            reset() {
                // simple reload defaults
                document.getElementById('inp-r1').value = 20;
                document.getElementById('inp-r2').value = 2.2;
                this.calculate();
            },

            handleTheme() {
                const toggle = document.getElementById('mode-toggle');
                const html = document.documentElement;
                if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    html.classList.add('dark');
                }
                toggle.addEventListener('click', () => {
                    html.classList.toggle('dark');
                    localStorage.theme = html.classList.contains('dark') ? 'dark' : 'light';
                });
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
     <!--  结尾必须包含的代码 -->
    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
</body>
</html>