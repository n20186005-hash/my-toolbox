<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rent vs. Buy Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #fffbe6; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="rvb_calc" 
         data-category="finance" 
         data-title="Rent vs. Buy Calculator" 
         data-icon="üè†">
        
        <div class="absolute top-4 right-4">
            <select id="rb-lang" onchange="RentBuy.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">üè† Rent vs. Buy Calculator</h2>

        <!-- Buy Inputs -->
        <div class="bg-blue-50 p-3 rounded mb-3 border border-blue-100">
            <div class="text-xs font-bold text-blue-800 uppercase mb-2" data-i18n="sec_buy">Buying Scenario</div>
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_price">Home Price</label>
                    <input type="number" id="rb-price" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-blue-500" placeholder="300000" value="300000">
                </div>
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_rate">Mortgage Rate (%)</label>
                    <input type="number" id="rb-rate" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-blue-500" placeholder="6.5" value="6.5">
                </div>
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_down">Down Pay (%)</label>
                    <input type="number" id="rb-down" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-blue-500" placeholder="20" value="20">
                </div>
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_apprec">Appreciation (%)</label>
                    <input type="number" id="rb-apprec" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-blue-500" placeholder="3" value="3">
                </div>
            </div>
        </div>

        <!-- Rent Inputs -->
        <div class="bg-orange-50 p-3 rounded mb-3 border border-orange-100">
            <div class="text-xs font-bold text-orange-800 uppercase mb-2" data-i18n="sec_rent">Renting Scenario</div>
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_rent">Monthly Rent</label>
                    <input type="number" id="rb-rent" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-orange-500" placeholder="1500" value="1500">
                </div>
                <div>
                    <label class="block text-xs text-gray-600 mb-1" data-i18n="lbl_r_inc">Rent Increase (%)</label>
                    <input type="number" id="rb-r-inc" class="w-full p-2 border rounded text-sm outline-none focus:ring-1 focus:ring-orange-500" placeholder="3" value="3">
                </div>
            </div>
        </div>

        <div class="mb-4">
            <div class="flex justify-between text-xs text-gray-500 mb-1">
                <span data-i18n="lbl_years">Comparison Period (Years)</span>
                <span id="rb-years-val" class="font-bold text-gray-700">7</span>
            </div>
            <input type="range" id="rb-years" min="1" max="30" value="7" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-gray-600" oninput="document.getElementById('rb-years-val').innerText=this.value">
        </div>

        <button onclick="RentBuy.calc()" class="w-full bg-gray-700 text-white py-2 rounded font-bold hover:bg-gray-800 transition mb-6" data-i18n="btn_calc">Compare</button>

        <div class="hidden" id="rb-result-box">
            <div class="p-4 rounded-lg text-center mb-3 bg-gray-100 border border-gray-200" id="rb-winner-bg">
                <div class="text-sm text-gray-500" data-i18n="res_verdict">Verdict</div>
                <div id="rb-verdict" class="text-xl font-bold my-1">--</div>
                <div id="rb-save" class="text-xs font-bold text-gray-600">--</div>
            </div>

            <div class="grid grid-cols-2 gap-4 text-center text-sm">
                <div>
                    <div class="text-gray-500" data-i18n="res_buy_cost">Total Cost (Buy)</div>
                    <div id="res-buy-val" class="font-bold text-blue-700">--</div>
                </div>
                <div>
                    <div class="text-gray-500" data-i18n="res_rent_cost">Total Cost (Rent)</div>
                    <div id="res-rent-val" class="font-bold text-orange-700">--</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const RentBuy = {
            i18n: {
                'en': {
                    title: 'üè† Rent vs. Buy Calculator',
                    sec_buy: 'Buying Scenario', sec_rent: 'Renting Scenario',
                    lbl_price: 'Home Price', lbl_rate: 'Mortgage Rate (%)',
                    lbl_down: 'Down Payment (%)', lbl_apprec: 'Home Growth (%)',
                    lbl_rent: 'Monthly Rent', lbl_r_inc: 'Rent Increase (%)',
                    lbl_years: 'Duration (Years)',
                    btn_calc: 'Compare',
                    res_verdict: 'Verdict', res_buy_cost: 'Net Cost of Buying', res_rent_cost: 'Net Cost of Renting',
                    txt_buy_better: 'Buying is cheaper', txt_rent_better: 'Renting is cheaper',
                    txt_save: 'You save about'
                },
                'zh-CN': {
                    title: 'üè† ÁßüÊàø vs ‰π∞ÊàøËÆ°ÁÆóÂô®',
                    sec_buy: '‰π∞ÊàøÊñπÊ°à', sec_rent: 'ÁßüÊàøÊñπÊ°à',
                    lbl_price: 'ÊàøÂ±ã‰ª∑Ê†º', lbl_rate: 'ÊàøË¥∑Âà©Áéá (%)',
                    lbl_down: 'È¶ñ‰ªòÊØî‰æã (%)', lbl_apprec: 'Êàø‰∫ßÂ¢ûÂÄºÁéá (%)',
                    lbl_rent: 'ÊúàÁßüÈáë', lbl_r_inc: 'ÁßüÈáëÊ∂®ÂπÖ (%)',
                    lbl_years: 'ÂØπÊØîÂπ¥Èôê',
                    btn_calc: 'ÂºÄÂßãÂØπÊØî',
                    res_verdict: 'ÁªìËÆ∫', res_buy_cost: '‰π∞ÊàøÂáÄÊàêÊú¨', res_rent_cost: 'ÁßüÊàøÂáÄÊàêÊú¨',
                    txt_buy_better: '‰π∞ÊàøÊõ¥ÂàíÁÆó', txt_rent_better: 'ÁßüÊàøÊõ¥ÂàíÁÆó',
                    txt_save: 'Â§ßÁ∫¶ËäÇÁúÅ'
                },
                'zh-TW': {
                    title: 'üè† ÁßüÊàø vs Ë≤∑ÊàøË®àÁÆóÂô®',
                    sec_buy: 'Ë≤∑ÊàøÊñπÊ°à', sec_rent: 'ÁßüÊàøÊñπÊ°à',
                    lbl_price: 'ÊàøÂ±ãÂÉπÊ†º', lbl_rate: 'ÊàøË≤∏Âà©Áéá (%)',
                    lbl_down: 'È¶ñ‰ªòÊØî‰æã (%)', lbl_apprec: 'ÊàøÁî¢Â¢ûÂÄºÁéá (%)',
                    lbl_rent: 'ÊúàÁßüÈáë', lbl_r_inc: 'ÁßüÈáëÊº≤ÂπÖ (%)',
                    lbl_years: 'Â∞çÊØîÂπ¥Èôê',
                    btn_calc: 'ÈñãÂßãÂ∞çÊØî',
                    res_verdict: 'ÁµêË´ñ', res_buy_cost: 'Ë≤∑ÊàøÊ∑®ÊàêÊú¨', res_rent_cost: 'ÁßüÊàøÊ∑®ÊàêÊú¨',
                    txt_buy_better: 'Ë≤∑ÊàøÊõ¥ÂàíÁÆó', txt_rent_better: 'ÁßüÊàøÊõ¥ÂàíÁÆó',
                    txt_save: 'Â§ßÁ¥ÑÁØÄÁúÅ'
                },
                'ja': {
                    title: 'üè† Ë≥ÉË≤∏ vs ÊåÅ„Å°ÂÆ∂',
                    sec_buy: 'Ë≥ºÂÖ•„ÅÆÂ†¥Âêà', sec_rent: 'Ë≥ÉË≤∏„ÅÆÂ†¥Âêà',
                    lbl_price: 'Áâ©‰ª∂‰æ°Ê†º', lbl_rate: '‰ΩèÂÆÖ„É≠„Éº„É≥ÈáëÂà© (%)',
                    lbl_down: 'È†≠Èáë (%)', lbl_apprec: '‰æ°Ê†º‰∏äÊòáÁéá (%)',
                    lbl_rent: 'ÂÆ∂Ë≥É (ÊúàÈ°ç)', lbl_r_inc: 'ÂÆ∂Ë≥ÉÊõ¥Êñ∞Áéá (%)',
                    lbl_years: 'ÊØîËºÉÊúüÈñì (Âπ¥)',
                    btn_calc: 'ÊØîËºÉ„Åô„Çã',
                    res_verdict: 'Âà§ÂÆö', res_buy_cost: 'Ë≥ºÂÖ•„ÅÆÂÆüË≥™„Ç≥„Çπ„Éà', res_rent_cost: 'Ë≥ÉË≤∏„ÅÆÂÆüË≥™„Ç≥„Çπ„Éà',
                    txt_buy_better: 'Ë≥ºÂÖ•„Åå„ÅäÂæó', txt_rent_better: 'Ë≥ÉË≤∏„Åå„ÅäÂæó',
                    txt_save: 'ÁØÄÁ¥ÑÈ°ç'
                },
                'ru': {
                    title: 'üè† –ê—Ä–µ–Ω–¥–∞ –∏–ª–∏ –ü–æ–∫—É–ø–∫–∞',
                    sec_buy: '–ü–æ–∫—É–ø–∫–∞', sec_rent: '–ê—Ä–µ–Ω–¥–∞',
                    lbl_price: '–¶–µ–Ω–∞ –∂–∏–ª—å—è', lbl_rate: '–°—Ç–∞–≤–∫–∞ –∏–ø–æ—Ç–µ–∫–∏ (%)',
                    lbl_down: '–ü–µ—Ä–≤. –≤–∑–Ω–æ—Å (%)', lbl_apprec: '–†–æ—Å—Ç —Ü–µ–Ω—ã (%)',
                    lbl_rent: '–ê—Ä–µ–Ω–¥–∞ (–º–µ—Å)', lbl_r_inc: '–†–æ—Å—Ç –∞—Ä–µ–Ω–¥—ã (%)',
                    lbl_years: '–ü–µ—Ä–∏–æ–¥ (–ª–µ—Ç)',
                    btn_calc: '–°—Ä–∞–≤–Ω–∏—Ç—å',
                    res_verdict: '–í–µ—Ä–¥–∏–∫—Ç', res_buy_cost: '–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø–æ–∫—É–ø–∫—É', res_rent_cost: '–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∞—Ä–µ–Ω–¥—É',
                    txt_buy_better: '–ü–æ–∫—É–ø–∫–∞ –≤—ã–≥–æ–¥–Ω–µ–µ', txt_rent_better: '–ê—Ä–µ–Ω–¥–∞ –≤—ã–≥–æ–¥–Ω–µ–µ',
                    txt_save: '–≠–∫–æ–Ω–æ–º–∏—è'
                },
                'es': {
                    title: 'üè† Comprar vs Alquilar',
                    sec_buy: 'Opci√≥n Compra', sec_rent: 'Opci√≥n Alquiler',
                    lbl_price: 'Precio Casa', lbl_rate: 'Inter√©s (%)',
                    lbl_down: 'Pago Inicial (%)', lbl_apprec: 'Plusval√≠a (%)',
                    lbl_rent: 'Alquiler Mensual', lbl_r_inc: 'Aumento Alquiler (%)',
                    lbl_years: 'Duraci√≥n (A√±os)',
                    btn_calc: 'Comparar',
                    res_verdict: 'Veredicto', res_buy_cost: 'Costo Neto Compra', res_rent_cost: 'Costo Neto Alquiler',
                    txt_buy_better: 'Comprar es mejor', txt_rent_better: 'Alquilar es mejor',
                    txt_save: 'Ahorras'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('rb-lang').value;
                const texts = RentBuy.i18n[lang];
                const elements = document.querySelectorAll('[data-id="rvb_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
                if(!document.getElementById('rb-result-box').classList.contains('hidden')) RentBuy.calc();
            },

            calc: () => {
                const price = parseFloat(document.getElementById('rb-price').value);
                const rate = parseFloat(document.getElementById('rb-rate').value) / 100;
                const downPct = parseFloat(document.getElementById('rb-down').value) / 100;
                const apprec = parseFloat(document.getElementById('rb-apprec').value) / 100;
                
                const rent = parseFloat(document.getElementById('rb-rent').value);
                const rentInc = parseFloat(document.getElementById('rb-r-inc').value) / 100;
                
                const years = parseInt(document.getElementById('rb-years').value);

                if (isNaN(price) || isNaN(rent)) return;

                // --- Rent Calculation ---
                // Cost = Sum of Rent payments over years - (Return on investment of Down Payment)
                // Simplified: Assuming Down Payment is invested at same rate as Mortgage Rate (conservative assumption for opportunity cost)
                // Real calc is complex, let's keep it robust but simple:
                // 1. Total Rent Paid (with increase)
                // 2. Opp Cost: Downpayment * ((1+rate)^n - 1)
                
                const downPayment = price * downPct;
                const loan = price - downPayment;
                const investRate = 0.05; // Assumed 5% return on cash if not buying
                
                let totalRentCost = 0;
                let currentRent = rent;
                for (let i = 0; i < years; i++) {
                    totalRentCost += currentRent * 12;
                    currentRent *= (1 + rentInc);
                }
                
                // Opportunity Cost of Down Payment (Future Value - Principal)
                const oppCost = downPayment * (Math.pow(1 + investRate, years) - 1);
                
                const netRentCost = totalRentCost - oppCost; // Wait, actually OppCost is money you GAINED. So Cost is Rent. 
                // BUT comparisons usually frame it as: Wealth at end. 
                // Let's stick to "Unrecoverable Costs" approach (sunk costs).
                // Rent Sunk Cost = Rent Paid.
                // Buy Sunk Cost = Interest + Tax + Maint + Buying/Selling Costs - Appreciation.
                
                // --- Buy Calculation ---
                // Sunk costs: Interest, Property Tax (approx 1.2%), Maint (1%), Buying Cost (2%), Selling Cost (6%)
                const taxRate = 0.012;
                const maintRate = 0.01;
                const buyCost = price * 0.02; 
                
                // Mortgage P&I
                const r_monthly = rate / 12;
                const n_months = 30 * 12; // Assume 30 year fixed
                let monthlyPMT = 0;
                if (r_monthly > 0) {
                    monthlyPMT = loan * (r_monthly * Math.pow(1 + r_monthly, n_months)) / (Math.pow(1 + r_monthly, n_months) - 1);
                } else {
                    monthlyPMT = loan / n_months;
                }

                let totalInterest = 0;
                let balance = loan;
                let totalTaxMaint = 0;
                
                let currentHomeValue = price;

                for (let i = 0; i < years * 12; i++) {
                    const interest = balance * r_monthly;
                    const principal = monthlyPMT - interest;
                    totalInterest += interest;
                    balance -= principal;
                    
                    // Annual updates
                    if (i % 12 === 0) {
                        totalTaxMaint += currentHomeValue * (taxRate + maintRate);
                        currentHomeValue *= (1 + apprec);
                    }
                }

                const sellCost = currentHomeValue * 0.06;
                const equityGained = (currentHomeValue - balance) - downPayment; // Gain over initial down
                // Buying Net Cost = (Interest + Tax + Maint + Buy/Sell Fees) - (Appreciation Gain)
                // Actually easier: Total Paid - Equity at End.
                // Total Paid = Down + (PMT * months) + Tax + Maint + Buy/Sell Fees.
                // Value at End = Home Value.
                // Net Cost = Total Outflow - Net Proceeds
                // Net Proceeds = Home Value - Remaining Loan
                
                const totalOutflow = downPayment + (monthlyPMT * years * 12) + totalTaxMaint + buyCost + sellCost;
                const netProceeds = currentHomeValue - balance;
                
                const netBuyCost = totalOutflow - netProceeds;
                
                // Re-adjust Rent Cost to include Opp Cost correctly?
                // Rent Net Cost = Rent Paid + (Value of Downpayment invested - Downpayment) ??
                // No, standard comparison:
                // Wealth Rent = (Downpayment * growth) - Rent Paid ... No.
                // Let's stick to the "Cost" view.
                // Rent Cost = Total Rent. (You keep your downpayment + growth separately, so cost is just rent).
                // But to compare apples to apples, we check Net Wealth difference? 
                // Let's simpler: Rent Sunk Cost = Total Rent - (Gain on Investment of Downpayment).
                const investmentGain = downPayment * (Math.pow(1 + investRate, years) - 1);
                const finalRentCost = totalRentCost - investmentGain;

                // Display
                const lang = document.getElementById('rb-lang').value;
                const txt = RentBuy.i18n[lang];
                const fmt = (n) => n.toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 });

                document.getElementById('res-buy-val').innerText = fmt(netBuyCost);
                document.getElementById('res-rent-val').innerText = fmt(finalRentCost);

                const verdictEl = document.getElementById('rb-verdict');
                const saveEl = document.getElementById('rb-save');
                const winBg = document.getElementById('rb-winner-bg');

                if (netBuyCost < finalRentCost) {
                    verdictEl.innerText = txt.txt_buy_better;
                    verdictEl.className = "text-xl font-bold my-1 text-blue-700";
                    saveEl.innerText = `${txt.txt_save} ${fmt(finalRentCost - netBuyCost)}`;
                    winBg.className = "p-4 rounded-lg text-center mb-3 bg-blue-50 border border-blue-200";
                } else {
                    verdictEl.innerText = txt.txt_rent_better;
                    verdictEl.className = "text-xl font-bold my-1 text-orange-700";
                    saveEl.innerText = `${txt.txt_save} ${fmt(netBuyCost - finalRentCost)}`;
                    winBg.className = "p-4 rounded-lg text-center mb-3 bg-orange-50 border border-orange-200";
                }

                document.getElementById('rb-result-box').classList.remove('hidden');
            }
        };
    </script>
</body>
</html>