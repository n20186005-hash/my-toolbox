<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pregnancy Weight Gain Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #fff1f2; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="preg_weight" 
         data-category="health" 
         data-title="Pregnancy Weight Gain Calculator" 
         data-icon="ü§∞">
        
        <div class="absolute top-4 right-4">
            <select id="pw-lang" onchange="PregWeight.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ü§∞ Pregnancy Weight Gain</h2>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_pre_weight">Pre-Pregnancy Weight</label>
                <input type="number" id="pw-weight" class="w-full p-2 border rounded focus:ring-1 focus:ring-pink-500 outline-none" placeholder="60">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_height">Height (cm)</label>
                <input type="number" id="pw-height" class="w-full p-2 border rounded focus:ring-1 focus:ring-pink-500 outline-none" placeholder="165">
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_week">Current Week (0-40)</label>
                <input type="number" id="pw-week" class="w-full p-2 border rounded focus:ring-1 focus:ring-pink-500 outline-none" placeholder="20" max="40">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_type">Pregnancy Type</label>
                <select id="pw-type" class="w-full p-2 border rounded bg-white text-sm">
                    <option value="single" data-i18n="type_single">Single Baby</option>
                    <option value="twins" data-i18n="type_twins">Twins</option>
                </select>
            </div>
        </div>

        <button onclick="PregWeight.calc()" class="w-full bg-pink-500 text-white py-2 rounded font-bold hover:bg-pink-600 transition mb-6" data-i18n="btn_calc">Calculate Range</button>

        <div class="bg-pink-50 p-4 rounded-lg border border-pink-100">
            <div class="mb-4">
                <span class="text-gray-500 text-xs block mb-1" data-i18n="res_total">Recommended Total Gain (Full Term)</span>
                <div id="pw-res-total" class="text-xl font-bold text-pink-800">--</div>
            </div>
            
            <div class="border-t border-pink-200 pt-3">
                <span class="text-gray-500 text-xs block mb-1" data-i18n="res_current">Target Gain at Week <span id="pw-week-display">--</span></span>
                <div id="pw-res-current" class="text-2xl font-bold text-pink-600">--</div>
            </div>
        </div>
    </div>

    <script>
        const PregWeight = {
            i18n: {
                'en': {
                    title: 'ü§∞ Pregnancy Weight Gain',
                    lbl_pre_weight: 'Pre-Pregnancy Weight (kg)',
                    lbl_height: 'Height (cm)',
                    lbl_week: 'Current Week (0-40)',
                    lbl_type: 'Pregnancy Type',
                    type_single: 'Single Baby', type_twins: 'Twins',
                    btn_calc: 'Calculate Range',
                    res_total: 'Recommended Total Gain (Full Term)',
                    res_current: 'Target Gain at Week ',
                    txt_kg: 'kg'
                },
                'zh-CN': {
                    title: 'ü§∞ Â≠ïÊúü‰ΩìÈáçÂ¢ûÈïøËÆ°ÁÆó',
                    lbl_pre_weight: 'Â≠ïÂâç‰ΩìÈáç (kg)',
                    lbl_height: 'Ë∫´È´ò (cm)',
                    lbl_week: 'ÂΩìÂâçÂ≠ïÂë® (0-40)',
                    lbl_type: 'ÊÄÄËÉéÁ±ªÂûã',
                    type_single: 'ÂçïËÉûËÉé', type_twins: 'ÂèåËÉûËÉé',
                    btn_calc: 'ËÆ°ÁÆóËåÉÂõ¥',
                    res_total: 'Âª∫ËÆÆÊÄªÂ¢ûÈáç (Ë∂≥Êúà)',
                    res_current: 'ÂΩìÂâçÂë®Êï∞Âª∫ËÆÆÂ¢ûÈáç ',
                    txt_kg: 'kg'
                },
                'zh-TW': {
                    title: 'ü§∞ Â≠ïÊúüÈ´îÈáçÂ¢ûÈï∑Ë®àÁÆó',
                    lbl_pre_weight: 'Â≠ïÂâçÈ´îÈáç (kg)',
                    lbl_height: 'Ë∫´È´ò (cm)',
                    lbl_week: 'Áï∂ÂâçÂ≠ïÈÄ± (0-40)',
                    lbl_type: 'Êá∑ËÉéÈ°ûÂûã',
                    type_single: 'ÂñÆËÉûËÉé', type_twins: 'ÈõôËÉûËÉé',
                    btn_calc: 'Ë®àÁÆóÁØÑÂúç',
                    res_total: 'Âª∫Ë≠∞Á∏ΩÂ¢ûÈáç (Ë∂≥Êúà)',
                    res_current: 'Áï∂ÂâçÈÄ±Êï∏Âª∫Ë≠∞Â¢ûÈáç ',
                    txt_kg: 'kg'
                },
                'ja': {
                    title: 'ü§∞ Â¶äÂ®†‰∏≠„ÅÆ‰ΩìÈáçÂ¢óÂä†',
                    lbl_pre_weight: 'Â¶äÂ®†Ââç„ÅÆ‰ΩìÈáç (kg)',
                    lbl_height: 'Ë∫´Èï∑ (cm)',
                    lbl_week: 'ÁèæÂú®„ÅÆÈÄ±Êï∞ (0-40)',
                    lbl_type: '„Çø„Ç§„Éó',
                    type_single: 'ÂçòËÉé', type_twins: 'ÂèåÂ≠ê',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã',
                    res_total: 'Êé®Â•®Â¢óÂä†Èáè (ÂÖ®ÊúüÈñì)',
                    res_current: 'ÁèæÂú®„ÅÆÊé®Â•®Â¢óÂä†Èáè (ÈÄ± ',
                    txt_kg: 'kg'
                },
                'ru': {
                    title: 'ü§∞ –ù–∞–±–æ—Ä –≤–µ—Å–∞ –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏',
                    lbl_pre_weight: '–í–µ—Å –¥–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏',
                    lbl_height: '–†–æ—Å—Ç (—Å–º)',
                    lbl_week: '–ù–µ–¥–µ–ª—è (0-40)',
                    lbl_type: '–¢–∏–ø',
                    type_single: '–û–¥–∏–Ω —Ä–µ–±–µ–Ω–æ–∫', type_twins: '–î–≤–æ–π–Ω—è',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                    res_total: '–û–±—â–∞—è –ø—Ä–∏–±–∞–≤–∫–∞ (–≤–µ—Å—å —Å—Ä–æ–∫)',
                    res_current: '–ù–æ—Ä–º–∞ –Ω–∞ –Ω–µ–¥–µ–ª–µ ',
                    txt_kg: '–∫–≥'
                },
                'es': {
                    title: 'ü§∞ Peso en el Embarazo',
                    lbl_pre_weight: 'Peso Pre-embarazo',
                    lbl_height: 'Altura (cm)',
                    lbl_week: 'Semana Actual (0-40)',
                    lbl_type: 'Tipo',
                    type_single: 'Un Beb√©', type_twins: 'Gemelos',
                    btn_calc: 'Calcular',
                    res_total: 'Aumento Total Recomendado',
                    res_current: 'Aumento en Semana ',
                    txt_kg: 'kg'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('pw-lang').value;
                const texts = PregWeight.i18n[lang];
                const elements = document.querySelectorAll('[data-id="preg_weight"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) {
                        if(el.tagName === 'OPTION') el.text = texts[key];
                        else if(key !== 'res_current') el.innerText = texts[key]; // handle dynamic label specially
                    }
                });
                
                // Refresh dynamic label part
                const wk = document.getElementById('pw-week').value || '--';
                const labelContainer = document.querySelector('[data-i18n="res_current"]');
                if (labelContainer) {
                    labelContainer.innerHTML = texts.res_current + `<span id="pw-week-display">${wk}</span>`;
                }

                if(document.getElementById('pw-res-total').innerText !== '--') PregWeight.calc();
            },

            calc: () => {
                const h = parseFloat(document.getElementById('pw-height').value);
                const w = parseFloat(document.getElementById('pw-weight').value);
                const week = parseFloat(document.getElementById('pw-week').value);
                const type = document.getElementById('pw-type').value;

                if (!h || !w || isNaN(week)) return;

                const bmi = w / Math.pow(h/100, 2);
                let minGain, maxGain;

                // IOM Guidelines (approximate kg)
                if (type === 'single') {
                    if (bmi < 18.5) { minGain = 12.5; maxGain = 18; }
                    else if (bmi < 25) { minGain = 11.5; maxGain = 16; }
                    else if (bmi < 30) { minGain = 7; maxGain = 11.5; }
                    else { minGain = 5; maxGain = 9; }
                } else {
                    // Twins
                    if (bmi < 18.5) { minGain = 22; maxGain = 28; } // Not strictly defined by IOM, extrapolated
                    else if (bmi < 25) { minGain = 17; maxGain = 25; }
                    else if (bmi < 30) { minGain = 14; maxGain = 23; }
                    else { minGain = 11; maxGain = 19; }
                }

                // Calculate current week target
                // Logic: 1st trimester (0-12 weeks): 0.5-2kg total gain
                // 2nd/3rd: Linear rate
                let currentMin = 0, currentMax = 0;
                
                if (week <= 12) {
                    // 1st trimester: 0.5 to 2 kg total
                    const progress = week / 12;
                    currentMin = 0.5 * progress;
                    currentMax = 2.0 * progress;
                } else {
                    // 13-40 weeks
                    const weeksRemaining = 40 - 12;
                    const weeksPast = week - 12;
                    
                    // Total gain minus 1st trimester gain
                    const remMin = minGain - 0.5;
                    const remMax = maxGain - 2.0;
                    
                    const rateMin = remMin / weeksRemaining;
                    const rateMax = remMax / weeksRemaining;
                    
                    currentMin = 0.5 + (rateMin * weeksPast);
                    currentMax = 2.0 + (rateMax * weeksPast);
                }

                const lang = document.getElementById('pw-lang').value;
                const unit = PregWeight.i18n[lang].txt_kg;

                document.getElementById('pw-res-total').innerText = `${minGain} - ${maxGain} ${unit}`;
                document.getElementById('pw-res-current').innerText = `${currentMin.toFixed(1)} - ${currentMax.toFixed(1)} ${unit}`;
                document.getElementById('pw-week-display').innerText = week;
            }
        };
    </script>
</body>
</html>