<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Category Meta Tag -->
    <meta name="category" content="finance">
    <meta name="icon" content="ğŸ’°">
    <meta name="description" content="Cash Flow Calculator - Track your monthly income and expenses to understand where your money goes.">
    <title>Cash Flow Pro | ä¸ªäººç°é‡‘æµè®¡ç®—å™¨</title>
    
    <link rel="canonical" href="https://toolboxpro.top/modules/others/cash-flow-pro.html" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chart.js for Visuals -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: { DEFAULT: '#10b981', hover: '#059669' }, /* Emerald for Income */
                        secondary: { DEFAULT: '#f59e0b', hover: '#d97706' }, /* Amber for Expenses */
                        surface: { light: '#ffffff', dark: '#1e293b' },
                        bg: { light: '#f8fafc', dark: '#020617' } 
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)',
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            /* åˆ—è¡¨è¡Œæ ·å¼ */
            .list-row {
                @apply flex items-center gap-3 py-3.5 px-5 border-b border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 transition-colors hover:bg-slate-50 dark:hover:bg-slate-800/50;
            }
            .list-row:last-child {
                @apply border-b-0;
            }

            /* å·¦ä¾§æ ‡ç­¾è¾“å…¥ */
            .label-input {
                @apply flex-grow bg-transparent border-none text-sm font-semibold text-slate-700 dark:text-slate-200 focus:text-slate-900 dark:focus:text-white focus:ring-0 p-0 placeholder-slate-400 transition-colors;
            }

            /* å³ä¾§é‡‘é¢è¾“å…¥å®¹å™¨ */
            .amount-wrapper {
                @apply flex items-center bg-slate-50 dark:bg-slate-800 rounded-lg px-3 py-1.5 border border-transparent transition-all focus-within:bg-white dark:focus-within:bg-black focus-within:shadow-sm;
            }
            
            /* æ”¶å…¥ç‰¹å®šæ ·å¼ */
            .wrapper-income:focus-within {
                @apply border-emerald-500 ring-1 ring-emerald-500/20;
            }
            .text-income { @apply text-emerald-600 dark:text-emerald-400; }

            /* æ”¯å‡ºç‰¹å®šæ ·å¼ */
            .wrapper-expense:focus-within {
                @apply border-amber-500 ring-1 ring-amber-500/20;
            }
            .text-expense { @apply text-amber-600 dark:text-amber-400; }

            /* è¾“å…¥æ¡†æœ¬ä½“ */
            .input-field {
                @apply w-28 sm:w-36 bg-transparent border-none text-right font-mono font-bold text-base outline-none p-0 ml-1 text-slate-800 dark:text-slate-200 placeholder-slate-400;
            }

            /* åˆ é™¤æŒ‰é’® */
            .delete-btn {
                @apply w-8 h-8 flex items-center justify-center rounded-full text-slate-300 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all cursor-pointer flex-shrink-0;
            }

            /* æ·»åŠ æŒ‰é’® */
            .add-btn {
                @apply w-full py-3.5 text-sm font-semibold text-slate-500 hover:text-primary dark:text-slate-400 dark:hover:text-primary hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors flex items-center justify-center gap-2 border-t border-slate-100 dark:border-slate-800;
            }
            
            /* å¿«é€Ÿæ·»åŠ æ ‡ç­¾æ ·å¼ */
            .quick-add-container {
                @apply px-5 py-3 flex flex-wrap gap-2 bg-slate-50/50 dark:bg-slate-800/30 border-t border-slate-100 dark:border-slate-800;
            }
            .chip {
                @apply px-2.5 py-1 rounded-md text-xs font-medium cursor-pointer transition-all border;
            }
            .chip-income {
                @apply bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700 hover:bg-emerald-50 hover:text-emerald-600 hover:border-emerald-200 dark:hover:bg-emerald-900/20 dark:hover:text-emerald-400 dark:hover:border-emerald-800;
            }
            .chip-expense {
                @apply bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700 hover:bg-amber-50 hover:text-amber-600 hover:border-amber-200 dark:hover:bg-amber-900/20 dark:hover:text-amber-400 dark:hover:border-amber-800;
            }
            
            /* æ€»è®¡åŒºåŸŸ */
            .section-footer {
                @apply p-5 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-100 dark:border-slate-800 flex justify-between items-center rounded-b-2xl;
            }
        }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body class="bg-bg-light dark:bg-bg-dark min-h-screen font-sans text-slate-800 dark:text-slate-200 transition-colors duration-300 overflow-x-hidden">

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        
        <!-- Header -->
        <header class="flex flex-col md:flex-row items-center justify-between gap-6 mb-10">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 rounded-xl bg-slate-900 dark:bg-white text-white dark:text-slate-900 flex items-center justify-center text-xl shadow-lg">
                    <i class="fa fa-line-chart"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold tracking-tight text-slate-900 dark:text-white" data-i18n="title">Cash Flow Pro</h1>
                    <p class="text-xs text-slate-500 font-medium tracking-wide uppercase" data-i18n="subtitle">ä¸ªäººç°é‡‘æµè®¡ç®—å™¨</p>
                </div>
            </div>

            <div class="flex items-center gap-3 bg-white dark:bg-slate-800 p-1.5 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm">
                <select id="lang-selector" class="bg-transparent text-xs font-bold px-2 py-1 rounded focus:outline-none cursor-pointer text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700">
                    <option value="zh-CN">CN</option>
                    <option value="en">EN</option>
                </select>
                <div class="w-px h-4 bg-slate-200 dark:bg-slate-600"></div>
                <button id="mode-toggle" class="w-7 h-7 rounded flex items-center justify-center text-slate-400 hover:text-indigo-600 dark:hover:text-yellow-400 transition-all">
                    <i class="fa fa-moon-o dark:hidden"></i>
                    <i class="fa fa-sun-o hidden dark:inline"></i>
                </button>
            </div>
        </header>

        <!-- Main Layout -->
        <div class="grid lg:grid-cols-12 gap-8 items-start mb-12">
            
            <!-- Left Column: Input Lists -->
            <main class="lg:col-span-7 space-y-8">
                
                <!-- Income Section -->
                <div class="bg-white dark:bg-slate-900 rounded-2xl shadow-card border border-slate-200 dark:border-slate-800">
                    <!-- Header -->
                    <div class="px-5 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-emerald-50/50 dark:bg-emerald-900/10 rounded-t-2xl">
                        <div class="flex items-center gap-2 text-emerald-700 dark:text-emerald-400 font-bold text-sm uppercase tracking-wide">
                            <i class="fa fa-plus-circle"></i> <span data-i18n="h_income">æ”¶å…¥ (Income)</span>
                        </div>
                    </div>
                    
                    <!-- List -->
                    <div id="income-list" class="divide-y divide-slate-100 dark:divide-slate-800">
                        <!-- Rows injected here -->
                    </div>

                    <!-- Quick Add Chips -->
                    <div class="quick-add-container">
                        <span class="text-[10px] uppercase font-bold text-slate-400 self-center mr-1" data-i18n="lbl_quick_add">å¿«é€Ÿæ·»åŠ :</span>
                        <div id="income-chips" class="flex flex-wrap gap-2">
                            <!-- Chips injected via JS -->
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <button onclick="App.addRow('income')" class="add-btn hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20">
                        <i class="fa fa-plus text-xs"></i> <span data-i18n="btn_add_income">æ·»åŠ æ”¶å…¥é¡¹ç›®</span>
                    </button>
                    
                    <!-- Footer Total -->
                    <div class="section-footer">
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-wider" data-i18n="subtotal_income">æ€»æ”¶å…¥</span>
                        <span class="font-mono text-xl font-bold text-emerald-600 dark:text-emerald-400" id="display-total-income">Â¥0</span>
                    </div>
                </div>

                <!-- Expenses Section -->
                <div class="bg-white dark:bg-slate-900 rounded-2xl shadow-card border border-slate-200 dark:border-slate-800">
                    <!-- Header -->
                    <div class="px-5 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-amber-50/50 dark:bg-amber-900/10 rounded-t-2xl">
                        <div class="flex items-center gap-2 text-amber-700 dark:text-amber-400 font-bold text-sm uppercase tracking-wide">
                            <i class="fa fa-minus-circle"></i> <span data-i18n="h_expenses">æ”¯å‡º (Expenses)</span>
                        </div>
                    </div>
                    
                    <!-- List -->
                    <div id="expenses-list" class="divide-y divide-slate-100 dark:divide-slate-800">
                        <!-- Rows injected here -->
                    </div>

                    <!-- Quick Add Chips -->
                    <div class="quick-add-container">
                        <span class="text-[10px] uppercase font-bold text-slate-400 self-center mr-1" data-i18n="lbl_quick_add">å¿«é€Ÿæ·»åŠ :</span>
                        <div id="expenses-chips" class="flex flex-wrap gap-2">
                             <!-- Chips injected via JS -->
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <button onclick="App.addRow('expenses')" class="add-btn hover:text-amber-600 hover:bg-amber-50 dark:hover:text-amber-400 dark:hover:bg-amber-900/20">
                        <i class="fa fa-plus text-xs"></i> <span data-i18n="btn_add_expense">æ·»åŠ æ”¯å‡ºé¡¹ç›®</span>
                    </button>

                    <!-- Footer Total -->
                    <div class="section-footer">
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-wider" data-i18n="subtotal_expenses">æ€»æ”¯å‡º</span>
                        <span class="font-mono text-xl font-bold text-amber-600 dark:text-amber-400" id="display-total-expenses">Â¥0</span>
                    </div>
                </div>

            </main>

            <!-- Right Column: Dashboard Sticky -->
            <aside class="lg:col-span-5 lg:sticky lg:top-6 space-y-6">
                
                <!-- Cash Flow Card -->
                <div class="bg-slate-900 dark:bg-black text-white rounded-3xl shadow-xl p-8 relative overflow-hidden flex flex-col items-center text-center">
                    <!-- Glow Effects -->
                    <div class="absolute top-0 left-1/2 -translate-x-1/2 w-64 h-64 bg-emerald-500/10 rounded-full blur-[80px] pointer-events-none"></div>
                    
                    <h2 class="relative z-10 text-slate-400 text-xs font-bold uppercase tracking-[0.2em] mb-4" data-i18n="res_net_cash_flow">å‡€ç°é‡‘æµ (Surplus/Deficit)</h2>
                    
                    <div class="relative z-10 mb-8">
                        <div class="text-5xl sm:text-6xl font-mono font-bold tracking-tighter" id="main-net-cash-flow">Â¥0</div>
                        <div id="cash-flow-status" class="mt-3 inline-block px-4 py-1.5 rounded-full bg-white/10 text-[10px] font-medium backdrop-blur-md border border-white/5 text-slate-300">
                            Ready
                        </div>
                    </div>

                    <!-- Chart & Legend -->
                    <div class="relative z-10 w-full bg-white/5 rounded-2xl p-6 border border-white/5 backdrop-blur-sm">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-2 text-xs">
                                <span class="w-2.5 h-2.5 rounded-full bg-emerald-400"></span>
                                <span class="text-slate-300" data-i18n="h_income">Income</span>
                            </div>
                            <div class="flex items-center gap-2 text-xs">
                                <span class="w-2.5 h-2.5 rounded-full bg-amber-500"></span>
                                <span class="text-slate-300" data-i18n="h_expenses">Expenses</span>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="space-y-2">
                             <div class="flex justify-between text-[10px] font-medium text-slate-400">
                                <span data-i18n="ratio_usage">æ”¯å‡ºå æ¯” (Expense Ratio)</span>
                                <span id="ratio-display" class="text-white font-mono">0%</span>
                            </div>
                            <div class="w-full bg-slate-700/50 rounded-full h-2 overflow-hidden">
                                <div id="ratio-bar" class="bg-amber-500 h-full rounded-full transition-all duration-700" style="width: 0%"></div>
                            </div>
                        </div>

                         <div class="h-32 w-full mt-6 flex justify-center">
                             <canvas id="cashFlowChart"></canvas>
                        </div>
                    </div>
                </div>

            </aside>
        </div>

        <!-- Expanded Guide Section -->
        <section class="mb-12">
            <div class="bg-white dark:bg-slate-900 rounded-3xl p-8 shadow-card border border-slate-200 dark:border-slate-800">
                
                <div class="grid md:grid-cols-2 gap-10">
                    <!-- Left: Core Concept -->
                    <div class="space-y-4">
                        <h3 class="flex items-center gap-3 text-lg font-bold text-slate-900 dark:text-white">
                            <div class="w-10 h-10 rounded-xl bg-blue-50 dark:bg-blue-900/20 text-blue-600 flex items-center justify-center">
                                <i class="fa fa-book"></i>
                            </div>
                            <span data-i18n="intro_title">ä¸ªäººç°é‡‘æµè®¡ç®—å™¨</span>
                        </h3>
                        <div class="prose prose-slate dark:prose-invert text-sm text-slate-600 dark:text-slate-400 leading-relaxed">
                            <p data-i18n="intro_text_main">
                                æœ‰æ—¶å€™éš¾å…ä¼šæƒ³ï¼Œé’±éƒ½èŠ±å“ªå„¿å»äº†ï¼Ÿä¸ºäº†æ›´å¥½åœ°äº†è§£æ‚¨æ¯æœˆæˆ–æ¯å¹´çš„æ”¯å‡ºæ˜ç»†ï¼Œè¯·è¾“å…¥ä»¥ä¸‹ç±»åˆ«çš„ä¿¡æ¯ã€‚å»ºè®®å‡†å¤‡å¥½æ‚¨çš„é“¶è¡Œè´¦æˆ·ã€ä¿¡ç”¨å¡ã€è´·æ¬¾å’Œå…¶ä»–å¯¹è´¦å•ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°å¡«å†™æ‚¨çš„æ”¶å…¥å’Œæ”¯å‡ºã€‚
                            </p>
                        </div>
                    </div>

                    <!-- Right: Optimization Tips -->
                    <div class="space-y-6">
                        <h3 class="flex items-center gap-3 text-lg font-bold text-slate-900 dark:text-white">
                            <div class="w-10 h-10 rounded-xl bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 flex items-center justify-center">
                                <i class="fa fa-lightbulb-o"></i>
                            </div>
                            <span data-i18n="intro_tips_title">ç†è´¢å»ºè®®</span>
                        </h3>
                        
                        <div class="grid sm:grid-cols-2 gap-4">
                            <!-- Tip 1 -->
                            <div class="p-4 rounded-xl bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-700 hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10 transition-colors group">
                                <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2 text-xs uppercase tracking-wide group-hover:text-emerald-600 transition-colors" data-i18n="tip_h_income">å¢åŠ æ”¶å…¥</h4>
                                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed" data-i18n="tip_p_income">
                                    å…³æ³¨é•¿æœŸèŒä¸šå‘å±•ï¼Œå‘å±•å‰¯ä¸šæˆ–è¢«åŠ¨æ”¶å…¥ï¼ˆå¦‚è‚¡æ¯ã€ç§Ÿé‡‘ï¼‰ï¼Œæå‡æ€»ç°é‡‘æµå…¥ã€‚
                                </p>
                            </div>

                            <!-- Tip 2 -->
                            <div class="p-4 rounded-xl bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-700 hover:bg-amber-50/50 dark:hover:bg-amber-900/10 transition-colors group">
                                <h4 class="font-bold text-slate-800 dark:text-slate-200 mb-2 text-xs uppercase tracking-wide group-hover:text-amber-600 transition-colors" data-i18n="tip_h_expenses">ä¼˜åŒ–æ”¯å‡º</h4>
                                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed" data-i18n="tip_p_expenses">
                                    åŒºåˆ†â€œéœ€è¦â€ä¸â€œæƒ³è¦â€ã€‚å®šæœŸå®¡æŸ¥è®¢é˜…æœåŠ¡å’Œå†²åŠ¨æ¶ˆè´¹ï¼Œä¿æŒæ­£å‘ç°é‡‘æµã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- Footer -->
        <footer class="border-t border-slate-200 dark:border-slate-800 pt-8 pb-12 text-center">
             <div class="max-w-4xl mx-auto space-y-4">
                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed" data-i18n="footer_disclaimer_1">
                    è¿™äº›ç»“æœå–å†³äºæ‚¨è¾“å…¥ä¿¡æ¯çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚è¿™äº›ç»“æœå¹¶éè´¢åŠ¡è®¡åˆ’ã€‚
                </p>
                <p class="text-[10px] text-slate-400 dark:text-slate-600 leading-relaxed max-w-3xl mx-auto opacity-80" data-i18n="footer_disclaimer_2">
                    æœ¬æ–‡æ‰€å«ä¿¡æ¯ä»…ä¾›å‚è€ƒã€‚ä¿¡æ¯å‡ºè‡ªæˆ‘ä»¬è®¤ä¸ºå¯é çš„æ¥æºã€‚æœ¬ä¿¡æ¯ä¸æä¾›è´¢åŠ¡ã€æ³•å¾‹ã€ç¨åŠ¡æˆ–æŠ•èµ„æ–¹é¢çš„è§„åˆ’æˆ–å»ºè®®ã€‚å…·ä½“çš„æŠ•èµ„ã€äº¤æ˜“æˆ–ç¨åŠ¡ç­–ç•¥åº”æ ¹æ®æ¯ä½æŠ•èµ„è€…çš„ç›®æ ‡å’Œé£é™©æ‰¿å—èƒ½åŠ›åŠ ä»¥è¯„ä¼°ã€‚
                </p>
                <p class="text-[10px] text-slate-400 dark:text-slate-600 leading-relaxed max-w-3xl mx-auto opacity-80" data-i18n="footer_disclaimer_3">
                    å¯¹äºæ‚¨æˆ–ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›ç»™æˆ‘ä»¬çš„ä¿¡æ¯çš„å‡†ç¡®æ€§ã€å¯¹äºå› æ‚¨æˆ–ä»»ä½•ç¬¬ä¸‰æ–¹ä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„ä¿¡æ¯æ‰€å¯¼è‡´çš„ä»»ä½•åæœï¼Œä»¥åŠå¯¹äºä»»ä½•äººä»¥ä»»ä½•æ–¹å¼ä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„ä¿¡æ¯è€Œäº§ç”Ÿçš„ä»»ä½•åŸå› çš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±ï¼Œé“æ˜æŠ•èµ„æœåŠ¡æœ‰é™å…¬å¸ã€é“æ˜é“¶è¡ŒåŠå…¶é™„å±å…¬å¸å’Œç›¸å…³å®ä½“å‡ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
                </p>
             </div>
        </footer>

    </div>

    <script>
        const i18nData = {
            'zh-CN': {
                title: "Cash Flow Pro", subtitle: "ä¸ªäººç°é‡‘æµè®¡ç®—å™¨",
                h_income: "æ”¶å…¥ (Income)", h_expenses: "æ”¯å‡º (Expenses)",
                btn_add_income: "æ·»åŠ æ”¶å…¥é¡¹ç›®", btn_add_expense: "æ·»åŠ æ”¯å‡ºé¡¹ç›®",
                subtotal_income: "æ€»æ”¶å…¥", subtotal_expenses: "æ€»æ”¯å‡º",
                res_net_cash_flow: "å‡€ç°é‡‘æµ (Net Cash Flow)", 
                ratio_usage: "æ”¯å‡ºå æ¯” (Expense Ratio)",
                lbl_quick_add: "å¿«é€Ÿæ·»åŠ :",
                
                // New Guide Section
                intro_title: "ä¸ªäººç°é‡‘æµè®¡ç®—å™¨",
                intro_text_main: "æœ‰æ—¶å€™éš¾å…ä¼šæƒ³ï¼Œé’±éƒ½èŠ±å“ªå„¿å»äº†ï¼Ÿä¸ºäº†æ›´å¥½åœ°äº†è§£æ‚¨æ¯æœˆæˆ–æ¯å¹´çš„æ”¯å‡ºæ˜ç»†ï¼Œè¯·è¾“å…¥ä»¥ä¸‹ç±»åˆ«çš„ä¿¡æ¯ã€‚å»ºè®®å‡†å¤‡å¥½æ‚¨çš„é“¶è¡Œè´¦æˆ·ã€ä¿¡ç”¨å¡ã€è´·æ¬¾å’Œå…¶ä»–å¯¹è´¦å•ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°å¡«å†™æ‚¨çš„æ”¶å…¥å’Œæ”¯å‡ºã€‚",
                intro_tips_title: "ç†è´¢å»ºè®®",
                tip_h_income: "å¢åŠ æ”¶å…¥",
                tip_p_income: "å…³æ³¨é•¿æœŸèŒä¸šå‘å±•ï¼Œå‘å±•å‰¯ä¸šæˆ–è¢«åŠ¨æ”¶å…¥ï¼ˆå¦‚è‚¡æ¯ã€ç§Ÿé‡‘ï¼‰ï¼Œæå‡æ€»ç°é‡‘æµå…¥ã€‚",
                tip_h_expenses: "ä¼˜åŒ–æ”¯å‡º",
                tip_p_expenses: "åŒºåˆ†â€œéœ€è¦â€ä¸â€œæƒ³è¦â€ã€‚å®šæœŸå®¡æŸ¥è®¢é˜…æœåŠ¡å’Œå†²åŠ¨æ¶ˆè´¹ï¼Œä¿æŒæ­£å‘ç°é‡‘æµï¼Œå¢åŠ å‚¨è“„ç‡ã€‚",

                // Footer
                footer_disclaimer_1: "è¿™äº›ç»“æœå–å†³äºæ‚¨è¾“å…¥ä¿¡æ¯çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚è¿™äº›ç»“æœå¹¶éè´¢åŠ¡è®¡åˆ’ã€‚",
                footer_disclaimer_2: "æœ¬æ–‡æ‰€å«ä¿¡æ¯ä»…ä¾›å‚è€ƒã€‚ä¿¡æ¯å‡ºè‡ªæˆ‘ä»¬è®¤ä¸ºå¯é çš„æ¥æºã€‚æœ¬ä¿¡æ¯ä¸æä¾›è´¢åŠ¡ã€æ³•å¾‹ã€ç¨åŠ¡æˆ–æŠ•èµ„æ–¹é¢çš„è§„åˆ’æˆ–å»ºè®®ã€‚å…·ä½“çš„æŠ•èµ„ã€äº¤æ˜“æˆ–ç¨åŠ¡ç­–ç•¥åº”æ ¹æ®æ¯ä½æŠ•èµ„è€…çš„ç›®æ ‡å’Œé£é™©æ‰¿å—èƒ½åŠ›åŠ ä»¥è¯„ä¼°ã€‚",
                footer_disclaimer_3: "å¯¹äºæ‚¨æˆ–ä»»ä½•ç¬¬ä¸‰æ–¹æä¾›ç»™æˆ‘ä»¬çš„ä¿¡æ¯çš„å‡†ç¡®æ€§ã€å¯¹äºå› æ‚¨æˆ–ä»»ä½•ç¬¬ä¸‰æ–¹ä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„ä¿¡æ¯æ‰€å¯¼è‡´çš„ä»»ä½•åæœï¼Œä»¥åŠå¯¹äºä»»ä½•äººä»¥ä»»ä½•æ–¹å¼ä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„ä¿¡æ¯è€Œäº§ç”Ÿçš„ä»»ä½•åŸå› çš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±ï¼Œé“æ˜æŠ•èµ„æœåŠ¡æœ‰é™å…¬å¸ã€é“æ˜é“¶è¡ŒåŠå…¶é™„å±å…¬å¸å’Œç›¸å…³å®ä½“å‡ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚",

                // Defaults & Chips
                def_income_total: "å®¶åº­å‡€æ”¶å…¥æ€»é¢",
                def_housing: "ä½æˆ¿", def_living: "ä¸ªäººä¸ç”Ÿæ´»", def_transport: "æ±½è½¦ä¸äº¤é€š", def_debt: "å€ºåŠ¡å¿è¿˜", def_savings: "å‚¨è“„", def_other: "å…¶ä»–",
                
                chip_salary: "å·¥èµ„/è–ªæ°´", chip_bonus: "å¥–é‡‘", chip_invest_inc: "æŠ•èµ„æ”¶ç›Š", chip_rent_inc: "ç§Ÿé‡‘æ”¶å…¥", chip_side: "å‰¯ä¸šæ”¶å…¥",
                chip_rent: "æˆ¿ç§Ÿ/æˆ¿è´·", chip_food: "é¤é¥®/è¶…å¸‚", chip_util: "æ°´ç”µç½‘è´¹", chip_insur: "ä¿é™©", chip_entertain: "å¨±ä¹", chip_med: "åŒ»ç–—", chip_edu: "æ•™è‚²"
            },
            'en': {
                title: "Cash Flow Pro", subtitle: "Personal Cash Flow Calculator",
                h_income: "Income", h_expenses: "Expenses",
                btn_add_income: "Add Income Item", btn_add_expense: "Add Expense Item",
                subtotal_income: "Total Income", subtotal_expenses: "Total Expenses",
                res_net_cash_flow: "Net Cash Flow", 
                ratio_usage: "Expense Ratio",
                lbl_quick_add: "Quick Add:",
                
                // New Guide Section
                intro_title: "Personal Cash Flow Calculator",
                intro_text_main: "Sometimes you wonder, where did the money go? To better understand your monthly or annual spending, please enter information for the following categories. It is recommended to have your bank accounts, credit cards, loans, and other statements ready to easily fill in your income and expenses.",
                intro_tips_title: "Financial Tips",
                tip_h_income: "Grow Income",
                tip_p_income: "Focus on career growth, side hustles, or passive income (dividends, rent) to increase total inflow.",
                tip_h_expenses: "Optimize Spending",
                tip_p_expenses: "Distinguish 'needs' vs 'wants'. Review subscriptions and impulse buys regularly to maintain positive cash flow.",

                // Footer
                footer_disclaimer_1: "These results depend on the accuracy and completeness of the information you entered. These results are not a financial plan.",
                footer_disclaimer_2: "The information contained herein is for informational purposes only. The information is derived from sources believed to be reliable. This information does not constitute financial, legal, tax or investment planning or advice. Specific investment, trading or tax strategies should be evaluated based on each investor's objectives and risk tolerance.",
                footer_disclaimer_3: "TD Investment Services Inc., TD Bank and its affiliates and related entities do not assume any liability for the accuracy of the information provided to us by you or any third party, for any consequences arising from your or any third party's use of the information in this document, or for any direct or indirect loss arising from any use of the information in this document by anyone in any manner.",

                // Defaults & Chips
                def_income_total: "Family Net Income",
                def_housing: "Housing", def_living: "Personal & Living", def_transport: "Auto & Transport", def_debt: "Debt Repayment", def_savings: "Savings", def_other: "Other",

                chip_salary: "Salary", chip_bonus: "Bonus", chip_invest_inc: "Investment Income", chip_rent_inc: "Rental Income", chip_side: "Side Hustle",
                chip_rent: "Rent/Mortgage", chip_food: "Groceries/Dining", chip_util: "Utilities", chip_insur: "Insurance", chip_entertain: "Entertainment", chip_med: "Medical", chip_edu: "Education"
            }
        };

        const Calculator = {
            chart: null,
            calculate() {
                const income = this.sumInputs('income');
                const expenses = this.sumInputs('expenses');
                const netCashFlow = income - expenses;

                this.updateText('display-total-income', income);
                this.updateText('display-total-expenses', expenses);
                
                const nwEl = document.getElementById('main-net-cash-flow');
                nwEl.textContent = this.format(netCashFlow);
                
                // Color Logic for Net Cash Flow
                if (netCashFlow > 0) nwEl.className = "text-5xl sm:text-6xl font-mono font-bold tracking-tighter text-emerald-400";
                else if (netCashFlow < 0) nwEl.className = "text-5xl sm:text-6xl font-mono font-bold tracking-tighter text-red-400";
                else nwEl.className = "text-5xl sm:text-6xl font-mono font-bold tracking-tighter text-white";

                const ratio = income > 0 ? (expenses / income) * 100 : (expenses > 0 ? 100 : 0);
                document.getElementById('ratio-display').textContent = ratio.toFixed(1) + '%';
                
                const bar = document.getElementById('ratio-bar');
                bar.style.width = Math.min(ratio, 100) + '%';
                
                // Bar Color Logic
                let barClass = "h-full rounded-full transition-all duration-700 ";
                if(ratio < 50) barClass += "bg-emerald-500";
                else if(ratio < 80) barClass += "bg-amber-400";
                else barClass += "bg-red-500";
                bar.className = barClass;

                let status = "Balanced";
                if(netCashFlow < 0) status = "Deficit (Shortfall)";
                else if(netCashFlow > 0) status = "Surplus (Positive)";
                document.getElementById('cash-flow-status').textContent = status;

                this.updateChart(income, expenses);
            },
            sumInputs(id) {
                let sum = 0;
                document.querySelectorAll(`#${id}-list .input-field`).forEach(el => sum += parseFloat(el.value) || 0);
                return sum;
            },
            format(val) {
                return App.symbol + val.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
            },
            updateText(id, val) {
                document.getElementById(id).textContent = this.format(val);
            },
            updateChart(income, expenses) {
                const ctx = document.getElementById('cashFlowChart').getContext('2d');
                if (this.chart) {
                    this.chart.data.datasets[0].data = [income, expenses];
                    this.chart.update();
                } else {
                    this.chart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Income', 'Expenses'],
                            datasets: [{
                                data: [income, expenses],
                                backgroundColor: ['#34d399', '#fbbf24'], // Emerald-400, Amber-400
                                borderWidth: 0,
                                hoverOffset: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '85%',
                            plugins: { legend: { display: false }, tooltip: { enabled: false } }
                        }
                    });
                }
            }
        };

        const App = {
            lang: 'zh-CN',
            symbol: 'Â¥',
            
            // Chip Definitions
            incomeChips: ['chip_salary', 'chip_bonus', 'chip_invest_inc', 'chip_rent_inc', 'chip_side'],
            expenseChips: ['chip_rent', 'chip_food', 'chip_util', 'chip_insur', 'chip_entertain', 'chip_med', 'chip_edu'],

            init() {
                const params = new URLSearchParams(window.location.search);
                this.lang = params.get('lang') || 'zh-CN';
                document.getElementById('lang-selector').value = this.lang;
                this.updateSymbol();

                // Defaults based on Prompt
                this.renderRow('income', 'def_income_total', 15000);
                
                this.renderRow('expenses', 'def_housing', 4000);
                this.renderRow('expenses', 'def_living', 2500);
                this.renderRow('expenses', 'def_transport', 1000);
                this.renderRow('expenses', 'def_debt', 1500);
                this.renderRow('expenses', 'def_savings', 3000);
                this.renderRow('expenses', 'def_other', 500);
                
                document.getElementById('lang-selector').addEventListener('change', e => {
                    this.lang = e.target.value;
                    this.updateSymbol();
                    this.translate();
                    this.translateRows(); 
                    this.renderChips();
                    this.updateUrl();
                    Calculator.calculate();
                });
                
                document.getElementById('mode-toggle').addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                });

                this.translate();
                this.renderChips();
                Calculator.calculate();
            },
            
            updateSymbol() {
                this.symbol = this.lang === 'zh-CN' ? 'Â¥' : '$';
            },

            updateUrl() {
                try {
                    const newUrl = new URL(window.location);
                    newUrl.searchParams.set('lang', this.lang);
                    window.history.pushState({}, '', newUrl);
                } catch (e) {
                    console.warn('URL update skipped due to environment restrictions.');
                }
            },

            renderRow(type, labelKey, val) {
                const container = document.getElementById(type + '-list');
                const div = document.createElement('div');
                div.className = 'list-row group';
                
                const texts = i18nData[this.lang] || i18nData['en'];
                const label = texts[labelKey] || labelKey || 'Item';
                const wrapClass = type === 'income' ? 'wrapper-income text-income' : 'wrapper-expense text-expense';
                
                // Add key for translation if available
                const isKnownKey = (labelKey.startsWith('def_') || labelKey.startsWith('chip_'));
                const dataKeyAttr = isKnownKey ? `data-key="${labelKey}"` : '';

                div.innerHTML = `
                    <input type="text" class="label-input" value="${label}" placeholder="Item Name" ${dataKeyAttr}>
                    <div class="amount-wrapper ${wrapClass}">
                        <span class="text-xs font-bold opacity-50 font-mono">${this.symbol}</span>
                        <input type="number" class="input-field" value="${val}" oninput="Calculator.calculate()" placeholder="0">
                    </div>
                    <div class="delete-btn" onclick="this.parentElement.remove(); Calculator.calculate();">
                        <i class="fa fa-times text-xs"></i>
                    </div>
                `;
                container.appendChild(div);
                return div;
            },
            
            renderChips() {
                this.renderChipSet('income', this.incomeChips, 'chip-income');
                this.renderChipSet('expenses', this.expenseChips, 'chip-expense');
            },
            
            renderChipSet(type, keys, cssClass) {
                const container = document.getElementById(type + '-chips');
                container.innerHTML = '';
                const texts = i18nData[this.lang] || i18nData['en'];
                
                keys.forEach(key => {
                    const label = texts[key] || key;
                    const span = document.createElement('span');
                    span.className = `chip ${cssClass}`;
                    span.textContent = `+ ${label}`;
                    span.onclick = () => {
                        this.renderRow(type, key, 0); 
                        Calculator.calculate();
                    };
                    container.appendChild(span);
                });
            },

            addRow(type) {
                this.renderRow(type, type === 'income' ? 'New Income' : 'New Expense', 0);
                Calculator.calculate();
            },

            translate() {
                const t = i18nData[this.lang] || i18nData['en'];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(t[key]) el.innerHTML = t[key];
                });
            },

            translateRows() {
                const t = i18nData[this.lang] || i18nData['en'];
                document.querySelectorAll('.label-input[data-key]').forEach(input => {
                    const key = input.getAttribute('data-key');
                    if(t[key]) {
                        input.value = t[key];
                    }
                });
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
     <!--  ç»“å°¾å¿…é¡»åŒ…å«çš„ä»£ç  -->
    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
</body>
</html>