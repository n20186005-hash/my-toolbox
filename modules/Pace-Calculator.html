<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pace Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0fdfa; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="pace_calc" 
         data-category="health" 
         data-title="Pace Calculator" 
         data-icon="⏱️">
        
        <div class="absolute top-4 right-4">
            <select id="pc-lang" onchange="PaceCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">簡體中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
                <option value="es">Español</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">⏱️ Pace Calculator</h2>

        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="calc_target">Calculate</label>
            <div class="flex gap-2">
                <button class="flex-1 py-1 text-sm rounded bg-teal-600 text-white font-medium target-btn" data-val="pace" onclick="PaceCalc.setTarget('pace')" data-i18n="btn_pace">Pace</button>
                <button class="flex-1 py-1 text-sm rounded bg-gray-200 text-gray-700 hover:bg-gray-300 target-btn" data-val="time" onclick="PaceCalc.setTarget('time')" data-i18n="btn_time">Time</button>
                <button class="flex-1 py-1 text-sm rounded bg-gray-200 text-gray-700 hover:bg-gray-300 target-btn" data-val="dist" onclick="PaceCalc.setTarget('dist')" data-i18n="btn_dist">Distance</button>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-4 mb-4">
            <!-- Time Input -->
            <div id="box-time">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_time">Time (h:m:s)</label>
                <div class="flex gap-2">
                    <input type="number" id="pc-h" class="w-1/3 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="Hrs">
                    <input type="number" id="pc-m" class="w-1/3 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="Mins">
                    <input type="number" id="pc-s" class="w-1/3 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="Secs">
                </div>
            </div>

            <!-- Distance Input -->
            <div id="box-dist">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_dist">Distance</label>
                <div class="flex gap-2">
                    <input type="number" id="pc-dist" class="w-2/3 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="10">
                    <select id="pc-dist-unit" class="w-1/3 p-2 border rounded focus:ring-2 focus:ring-teal-500 bg-white">
                        <option value="km" data-i18n="u_km">km</option>
                        <option value="mi" data-i18n="u_mi">miles</option>
                        <option value="m" data-i18n="u_m">meters</option>
                    </select>
                </div>
            </div>

            <!-- Pace Input -->
            <div id="box-pace" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_pace">Pace (h:m:s)</label>
                <div class="flex gap-2">
                    <input type="number" id="pc-pace-h" class="w-1/4 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="00">
                    <input type="number" id="pc-pace-m" class="w-1/4 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="05">
                    <input type="number" id="pc-pace-s" class="w-1/4 p-2 border rounded focus:ring-2 focus:ring-teal-500 outline-none" placeholder="30">
                    <select id="pc-pace-unit" class="w-1/4 text-xs p-1 border rounded bg-white">
                        <option value="km" data-i18n="per_km">/km</option>
                        <option value="mi" data-i18n="per_mi">/mi</option>
                    </select>
                </div>
            </div>
        </div>

        <button onclick="PaceCalc.calc()" class="w-full bg-teal-600 text-white py-2 rounded font-bold hover:bg-teal-700 transition mb-6" data-i18n="btn_calculate">Calculate</button>

        <div class="bg-teal-50 p-4 rounded-lg border border-teal-100 text-center">
            <span class="text-gray-600 text-sm" data-i18n="res_result">Result</span>
            <div id="pc-result-val" class="text-3xl font-bold text-teal-700 my-1">--</div>
            <div id="pc-result-sub" class="text-sm text-teal-600"></div>
        </div>
    </div>

    <script>
        const PaceCalc = {
            target: 'pace', // pace, time, dist
            i18n: {
                'en': {
                    title: '⏱️ Pace Calculator',
                    calc_target: 'Calculate For:',
                    btn_pace: 'Pace',
                    btn_time: 'Time',
                    btn_dist: 'Distance',
                    lbl_time: 'Time (h:m:s)',
                    lbl_dist: 'Distance',
                    lbl_pace: 'Pace (per km/mi)',
                    u_km: 'km',
                    u_mi: 'miles',
                    u_m: 'meters',
                    per_km: '/ km',
                    per_mi: '/ mile',
                    btn_calculate: 'Calculate',
                    res_result: 'Result'
                },
                'zh-CN': {
                    title: '⏱️ 配速计算器',
                    calc_target: '计算目标：',
                    btn_pace: '配速',
                    btn_time: '时间',
                    btn_dist: '距离',
                    lbl_time: '时间 (时:分:秒)',
                    lbl_dist: '距离',
                    lbl_pace: '配速 (每公里/英里)',
                    u_km: '公里',
                    u_mi: '英里',
                    u_m: '米',
                    per_km: '/ 公里',
                    per_mi: '/ 英里',
                    btn_calculate: '计算',
                    res_result: '计算结果'
                },
                'zh-TW': {
                    title: '⏱️ 配速計算器',
                    calc_target: '計算目標：',
                    btn_pace: '配速',
                    btn_time: '時間',
                    btn_dist: '距離',
                    lbl_time: '時間 (時:分:秒)',
                    lbl_dist: '距離',
                    lbl_pace: '配速 (每公里/英里)',
                    u_km: '公里',
                    u_mi: '英里',
                    u_m: '公尺',
                    per_km: '/ 公里',
                    per_mi: '/ 英里',
                    btn_calculate: '計算',
                    res_result: '計算結果'
                },
                'ja': {
                    title: '⏱️ ペース計算機',
                    calc_target: '計算対象:',
                    btn_pace: 'ペース',
                    btn_time: '時間',
                    btn_dist: '距離',
                    lbl_time: '時間 (時:分:秒)',
                    lbl_dist: '距離',
                    lbl_pace: 'ペース (/km, /mi)',
                    u_km: 'km',
                    u_mi: 'マイル',
                    u_m: 'メートル',
                    per_km: '/ km',
                    per_mi: '/ マイル',
                    btn_calculate: '計算する',
                    res_result: '結果'
                },
                'ru': {
                    title: '⏱️ Калькулятор темпа',
                    calc_target: 'Рассчитать:',
                    btn_pace: 'Темп',
                    btn_time: 'Время',
                    btn_dist: 'Дистанция',
                    lbl_time: 'Время (ч:м:с)',
                    lbl_dist: 'Дистанция',
                    lbl_pace: 'Темп (мин/км)',
                    u_km: 'км',
                    u_mi: 'мили',
                    u_m: 'метры',
                    per_km: '/ км',
                    per_mi: '/ милю',
                    btn_calculate: 'Рассчитать',
                    res_result: 'Результат'
                },
                'es': {
                    title: '⏱️ Calculadora de Ritmo',
                    calc_target: 'Calcular:',
                    btn_pace: 'Ritmo',
                    btn_time: 'Tiempo',
                    btn_dist: 'Distancia',
                    lbl_time: 'Tiempo (h:m:s)',
                    lbl_dist: 'Distancia',
                    lbl_pace: 'Ritmo',
                    u_km: 'km',
                    u_mi: 'millas',
                    u_m: 'metros',
                    per_km: '/ km',
                    per_mi: '/ milla',
                    btn_calculate: 'Calcular',
                    res_result: 'Resultado'
                }
            },

            setTarget: (t) => {
                PaceCalc.target = t;
                const btns = document.querySelectorAll('.target-btn');
                btns.forEach(b => {
                    if (b.dataset.val === t) {
                        b.className = "flex-1 py-1 text-sm rounded bg-teal-600 text-white font-medium target-btn";
                    } else {
                        b.className = "flex-1 py-1 text-sm rounded bg-gray-200 text-gray-700 hover:bg-gray-300 target-btn";
                    }
                });

                const boxTime = document.getElementById('box-time');
                const boxDist = document.getElementById('box-dist');
                const boxPace = document.getElementById('box-pace');

                if (t === 'pace') {
                    boxTime.classList.remove('hidden');
                    boxDist.classList.remove('hidden');
                    boxPace.classList.add('hidden');
                } else if (t === 'time') {
                    boxTime.classList.add('hidden');
                    boxDist.classList.remove('hidden');
                    boxPace.classList.remove('hidden');
                } else {
                    boxTime.classList.remove('hidden');
                    boxDist.classList.add('hidden');
                    boxPace.classList.remove('hidden');
                }
                
                document.getElementById('pc-result-val').innerText = '--';
                document.getElementById('pc-result-sub').innerText = '';
            },

            changeLang: () => {
                const lang = document.getElementById('pc-lang').value;
                const texts = PaceCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="pace_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
                
                // Update Selects
                const opts = document.querySelectorAll('#pc-dist-unit option, #pc-pace-unit option');
                opts.forEach(op => {
                    const key = op.getAttribute('data-i18n');
                    if(texts[key]) op.text = texts[key];
                });
            },

            formatTime: (totalSecs) => {
                const h = Math.floor(totalSecs / 3600);
                const m = Math.floor((totalSecs % 3600) / 60);
                const s = Math.floor(totalSecs % 60);
                const pad = (n) => n < 10 ? '0'+n : n;
                if (h > 0) return `${h}:${pad(m)}:${pad(s)}`;
                return `${m}:${pad(s)}`;
            },

            calc: () => {
                const t = PaceCalc.target;
                
                // Get Time
                const th = parseFloat(document.getElementById('pc-h').value) || 0;
                const tm = parseFloat(document.getElementById('pc-m').value) || 0;
                const ts = parseFloat(document.getElementById('pc-s').value) || 0;
                const totalTimeSec = (th * 3600) + (tm * 60) + ts;

                // Get Distance
                let dist = parseFloat(document.getElementById('pc-dist').value) || 0;
                const distUnit = document.getElementById('pc-dist-unit').value;
                // Normalize dist to km
                let distKm = dist;
                if (distUnit === 'mi') distKm = dist * 1.60934;
                if (distUnit === 'm') distKm = dist / 1000;

                // Get Pace
                const ph = parseFloat(document.getElementById('pc-pace-h').value) || 0;
                const pm = parseFloat(document.getElementById('pc-pace-m').value) || 0;
                const ps = parseFloat(document.getElementById('pc-pace-s').value) || 0;
                const paceUnit = document.getElementById('pc-pace-unit').value;
                // Normalize pace to sec/km
                let paceSecKm = (ph * 3600) + (pm * 60) + ps;
                if (paceUnit === 'mi') paceSecKm = paceSecKm / 1.60934; // convert sec/mi to sec/km

                let result = "";
                let subResult = "";

                if (t === 'pace') {
                    if (totalTimeSec === 0 || distKm === 0) return;
                    const pSecKm = totalTimeSec / distKm;
                    const pSecMi = pSecKm * 1.60934;
                    result = PaceCalc.formatTime(pSecKm) + " /km";
                    subResult = PaceCalc.formatTime(pSecMi) + " /mi";

                } else if (t === 'time') {
                    if (distKm === 0 || paceSecKm === 0) return;
                    const tSec = distKm * paceSecKm;
                    result = PaceCalc.formatTime(tSec);
                    
                } else if (t === 'dist') {
                    if (totalTimeSec === 0 || paceSecKm === 0) return;
                    const dKm = totalTimeSec / paceSecKm;
                    const dMi = dKm / 1.60934;
                    result = dKm.toFixed(2) + " km";
                    subResult = dMi.toFixed(2) + " miles";
                }

                document.getElementById('pc-result-val').innerText = result;
                document.getElementById('pc-result-sub').innerText = subResult;
            }
        };
    </script>
</body>
</html>