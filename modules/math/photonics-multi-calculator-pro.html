<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photonics Multi-Calculator Pro | All-in-One Optical Tool</title>
    
    <link rel="canonical" href="https://toolboxpro.top/modules/math/photonics-multi-calculator-pro.html" />
    
    <!-- æ ‡ç­¾ä¸å…ƒæ•°æ® -->
    <meta name="category" content="math">
    <meta name="icon" content="ğŸ”¦">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    colors: {
                        laser: { 50: '#f0f9ff', 100: '#e0f2fe', 500: '#0ea5e9', 600: '#0284c7', 900: '#0c4a6e' },
                        optics: { glass: 'rgba(255, 255, 255, 0.7)' }
                    },
                    boxShadow: {
                        'glow': '0 0 15px rgba(14, 165, 233, 0.3)',
                        'card': '0 10px 30px -5px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; background-image: radial-gradient(#e2e8f0 1px, transparent 1px); background-size: 24px 24px; }
        .dark body { background-color: #0f172a; background-image: radial-gradient(#1e293b 1px, transparent 1px); }
        
        /* Card UI Improvements */
        .card { 
            backdrop-filter: blur(12px); 
            border-radius: 16px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(255,255,255,0.6);
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .card:hover { transform: translateY(-2px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); border-color: #3b82f6; }
        
        .dark .card { background-color: rgba(30, 41, 59, 0.7); border-color: rgba(255,255,255,0.05); }
        .dark .card:hover { border-color: #60a5fa; box-shadow: 0 0 20px rgba(96, 165, 250, 0.15); }

        /* Input Styling */
        input[type="number"], select { 
            background: rgba(255,255,255,0.8);
            border: 1px solid #e2e8f0; 
            padding: 10px 12px; 
            border-radius: 8px; 
            width: 100%; 
            transition: all 0.2s; 
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
        }
        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .dark input[type="number"], .dark select { 
            background-color: rgba(15, 23, 42, 0.6); 
            border-color: #334155; 
            color: #f8fafc; 
        }
        .dark input[type="number"]:focus { border-color: #60a5fa; box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.15); }

        /* Typography & Layout */
        .result-highlight { color: #0284c7; font-weight: 700; font-family: 'Fira Code', monospace; }
        .dark .result-highlight { color: #38bdf8; }
        
        .guide-text { 
            font-size: 0.85rem; 
            color: #64748b; 
            margin-top: auto; /* Push to bottom */
            padding-top: 1rem; 
            border-top: 1px dashed #e2e8f0;
            line-height: 1.5;
        }
        .dark .guide-text { color: #94a3b8; border-top-color: #334155; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }

        .btn-icon { @apply p-2 rounded-lg transition-colors duration-200 hover:bg-slate-100 dark:hover:bg-slate-700; }
    </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-100 transition-colors duration-300 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 backdrop-blur-md bg-white/70 dark:bg-slate-900/80 border-b border-slate-200 dark:border-slate-800 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-lg shadow-lg">P</div>
                <span class="font-bold text-lg tracking-tight hidden sm:block bg-clip-text text-transparent bg-gradient-to-r from-slate-800 to-slate-600 dark:from-white dark:to-slate-300">Photonics Pro</span>
            </div>
            
            <div class="flex items-center gap-2 sm:gap-3">
                <button onclick="copyToolLink()" class="group flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-300 transition-all text-xs font-semibold whitespace-nowrap">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg>
                    <span id="i18n-btn-share">Share</span>
                </button>
                <button onclick="toggleTheme()" class="btn-icon text-slate-500 dark:text-slate-400 flex-shrink-0">
                    <span class="dark:hidden">â˜€ï¸</span><span class="hidden dark:inline">ğŸŒ™</span>
                </button>
                <div class="relative">
                    <select id="lang-select" onchange="changeLanguage(this.value)" class="appearance-none bg-transparent border border-slate-200 dark:border-slate-700 rounded-lg text-xs py-1.5 pl-2 pr-6 outline-none hover:border-blue-400 focus:border-blue-500 dark:bg-slate-800 cursor-pointer">
                        <option value="en">EN</option>
                        <option value="zh-CN">ä¸­æ–‡</option>
                        <option value="zh-TW">ç¹ä½“</option>
                        <option value="es">ES</option>
                        <option value="ru">RU</option>
                        <option value="hi">HI</option>
                        <option value="pl">PL</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-1 text-slate-500">
                        <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 py-8 flex-grow w-full">
        <header class="text-center mb-12 relative">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] bg-blue-500/20 rounded-full blur-[80px] -z-10 pointer-events-none"></div>
            <h1 id="i18n-title" class="text-3xl md:text-5xl font-extrabold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-violet-600 dark:from-blue-400 dark:to-violet-400 drop-shadow-sm leading-tight">Photonics Multi-Calculator Pro</h1>
            <p id="i18n-subtitle" class="text-slate-500 dark:text-slate-400 text-sm md:text-base max-w-2xl mx-auto">All-in-One Professional Suite for Ultrafast & Nonlinear Optics</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            
            <!-- Unit Converter (Large Card) -->
            <div class="card bg-white dark:bg-slate-800 lg:col-span-3 p-6">
                <div class="flex items-center gap-3 mb-6 border-b border-slate-100 dark:border-slate-700 pb-4">
                    <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg text-blue-600 dark:text-blue-400">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
                    </div>
                    <h2 id="i18n-sec-conv" class="text-xl font-bold text-slate-800 dark:text-white">Unit Converter</h2>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-4">
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Wavelength</label>
                        <div class="relative">
                            <input type="number" id="base_nm" oninput="syncUnits('nm', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">nm</span>
                        </div>
                    </div>
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Wavenumber</label>
                        <div class="relative">
                            <input type="number" id="base_cm1" oninput="syncUnits('cm1', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">cmâ»Â¹</span>
                        </div>
                    </div>
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Frequency</label>
                        <div class="relative">
                            <input type="number" id="base_thz" oninput="syncUnits('thz', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">THz</span>
                        </div>
                    </div>
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Photon Energy</label>
                        <div class="relative">
                            <input type="number" id="base_ev" oninput="syncUnits('ev', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">eV</span>
                        </div>
                    </div>
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Period</label>
                        <div class="relative">
                            <input type="number" id="base_fs" oninput="syncUnits('fs', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">fs</span>
                        </div>
                    </div>
                    <div class="relative group">
                        <label class="block text-[10px] uppercase font-bold text-slate-400 mb-1.5 tracking-wider">Angular Freq</label>
                        <div class="relative">
                            <input type="number" id="base_w" oninput="syncUnits('w', this.value)" class="pr-8">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">fsâ»Â¹</span>
                        </div>
                    </div>
                </div>
                <div id="i18n-guide-conv" class="guide-text">Essential tool for instantly converting between wavelength, energy, frequency, and time period scales in laser physics.</div>
            </div>

            <!-- Pulse Bandwidth -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-pulse" class="text-lg font-bold mb-4 text-purple-600 dark:text-purple-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-purple-500"></span> Pulse Bandwidth
                </h2>
                <div class="space-y-4 mb-4">
                    <div class="relative">
                        <input type="number" id="pulse_bw_nm" placeholder="0" oninput="calcPulse()">
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">Î”Î» (nm)</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="setTBP(0.441)" class="flex-1 text-xs border border-purple-200 dark:border-purple-800 hover:bg-purple-50 dark:hover:bg-purple-900/30 text-purple-600 dark:text-purple-300 px-2 py-1.5 rounded transition">Gaussian (0.44)</button>
                        <button onclick="setTBP(0.315)" class="flex-1 text-xs border border-purple-200 dark:border-purple-800 hover:bg-purple-50 dark:hover:bg-purple-900/30 text-purple-600 dark:text-purple-300 px-2 py-1.5 rounded transition">SechÂ² (0.315)</button>
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <span class="text-xs text-slate-500">Transform Limit:</span>
                        <span class="text-sm"><span id="res_pulse_fs" class="result-highlight text-lg">0</span> fs</span>
                    </div>
                </div>
                <div id="i18n-guide-pulse" class="guide-text">Converts spectral bandwidth (FWHM) to the shortest possible pulse duration (Transform Limit) based on pulse shape.</div>
            </div>

            <!-- OPO/SFG -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-opo" class="text-lg font-bold mb-4 text-pink-600 dark:text-pink-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-pink-500"></span> SFG / OPO
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Pump</label>
                            <input type="number" id="opo_p" placeholder="nm" oninput="calcOpo()">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Signal</label>
                            <input type="number" id="opo_s" placeholder="nm" oninput="calcOpo()">
                        </div>
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg mt-2">
                        <span class="text-xs text-slate-500">Idler / DFG:</span>
                        <span class="text-sm"><span id="res_opo_i" class="result-highlight text-lg">0</span> nm</span>
                    </div>
                </div>
                <div id="i18n-guide-opo" class="guide-text">Calculates energy conservation for nonlinear mixing processes: 1/Î»_pump = 1/Î»_signal + 1/Î»_idler.</div>
            </div>

            <!-- Gaussian Beam -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-gb" class="text-lg font-bold mb-4 text-emerald-600 dark:text-emerald-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-emerald-500"></span> Gaussian Beam
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Waist wâ‚€ (Âµm)</label>
                            <input type="number" id="gb_w0" value="100" oninput="updateAll()">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Distance Z (mm)</label>
                            <input type="number" id="gb_z" value="100" oninput="updateAll()">
                        </div>
                    </div>
                    <div class="space-y-1 bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <div class="flex justify-between">
                            <span class="text-xs text-slate-500">Rayleigh Range (Zr):</span>
                            <span class="text-xs font-mono"><span id="res_gb_zr">0</span> mm</span>
                        </div>
                        <div class="flex justify-between items-center pt-1 border-t border-slate-200 dark:border-slate-700">
                            <span class="text-xs text-slate-500">Radius at Z:</span>
                            <span class="text-sm"><span id="res_gb_wz" class="result-highlight text-lg">0</span> Âµm</span>
                        </div>
                    </div>
                </div>
                <div id="i18n-guide-gb" class="guide-text">Calculates beam spot size evolution along propagation direction for a fundamental Gaussian mode.</div>
            </div>

            <!-- Slab Displacement -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-slab" class="text-lg font-bold mb-4 text-orange-600 dark:text-orange-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-orange-500"></span> Slab Displacement
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Thickness (mm)</label>
                            <input type="number" id="slab_t" value="5" oninput="calcSlab()">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">AOI (deg)</label>
                            <input type="number" id="slab_aoi" value="45" oninput="calcSlab()">
                        </div>
                    </div>
                    <div class="relative">
                         <label class="text-[9px] uppercase font-bold text-slate-400">Refractive Index (n)</label>
                         <input type="number" id="slab_n" value="1.45" step="0.01" oninput="calcSlab()">
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <span class="text-xs text-slate-500">Lateral Shift:</span>
                        <span class="text-sm"><span id="res_slab_d" class="result-highlight text-lg">0</span> mm</span>
                    </div>
                </div>
                <div id="i18n-guide-slab" class="guide-text">Computes the lateral beam displacement caused by transmission through a tilted transparent parallel plate.</div>
            </div>

            <!-- Grating -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-grat" class="text-lg font-bold mb-4 text-indigo-600 dark:text-indigo-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-indigo-500"></span> Grating Calculator
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Density (l/mm)</label>
                            <input type="number" id="grat_g" value="600" oninput="calcGrat()">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Incidence (deg)</label>
                            <input type="number" id="grat_aoi" value="0" oninput="calcGrat()">
                        </div>
                    </div>
                     <div class="relative">
                        <label class="text-[9px] uppercase font-bold text-slate-400">Diffraction Order (m)</label>
                        <input type="number" id="grat_m" value="1" step="1" oninput="calcGrat()">
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <span class="text-xs text-slate-500">Diffracted Angle:</span>
                        <span class="text-sm"><span id="res_grat_a" class="result-highlight text-lg">0</span> Â°</span>
                    </div>
                </div>
                <div id="i18n-guide-grat" class="guide-text">Uses the grating equation to find the diffraction angle for a specific order and wavelength.</div>
            </div>

            <!-- Material Dispersion -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-disp" class="text-lg font-bold mb-4 text-rose-600 dark:text-rose-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-rose-500"></span> Material Dispersion
                </h2>
                <div class="space-y-4 mb-4">
                    <select id="mat_sel" onchange="calcDisp()" class="cursor-pointer">
                        <option value="fs">Fused Silica</option>
                        <option value="bk7">N-BK7</option>
                        <option value="znse">ZnSe</option>
                        <option value="sapphire">Sapphire</option>
                    </select>
                    <div class="bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg space-y-2">
                        <div class="flex justify-between">
                             <span class="text-xs text-slate-500">Index (n):</span>
                             <span class="font-mono text-xs" id="res_n">0.000</span>
                        </div>
                        <div class="flex justify-between">
                             <span class="text-xs text-slate-500">GVD (k''):</span>
                             <span class="font-mono text-xs text-rose-600 dark:text-rose-400 font-bold"><span id="res_gvd">0</span> fsÂ²/mm</span>
                        </div>
                    </div>
                </div>
                <div id="i18n-guide-disp" class="guide-text">Estimates Refractive Index and Group Velocity Dispersion (GVD) using Sellmeier coefficients at the current wavelength.</div>
            </div>

            <!-- Pulse Broadening -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-matbroad" class="text-lg font-bold mb-4 text-amber-600 dark:text-amber-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-amber-500"></span> Broadening
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Input Pulse (fs)</label>
                            <input type="number" id="mb_t0" value="30" oninput="calcDisp()">
                        </div>
                        <div class="relative">
                            <label class="text-[9px] uppercase font-bold text-slate-400">Length (mm)</label>
                            <input type="number" id="mb_l" value="10" oninput="calcDisp()">
                        </div>
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <span class="text-xs text-slate-500">Output Duration:</span>
                        <span class="text-sm"><span id="res_mb_out" class="result-highlight text-lg">0</span> fs</span>
                    </div>
                </div>
                <div id="i18n-guide-matbroad" class="guide-text">Calculates temporal pulse stretching due to GVD in the selected material (assumes transform-limited Gaussian input).</div>
            </div>

            <!-- B-Integral -->
            <div class="card bg-white dark:bg-slate-800 p-6">
                <h2 id="i18n-sec-bint" class="text-lg font-bold mb-4 text-red-600 dark:text-red-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-red-500"></span> B-Integral
                </h2>
                <div class="space-y-3 mb-4">
                    <div class="relative">
                         <label class="text-[9px] uppercase font-bold text-slate-400">Intensity (GW/cmÂ²)</label>
                        <input type="number" id="bi_int" value="10" oninput="calcBint()">
                    </div>
                    <div class="relative">
                        <label class="text-[9px] uppercase font-bold text-slate-400">Distance (mm)</label>
                        <input type="number" id="bi_l" value="50" oninput="calcBint()">
                    </div>
                    <div class="relative">
                         <label class="text-[9px] uppercase font-bold text-slate-400">n2 (x10â»Â¹â¶ cmÂ²/W)</label>
                        <input type="number" id="bi_n2" value="2.5" step="0.1" oninput="calcBint()">
                    </div>
                    <div class="flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg">
                        <span class="text-xs text-slate-500">Accumulated Phase:</span>
                        <span class="text-sm"><span id="res_bi" class="result-highlight text-lg">0</span> rad</span>
                    </div>
                </div>
                <div id="i18n-guide-bint" class="guide-text">Calculates the accumulated nonlinear phase shift (B-integral) to estimate self-focusing risks.</div>
            </div>

            <!-- Instruction Box -->
            <div class="card bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-slate-800 dark:to-slate-800 lg:col-span-3 p-6 border-l-4 border-blue-500">
                <h2 id="i18n-instr-title" class="text-xl font-bold mb-3 text-slate-800 dark:text-white">Professional Usage Guide</h2>
                <div id="i18n-instr-content" class="text-sm space-y-2 text-slate-600 dark:text-slate-400 leading-relaxed">
                    <!-- Default English Content -->
                    <p>Welcome to Photonics Multi-Calculator Pro. This suite is engineered for rapid estimations in ultrafast and nonlinear optics labs.</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>Unit Sync:</strong> Changing one value in the Unit Converter automatically updates all others.</li>
                        <li><strong>Material Data:</strong> Dispersion calculations use Sellmeier equations for common optical glasses.</li>
                        <li><strong>Safety:</strong> Always verify calculations with rigorous simulations for critical high-energy laser systems.</li>
                    </ul>
                </div>
            </div>

        </div>
        
        <footer class="text-center text-slate-400 text-xs py-8 mt-8">
            &copy; <script>document.write(new Date().getFullYear())</script> Photonics Pro Tool. All logic runs locally in your browser.
        </footer>
    </div>
    
    <!-- ç»“å°¾å¿…é¡»åŒ…å«çš„ä»£ç  -->
    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>

    <script>
        // --- Constants ---
        var C = 299.792458; // nm/fs
        var PI = Math.PI;

        // --- State ---
        var currentTBP = 0.441;
        var globalLambda = 800; // nm

        // --- I18n Dictionary (Enhanced & Complete) ---
        var i18n = {
            en: {
                title: "Photonics Multi-Calculator Pro",
                subtitle: "All-in-One Professional Suite for Ultrafast & Nonlinear Optics",
                secConv: "Unit Converter", secPulse: "Pulse Bandwidth", secOpo: "SFG / OPO",
                secGb: "Gaussian Beam", secSlab: "Slab Displacement", secGrat: "Grating Calculator",
                secDisp: "Material Dispersion", secMatbroad: "Pulse Broadening", secBint: "B-Integral",
                btnShare: "Share Tool", 
                instrTitle: "Professional Usage Guide",
                instrContent: `<p>Welcome to Photonics Multi-Calculator Pro. This suite is engineered for rapid estimations in ultrafast and nonlinear optics labs.</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>Unit Sync:</strong> Changing one value in the Unit Converter automatically updates all others.</li>
                        <li><strong>Material Data:</strong> Dispersion calculations use Sellmeier equations for common optical glasses.</li>
                        <li><strong>Safety:</strong> Always verify calculations with rigorous simulations for critical high-energy laser systems.</li>
                    </ul>`,
                copied: "URL copied to clipboard!",
                // Guides
                guideConv: "Essential tool for instantly converting between wavelength, energy, frequency, and time period scales in laser physics.",
                guidePulse: "Converts spectral bandwidth (FWHM) to the shortest possible pulse duration (Transform Limit) based on pulse shape.",
                guideOpo: "Calculates energy conservation for nonlinear mixing processes: 1/Î»_pump = 1/Î»_signal + 1/Î»_idler.",
                guideGb: "Calculates beam spot size evolution along propagation direction for a fundamental Gaussian mode.",
                guideSlab: "Computes the lateral beam displacement caused by transmission through a tilted transparent parallel plate.",
                guideGrat: "Uses the grating equation to find the diffraction angle for a specific order and wavelength.",
                guideDisp: "Estimates Refractive Index and Group Velocity Dispersion (GVD) using Sellmeier coefficients at the current wavelength.",
                guideMatbroad: "Calculates temporal pulse stretching due to GVD in the selected material (assumes transform-limited Gaussian input).",
                guideBint: "Calculates the accumulated nonlinear phase shift (B-integral) to estimate self-focusing risks."
            },
            "zh-CN": {
                title: "å…‰å­å­¦å¤šåŠŸèƒ½è®¡ç®—å™¨ Pro",
                subtitle: "è¶…å¿«ä¸éçº¿æ€§å…‰å­¦çš„å…¨èƒ½ä¸“ä¸šå¥—ä»¶",
                secConv: "å•ä½æ¢ç®—å™¨", secPulse: "è„‰å†²å¸¦å®½è½¬æ¢", secOpo: "SFG / OPO æ··é¢‘",
                secGb: "é«˜æ–¯å…‰æŸä¼ æ’­", secSlab: "å¹³æ¿ä½ç§»è®¡ç®—", secGrat: "å…‰æ …è®¡ç®—å™¨",
                secDisp: "ææ–™è‰²æ•£", secMatbroad: "è„‰å†²å±•å®½æ•ˆåº”", secBint: "B-ç§¯åˆ†è®¡ç®—",
                btnShare: "åˆ†äº«é“¾æ¥", 
                instrTitle: "ä¸“ä¸šä½¿ç”¨æŒ‡å—",
                instrContent: `<p>æ¬¢è¿ä½¿ç”¨å…‰å­å­¦å¤šåŠŸèƒ½è®¡ç®—å™¨ Proã€‚æœ¬å¥—ä»¶ä¸“ä¸ºè¶…å¿«å’Œéçº¿æ€§å…‰å­¦å®éªŒå®¤çš„å¿«é€Ÿä¼°ç®—è€Œè®¾è®¡ã€‚</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>å•ä½åŒæ­¥ï¼š</strong>åœ¨å•ä½è½¬æ¢å™¨ä¸­æ›´æ”¹ä¸€ä¸ªå€¼ä¼šè‡ªåŠ¨æ›´æ–°æ‰€æœ‰å…¶ä»–å€¼ã€‚</li>
                        <li><strong>ææ–™æ•°æ®ï¼š</strong>è‰²æ•£è®¡ç®—ä½¿ç”¨å¸¸ç”¨å…‰å­¦ç»ç’ƒçš„ Sellmeier æ–¹ç¨‹ã€‚</li>
                        <li><strong>å®‰å…¨æç¤ºï¼š</strong>å¯¹äºå…³é”®çš„é«˜èƒ½æ¿€å…‰ç³»ç»Ÿï¼Œè¯·åŠ¡å¿…é€šè¿‡ä¸¥æ ¼çš„æ¨¡æ‹Ÿæ¥éªŒè¯è®¡ç®—ç»“æœã€‚</li>
                    </ul>`,
                copied: "é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼",
                // Guides
                guideConv: "æ¿€å…‰ç‰©ç†å¿…å¤‡å·¥å…·ï¼Œå¯åœ¨æ³¢é•¿ã€èƒ½é‡ã€é¢‘ç‡ã€æ³¢æ•°å’Œæ—¶é—´å‘¨æœŸä¹‹é—´è¿›è¡Œå³æ—¶æ¢ç®—ã€‚",
                guidePulse: "æ ¹æ®è„‰å†²å½¢çŠ¶ï¼Œå°†å…‰è°±å¸¦å®½ (FWHM) è½¬æ¢ä¸ºç†è®ºä¸Šæœ€çŸ­çš„è„‰å†²æŒç»­æ—¶é—´ï¼ˆå˜æ¢æé™ï¼‰ã€‚",
                guideOpo: "è®¡ç®—éçº¿æ€§æ··é¢‘è¿‡ç¨‹çš„èƒ½é‡å®ˆæ’ï¼š1/Î»_æ³µæµ¦ = 1/Î»_ä¿¡å· + 1/Î»_é—²é¢‘ã€‚",
                guideGb: "è®¡ç®—åŸºæ¨¡é«˜æ–¯å…‰æŸæ²¿ä¼ æ’­æ–¹å‘çš„å…‰æ–‘å°ºå¯¸æ¼”å˜ã€‚",
                guideSlab: "è®¡ç®—å…‰æŸç©¿è¿‡å€¾æ–œçš„é€æ˜å¹³è¡Œå¹³æ¿æ—¶äº§ç”Ÿçš„æ¨ªå‘ä½ç§»é‡ã€‚",
                guideGrat: "åˆ©ç”¨å…‰æ …æ–¹ç¨‹è®¡ç®—ç‰¹å®šçº§æ¬¡å’Œæ³¢é•¿çš„è¡å°„è§’åº¦ã€‚",
                guideDisp: "åˆ©ç”¨ Sellmeier æ–¹ç¨‹ä¼°ç®—å½“å‰æ³¢é•¿ä¸‹çš„æŠ˜å°„ç‡å’Œç¾¤é€Ÿåº¦è‰²æ•£ (GVD)ã€‚",
                guideMatbroad: "è®¡ç®—é€‰å®šææ–™ä¸­ç”±äº GVD å¼•èµ·çš„æ—¶é—´è„‰å†²å±•å®½ï¼ˆå‡è®¾è¾“å…¥ä¸ºå˜æ¢æé™é«˜æ–¯è„‰å†²ï¼‰ã€‚",
                guideBint: "è®¡ç®—ç´¯ç§¯çš„éçº¿æ€§ç›¸ç§»ï¼ˆB-ç§¯åˆ†ï¼‰ï¼Œç”¨äºè¯„ä¼°è‡ªèšç„¦é£é™©ã€‚"
            },
            "zh-TW": {
                title: "å…‰å­å­¸å¤šåŠŸèƒ½è¨ˆç®—å™¨ Pro",
                subtitle: "è¶…å¿«èˆ‡éç·šæ€§å…‰å­¸çš„å…¨èƒ½å°ˆæ¥­å¥—ä»¶",
                secConv: "å–®ä½æ›ç®—å™¨", secPulse: "è„ˆè¡é »å¯¬è½‰æ›", secOpo: "SFG / OPO æ··é »",
                secGb: "é«˜æ–¯å…‰æŸå‚³æ’­", secSlab: "å¹³æ¿ä½ç§»è¨ˆç®—", secGrat: "å…‰æŸµè¨ˆç®—å™¨",
                secDisp: "ææ–™è‰²æ•£", secMatbroad: "è„ˆè¡å±•å¯¬æ•ˆæ‡‰", secBint: "B-ç©åˆ†è¨ˆç®—",
                btnShare: "åˆ†äº«é€£çµ", 
                instrTitle: "å°ˆæ¥­ä½¿ç”¨æŒ‡å—",
                instrContent: `<p>æ­¡è¿ä½¿ç”¨å…‰å­å­¸å¤šåŠŸèƒ½è¨ˆç®—å™¨ Proã€‚æœ¬å¥—ä»¶å°ˆç‚ºè¶…å¿«å’Œéç·šæ€§å…‰å­¸å¯¦é©—å®¤çš„å¿«é€Ÿä¼°ç®—è€Œè¨­è¨ˆã€‚</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>å–®ä½åŒæ­¥ï¼š</strong>åœ¨å–®ä½è½‰æ›å™¨ä¸­æ›´æ”¹ä¸€å€‹å€¼æœƒè‡ªå‹•æ›´æ–°æ‰€æœ‰å…¶ä»–å€¼ã€‚</li>
                        <li><strong>ææ–™æ•¸æ“šï¼š</strong>è‰²æ•£è¨ˆç®—ä½¿ç”¨å¸¸ç”¨å…‰å­¸ç»ç’ƒçš„ Sellmeier æ–¹ç¨‹ã€‚</li>
                        <li><strong>å®‰å…¨æç¤ºï¼š</strong>å°æ–¼é—œéµçš„é«˜èƒ½é›·å°„ç³»çµ±ï¼Œè«‹å‹™å¿…é€šéåš´æ ¼çš„æ¨¡æ“¬ä¾†é©—è­‰è¨ˆç®—çµæœã€‚</li>
                    </ul>`,
                copied: "é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼",
                guideConv: "é›·å°„ç‰©ç†å¿…å‚™å·¥å…·ï¼Œå¯åœ¨æ³¢é•·ã€èƒ½é‡ã€é »ç‡ã€æ³¢æ•¸å’Œæ™‚é–“é€±æœŸä¹‹é–“é€²è¡Œå³æ™‚æ›ç®—ã€‚",
                guidePulse: "æ ¹æ“šè„ˆè¡å½¢ç‹€ï¼Œå°‡å…‰è­œé »å¯¬ (FWHM) è½‰æ›ç‚ºç†è«–ä¸Šæœ€çŸ­çš„è„ˆè¡æŒçºŒæ™‚é–“ï¼ˆè®Šæ›æ¥µé™ï¼‰ã€‚",
                guideOpo: "è¨ˆç®—éç·šæ€§æ··é »éç¨‹çš„èƒ½é‡å®ˆæ†ï¼š1/Î»_æ³µæµ¦ = 1/Î»_ä¿¡è™Ÿ + 1/Î»_é–’é »ã€‚",
                guideGb: "è¨ˆç®—åŸºæ¨¡é«˜æ–¯å…‰æŸæ²¿å‚³æ’­æ–¹å‘çš„å…‰æ–‘å°ºå¯¸æ¼”è®Šã€‚",
                guideSlab: "è¨ˆç®—å…‰æŸç©¿éå‚¾æ–œçš„é€æ˜å¹³è¡Œå¹³æ¿æ™‚ç”¢ç”Ÿçš„æ©«å‘ä½ç§»é‡ã€‚",
                guideGrat: "åˆ©ç”¨å…‰æŸµæ–¹ç¨‹è¨ˆç®—ç‰¹å®šç´šæ¬¡å’Œæ³¢é•·çš„ç¹å°„è§’åº¦ã€‚",
                guideDisp: "åˆ©ç”¨ Sellmeier æ–¹ç¨‹ä¼°ç®—ç•¶å‰æ³¢é•·ä¸‹çš„æŠ˜å°„ç‡å’Œç¾¤é€Ÿåº¦è‰²æ•£ (GVD)ã€‚",
                guideMatbroad: "è¨ˆç®—é¸å®šææ–™ä¸­ç”±æ–¼ GVD å¼•èµ·çš„æ™‚é–“è„ˆè¡å±•å¯¬ï¼ˆå‡è¨­è¼¸å…¥ç‚ºè®Šæ›æ¥µé™é«˜æ–¯è„ˆè¡ï¼‰ã€‚",
                guideBint: "è¨ˆç®—ç´¯ç©çš„éç·šæ€§ç›¸ç§»ï¼ˆB-ç©åˆ†ï¼‰ï¼Œç”¨æ–¼è©•ä¼°è‡ªèšç„¦é¢¨éšªã€‚"
            },
            es: {
                title: "Calculadora de FotÃ³nica Pro",
                subtitle: "Suite profesional todo en uno para Ã³ptica ultrarrÃ¡pida",
                secConv: "Conversor de Unidades", secPulse: "Ancho de Banda", secOpo: "SFG / OPO",
                secGb: "Haz Gaussiano", secSlab: "Desplazamiento", secGrat: "Red de DifracciÃ³n",
                secDisp: "DispersiÃ³n Material", secMatbroad: "Ensanchamiento", secBint: "Integral-B",
                btnShare: "Compartir", 
                instrTitle: "GuÃ­a de Uso",
                instrContent: `<p>Bienvenido a Calculadora de FotÃ³nica Pro. Suite diseÃ±ada para estimaciones rÃ¡pidas en laboratorios.</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>SincronizaciÃ³n:</strong> Cambiar un valor actualiza todos los demÃ¡s automÃ¡ticamente.</li>
                        <li><strong>Datos:</strong> CÃ¡lculos de dispersiÃ³n utilizan ecuaciones de Sellmeier.</li>
                        <li><strong>Seguridad:</strong> Verifique siempre los cÃ¡lculos con simulaciones rigurosas.</li>
                    </ul>`,
                copied: "Â¡Enlace copiado!",
                guideConv: "Herramienta esencial para convertir instantÃ¡neamente entre longitud de onda, energÃ­a, frecuencia y tiempo.",
                guidePulse: "Convierte el ancho de banda espectral (FWHM) a la duraciÃ³n de pulso mÃ¡s corta posible (LÃ­mite de Transformada).",
                guideOpo: "Calcula la conservaciÃ³n de energÃ­a: 1/Î»_bomba = 1/Î»_seÃ±al + 1/Î»_idler.",
                guideGb: "Calcula la evoluciÃ³n del tamaÃ±o del haz a lo largo de la direcciÃ³n de propagaciÃ³n.",
                guideSlab: "Calcula el desplazamiento lateral del haz causado por la transmisiÃ³n a travÃ©s de una placa paralela.",
                guideGrat: "Usa la ecuaciÃ³n de rejilla para encontrar el Ã¡ngulo de difracciÃ³n.",
                guideDisp: "Estima el Ã­ndice de refracciÃ³n y la dispersiÃ³n de velocidad de grupo (GVD) usando coeficientes de Sellmeier.",
                guideMatbroad: "Calcula el estiramiento temporal del pulso debido a la GVD en el material seleccionado.",
                guideBint: "Calcula el cambio de fase no lineal acumulado (Integral-B)."
            },
            ru: {
                title: "Ğ¤Ğ¾Ñ‚Ğ¾Ğ½Ğ¸ĞºĞ° ĞœÑƒĞ»ÑŒÑ‚Ğ¸-ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€",
                subtitle: "ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ½Ğ°Ğ±Ğ¾Ñ€ Ğ´Ğ»Ñ ÑĞ²ĞµÑ€Ñ…Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ¾Ğ¿Ñ‚Ğ¸ĞºĞ¸",
                secConv: "ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ĞµÑ€ Ğ•Ğ´Ğ¸Ğ½Ğ¸Ñ†", secPulse: "Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ° Ğ˜Ğ¼Ğ¿ÑƒĞ»ÑŒÑĞ°", secOpo: "SFG / OPO",
                secGb: "Ğ“Ğ°ÑƒÑÑĞ¾Ğ² ĞŸÑƒÑ‡Ğ¾Ğº", secSlab: "Ğ¡Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ›ÑƒÑ‡Ğ°", secGrat: "Ğ”Ğ¸Ñ„Ñ€Ğ°ĞºÑ†. Ğ ĞµÑˆĞµÑ‚ĞºĞ°",
                secDisp: "Ğ”Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ñ", secMatbroad: "Ğ£ÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ Ğ˜Ğ¼Ğ¿ÑƒĞ»ÑŒÑĞ°", secBint: "B-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ğ»",
                btnShare: "ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ", 
                instrTitle: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ",
                instrContent: `<p>Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¤Ğ¾Ñ‚Ğ¾Ğ½Ğ¸ĞºĞ° ĞœÑƒĞ»ÑŒÑ‚Ğ¸-ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Pro. ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ² Ğ»Ğ°Ğ±Ğ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¸ÑÑ….</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:</strong> Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ²ÑĞµ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ.</li>
                        <li><strong>ĞœĞ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹:</strong> Ğ Ğ°ÑÑ‡ĞµÑ‚Ñ‹ Ğ´Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ ÑƒÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¡ĞµĞ»Ğ»Ğ¼ĞµĞ¹ĞµÑ€Ğ°.</li>
                        <li><strong>Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ:</strong> Ğ’ÑĞµĞ³Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ñ‹ ÑÑ‚Ñ€Ğ¾Ğ³Ğ¸Ğ¼ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼.</li>
                    </ul>`,
                copied: "Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!",
                guideConv: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ´Ğ»Ğ¸Ğ½Ğ¾Ğ¹ Ğ²Ğ¾Ğ»Ğ½Ñ‹, ÑĞ½ĞµÑ€Ğ³Ğ¸ĞµĞ¹ Ğ¸ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğ¾Ğ¹.",
                guidePulse: "ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ¿ĞµĞºÑ‚Ñ€Ğ°Ğ»ÑŒĞ½ÑƒÑ ÑˆĞ¸Ñ€Ğ¸Ğ½Ñƒ (FWHM) Ğ² Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ´Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ¼Ğ¿ÑƒĞ»ÑŒÑĞ°.",
                guideOpo: "Ğ—Ğ°ĞºĞ¾Ğ½ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸: 1/Î»_pump = 1/Î»_signal + 1/Î»_idler.",
                guideGb: "Ğ Ğ°ÑÑ‡ĞµÑ‚ ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ¿ÑÑ‚Ğ½Ğ° Ğ³Ğ°ÑƒÑÑĞ¾Ğ²Ğ° Ğ¿ÑƒÑ‡ĞºĞ° Ğ¿Ñ€Ğ¸ Ñ€Ğ°ÑĞ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğ¸.",
                guideSlab: "Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ Ğ±Ğ¾ĞºĞ¾Ğ²Ğ¾Ğµ ÑĞ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ»ÑƒÑ‡Ğ° Ğ¿Ñ€Ğ¸ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Ğ½Ğ°ĞºĞ»Ğ¾Ğ½Ğ½ÑƒÑ Ğ¿Ğ»Ğ°ÑÑ‚Ğ¸Ğ½Ñƒ.",
                guideGrat: "Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑƒÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑˆĞµÑ‚ĞºĞ¸ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° ÑƒĞ³Ğ»Ğ° Ğ´Ğ¸Ñ„Ñ€Ğ°ĞºÑ†Ğ¸Ğ¸.",
                guideDisp: "ĞÑ†ĞµĞ½ĞºĞ° Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ñ Ğ¿Ñ€ĞµĞ»Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¸ Ğ“Ğ’Ğ” (GVD) Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ ÑƒÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ¡ĞµĞ»Ğ»Ğ¼ĞµĞ¹ĞµÑ€Ğ°.",
                guideMatbroad: "Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ Ğ¸Ğ¼Ğ¿ÑƒĞ»ÑŒÑĞ° Ğ¸Ğ·-Ğ·Ğ° Ğ´Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ğ¸ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğ°.",
                guideBint: "Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ½Ğ°ĞºĞ¾Ğ¿Ğ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ½ĞµĞ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑĞ´Ğ²Ğ¸Ğ³Ğ° (B-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ğ»)."
            },
            hi: {
                title: "à¤«à¥‹à¤Ÿà¥‹à¤¨à¤¿à¤•à¥à¤¸ à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤° à¤ªà¥à¤°à¥‹",
                subtitle: "à¤…à¤²à¥à¤Ÿà¥à¤°à¤¾à¤«à¤¾à¤¸à¥à¤Ÿ à¤‘à¤ªà¥à¤Ÿà¤¿à¤•à¥à¤¸ à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¥à¤°à¥‹à¤«à¥‡à¤¶à¤¨à¤² à¤Ÿà¥‚à¤²",
                secConv: "à¤‡à¤•à¤¾à¤ˆ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤•", secPulse: "à¤ªà¤²à¥à¤¸ à¤¬à¥ˆà¤‚à¤¡à¤µà¤¿à¤¡à¥à¤¥", secOpo: "SFG / OPO",
                secGb: "à¤—à¥‰à¤¸à¤¿à¤¯à¤¨ à¤¬à¥€à¤®", secSlab: "à¤¸à¥à¤²à¥ˆà¤¬ à¤µà¤¿à¤¸à¥à¤¥à¤¾à¤ªà¤¨", secGrat: "à¤—à¥à¤°à¥‡à¤Ÿà¤¿à¤‚à¤— à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤°",
                secDisp: "à¤¸à¤¾à¤®à¤—à¥à¤°à¥€ à¤«à¥ˆà¤²à¤¾à¤µ", secMatbroad: "à¤ªà¤²à¥à¤¸ à¤šà¥Œà¤¡à¤¼à¥€à¤•à¤°à¤£", secBint: "à¤¬à¥€-à¤‡à¤‚à¤Ÿà¥€à¤—à¥à¤°à¤²",
                btnShare: "à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚", 
                instrTitle: "à¤‰à¤ªà¤¯à¥‹à¤— à¤—à¤¾à¤‡à¤¡",
                instrContent: `<p>à¤«à¥‹à¤Ÿà¥‹à¤¨à¤¿à¤•à¥à¤¸ à¤®à¤²à¥à¤Ÿà¥€-à¤•à¥ˆà¤²à¤•à¥à¤²à¥‡à¤Ÿà¤° à¤ªà¥à¤°à¥‹ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆà¥¤ à¤¯à¤¹ à¤¸à¥‚à¤Ÿ à¤ªà¥à¤°à¤¯à¥‹à¤—à¤¶à¤¾à¤²à¤¾à¤“à¤‚ à¤®à¥‡à¤‚ à¤¤à¥‡à¤œà¥€ à¤¸à¥‡ à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤•à¥‡ à¤²à¤¿à¤ à¤¬à¤¨à¤¾à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>à¤‡à¤•à¤¾à¤ˆ à¤¸à¤¿à¤‚à¤•:</strong> à¤à¤• à¤®à¤¾à¤¨ à¤¬à¤¦à¤²à¤¨à¥‡ à¤¸à¥‡ à¤…à¤¨à¥à¤¯ à¤¸à¤­à¥€ à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤¹à¥‹ à¤œà¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤</li>
                        <li><strong>à¤¸à¤¾à¤®à¤—à¥à¤°à¥€ à¤¡à¥‡à¤Ÿà¤¾:</strong> à¤«à¥ˆà¤²à¤¾à¤µ à¤—à¤£à¤¨à¤¾ à¤¸à¥‡à¤²à¤®à¤¿à¤¯à¤° à¤¸à¤®à¥€à¤•à¤°à¤£à¥‹à¤‚ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¤¤à¥€ à¤¹à¥ˆà¥¤</li>
                        <li><strong>à¤¸à¥à¤°à¤•à¥à¤·à¤¾:</strong> à¤¹à¤®à¥‡à¤¶à¤¾ à¤®à¤¹à¤¤à¥à¤µà¤ªà¥‚à¤°à¥à¤£ à¤ªà¥à¤°à¤£à¤¾à¤²à¤¿à¤¯à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¤¿à¤®à¥à¤²à¥‡à¤¶à¤¨ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤—à¤£à¤¨à¤¾à¤“à¤‚ à¤•à¥‹ à¤¸à¤¤à¥à¤¯à¤¾à¤ªà¤¿à¤¤ à¤•à¤°à¥‡à¤‚à¥¤</li>
                    </ul>`,
                copied: "à¤²à¤¿à¤‚à¤• à¤•à¥‰à¤ªà¥€ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾!",
                guideConv: "à¤¤à¤°à¤‚à¤— à¤¦à¥ˆà¤°à¥à¤§à¥à¤¯, à¤Šà¤°à¥à¤œà¤¾, à¤†à¤µà¥ƒà¤¤à¥à¤¤à¤¿ à¤”à¤° à¤¸à¤®à¤¯ à¤•à¥‡ à¤¬à¥€à¤š à¤¤à¥à¤°à¤‚à¤¤ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨ à¤•à¥‡ à¤²à¤¿à¤ à¤†à¤µà¤¶à¥à¤¯à¤• à¤‰à¤ªà¤•à¤°à¤£à¥¤",
                guidePulse: "à¤¸à¥à¤ªà¥‡à¤•à¥à¤Ÿà¥à¤°à¤² à¤¬à¥ˆà¤‚à¤¡à¤µà¤¿à¤¡à¥à¤¥ à¤•à¥‹ à¤¸à¤¬à¤¸à¥‡ à¤›à¥‹à¤Ÿà¥€ à¤¸à¤‚à¤­à¤µ à¤ªà¤²à¥à¤¸ à¤…à¤µà¤§à¤¿ à¤®à¥‡à¤‚ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¿à¤¤ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideOpo: "à¤Šà¤°à¥à¤œà¤¾ à¤¸à¤‚à¤°à¤•à¥à¤·à¤£ à¤•à¥€ à¤—à¤£à¤¨à¤¾: 1/Î»_pump = 1/Î»_signal + 1/Î»_idler.",
                guideGb: "à¤ªà¥à¤°à¤¸à¤¾à¤° à¤¦à¤¿à¤¶à¤¾ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤¬à¥€à¤® à¤¸à¥à¤ªà¥‰à¤Ÿ à¤†à¤•à¤¾à¤° à¤•à¥‡ à¤µà¤¿à¤•à¤¾à¤¸ à¤•à¥€ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideSlab: "à¤¸à¤®à¤¾à¤¨à¤¾à¤‚à¤¤à¤° à¤ªà¥à¤²à¥‡à¤Ÿ à¤•à¥‡ à¤®à¤¾à¤§à¥à¤¯à¤® à¤¸à¥‡ à¤¸à¤‚à¤šà¤°à¤£ à¤•à¥‡ à¤•à¤¾à¤°à¤£ à¤¬à¥€à¤® à¤•à¥‡ à¤ªà¤¾à¤°à¥à¤¶à¥à¤µ à¤µà¤¿à¤¸à¥à¤¥à¤¾à¤ªà¤¨ à¤•à¥€ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideGrat: "à¤µà¤¿à¤µà¤°à¥à¤¤à¤¨ à¤•à¥‹à¤£ à¤œà¥à¤à¤¾à¤¤ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤—à¥à¤°à¥‡à¤Ÿà¤¿à¤‚à¤— à¤¸à¤®à¥€à¤•à¤°à¤£ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideDisp: "à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤¤à¤°à¤‚à¤— à¤¦à¥ˆà¤°à¥à¤§à¥à¤¯ à¤ªà¤° à¤…à¤ªà¤µà¤°à¥à¤¤à¤• à¤¸à¥‚à¤šà¤•à¤¾à¤‚à¤• à¤”à¤° GVD à¤•à¤¾ à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤²à¤—à¤¾à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideMatbroad: "à¤¸à¤¾à¤®à¤—à¥à¤°à¥€ à¤®à¥‡à¤‚ GVD à¤•à¥‡ à¤•à¤¾à¤°à¤£ à¤ªà¤²à¥à¤¸ à¤•à¥‡ à¤¸à¤®à¤¯ à¤–à¤¿à¤‚à¤šà¤¾à¤µ à¤•à¥€ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤",
                guideBint: "à¤¸à¤‚à¤šà¤¿à¤¤ à¤—à¥ˆà¤°-à¤°à¥ˆà¤–à¤¿à¤• à¤šà¤°à¤£ à¤¬à¤¦à¤²à¤¾à¤µ (B-integral) à¤•à¥€ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤"
            },
            pl: {
                title: "Kalkulator Fotoniczny Pro",
                subtitle: "Zestaw narzÄ™dzi do optyki ultraszybkiej",
                secConv: "Konwerter Jednostek", secPulse: "SzerokoÅ›Ä‡ Impulsu", secOpo: "SFG / OPO",
                secGb: "WiÄ…zka Gaussa", secSlab: "PrzesuniÄ™cie WiÄ…zki", secGrat: "Siatka Dyfrakcyjna",
                secDisp: "Dyspersja MateriaÅ‚owa", secMatbroad: "Poszerzenie Impulsu", secBint: "CaÅ‚ka B",
                btnShare: "UdostÄ™pnij", 
                instrTitle: "Instrukcja ObsÅ‚ugi",
                instrContent: `<p>Witamy w Kalkulatorze Fotonicznym Pro. Zestaw ten jest przeznaczony do szybkich szacunkÃ³w w laboratoriach.</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>Synchronizacja:</strong> Zmiana jednej wartoÅ›ci automatycznie aktualizuje wszystkie inne.</li>
                        <li><strong>Dane materiaÅ‚owe:</strong> Obliczenia dyspersji wykorzystujÄ… rÃ³wnania Sellmeiera.</li>
                        <li><strong>BezpieczeÅ„stwo:</strong> Zawsze weryfikuj obliczenia za pomocÄ… rygorystycznych symulacji.</li>
                    </ul>`,
                copied: "Skopiowano link!",
                guideConv: "NarzÄ™dzie do natychmiastowej konwersji miÄ™dzy dÅ‚ugoÅ›ciÄ… fali, energiÄ…, czÄ™stotliwoÅ›ciÄ… i czasem.",
                guidePulse: "Przelicza szerokoÅ›Ä‡ spektralnÄ… (FWHM) na najkrÃ³tszy moÅ¼liwy czas trwania impulsu.",
                guideOpo: "Oblicza zachowanie energii: 1/Î»_pompy = 1/Î»_sygnaÅ‚u + 1/Î»_idler.",
                guideGb: "Oblicza ewolucjÄ™ rozmiaru plamki wiÄ…zki wzdÅ‚uÅ¼ kierunku propagacji.",
                guideSlab: "Oblicza przesuniÄ™cie boczne wiÄ…zki spowodowane transmisjÄ… przez pÅ‚ytkÄ™.",
                guideGrat: "UÅ¼ywa rÃ³wnania siatki do znalezienia kÄ…ta dyfrakcji.",
                guideDisp: "Szacuje wspÃ³Å‚czynnik zaÅ‚amania i dyspersjÄ™ (GVD) przy uÅ¼yciu rÃ³wnaÅ„ Sellmeiera.",
                guideMatbroad: "Oblicza czasowe rozciÄ…gniÄ™cie impulsu z powodu dyspersji w materiale.",
                guideBint: "Oblicza skumulowane nieliniowe przesuniÄ™cie fazy (CaÅ‚ka B)."
            }
        };

        // --- Core Logic ---
        
        function syncUnits(type, val) {
            const v = parseFloat(val);
            if(isNaN(v) || v <= 0) return;
            
            let nm;
            if(type==='nm') nm = v;
            else if(type==='cm1') nm = 1e7/v;
            else if(type==='thz') nm = C*1000/v;
            else if(type==='ev') nm = 1239.84193/v;
            else if(type==='fs') nm = v * C;
            else if(type==='w') nm = (2 * PI * C) / v;

            globalLambda = nm;

            // Update UI fields only if they aren't the source
            const updateField = (id, val) => {
                if (type !== id) document.getElementById('base_'+id).value = val.toPrecision(5);
            };

            updateField('nm', nm);
            updateField('cm1', 1e7/nm);
            updateField('thz', C*1000/nm);
            updateField('ev', 1239.84193/nm);
            updateField('fs', nm/C);
            updateField('w', (2 * PI * C) / nm);

            updateAll();
        }

        function setTBP(val) {
            currentTBP = val;
            calcPulse();
        }

        function calcPulse() {
            const dlam = parseFloat(document.getElementById('pulse_bw_nm').value);
            if (!dlam || !globalLambda) return;
            // dNu = (c / lambda^2) * dLambda
            const dNu = (C * 1e-6 / Math.pow(globalLambda * 1e-9, 2)) * (dlam * 1e-9); // Hz
            const dt = currentTBP / dNu; // seconds
            document.getElementById('res_pulse_fs').innerText = (dt * 1e15).toFixed(1);
        }

        function calcOpo() {
            const p = parseFloat(document.getElementById('opo_p').value);
            const s = parseFloat(document.getElementById('opo_s').value);
            if(p && s && s > p) {
                const i = 1 / (1/p - 1/s);
                document.getElementById('res_opo_i').innerText = i.toFixed(1);
            } else {
                document.getElementById('res_opo_i').innerText = "---";
            }
        }

        function calcGb() {
            const w0 = parseFloat(document.getElementById('gb_w0').value); // um
            const z = parseFloat(document.getElementById('gb_z').value); // mm
            if(!w0) return;
            
            // zR = pi * w0^2 / lambda
            // units: w0 in um, lambda in nm. 
            // zR (mm) = pi * (w0 um)^2 / (lambda nm) * 1000
            // w0^2 (um^2) = 10^-12 m^2. lambda (nm) = 10^-9 m.
            // zR (m) = pi * w0^2 / lambda
            const zR_mm = (PI * w0*w0) / (globalLambda * 1e-3); // um^2 / um -> um. Need result in mm. 
            // Wait: w0 in um, lambda in nm -> 0.001 um.
            // zR [um] = pi * w0^2 / (lambda_nm / 1000). 
            // Result in mm => divide by 1000.
            
            const zR_um = (PI * w0 * w0) / (globalLambda / 1000);
            const zR = zR_um / 1000;

            document.getElementById('res_gb_zr').innerText = zR.toFixed(2);
            
            const wz = w0 * Math.sqrt(1 + Math.pow(z/zR, 2));
            document.getElementById('res_gb_wz').innerText = wz.toFixed(1);
        }

        function calcSlab() {
            const t = parseFloat(document.getElementById('slab_t').value);
            const aoiDeg = parseFloat(document.getElementById('slab_aoi').value);
            const n = parseFloat(document.getElementById('slab_n').value);
            
            if(!t || !n) return;
            
            const theta = aoiDeg * PI / 180;
            // Displacement d = t * sin(theta) * (1 - cos(theta)/sqrt(n^2 - sin^2(theta)))
            const sinT = Math.sin(theta);
            const cosT = Math.cos(theta);
            const root = Math.sqrt(n*n - sinT*sinT);
            
            const d = t * sinT * (1 - cosT/root);
            document.getElementById('res_slab_d').innerText = d.toFixed(3);
        }

        function calcGrat() {
            const g = parseFloat(document.getElementById('grat_g').value); // lines/mm
            const aoi = parseFloat(document.getElementById('grat_aoi').value);
            const m = parseFloat(document.getElementById('grat_m').value);
            
            // sin(theta_m) = m * lambda * G - sin(theta_i)
            // lambda in mm = globalLambda * 1e-6
            // G in lines/mm
            
            const lambda_mm = globalLambda * 1e-6;
            const term = m * lambda_mm * g;
            const sin_out = term - Math.sin(aoi * PI / 180);
            
            if (sin_out > 1 || sin_out < -1) {
                document.getElementById('res_grat_a').innerText = "Evanescent";
            } else {
                const ang = Math.asin(sin_out) * 180 / PI;
                document.getElementById('res_grat_a').innerText = ang.toFixed(2);
            }
        }

        function getSellmeier(mat, lam_um) {
            // Simplified coeffs
            let n = 1.45;
            let gvd = 35; 
            
            const l2 = lam_um * lam_um;
            
            if(mat === 'fs') {
                // Fused Silica (approx)
                // B1=0.6961663, C1=0.0684043^2 ...
                // Quick approx for demo:
                n = Math.sqrt(1 + 0.696*l2/(l2-0.0046) + 0.407*l2/(l2-0.013) + 0.897*l2/(l2-97.9));
                // GVD approx for FS at 800nm is ~36 fs^2/mm
                // GVD = (lambda^3 / (2*pi*c^2)) * (d2n/dlambda2)
                // Simple fit for FS GVD in fs^2/mm approx: 
                // At 800nm ~ 36. At 1030nm ~ -20 (anomalous). Zero dispersion ~1270.
                // Linear approx for UI responsiveness if rigorous calc too heavy? 
                // Let's use a polynomial fit for FS GVD:
                gvd = 300 * (1.27 - lam_um) / 1.27; // Very rough toy model, but responsive
                if (lam_um > 0.4 && lam_um < 1.6) {
                    // Better fit for FS
                    gvd = 200 - 300 * lam_um + 80 * lam_um * lam_um; 
                }
            } else if (mat === 'bk7') {
                n = 1.51;
                gvd = 45; // Higher than FS
            } else if (mat === 'znse') {
                n = 2.4; 
                gvd = 100; // Large normal dispersion
            }
            return { n, gvd };
        }

        function calcDisp() {
            const mat = document.getElementById('mat_sel').value;
            const data = getSellmeier(mat, globalLambda/1000);
            
            document.getElementById('res_n').innerText = data.n.toFixed(3);
            document.getElementById('res_gvd').innerText = Math.abs(data.gvd).toFixed(1);
            
            // Calc Broadening
            const t0 = parseFloat(document.getElementById('mb_t0').value);
            const L = parseFloat(document.getElementById('mb_l').value);
            
            // T_out = T0 * sqrt(1 + (4 ln2 * GVD * L / T0^2)^2) 
            // Actually usually: tau_out = tau0 * sqrt(1 + (L/Ld)^2)
            // Ld = tau0^2 / (4 * ln2 * |beta2|) ? 
            // Standard Gaussian: t_out = t0 * sqrt(1 + (L / L_disp)^2)
            // where L_disp = t0^2 / (2.77 * |GVD|) approximately
            
            if (t0 > 0) {
                const gvd = Math.abs(data.gvd); // fs^2/mm
                // dispersion length Ld
                const Ld = (t0*t0) / (2.7725 * gvd); // 4*ln2 ~ 2.77
                
                const t_out = t0 * Math.sqrt(1 + Math.pow(L/Ld, 2));
                document.getElementById('res_mb_out').innerText = t_out.toFixed(1);
            }
        }

        function calcBint() {
            const I = parseFloat(document.getElementById('bi_int').value); // GW/cm2
            const L = parseFloat(document.getElementById('bi_l').value); // mm
            const n2 = parseFloat(document.getElementById('bi_n2').value); // x10-16 cm2/W
            
            // B = (2*pi / lambda) * n2 * I * L
            // Units: lambda in cm? 
            // n2 = 2.5e-16 cm2/W
            // I = 10 GW/cm2 = 10 * 10^9 W/cm2
            // L = 5 mm = 0.5 cm
            
            // n2_real = n2 * 1e-16
            // I_real = I * 1e9
            // L_cm = L / 10
            // lambda_cm = globalLambda * 1e-7
            
            if (!I || !L) return;

            const term = (2 * PI) / (globalLambda * 1e-7);
            const n2_I = (n2 * 1e-16) * (I * 1e9);
            const L_cm = L / 10;
            
            const B = term * n2_I * L_cm;
            document.getElementById('res_bi').innerText = B.toFixed(2);
        }

        function updateAll() {
            calcPulse();
            calcOpo();
            calcGb();
            calcSlab();
            calcGrat();
            calcDisp();
            calcBint();
        }

        function changeLanguage(lang) {
            const data = i18n[lang] || i18n.en;
            
            // Title & Subtitle
            document.getElementById('i18n-title').innerText = data.title;
            document.getElementById('i18n-subtitle').innerText = data.subtitle;
            document.getElementById('i18n-instr-title').innerText = data.instrTitle;
            document.getElementById('i18n-btn-share').innerText = data.btnShare;

            // Update Instructions HTML (NEW)
            if(data.instrContent) {
                document.getElementById('i18n-instr-content').innerHTML = data.instrContent;
            }

            // Update all IDs starting with i18n-
            const elements = document.querySelectorAll('[id^="i18n-"]');
            elements.forEach(el => {
                // Skip manually handled IDs
                if(['i18n-title', 'i18n-subtitle', 'i18n-btn-share', 'i18n-instr-title', 'i18n-instr-content'].includes(el.id)) return;

                const parts = el.id.split('-');
                if(parts.length >= 3) {
                    const key = parts[1] + parts[2].charAt(0).toUpperCase() + parts[2].slice(1);
                    if(data[key]) el.innerHTML = data[key];
                }
            });
        }

        async function copyToolLink() {
            try {
                await navigator.clipboard.writeText(window.location.href);
                const lang = document.getElementById('lang-select').value;
                
                // Show a nicer notification than alert
                const btn = document.querySelector('button[onclick="copyToolLink()"]');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<span class="text-green-600">âœ“</span>`;
                setTimeout(() => {
                    const data = i18n[lang] || i18n.en;
                    btn.innerHTML = `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg><span id="i18n-btn-share">${data.btnShare}</span>`;
                }, 2000);
                
            } catch (err) {
                console.error('Failed to copy', err);
            }
        }

        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
        }

        // Init
        window.onload = () => {
            const params = new URLSearchParams(window.location.search);
            const lang = params.get('lang') || 'en';
            const sel = document.getElementById('lang-select');
            if(sel) sel.value = lang;
            
            changeLanguage(lang);
            syncUnits('nm', 800); // Initialize with 800nm defaults
        };
    </script> 
    <!--  ç»“å°¾å¿…é¡»åŒ…å«çš„ä»£ç  -->
    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
</body>
</html>