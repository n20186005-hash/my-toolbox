<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amortization Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="amortization_calculator">
    <meta name="category" content="finance">
    <meta name="icon" content="ğŸ“‹">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Amortization Calculator">
    <meta name="description" content="Calculate loan amortization schedule and monthly payments.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="æ‘Šé”€è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="è®¡ç®—è´·æ¬¾æ‘Šé”€è¡¨å’Œæ¯æœˆè¿˜æ¬¾é¢ã€‚">
    
    <meta name="lang-title-zh-TW" content="æ”¤éŠ·è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="è¨ˆç®—è²¸æ¬¾æ”¤éŠ·è¡¨å’Œæ¯æœˆé‚„æ¬¾é¡ã€‚">
    
    <meta name="lang-title-ja" content="è¿”æ¸ˆè¨ˆç®—æ©Ÿ">
    <meta name="lang-description-ja" content="ãƒ­ãƒ¼ãƒ³ã®è¿”æ¸ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨æœˆã€…ã®æ”¯æ‰•ã„ã‚’è¨ˆç®—ã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ°Ğ¼Ğ¾Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸">
    <meta name="lang-description-ru" content="Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ°Ğ¼Ğ¾Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ° Ğ¸ ĞµĞ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸.">
    
    <meta name="lang-title-es" content="Calculadora de amortizaciÃ³n">
    <meta name="lang-description-es" content="Calcule el calendario de amortizaciÃ³n del prÃ©stamo y los pagos mensuales.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .amort-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .amort-table th, .amort-table td { border: 1px solid #ddd; padding: 8px; text-align: right; }
        .amort-table th { background-color: #f8f9fa; }
        .amort-table tr:nth-child(even) { background-color: #f8f9fa; }
        .scrollable { max-height: 300px; overflow-y: auto; margin-top: 10px; }
        /* å¢åŠ å¯¹ table å•å…ƒæ ¼çš„å·¦å³å¯¹é½æ§åˆ¶ï¼Œä»¥é€‚åº”ä¸­æ–‡ */
        .amort-table th:first-child, .amort-table td:first-child { text-align: center; }
        .text-left-align { text-align: left !important; }
    </style>
    <link rel="canonical" href="https://toolboxpro.top/modules/math/amortization-calculator.html" />

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body>

    <div class="tool-module active" 
         data-id="amortization_calculator" 
         data-category="finance" 
         data-title="Amortization Calculator" 
         data-icon="ğŸ“‹">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="amort-lang" onchange="AmortCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                <option value="es">EspaÃ±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ğŸ“‹ Amortization Calculator</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="loan_amount_label">Loan Amount</label>
                <!-- æ·»åŠ  oninput äº‹ä»¶ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ -->
                <input type="number" id="loan-amount" oninput="AmortCalc.debounceCalc()" class="w-full p-2 border rounded focus:ring-2 focus:ring-purple-500 outline-none" placeholder="e.g. 200000" min="0" step="any">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="interest_rate_label">Interest Rate (% per year)</label>
                <input type="number" id="interest-rate" oninput="AmortCalc.debounceCalc()" class="w-full p-2 border rounded focus:ring-2 focus:ring-purple-500 outline-none" placeholder="e.g. 4.5" min="0" step="0.01">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="loan_term_label">Loan Term (years)</label>
                <input type="number" id="loan-term" oninput="AmortCalc.debounceCalc()" class="w-full p-2 border rounded focus:ring-2 focus:ring-purple-500 outline-none" placeholder="e.g. 30" min="1" step="1">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="payments_year_label">Payments per Year</label>
                <!-- æ·»åŠ  onchange äº‹ä»¶ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ -->
                <select id="payments-year" onchange="AmortCalc.debounceCalc()" class="w-full p-2 border rounded focus:ring-2 focus:ring-purple-500 outline-none">
                    <option value="12">12 (Monthly)</option>
                    <option value="6">6 (Bi-monthly)</option>
                    <option value="4">4 (Quarterly)</option>
                    <option value="2">2 (Semi-annually)</option>
                    <option value="1">1 (Annually)</option>
                </select>
            </div>
        </div>

        <!-- ç§»é™¤ç‚¹å‡»æŒ‰é’®ï¼Œæ”¹ä¸ºè‡ªåŠ¨è®¡ç®—ä»¥æå‡æµç•…åº¦ï¼Œä½†ä¿ç•™æŒ‰é’®ä½œä¸ºæ‰‹åŠ¨è§¦å‘å¤‡ä»½ -->
        <button onclick="AmortCalc.calc()" class="w-full bg-purple-600 text-white py-2 rounded font-bold hover:bg-purple-700 transition mb-6" data-i18n="btn_calc">Calculate Amortization</button>

        <div class="bg-purple-50 p-6 rounded-lg border border-purple-100 mb-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <div class="text-sm text-gray-500 mb-1" data-i18n="monthly_payment_label">Payment per Period</div>
                    <div id="monthly-payment" class="text-xl font-bold text-purple-800">--</div>
                </div>
                <div>
                    <div class="text-sm text-gray-500 mb-1" data-i18n="total_principal_label">Total Principal Paid</div>
                    <div id="total-principal" class="text-xl font-bold text-purple-800">--</div>
                </div>
                <div>
                    <div class="text-sm text-gray-500 mb-1" data-i18n="total_interest_label">Total Interest Paid</div>
                    <div id="total-interest" class="text-xl font-bold text-purple-800">--</div>
                </div>
            </div>
            <div class="p-3 bg-white rounded border border-gray-100 text-left text-sm">
                <div data-i18n="formula_label" class="font-medium mb-1">Payment Formula: P = (r*PV) / (1 - (1+r)^-n)</div>
                <div id="amort-formula" class="text-gray-600">--</div>
                <div id="amort-message" class="text-green-600 mt-2"></div>
            </div>
        </div>

        <div>
            <h3 class="text-lg font-semibold mb-2" data-i18n="schedule_label">Amortization Schedule</h3>
            <div class="scrollable">
                <table class="amort-table">
                    <thead>
                        <tr>
                            <th data-i18n="period_header">Period</th>
                            <th data-i18n="payment_header">Payment</th>
                            <th data-i18n="principal_header">Principal</th>
                            <th data-i18n="interest_header">Interest</th>
                            <th data-i18n="balance_header">Remaining Balance</th>
                        </tr>
                    </thead>
                    <tbody id="amort-schedule">
                        <tr><td colspan="5" class="text-center" data-i18n="schedule_empty">Please calculate to see schedule</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const AmortCalc = {
            // ç¼“å­˜è®¡æ—¶å™¨ï¼Œç”¨äºé˜²æŠ–
            calcTimeout: null,
            // å­˜å‚¨å½“å‰è¯­è¨€
            currentLang: 'en',
            
            i18n: {
                'en': {
                    title: 'ğŸ“‹ Amortization Calculator',
                    loan_amount_label: 'Loan Amount',
                    interest_rate_label: 'Interest Rate (% per year)',
                    loan_term_label: 'Loan Term (years)',
                    payments_year_label: 'Payments per Year',
                    btn_calc: 'Calculate Amortization',
                    monthly_payment_label: 'Payment per Period',
                    total_principal_label: 'Total Principal Paid',
                    total_interest_label: 'Total Interest Paid',
                    formula_label: 'Payment Formula: P = (r*PV) / (1 - (1+r)^-n)',
                    schedule_label: 'Amortization Schedule',
                    period_header: 'Period',
                    payment_header: 'Payment',
                    principal_header: 'Principal',
                    interest_header: 'Interest',
                    balance_header: 'Remaining Balance',
                    schedule_empty: 'Please calculate to see schedule',
                    err_invalid: 'Please enter valid numbers',
                    schedule_truncated: (total) => `Schedule truncated. Showing first 50 and last 50 periods. Total periods: ${total}.`,
                    currency: '$'
                },
                'zh-CN': {
                    title: 'ğŸ“‹ æ‘Šé”€è®¡ç®—å™¨',
                    loan_amount_label: 'è´·æ¬¾é‡‘é¢',
                    interest_rate_label: 'å¹´åˆ©ç‡ï¼ˆ%ï¼‰',
                    loan_term_label: 'è´·æ¬¾æœŸé™ï¼ˆå¹´ï¼‰',
                    payments_year_label: 'æ¯å¹´è¿˜æ¬¾æ¬¡æ•°',
                    btn_calc: 'è®¡ç®—æ‘Šé”€',
                    monthly_payment_label: 'æ¯æœŸè¿˜æ¬¾é¢',
                    total_principal_label: 'æ€»æœ¬é‡‘æ”¯ä»˜',
                    total_interest_label: 'æ€»åˆ©æ¯æ”¯ä»˜',
                    formula_label: 'è¿˜æ¬¾å…¬å¼ï¼šæ¯æœŸè¿˜æ¬¾ = (æœŸåˆ©ç‡*è´·æ¬¾é‡‘é¢) / (1 - (1+æœŸåˆ©ç‡)^-æ€»æœŸæ•°)',
                    schedule_label: 'æ‘Šé”€è¡¨',
                    period_header: 'æœŸæ•°',
                    payment_header: 'è¿˜æ¬¾é¢',
                    principal_header: 'æœ¬é‡‘',
                    interest_header: 'åˆ©æ¯',
                    balance_header: 'å‰©ä½™æœ¬é‡‘',
                    schedule_empty: 'è¯·è®¡ç®—ä»¥æŸ¥çœ‹æ‘Šé”€è¡¨',
                    err_invalid: 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—',
                    schedule_truncated: (total) => `è¡¨æ ¼å·²æˆªæ–­ã€‚æ˜¾ç¤ºå‰50æœŸå’Œå50æœŸã€‚æ€»æœŸæ•°ï¼š${total}ã€‚`,
                    currency: 'Â¥'
                },
                'zh-TW': {
                    title: 'ğŸ“‹ æ”¤éŠ·è¨ˆç®—å™¨',
                    loan_amount_label: 'è²¸æ¬¾é‡‘é¡',
                    interest_rate_label: 'å¹´åˆ©ç‡ï¼ˆ%ï¼‰',
                    loan_term_label: 'è²¸æ¬¾æœŸé™ï¼ˆå¹´ï¼‰',
                    payments_year_label: 'æ¯å¹´é‚„æ¬¾æ¬¡æ•¸',
                    btn_calc: 'è¨ˆç®—æ”¤éŠ·',
                    monthly_payment_label: 'æ¯æœŸé‚„æ¬¾é¡',
                    total_principal_label: 'ç¸½æœ¬é‡‘æ”¯ä»˜',
                    total_interest_label: 'ç¸½åˆ©æ¯æ”¯ä»˜',
                    formula_label: 'é‚„æ¬¾å…¬å¼ï¼šæ¯æœŸé‚„æ¬¾ = (æœŸåˆ©ç‡*è²¸æ¬¾é‡‘é¡) / (1 - (1+æœŸåˆ©ç‡)^-ç¸½æœŸæ•¸)',
                    schedule_label: 'æ”¤éŠ·è¡¨',
                    period_header: 'æœŸæ•¸',
                    payment_header: 'é‚„æ¬¾é¡',
                    principal_header: 'æœ¬é‡‘',
                    interest_header: 'åˆ©æ¯',
                    balance_header: 'å‰©é¤˜æœ¬é‡‘',
                    schedule_empty: 'è«‹è¨ˆç®—ä»¥æŸ¥çœ‹æ”¤éŠ·è¡¨',
                    err_invalid: 'è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å­—',
                    schedule_truncated: (total) => `è¡¨æ ¼å·²æˆªæ–·ã€‚é¡¯ç¤ºå‰50æœŸå’Œå¾Œ50æœŸã€‚ç¸½æœŸæ•¸ï¼š${total}ã€‚`,
                    currency: 'NT$'
                },
                'ja': {
                    title: 'ğŸ“‹ è¿”æ¸ˆè¨ˆç®—æ©Ÿ',
                    loan_amount_label: 'ãƒ­ãƒ¼ãƒ³é‡‘é¡',
                    interest_rate_label: 'å¹´åˆ©ç‡ï¼ˆ%ï¼‰',
                    loan_term_label: 'ãƒ­ãƒ¼ãƒ³æœŸé–“ï¼ˆå¹´ï¼‰',
                    payments_year_label: 'å¹´é–“è¿”æ¸ˆå›æ•°',
                    btn_calc: 'è¿”æ¸ˆè¨ˆç®—',
                    monthly_payment_label: 'æ¯æœŸè¿”æ¸ˆé¡',
                    total_principal_label: 'ç·å…ƒæœ¬æ”¯æ‰•ã„',
                    total_interest_label: 'ç·åˆ©æ¯æ”¯æ‰•ã„',
                    formula_label: 'è¿”æ¸ˆå…¬å¼ï¼šæ¯æœŸè¿”æ¸ˆ = (æœŸåˆ©ç‡*ãƒ­ãƒ¼ãƒ³é‡‘é¡) / (1 - (1+æœŸåˆ©ç‡)^-ç·æœŸæ•°)',
                    schedule_label: 'è¿”æ¸ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«',
                    period_header: 'æœŸæ•°',
                    payment_header: 'è¿”æ¸ˆé¡',
                    principal_header: 'å…ƒæœ¬',
                    interest_header: 'åˆ©æ¯',
                    balance_header: 'æ®‹å…ƒæœ¬',
                    schedule_empty: 'è¨ˆç®—ã‚’å®Ÿè¡Œã—ã¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¡¨ç¤º',
                    err_invalid: 'æœ‰åŠ¹ãªæ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
                    schedule_truncated: (total) => `ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çŸ­ç¸®ã—ã¾ã—ãŸã€‚æœ€åˆã®50æœŸé–“ã¨æœ€å¾Œã®50æœŸé–“ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ç·æœŸé–“ï¼š${total}ã€‚`,
                    currency: 'Â¥'
                },
                'ru': {
                    title: 'ğŸ“‹ ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ°Ğ¼Ğ¾Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸',
                    loan_amount_label: 'Ğ¡ÑƒĞ¼Ğ¼Ğ° ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ°',
                    interest_rate_label: 'ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ½Ğ°Ñ ÑÑ‚Ğ°Ğ²ĞºĞ° (% Ğ² Ğ³Ğ¾Ğ´)',
                    loan_term_label: 'Ğ¡Ñ€Ğ¾Ğº ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ° (Ğ»ĞµÑ‚)',
                    payments_year_label: 'ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ Ğ² Ğ³Ğ¾Ğ´',
                    btn_calc: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ°Ğ¼Ğ¾Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ',
                    monthly_payment_label: 'ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ Ğ·Ğ° Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´',
                    total_principal_label: 'Ğ’ÑĞµĞ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½Ğ¾ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾Ğ»Ğ³Ğ°',
                    total_interest_label: 'Ğ’ÑĞµĞ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½Ğ¾ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ¾Ğ²',
                    formula_label: 'Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°: ĞŸ = (Ğ¿*Ğ¡Ğš) / (1 - (1+Ğ¿)^-Ğ¿)',
                    schedule_label: 'Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ°Ğ¼Ğ¾Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸',
                    period_header: 'ĞŸĞµÑ€Ğ¸Ğ¾Ğ´',
                    payment_header: 'ĞŸĞ»Ğ°Ñ‚ĞµĞ¶',
                    principal_header: 'ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ´Ğ¾Ğ»Ğ³',
                    interest_header: 'ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚Ñ‹',
                    balance_header: 'ĞÑÑ‚Ğ°Ğ²ÑˆĞ¸Ğ¹ÑÑ Ğ´Ğ¾Ğ»Ğ³',
                    schedule_empty: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº',
                    err_invalid: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‡Ğ¸ÑĞ»Ğ°',
                    schedule_truncated: (total) => `Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº ÑƒÑĞµÑ‡ĞµĞ½. ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ğ½Ñ‹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 50 Ğ¸ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 50 Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ¾Ğ². Ğ’ÑĞµĞ³Ğ¾ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ¾Ğ²: ${total}.`,
                    currency: 'â‚½'
                },
                'es': {
                    title: 'ğŸ“‹ Calculadora de amortizaciÃ³n',
                    loan_amount_label: 'Monto del prÃ©stamo',
                    interest_rate_label: 'Tasa de interÃ©s (% anual)',
                    loan_term_label: 'Plazo del prÃ©stamo (aÃ±os)',
                    payments_year_label: 'Pagos por aÃ±o',
                    btn_calc: 'Calcular amortizaciÃ³n',
                    monthly_payment_label: 'Pago por perÃ­odo',
                    total_principal_label: 'Total pagado en principal',
                    total_interest_label: 'Total pagado en intereses',
                    formula_label: 'FÃ³rmula de pago: P = (t*VP) / (1 - (1+t)^-n)',
                    schedule_label: 'Calendario de amortizaciÃ³n',
                    period_header: 'Periodo',
                    payment_header: 'Pago',
                    principal_header: 'Principal',
                    interest_header: 'Intereses',
                    balance_header: 'Saldo restante',
                    schedule_empty: 'Por favor, calcule para ver el calendario',
                    err_invalid: 'Por favor, ingrese nÃºmeros vÃ¡lidos',
                    schedule_truncated: (total) => `Calendario truncado. Mostrando los primeros 50 y los Ãºltimos 50 perÃ­odos. Total de perÃ­odos: ${total}.`,
                    currency: 'â‚¬'
                }
            },

            init: () => {
                // åˆå§‹åŒ–ç¤ºä¾‹å€¼
                document.getElementById('loan-amount').value = 200000;
                document.getElementById('interest-rate').value = 4.5;
                document.getElementById('loan-term').value = 30;
                document.getElementById('payments-year').value = 12;

                // åˆå§‹è®¡ç®—
                AmortCalc.calc();
            },
            
            // æ€§èƒ½ä¼˜åŒ–ï¼šé˜²æŠ–å‡½æ•°ï¼Œé¿å…è¾“å…¥æ—¶è¿ç»­è§¦å‘ calc é€ æˆå¡é¡¿
            debounceCalc: function() {
                clearTimeout(this.calcTimeout);
                this.calcTimeout = setTimeout(this.calc, 300); // å»¶è¿Ÿ 300ms åæ‰§è¡Œè®¡ç®—
            },

            // è¯­è¨€åˆ‡æ¢
            changeLang: () => {
                const lang = document.getElementById('amort-lang').value;
                AmortCalc.currentLang = lang; // æ›´æ–°å½“å‰è¯­è¨€
                const texts = AmortCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="amortization_calculator"] [data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key] && typeof texts[key] === 'string') {
                        el.innerText = texts[key];
                    }
                });

                // é‡æ–°è®¡ç®—ä»¥æ›´æ–°ç»“æœå’Œæ¶ˆæ¯çš„è¯­è¨€
                AmortCalc.calc();
            },

            // æ ¸å¿ƒè®¡ç®—å‡½æ•°
            calc: () => {
                const loanAmount = parseFloat(document.getElementById('loan-amount').value) || 0;
                const annualRate = parseFloat(document.getElementById('interest-rate').value) / 100 || 0;
                const years = parseFloat(document.getElementById('loan-term').value) || 0;
                const paymentsPerYear = parseInt(document.getElementById('payments-year').value) || 12;
                const texts = AmortCalc.i18n[AmortCalc.currentLang];
                const currency = texts.currency;

                const paymentEl = document.getElementById('monthly-payment');
                const principalEl = document.getElementById('total-principal');
                const interestEl = document.getElementById('total-interest');
                const formulaEl = document.getElementById('amort-formula');
                const scheduleEl = document.getElementById('amort-schedule');
                const messageEl = document.getElementById('amort-message');


                // éªŒè¯è¾“å…¥
                if (isNaN(loanAmount) || isNaN(annualRate) || isNaN(years) || years <= 0 || loanAmount <= 0) {
                    paymentEl.innerText = texts.err_invalid;
                    paymentEl.className = "text-xl font-bold text-red-600";
                    principalEl.innerText = "--";
                    interestEl.innerText = "--";
                    formulaEl.innerText = "";
                    messageEl.innerText = "";
                    scheduleEl.innerHTML = `<tr><td colspan="5" class="text-center">${texts.err_invalid}</td></tr>`;
                    return;
                }

                // è´·æ¬¾å‚æ•°
                const ratePerPeriod = annualRate / paymentsPerYear;
                const totalPayments = years * paymentsPerYear;
                
                // P = (r*PV) / (1 - (1+r)^-n)
                let monthlyPayment = 0;
                
                if (ratePerPeriod > 0) {
                    monthlyPayment = (ratePerPeriod * loanAmount) / (1 - Math.pow(1 + ratePerPeriod, -totalPayments));
                } else {
                    // é›¶åˆ©ç‡è®¡ç®—
                    monthlyPayment = loanAmount / totalPayments;
                }
                
                const totalPaid = monthlyPayment * totalPayments;
                const totalInterest = totalPaid - loanAmount;

                // æ˜¾ç¤ºç»“æœ
                paymentEl.className = "text-xl font-bold text-purple-800";
                principalEl.className = "text-xl font-bold text-purple-800";
                interestEl.className = "text-xl font-bold text-purple-800";
                
                paymentEl.innerText = `${currency}${monthlyPayment.toFixed(2)}`;
                principalEl.innerText = `${currency}${loanAmount.toFixed(2)}`;
                interestEl.innerText = `${currency}${totalInterest.toFixed(2)}`;
                
                // æ˜¾ç¤ºè®¡ç®—å…¬å¼
                formulaEl.innerText = `${currency}${monthlyPayment.toFixed(2)} = (${(ratePerPeriod*100).toFixed(4)}% * ${currency}${loanAmount.toFixed(2)}) / (1 - (1+${(ratePerPeriod*100).toFixed(4)}%)^-${totalPayments})`;
                
                // --- æ€§èƒ½ä¼˜åŒ–ï¼šç”Ÿæˆæ‘Šé”€è¡¨ (é™åˆ¶è¡Œæ•°) ---
                let remainingBalance = loanAmount;
                let scheduleHtml = '';
                const displayLimit = 50; // æ˜¾ç¤ºå¼€å¤´å’Œç»“å°¾çš„æœŸæ•°
                const shouldTruncate = totalPayments > (displayLimit * 2 + 1);
                
                messageEl.innerText = shouldTruncate ? texts.schedule_truncated(totalPayments) : '';
                messageEl.className = shouldTruncate ? "text-green-600 mt-2" : "";

                for (let i = 1; i <= totalPayments; i++) {
                    let interestPayment = remainingBalance * ratePerPeriod;
                    let principalPayment = monthlyPayment - interestPayment;
                    
                    // ç¡®ä¿æœ€åä¸€æœŸè¿˜æ¸…ï¼Œé¿å…æµ®ç‚¹æ•°è¯¯å·®
                    if (i === totalPayments) {
                        principalPayment = remainingBalance; // æœ€åä¸€æœŸçš„æœ¬é‡‘ç­‰äºå‰©ä½™æœ¬é‡‘
                        monthlyPayment = principalPayment + interestPayment; // æœ€åä¸€æœŸçš„è¿˜æ¬¾é¢
                        remainingBalance = 0;
                    } else {
                        remainingBalance = remainingBalance - principalPayment;
                        // ä¿®æ­£æµ®ç‚¹æ•°è¯¯å·®ï¼Œç¡®ä¿ä½™é¢ä¸ä¸ºè´Ÿä¸”å°æ•°ç‚¹åä¸¤ä½ç²¾åº¦
                        remainingBalance = parseFloat(remainingBalance.toFixed(2));
                        if (remainingBalance < 0) remainingBalance = 0;
                    }
                    
                    // ä»…åœ¨éœ€è¦æ˜¾ç¤ºçš„è¡Œæ•°èŒƒå›´å†…ç”Ÿæˆ HTML
                    if (i <= displayLimit || (shouldTruncate && i > totalPayments - displayLimit)) {
                        scheduleHtml += `
                            <tr>
                                <td class="text-center">${i}</td>
                                <td>${currency}${monthlyPayment.toFixed(2)}</td>
                                <td>${currency}${principalPayment.toFixed(2)}</td>
                                <td>${currency}${interestPayment.toFixed(2)}</td>
                                <td>${currency}${remainingBalance.toFixed(2)}</td>
                            </tr>
                        `;
                    }
                    
                    // æ’å…¥çœç•¥å·
                    if (shouldTruncate && i === displayLimit) {
                        scheduleHtml += `<tr><td colspan="5" class="text-center">...</td></tr>`;
                        // è·³åˆ°æœ€åä¸€éƒ¨åˆ†
                        i = totalPayments - displayLimit;
                    }
                }
                
                // ä¸€æ¬¡æ€§æ›´æ–° DOMï¼Œé¿å…å¡é¡¿
                scheduleEl.innerHTML = scheduleHtml;
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // è‡ªåŠ¨åŒ¹é…æµè§ˆå™¨è¯­è¨€
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            AmortCalc.currentLang = targetLang; // è®¾ç½®åˆå§‹è¯­è¨€
            
            const langSelect = document.getElementById('amort-lang');
            if(langSelect) {
                langSelect.value = targetLang;
                AmortCalc.changeLang();
            } else {
                AmortCalc.init(); // å¦‚æœæ²¡æœ‰é€‰æ‹©å™¨ï¼Œåˆ™åªåˆå§‹åŒ–æ•°æ®å¹¶è®¡ç®—
            }
        });
    </script>


    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
    

    <div id="toolbox-seo-wrapper-unique-id" class="max-w-4xl mx-auto px-4"></div>
    <script src="/scripts/seo-loader.js"></script>

</body>
</html>