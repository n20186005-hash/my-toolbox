<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Language Dew Point Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="dew_point_calc">
    <meta name="category" content="weather">
    <meta name="icon" content="ğŸ’§">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Dew Point Calculator">
    <meta name="description" content="Calculate the dew point temperature based on current temperature and relative humidity.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="éœ²ç‚¹è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="æ ¹æ®å½“å‰æ¸©åº¦å’Œç›¸å¯¹æ¹¿åº¦è®¡ç®—éœ²ç‚¹æ¸©åº¦ã€‚">
    <meta name="lang-title-zh-TW" content="éœ²é»è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="æ ¹æ“šç•¶å‰æº«åº¦å’Œç›¸å°æ¿•åº¦è¨ˆç®—éœ²é»æº«åº¦ã€‚">
    <meta name="lang-title-ja" content="éœ²ç‚¹è¨ˆç®—ãƒ„ãƒ¼ãƒ«">
    <meta name="lang-description-ja" content="ç¾åœ¨ã®æ¸©åº¦ã¨ç›¸å¯¾æ¹¿åº¦ã«åŸºã¥ã„ã¦éœ²ç‚¹æ¸©åº¦ã‚’è¨ˆç®—ã—ã¾ã™ã€‚">
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ¾ÑÑ‹">
    <meta name="lang-description-ru" content="Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ¹Ñ‚Ğµ Ñ‚ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ñƒ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ¾ÑÑ‹ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ñ‚ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ñ‹ Ğ¸ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ²Ğ»Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸.">
    <meta name="lang-title-es" content="Calculadora de Punto de RocÃ­o">
    <meta name="lang-description-es" content="Calcule la temperatura del punto de rocÃ­o a partir de la temperatura actual y la humedad relativa.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—ä½“å¹¶åº”ç”¨åŸºç¡€æ ·å¼ */
        body { font-family: 'Inter', sans-serif; background: #f0f4f8; }
        .tool-module { 
            background: white; 
            padding: 32px; 
            border-radius: 16px; 
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); 
            max-width: 500px; 
            margin: 40px auto; 
            position: relative; 
            border: 1px solid #cbd5e1;
        }
        .unit-toggle-group {
            display: inline-flex;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        .unit-toggle-group button {
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            background-color: #f7fafc;
            color: #4b5563;
        }
        .unit-toggle-group button.active {
            background-color: #3b82f6; /* Blue 500 */
            color: white;
            z-index: 10;
        }
        .unit-toggle-group button:hover:not(.active) {
            background-color: #e2e8f0;
        }
    </style>
</head>
<body>

    <div class="tool-module active" data-id="dew_point_calc">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4 z-10">
            <select id="dp-lang" onchange="DewPointCalc.changeLang()" class="text-xs border border-gray-300 rounded-lg p-1 bg-white text-gray-600 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                <option value="es">EspaÃ±ol</option>
            </select>
        </div>

        <h2 class="text-3xl font-extrabold mb-8 text-gray-900 flex items-center" data-i18n="title">
            <span class="mr-3 text-blue-500 text-4xl">ğŸ’§</span>Dew Point Calculator
        </h2>
        
        <!-- è¾“å…¥ç»„ - æ¸©åº¦ -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="label_temp">Air Temperature</label>
            <div class="flex">
                <input type="number" id="dp-temp" class="flex-grow p-3 border border-r-0 border-gray-300 rounded-l-lg focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="e.g., 25" value="25">
                <div class="unit-toggle-group">
                    <button id="temp-unit-c" onclick="DewPointCalc.setTempUnit('C')" class="active">Â°C</button>
                    <button id="temp-unit-f" onclick="DewPointCalc.setTempUnit('F')">Â°F</button>
                </div>
            </div>
            <div id="temp-error" class="text-xs text-red-500 mt-1 h-3"></div>
        </div>

        <!-- è¾“å…¥ç»„ - ç›¸å¯¹æ¹¿åº¦ -->
        <div class="mb-8">
            <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="label_rh">Relative Humidity</label>
            <div class="flex">
                <input type="number" id="dp-rh" class="flex-grow p-3 border border-r-0 border-gray-300 rounded-l-lg focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="e.g., 60" value="60">
                <span class="p-3 bg-gray-100 border border-gray-300 rounded-r-lg text-gray-700 font-semibold">%</span>
            </div>
            <div id="rh-error" class="text-xs text-red-500 mt-1 h-3"></div>
        </div>
        
        <button onclick="DewPointCalc.calc()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition duration-150 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50" data-i18n="btn_calc">Calculate Dew Point</button>

        <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
        <div class="bg-teal-50 p-6 rounded-xl border border-teal-300 text-center mt-8">
            <div class="text-lg text-teal-700 mb-2 font-semibold" data-i18n="res_label">Dew Point Temperature</div>
            <div id="dp-result" class="text-5xl font-extrabold text-teal-800 break-all">-- Â°C</div>
        </div>
    </div>

    <script>
        const DewPointCalc = {
            // å›½é™…åŒ–æ–‡æœ¬å­—å…¸
            i18n: {
                'en': {
                    title: 'ğŸ’§ Dew Point Calculator',
                    label_temp: 'Air Temperature',
                    label_rh: 'Relative Humidity (0-100)',
                    btn_calc: 'Calculate Dew Point',
                    res_label: 'Dew Point Temperature',
                    err_temp_missing: 'Please enter a valid temperature.',
                    err_rh_invalid: 'Relative Humidity must be between 0 and 100.',
                },
                'zh-CN': {
                    title: 'ğŸ’§ éœ²ç‚¹è®¡ç®—å™¨',
                    label_temp: 'ç©ºæ°”æ¸©åº¦',
                    label_rh: 'ç›¸å¯¹æ¹¿åº¦ (0-100)',
                    btn_calc: 'è®¡ç®—éœ²ç‚¹',
                    res_label: 'éœ²ç‚¹æ¸©åº¦',
                    err_temp_missing: 'è¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„æ¸©åº¦å€¼ã€‚',
                    err_rh_invalid: 'ç›¸å¯¹æ¹¿åº¦å¿…é¡»ä»‹äº 0 åˆ° 100 ä¹‹é—´ã€‚',
                },
                'zh-TW': {
                    title: 'ğŸ’§ éœ²é»è¨ˆç®—å™¨',
                    label_temp: 'ç©ºæ°£æº«åº¦',
                    label_rh: 'ç›¸å°æ¿•åº¦ (0-100)',
                    btn_calc: 'è¨ˆç®—éœ²é»',
                    res_label: 'éœ²é»æº«åº¦',
                    err_temp_missing: 'è«‹è¼¸å…¥ä¸€å€‹æœ‰æ•ˆçš„æº«åº¦å€¼ã€‚',
                    err_rh_invalid: 'ç›¸å°æ¿•åº¦å¿…é ˆä»‹æ–¼ 0 åˆ° 100 ä¹‹é–“ã€‚',
                },
                'ja': {
                    title: 'ğŸ’§ éœ²ç‚¹è¨ˆç®—ãƒ„ãƒ¼ãƒ«',
                    label_temp: 'æ°—æ¸©',
                    label_rh: 'ç›¸å¯¾æ¹¿åº¦ (0-100)',
                    btn_calc: 'éœ²ç‚¹ã‚’è¨ˆç®—ã™ã‚‹',
                    res_label: 'éœ²ç‚¹æ¸©åº¦',
                    err_temp_missing: 'æœ‰åŠ¹ãªæ°—æ¸©ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
                    err_rh_invalid: 'ç›¸å¯¾æ¹¿åº¦ã¯0ã‹ã‚‰100ã®é–“ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚',
                },
                'ru': {
                    title: 'ğŸ’§ ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ¾ÑÑ‹',
                    label_temp: 'Ğ¢ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ğ° Ğ²Ğ¾Ğ·Ğ´ÑƒÑ…Ğ°',
                    label_rh: 'ĞÑ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ²Ğ»Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ (0-100)',
                    btn_calc: 'Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ñ‡ĞºÑƒ Ñ€Ğ¾ÑÑ‹',
                    res_label: 'Ğ¢ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ğ° Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ¾ÑÑ‹',
                    err_temp_missing: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½ÑƒÑ Ñ‚ĞµĞ¼Ğ¿ĞµÑ€Ğ°Ñ‚ÑƒÑ€Ñƒ.',
                    err_rh_invalid: 'ĞÑ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ²Ğ»Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ğ² Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğµ Ğ¾Ñ‚ 0 Ğ´Ğ¾ 100.',
                },
                'es': {
                    title: 'ğŸ’§ Calculadora de Punto de RocÃ­o',
                    label_temp: 'Temperatura del Aire',
                    label_rh: 'Humedad Relativa (0-100)',
                    btn_calc: 'Calcular Punto de RocÃ­o',
                    res_label: 'Temperatura del Punto de RocÃ­o',
                    err_temp_missing: 'Por favor, ingrese una temperatura vÃ¡lida.',
                    err_rh_invalid: 'La Humedad Relativa debe estar entre 0 y 100.',
                }
            },
            
            // å½“å‰æ¸©åº¦å•ä½çŠ¶æ€
            currentUnit: 'C',

            // è®¾ç½®æ¸©åº¦å•ä½å¹¶åˆ‡æ¢æŒ‰é’®æ ·å¼
            setTempUnit: (unit) => {
                if (DewPointCalc.currentUnit === unit) return;

                // åˆ‡æ¢æŒ‰é’®æ ·å¼
                document.getElementById('temp-unit-c').classList.remove('active');
                document.getElementById('temp-unit-f').classList.remove('active');
                document.getElementById(`temp-unit-${unit.toLowerCase()}`).classList.add('active');

                // è½¬æ¢è¾“å…¥å€¼ (å¦‚æœéœ€è¦)
                const tempInput = document.getElementById('dp-temp');
                let tempValue = parseFloat(tempInput.value);

                if (!isNaN(tempValue)) {
                    if (DewPointCalc.currentUnit === 'C' && unit === 'F') {
                        // C to F: T_F = T_C * 9/5 + 32
                        tempValue = tempValue * 9 / 5 + 32;
                    } else if (DewPointCalc.currentUnit === 'F' && unit === 'C') {
                        // F to C: T_C = (T_F - 32) * 5/9
                        tempValue = (tempValue - 32) * 5 / 9;
                    }
                    // æ›´æ–°è¾“å…¥æ¡†ï¼Œä¿ç•™ä¸¤ä½å°æ•°
                    tempInput.value = tempValue.toFixed(2);
                }

                DewPointCalc.currentUnit = unit;
                DewPointCalc.calc(); // é‡æ–°è®¡ç®—å¹¶æ›´æ–°ç»“æœå•ä½
            },

            // åˆ‡æ¢è¯­è¨€
            changeLang: () => {
                const lang = document.getElementById('dp-lang').value;
                const texts = DewPointCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="dew_point_calc"] [data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerHTML = texts[key];
                });

                // é‡æ–°è®¡ç®—ä»¥æ›´æ–°ç»“æœå•ä½çš„è¯­è¨€
                DewPointCalc.calc();
            },

            // æ‰§è¡Œè®¡ç®—
            calc: () => {
                const lang = document.getElementById('dp-lang').value;
                const texts = DewPointCalc.i18n[lang];
                
                const tempInput = document.getElementById('dp-temp');
                const rhInput = document.getElementById('dp-rh');
                const resultEl = document.getElementById('dp-result');
                const tempErrorEl = document.getElementById('temp-error');
                const rhErrorEl = document.getElementById('rh-error');
                
                // æ¸…ç©ºé”™è¯¯ä¿¡æ¯
                tempErrorEl.innerText = '';
                rhErrorEl.innerText = '';
                resultEl.innerText = `-- ${DewPointCalc.currentUnit}`;

                const tempValueRaw = parseFloat(tempInput.value);
                const rhValue = parseFloat(rhInput.value);

                // --- 1. è¾“å…¥éªŒè¯ ---

                if (isNaN(tempValueRaw)) {
                    tempErrorEl.innerText = texts.err_temp_missing;
                    return;
                }

                if (isNaN(rhValue) || rhValue < 0 || rhValue > 100) {
                    rhErrorEl.innerText = texts.err_rh_invalid;
                    return;
                }

                // --- 2. æ ¸å¿ƒè®¡ç®— (Magnus-Tetensè¿‘ä¼¼å…¬å¼) ---
                
                // å°†è¾“å…¥æ¸©åº¦è½¬æ¢ä¸ºæ‘„æ°åº¦ (C) è¿›è¡Œè®¡ç®—
                let T_C;
                if (DewPointCalc.currentUnit === 'F') {
                    // F to C: T_C = (T_F - 32) * 5/9
                    T_C = (tempValueRaw - 32) * 5 / 9;
                } else {
                    T_C = tempValueRaw;
                }

                const RH = rhValue / 100; // ç›¸å¯¹æ¹¿åº¦ (0.0 to 1.0)

                // Magnu-Tetens å…¬å¼å¸¸æ•° (é€‚ç”¨äº C)
                const A = 17.27;
                const B = 237.7;
                
                // é¥±å’Œæ°´æ±½å‹ E_s(T) çš„ä¸­é—´é¡¹ (Gamma)
                const gamma = (A * T_C) / (B + T_C) + Math.log(RH);

                // éœ²ç‚¹æ¸©åº¦ T_dp
                // T_dp = (B * gamma) / (A - gamma)
                let T_dp_C = (B * gamma) / (A - gamma);

                // --- 3. ç»“æœè½¬æ¢å’Œæ˜¾ç¤º ---

                let finalResult;
                let unitSymbol;

                if (DewPointCalc.currentUnit === 'F') {
                    // C to F: T_F = T_C * 9/5 + 32
                    finalResult = T_dp_C * 9 / 5 + 32;
                    unitSymbol = 'Â°F';
                } else {
                    finalResult = T_dp_C;
                    unitSymbol = 'Â°C';
                }

                // ç»“æœä¿ç•™ä¸¤ä½å°æ•°
                resultEl.innerText = `${finalResult.toFixed(2)} ${unitSymbol}`;
            }
        };

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // ç¡®ä¿é¡µé¢åŠ è½½åï¼Œè¯­è¨€å’Œåˆå§‹è®¡ç®—æ˜¯æ­£ç¡®çš„
            DewPointCalc.changeLang();
            
            // å°è¯•è‡ªåŠ¨åŒ¹é…æµè§ˆå™¨è¯­è¨€
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            const langSelect = document.getElementById('dp-lang');
            if(langSelect && targetLang !== 'en') {
                const optionExists = Array.from(langSelect.options).some(option => option.value === targetLang);
                if (optionExists) {
                    langSelect.value = targetLang;
                    DewPointCalc.changeLang();
                }
            }

            // ç»‘å®šè¾“å…¥äº‹ä»¶åˆ°è®¡ç®—å‡½æ•°
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('change', DewPointCalc.calc);
                input.addEventListener('input', DewPointCalc.calc);
            });
            
            // åˆå§‹è®¡ç®—ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼çš„ç»“æœ
            DewPointCalc.calc();
        });
    </script>

</body>
</html>