<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; background-color: #f3f4f6; }
        
        /* Ê†áÁ≠æÈ°µÊ†∑Âºè */
        .nav-btn { position: relative; transition: all 0.3s; }
        .nav-btn.active { color: #2563eb; background-color: #eff6ff; }
        .nav-btn.active::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background-color: #2563eb; border-radius: 3px 3px 0 0;
        }

        /* Âä®Áîª */
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ËæìÂÖ•Ê°ÜÂéªÁÆ≠Â§¥ */
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        
        /* Ë°®Ê†ºÊªöÂä®Êù° */
        .custom-scroll::-webkit-scrollbar { height: 6px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex flex-col">

    <div class="max-w-6xl mx-auto w-full flex-grow">
        
        <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 mb-6 sticky top-2 z-20">
            <div class="flex flex-col md:flex-row justify-between items-center p-3 md:px-6">
                <!-- Logo & Title -->
                <div class="flex items-center gap-3 mb-3 md:mb-0 w-full md:w-auto">
                    <div class="bg-gradient-to-br from-blue-600 to-indigo-600 text-white p-2.5 rounded-lg shadow-md">
                        <i class="fa-solid fa-earth-americas text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-gray-800 leading-tight" data-i18n="app_title">E-Commerce</h1>
                        <p class="text-xs text-gray-400" data-i18n="app_subtitle">Global Operations Assistant</p>
                    </div>
                </div>

                <!-- Controls -->
                <div class="flex items-center gap-3 w-full md:w-auto justify-between md:justify-end">
                    <!-- Tab Switcher (Mobile optimized) -->
                    <div class="flex bg-gray-100 p-1 rounded-lg">
                        <button onclick="App.switchTab('bid')" id="nav-bid" class="nav-btn active px-4 py-1.5 rounded-md text-sm font-medium text-gray-500 hover:text-gray-700 flex items-center gap-2">
                            <i class="fa-solid fa-calculator"></i> <span data-i18n="tab_bid">Bid Calc</span>
                        </button>
                        <button onclick="App.switchTab('roi')" id="nav-roi" class="nav-btn px-4 py-1.5 rounded-md text-sm font-medium text-gray-500 hover:text-gray-700 flex items-center gap-2">
                            <i class="fa-solid fa-chart-pie"></i> <span data-i18n="tab_roi">ROI Sim</span>
                        </button>
                    </div>

                    <!-- Language Selector -->
                    <div class="relative group">
                        <select id="lang-select" onchange="I18nModule.changeLanguage(this.value)" class="appearance-none bg-white border border-gray-200 text-gray-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 pr-8 cursor-pointer font-medium hover:border-blue-300 transition">
                            <option value="zh-CN">üá®üá≥ ÁÆÄ‰Ωì‰∏≠Êñá</option>
                            <option value="zh-TW">üá≠üá∞ ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="en">üá∫üá∏ English</option>
                            <option value="ja">üáØüáµ Êó•Êú¨Ë™û</option>
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500">
                            <i class="fa-solid fa-chevron-down text-xs"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
        <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden min-h-[600px] relative">
            
            <!-- Ê®°Âùó 1: ÂÖ≥ÈîÆËØçÂá∫‰ª∑ (Bid Module) -->
            <div id="view-bid" class="fade-in p-6 md:p-8">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-full">
                    <!-- Â∑¶‰æß: ËæìÂÖ• -->
                    <div class="lg:col-span-4 flex flex-col gap-6">
                        <div class="bg-blue-50 p-6 rounded-2xl border border-blue-100 shadow-sm">
                            <h3 class="text-lg font-bold text-gray-800 mb-5 flex items-center gap-2">
                                <i class="fa-solid fa-sliders text-blue-500"></i> <span data-i18n="params_title">Parameters</span>
                            </h3>
                            
                            <div class="space-y-4">
                                <div class="group">
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="bid_label">Bid Amount</label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400"><i class="fa-solid fa-tag"></i></div>
                                        <input type="number" id="bid-base" step="0.01" class="w-full pl-9 pr-3 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition bg-white" placeholder="0.00">
                                    </div>
                                </div>

                                <div class="group">
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="premium_label">Crowd Premium (%)</label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400"><i class="fa-solid fa-users"></i></div>
                                        <input type="number" id="bid-premium" step="1" class="w-full pl-9 pr-3 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition bg-white" placeholder="0">
                                    </div>
                                </div>

                                <div class="group">
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="discount_label">Time Discount (%)</label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400"><i class="fa-solid fa-clock"></i></div>
                                        <input type="number" id="bid-discount" step="1" value="100" class="w-full pl-9 pr-3 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition bg-white" placeholder="100">
                                    </div>
                                </div>

                                <button onclick="BidModule.calculate()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-lg hover:shadow-blue-500/30 transition-all transform active:scale-95 mt-2 flex justify-center items-center gap-2 group">
                                    <i class="fa-solid fa-bolt group-hover:animate-pulse"></i> <span data-i18n="btn_calc">Calculate</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- ÊèêÁ§∫Âç°Áâá -->
                        <div class="bg-gray-50 p-4 rounded-xl border border-gray-100 text-xs text-gray-500 leading-relaxed">
                            <i class="fa-solid fa-circle-info text-blue-400 mr-1"></i> <span data-i18n="bid_formula_hint">Formula: Final = Base * (1 + Premium%) * (Discount%)</span>
                        </div>
                    </div>

                    <!-- Âè≥‰æß: ÂàóË°® -->
                    <div class="lg:col-span-8 flex flex-col h-full">
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800" data-i18n="history_title">Calculation History</h3>
                                <p class="text-sm text-gray-400 mt-1" data-i18n="history_subtitle">Local records, safe & private.</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="App.exportCSV('bid')" class="text-xs font-medium text-blue-600 hover:text-blue-800 px-3 py-2 bg-blue-50 rounded-lg hover:bg-blue-100 transition flex items-center gap-1">
                                    <i class="fa-solid fa-download"></i> <span data-i18n="btn_export">Export</span>
                                </button>
                                <button onclick="App.clearData('bid')" class="text-xs font-medium text-red-500 hover:text-red-700 px-3 py-2 bg-red-50 rounded-lg hover:bg-red-100 transition flex items-center gap-1">
                                    <i class="fa-regular fa-trash-can"></i> <span data-i18n="btn_clear">Clear</span>
                                </button>
                            </div>
                        </div>

                        <div class="flex-grow overflow-hidden rounded-xl border border-gray-200 bg-white relative">
                            <div class="absolute inset-0 overflow-auto custom-scroll">
                                <table class="w-full text-sm text-left text-gray-600">
                                    <thead class="text-xs text-gray-500 uppercase bg-gray-50/80 sticky top-0 backdrop-blur-sm z-10">
                                        <tr>
                                            <th class="px-5 py-3 font-semibold" data-i18n="col_base">Base Bid</th>
                                            <th class="px-5 py-3 font-semibold" data-i18n="col_premium">Premium</th>
                                            <th class="px-5 py-3 font-semibold" data-i18n="col_discount">Discount</th>
                                            <th class="px-5 py-3 font-semibold text-blue-600" data-i18n="col_final">Final</th>
                                            <th class="px-5 py-3 text-center" data-i18n="col_action">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bid-list" class="divide-y divide-gray-100">
                                        <!-- Data Injected Here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê®°Âùó 2: ROI Ê®°Êãü (ROI Module) -->
            <div id="view-roi" class="fade-in hidden p-6 md:p-8">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-full">
                    <!-- Â∑¶‰æß: ËæìÂÖ• -->
                    <div class="lg:col-span-4 flex flex-col gap-6">
                        <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100 shadow-sm">
                            <h3 class="text-lg font-bold text-gray-800 mb-5 flex items-center gap-2">
                                <i class="fa-solid fa-coins text-indigo-500"></i> <span data-i18n="cost_title">Cost Structure</span>
                            </h3>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="col-span-2">
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_price">Selling Price</label>
                                    <input type="number" id="roi-price" step="0.01" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="0.00">
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_cost">Product Cost</label>
                                    <input type="number" id="roi-cost" step="0.01" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_rate">Platform (%)</label>
                                    <input type="number" id="roi-rate" step="0.1" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="5.0">
                                </div>

                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_misc">Misc/Pack</label>
                                    <input type="number" id="roi-pack" step="0.01" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_ship">Shipping</label>
                                    <input type="number" id="roi-ship" step="0.01" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="0.00">
                                </div>

                                <div class="col-span-2">
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1" data-i18n="roi_gift">Gift Cost</label>
                                    <input type="number" id="roi-gift" step="0.01" value="0" class="w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition bg-white" placeholder="0.00">
                                </div>
                            </div>

                            <button onclick="RoiModule.calculate()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 rounded-xl shadow-lg hover:shadow-indigo-500/30 transition-all transform active:scale-95 mt-6 flex justify-center items-center gap-2 group">
                                <i class="fa-solid fa-wand-magic-sparkles group-hover:animate-spin-slow"></i> <span data-i18n="btn_simulate">Simulate</span>
                            </button>
                        </div>
                    </div>

                    <!-- Âè≥‰æß: ÂàóË°® -->
                    <div class="lg:col-span-8 flex flex-col h-full">
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800" data-i18n="sim_result_title">Simulation Results</h3>
                                <p class="text-sm text-gray-400 mt-1" data-i18n="sim_subtitle">Find your breakeven point.</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="App.exportCSV('roi')" class="text-xs font-medium text-blue-600 hover:text-blue-800 px-3 py-2 bg-blue-50 rounded-lg hover:bg-blue-100 transition flex items-center gap-1">
                                    <i class="fa-solid fa-download"></i> <span data-i18n="btn_export">Export</span>
                                </button>
                                <button onclick="App.clearData('roi')" class="text-xs font-medium text-red-500 hover:text-red-700 px-3 py-2 bg-red-50 rounded-lg hover:bg-red-100 transition flex items-center gap-1">
                                    <i class="fa-regular fa-trash-can"></i> <span data-i18n="btn_clear">Clear</span>
                                </button>
                            </div>
                        </div>

                        <div class="flex-grow overflow-hidden rounded-xl border border-gray-200 bg-white relative">
                            <div class="absolute inset-0 overflow-auto custom-scroll">
                                <table class="w-full text-sm text-left text-gray-600">
                                    <thead class="text-xs text-gray-500 uppercase bg-gray-50/80 sticky top-0 backdrop-blur-sm z-10">
                                        <tr>
                                            <th class="px-4 py-3 font-semibold" data-i18n="col_price">Price</th>
                                            <th class="px-4 py-3 font-semibold" data-i18n="col_costs">Costs</th>
                                            <th class="px-4 py-3 font-semibold" data-i18n="col_margin">Margin</th>
                                            <th class="px-4 py-3 font-semibold text-indigo-600" data-i18n="col_breakeven">Breakeven ROI</th>
                                            <th class="px-4 py-3 text-center" data-i18n="col_action">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="roi-list" class="divide-y divide-gray-100">
                                        <!-- Data Injected -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        
        <div class="text-center mt-6 text-gray-400 text-xs">
            &copy; 2024 Global E-Commerce Tools. All calculations are performed locally.
        </div>
    </div>

    <script>
        /**
         * Ê®°Âùó 1: ÂõΩÈôÖÂåñ (I18N Module)
         * ÁÆ°ÁêÜÂ§öËØ≠Ë®ÄÊï∞ÊçÆÂíåÁïåÈù¢ÊñáÊú¨ÊõøÊç¢
         */
        const I18nModule = {
            currentLang: 'zh-CN',
            
            data: {
                'zh-CN': {
                    app_title: 'ÁîµÂ≠êÂïÜÂä°',
                    app_subtitle: 'ÂÖ®ÁêÉÁîµÂïÜËøêËê•ËæÖÂä©Âä©Êâã',
                    tab_bid: 'ÂÖ≥ÈîÆËØçÂá∫‰ª∑',
                    tab_roi: '‰øùÊú¨ROIÊ®°Êãü',
                    params_title: 'ÂèÇÊï∞ËÆæÁΩÆ',
                    bid_label: 'ÂÖ≥ÈîÆËØçÂá∫‰ª∑',
                    premium_label: '‰∫∫Áæ§Ê∫¢‰ª∑ (%)',
                    discount_label: 'Êó∂Èó¥ÊäòÊâ£ (%)',
                    btn_calc: 'ÂºÄÂßãËÆ°ÁÆó',
                    bid_formula_hint: 'ÂÖ¨ÂºèÔºöÊúÄÁªàÂá∫‰ª∑ = Âü∫Á°ÄÂá∫‰ª∑ √ó (1 + Ê∫¢‰ª∑%) √ó (Êó∂Èó¥ÊäòÊâ£%)',
                    history_title: 'ËÆ°ÁÆóËÆ∞ÂΩï',
                    history_subtitle: 'Êï∞ÊçÆ‰øùÂ≠òÂú®Êú¨Âú∞ÊµèËßàÂô®‰∏≠',
                    btn_export: 'ÂØºÂá∫Ë°®Ê†º',
                    btn_clear: 'Ê∏ÖÁ©∫',
                    col_base: 'Âü∫Á°ÄÂá∫‰ª∑',
                    col_premium: 'Ê∫¢‰ª∑',
                    col_discount: 'ÊäòÊâ£',
                    col_final: 'ÊúÄÁªàÂá∫‰ª∑',
                    col_action: 'Êìç‰Ωú',
                    cost_title: 'ÊàêÊú¨ÁªìÊûÑ',
                    roi_price: 'ÈîÄÂîÆ‰ª∑Ê†º',
                    roi_cost: '‰∫ßÂìÅÊàêÊú¨',
                    roi_rate: 'Âπ≥Âè∞Êâ£ÁÇπ (%)',
                    roi_misc: 'ÂåÖË£Ö/ÊùÇË¥π',
                    roi_ship: 'Âπ≥ÂùáËøêË¥π',
                    roi_gift: 'Ëµ†ÂìÅÊàêÊú¨',
                    btn_simulate: 'ÂºÄÂßãÊ®°Êãü',
                    sim_result_title: 'Ê®°ÊãüÁªìÊûú',
                    sim_subtitle: 'ÂØªÊâæ‰Ω†ÁöÑÁõà‰∫èÂπ≥Ë°°ÁÇπ',
                    col_price: 'ÂîÆ‰ª∑',
                    col_costs: 'ÊÄªÁ°¨ÊàêÊú¨',
                    col_margin: 'ÊØõÂà©',
                    col_breakeven: '‰øùÊú¨ROI',
                    empty_data: 'ÊöÇÊó†Êï∞ÊçÆÔºåËØ∑Âú®Â∑¶‰æßËæìÂÖ•ÂèÇÊï∞Âπ∂ËÆ°ÁÆó„ÄÇ',
                    loss_label: '‰∫èÊçü'
                },
                'zh-TW': {
                    app_title: 'ÈõªÂ≠êÂïÜÂãô',
                    app_subtitle: 'ÂÖ®ÁêÉÈõªÂïÜÈÅãÁáüËºîÂä©Âä©Êâã',
                    tab_bid: 'ÈóúÈçµÂ≠óÂá∫ÂÉπ',
                    tab_roi: '‰øùÊú¨ROIÊ®°Êì¨',
                    params_title: 'ÂèÉÊï∏Ë®≠ÁΩÆ',
                    bid_label: 'ÈóúÈçµÂ≠óÂá∫ÂÉπ',
                    premium_label: '‰∫∫Áæ§Ê∫¢ÂÉπ (%)',
                    discount_label: 'ÊôÇÈñìÊäòÊâ£ (%)',
                    btn_calc: 'ÈñãÂßãË®àÁÆó',
                    bid_formula_hint: 'ÂÖ¨ÂºèÔºöÊúÄÁµÇÂá∫ÂÉπ = Âü∫Á§éÂá∫ÂÉπ √ó (1 + Ê∫¢ÂÉπ%) √ó (ÊôÇÈñìÊäòÊâ£%)',
                    history_title: 'Ë®àÁÆóË®òÈåÑ',
                    history_subtitle: 'Êï∏Êìö‰øùÂ≠òÂú®Êú¨Âú∞ÁÄèË¶ΩÂô®‰∏≠',
                    btn_export: 'Â∞éÂá∫Ë°®Ê†º',
                    btn_clear: 'Ê∏ÖÁ©∫',
                    col_base: 'Âü∫Á§éÂá∫ÂÉπ',
                    col_premium: 'Ê∫¢ÂÉπ',
                    col_discount: 'ÊäòÊâ£',
                    col_final: 'ÊúÄÁµÇÂá∫ÂÉπ',
                    col_action: 'Êìç‰Ωú',
                    cost_title: 'ÊàêÊú¨ÁµêÊßã',
                    roi_price: 'Èä∑ÂîÆÂÉπÊ†º',
                    roi_cost: 'Áî¢ÂìÅÊàêÊú¨',
                    roi_rate: 'Âπ≥Âè∞Êâ£Èªû (%)',
                    roi_misc: 'ÂåÖË£ù/ÈõúË≤ª',
                    roi_ship: 'Âπ≥ÂùáÈÅãË≤ª',
                    roi_gift: 'Ë¥àÂìÅÊàêÊú¨',
                    btn_simulate: 'ÈñãÂßãÊ®°Êì¨',
                    sim_result_title: 'Ê®°Êì¨ÁµêÊûú',
                    sim_subtitle: 'Â∞ãÊâæ‰Ω†ÁöÑÁõàËôßÂπ≥Ë°°Èªû',
                    col_price: 'ÂîÆÂÉπ',
                    col_costs: 'Á∏ΩÁ°¨ÊàêÊú¨',
                    col_margin: 'ÊØõÂà©',
                    col_breakeven: '‰øùÊú¨ROI',
                    empty_data: 'Êö´ÁÑ°Êï∏ÊìöÔºåË´ãÂú®Â∑¶ÂÅ¥Ëº∏ÂÖ•ÂèÉÊï∏‰∏¶Ë®àÁÆó„ÄÇ',
                    loss_label: 'ËôßÊêç'
                },
                'en': {
                    app_title: 'E-Commerce',
                    app_subtitle: 'Global Operations Assistant',
                    tab_bid: 'Bid Calculator',
                    tab_roi: 'ROI Simulator',
                    params_title: 'Parameters',
                    bid_label: 'Base Bid',
                    premium_label: 'Crowd Premium (%)',
                    discount_label: 'Time Discount (%)',
                    btn_calc: 'Calculate',
                    bid_formula_hint: 'Formula: Final = Base * (1 + Premium%) * (Discount%)',
                    history_title: 'History',
                    history_subtitle: 'Stored locally in your browser',
                    btn_export: 'Export CSV',
                    btn_clear: 'Clear',
                    col_base: 'Base',
                    col_premium: 'Premium',
                    col_discount: 'Discount',
                    col_final: 'Final Bid',
                    col_action: 'Action',
                    cost_title: 'Cost Structure',
                    roi_price: 'Selling Price',
                    roi_cost: 'Product Cost',
                    roi_rate: 'Platform Fee (%)',
                    roi_misc: 'Misc/Pack',
                    roi_ship: 'Shipping',
                    roi_gift: 'Gift Cost',
                    btn_simulate: 'Simulate',
                    sim_result_title: 'Results',
                    sim_subtitle: 'Find your Breakeven Point',
                    col_price: 'Price',
                    col_costs: 'Total Cost',
                    col_margin: 'Margin',
                    col_breakeven: 'Breakeven ROI',
                    empty_data: 'No data yet. Enter parameters to start.',
                    loss_label: 'LOSS'
                },
                'ja': {
                    app_title: 'E„Ç≥„Éû„Éº„Çπ',
                    app_subtitle: '„Ç∞„É≠„Éº„Éê„É´ÈÅãÁî®„Ç¢„Ç∑„Çπ„Çø„É≥„Éà',
                    tab_bid: 'ÂÖ•Êú≠Ë®àÁÆóÊ©ü',
                    tab_roi: 'ÊêçÁõäROI',
                    params_title: '„Éë„É©„É°„Éº„ÇøË®≠ÂÆö',
                    bid_label: 'Âü∫Êú¨ÂÖ•Êú≠È°ç',
                    premium_label: '„Çø„Éº„Ç≤„ÉÉ„ÉàÂâ≤Â¢ó (%)',
                    discount_label: 'ÊôÇÈñìÂ∏ØÂâ≤Âºï (%)',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã',
                    bid_formula_hint: 'ÂºèÔºöÊúÄÁµÇ = Âü∫Êú¨ √ó (1 + Ââ≤Â¢ó%) √ó (Ââ≤Âºï%)',
                    history_title: 'Ë®àÁÆóÂ±•Ê≠¥',
                    history_subtitle: '„Éá„Éº„Çø„ÅØ„Éñ„É©„Ç¶„Ç∂„Å´‰øùÂ≠ò„Åï„Çå„Åæ„Åô',
                    btn_export: 'CSVÂá∫Âäõ',
                    btn_clear: '„ÇØ„É™„Ç¢',
                    col_base: 'Âü∫Êú¨È°ç',
                    col_premium: 'Ââ≤Â¢ó',
                    col_discount: 'Ââ≤Âºï',
                    col_final: 'ÊúÄÁµÇÂÖ•Êú≠',
                    col_action: 'Êìç‰Ωú',
                    cost_title: '„Ç≥„Çπ„ÉàÊßãÈÄ†',
                    roi_price: 'Ë≤©Â£≤‰æ°Ê†º',
                    roi_cost: 'Ë£ΩÂìÅÂéü‰æ°',
                    roi_rate: 'ÊâãÊï∞Êñô (%)',
                    roi_misc: 'Ê¢±ÂåÖ/ÈõëË≤ª',
                    roi_ship: 'Âπ≥ÂùáÈÄÅÊñô',
                    roi_gift: '„ÇÆ„Éï„ÉàÂéü‰æ°',
                    btn_simulate: '„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                    sim_result_title: 'ÁµêÊûú‰∏ÄË¶ß',
                    sim_subtitle: 'ÊêçÁõäÂàÜÂ≤êÁÇπ„ÇíË¶ã„Å§„Åë„Çã',
                    col_price: '‰æ°Ê†º',
                    col_costs: 'Á∑è„Ç≥„Çπ„Éà',
                    col_margin: 'Á≤óÂà©Áõä',
                    col_breakeven: 'ÊêçÁõäÂàÜÂ≤êROI',
                    empty_data: '„Éá„Éº„Çø„Å™„Åó„ÄÇÂ∑¶ÂÅ¥„Åß„Éë„É©„É°„Éº„Çø„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                    loss_label: 'Ëµ§Â≠ó'
                },
                'ru': {
                    app_title: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º–µ—Ä—Ü–∏—è',
                    app_subtitle: '–ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π',
                    tab_bid: '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç–∞–≤–æ–∫',
                    tab_roi: '–°–∏–º—É–ª—è—Ç–æ—Ä ROI',
                    params_title: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã',
                    bid_label: '–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞',
                    premium_label: '–ü—Ä–µ–º–∏—É–º –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (%)',
                    discount_label: '–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∫–∏–¥–∫–∞ (%)',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                    bid_formula_hint: '–§–æ—Ä–º—É–ª–∞: –ò—Ç–æ–≥ = –ë–∞–∑–∞ * (1 + –ü—Ä–µ–º%) * (–°–∫–∏–¥–∫–∞%)',
                    history_title: '–ò—Å—Ç–æ—Ä–∏—è',
                    history_subtitle: '–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ',
                    btn_export: '–≠–∫—Å–ø–æ—Ä—Ç',
                    btn_clear: '–û—á–∏—Å—Ç–∏—Ç—å',
                    col_base: '–ë–∞–∑–∞',
                    col_premium: '–ü—Ä–µ–º–∏—É–º',
                    col_discount: '–°–∫–∏–¥–∫–∞',
                    col_final: '–ò—Ç–æ–≥',
                    col_action: '–î–µ–π—Å—Ç–≤–∏–µ',
                    cost_title: '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤',
                    roi_price: '–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏',
                    roi_cost: '–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å',
                    roi_rate: '–ö–æ–º–∏—Å—Å–∏—è (%)',
                    roi_misc: '–£–ø–∞–∫–æ–≤–∫–∞/–ü—Ä–æ—á–µ–µ',
                    roi_ship: '–î–æ—Å—Ç–∞–≤–∫–∞',
                    roi_gift: '–ü–æ–¥–∞—Ä–æ–∫',
                    btn_simulate: '–°–∏–º—É–ª—è—Ü–∏—è',
                    sim_result_title: '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã',
                    sim_subtitle: '–ü–æ–∏—Å–∫ —Ç–æ—á–∫–∏ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏',
                    col_price: '–¶–µ–Ω–∞',
                    col_costs: '–†–∞—Å—Ö–æ–¥—ã',
                    col_margin: '–ú–∞—Ä–∂–∞',
                    col_breakeven: 'ROI (–ë–µ–∑—É–±—ã—Ç–æ–∫)',
                    empty_data: '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.',
                    loss_label: '–£–±—ã—Ç–æ–∫'
                }
            },

            init: () => {
                // Auto detect or load saved
                const saved = localStorage.getItem('app_lang');
                if (saved && I18nModule.data[saved]) {
                    I18nModule.currentLang = saved;
                } else {
                    const navLang = navigator.language;
                    if (navLang.startsWith('zh')) I18nModule.currentLang = navLang.includes('TW') || navLang.includes('HK') ? 'zh-TW' : 'zh-CN';
                    else if (navLang.startsWith('ja')) I18nModule.currentLang = 'ja';
                    else if (navLang.startsWith('ru')) I18nModule.currentLang = 'ru';
                    else I18nModule.currentLang = 'en';
                }
                document.getElementById('lang-select').value = I18nModule.currentLang;
                I18nModule.apply();
            },

            changeLanguage: (lang) => {
                I18nModule.currentLang = lang;
                localStorage.setItem('app_lang', lang);
                I18nModule.apply();
                // Re-render lists to update status text (like "Loss") if needed
                BidModule.render();
                RoiModule.render();
            },

            apply: () => {
                const texts = I18nModule.data[I18nModule.currentLang];
                
                // Update document Title (Metadata)
                document.title = texts['app_title'];

                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) {
                        if (el.tagName === 'INPUT') el.placeholder = texts[key];
                        else el.innerText = texts[key];
                    }
                });
                document.documentElement.lang = I18nModule.currentLang;
            },

            t: (key) => {
                return I18nModule.data[I18nModule.currentLang][key] || key;
            }
        };

        /**
         * Ê®°Âùó 2: Â≠òÂÇ®‰∏éÁä∂ÊÄÅ (Storage Module)
         */
        const StorageModule = {
            get: (key) => JSON.parse(localStorage.getItem(key)) || [],
            set: (key, data) => localStorage.setItem(key, JSON.stringify(data))
        };

        /**
         * Ê®°Âùó 3: Âá∫‰ª∑ËÆ°ÁÆó (Bid Module)
         */
        const BidModule = {
            data: [],
            
            init: () => {
                BidModule.data = StorageModule.get('bid_history');
                BidModule.render();
            },

            calculate: () => {
                const base = parseFloat(document.getElementById('bid-base').value);
                const premium = parseFloat(document.getElementById('bid-premium').value) || 0;
                const discount = parseFloat(document.getElementById('bid-discount').value);

                if (isNaN(base)) return alert(I18nModule.t('empty_data')); // Simplified error
                if (isNaN(discount)) return;

                const final = base * (1 + premium / 100) * (discount / 100);

                const record = {
                    id: Date.now(),
                    base: base.toFixed(2),
                    premium: premium,
                    discount: discount,
                    final: final.toFixed(2)
                };

                BidModule.data.unshift(record);
                if (BidModule.data.length > 50) BidModule.data.pop();
                
                StorageModule.set('bid_history', BidModule.data);
                BidModule.render();
            },

            delete: (id) => {
                BidModule.data = BidModule.data.filter(item => item.id !== id);
                StorageModule.set('bid_history', BidModule.data);
                BidModule.render();
            },

            clear: () => {
                if(confirm(I18nModule.t('btn_clear') + "?")) {
                    BidModule.data = [];
                    StorageModule.set('bid_history', BidModule.data);
                    BidModule.render();
                }
            },

            render: () => {
                const tbody = document.getElementById('bid-list');
                if (BidModule.data.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="5" class="px-6 py-12 text-center text-gray-400 italic">${I18nModule.t('empty_data')}</td></tr>`;
                    return;
                }
                
                tbody.innerHTML = BidModule.data.map(item => `
                    <tr class="hover:bg-blue-50/50 transition border-b border-gray-50 last:border-0">
                        <td class="px-5 py-3 font-mono">¬•${item.base}</td>
                        <td class="px-5 py-3 text-gray-500">${item.premium}%</td>
                        <td class="px-5 py-3 text-gray-500">${item.discount}%</td>
                        <td class="px-5 py-3 font-bold text-blue-600">¬•${item.final}</td>
                        <td class="px-5 py-3 text-center">
                            <button onclick="BidModule.delete(${item.id})" class="text-gray-300 hover:text-red-500 transition px-2">
                                <i class="fa-solid fa-xmark"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
        };

        /**
         * Ê®°Âùó 4: ROI ËÆ°ÁÆó (ROI Module)
         */
        const RoiModule = {
            data: [],
            
            init: () => {
                RoiModule.data = StorageModule.get('roi_history');
                RoiModule.render();
            },

            calculate: () => {
                const inputs = ['roi-price', 'roi-cost', 'roi-rate', 'roi-pack', 'roi-ship', 'roi-gift'];
                const vals = {};
                for (let id of inputs) {
                    vals[id] = parseFloat(document.getElementById(id).value) || 0;
                }

                if (vals['roi-price'] <= 0) return alert(I18nModule.t('empty_data'));

                const fee = vals['roi-price'] * (vals['roi-rate'] / 100);
                const totalCost = vals['roi-cost'] + fee + vals['roi-pack'] + vals['roi-ship'] + vals['roi-gift'];
                const margin = vals['roi-price'] - totalCost;
                
                let roiDisplay = "";
                let isLoss = false;

                if (margin <= 0) {
                    roiDisplay = I18nModule.t('loss_label');
                    isLoss = true;
                } else {
                    const roi = vals['roi-price'] / margin;
                    roiDisplay = roi.toFixed(2);
                }

                const record = {
                    id: Date.now(),
                    price: vals['roi-price'].toFixed(2),
                    cost: totalCost.toFixed(2), // Storing Total Hard Cost for simple display
                    margin: margin.toFixed(2),
                    roi: roiDisplay,
                    isLoss: isLoss
                };

                RoiModule.data.unshift(record);
                if (RoiModule.data.length > 50) RoiModule.data.pop();

                StorageModule.set('roi_history', RoiModule.data);
                RoiModule.render();
            },

            delete: (id) => {
                RoiModule.data = RoiModule.data.filter(item => item.id !== id);
                StorageModule.set('roi_history', RoiModule.data);
                RoiModule.render();
            },

            clear: () => {
                if(confirm(I18nModule.t('btn_clear') + "?")) {
                    RoiModule.data = [];
                    StorageModule.set('roi_history', RoiModule.data);
                    RoiModule.render();
                }
            },

            render: () => {
                const tbody = document.getElementById('roi-list');
                if (RoiModule.data.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="5" class="px-6 py-12 text-center text-gray-400 italic">${I18nModule.t('empty_data')}</td></tr>`;
                    return;
                }

                const lossText = I18nModule.t('loss_label');

                tbody.innerHTML = RoiModule.data.map(item => {
                    // Handle translated text for existing records if language changed
                    const displayRoi = item.isLoss ? lossText : item.roi;
                    const roiClass = item.isLoss ? 'text-red-500 bg-red-50 px-2 py-1 rounded' : 'text-indigo-600 font-bold';

                    return `
                    <tr class="hover:bg-indigo-50/50 transition border-b border-gray-50 last:border-0">
                        <td class="px-4 py-3 font-medium">¬•${item.price}</td>
                        <td class="px-4 py-3 text-gray-500 text-xs">¬•${item.cost}</td>
                        <td class="px-4 py-3 ${item.margin > 0 ? 'text-green-600' : 'text-red-400'}">¬•${item.margin}</td>
                        <td class="px-4 py-3"><span class="${roiClass}">${displayRoi}</span></td>
                        <td class="px-4 py-3 text-center">
                            <button onclick="RoiModule.delete(${item.id})" class="text-gray-300 hover:text-red-500 transition px-2">
                                <i class="fa-solid fa-xmark"></i>
                            </button>
                        </td>
                    </tr>
                `}).join('');
            }
        };

        /**
         * Ê®°Âùó 5: ‰∏ªÁ®ãÂ∫è (App Module)
         * UI ‰∫§‰∫í‰∏éÁªüÁ≠π
         */
        const App = {
            init: () => {
                I18nModule.init();
                BidModule.init();
                RoiModule.init();
            },

            switchTab: (tab) => {
                // UI
                document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
                document.getElementById(`nav-${tab}`).classList.add('active');

                // View
                document.getElementById('view-bid').classList.add('hidden');
                document.getElementById('view-roi').classList.add('hidden');
                
                const view = document.getElementById(`view-${tab}`);
                view.classList.remove('hidden');
                view.classList.add('fade-in');
            },

            exportCSV: (type) => {
                const list = type === 'bid' ? BidModule.data : RoiModule.data;
                if (list.length === 0) return alert(I18nModule.t('empty_data'));

                let csv = "data:text/csv;charset=utf-8,\uFEFF";
                
                if (type === 'bid') {
                    csv += `Base,Premium,Discount,Final\n`;
                    list.forEach(i => csv += `${i.base},${i.premium},${i.discount},${i.final}\n`);
                } else {
                    csv += `Price,TotalCost,Margin,ROI\n`;
                    list.forEach(i => csv += `${i.price},${i.cost},${i.margin},${i.isLoss ? 'LOSS' : i.roi}\n`);
                }

                const link = document.createElement("a");
                link.href = encodeURI(csv);
                link.download = `export_${type}_${Date.now()}.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            },
            
            clearData: (type) => {
                if (type === 'bid') BidModule.clear();
                else RoiModule.clear();
            }
        };

        // ÂêØÂä®Â∫îÁî®
        document.addEventListener('DOMContentLoaded', App.init);

    </script>
</body>
</html>