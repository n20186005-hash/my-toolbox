<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Date Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #ecfeff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .tab-btn { padding: 8px 16px; font-size: 0.9em; border-radius: 20px; color: #666; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; }
        .tab-btn.active { background-color: #0891b2; color: white; border-color: #0891b2; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="date_calc" 
         data-category="date" 
         data-title="Date Calculator" 
         data-icon="üìÖ">
        
        <div class="absolute top-4 right-4">
            <select id="dc-lang" onchange="DateCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">üìÖ Date Calculator</h2>
        
        <div class="flex justify-center gap-2 mb-6">
            <button class="tab-btn active" onclick="DateCalc.setMode('add')" data-i18n="tab_add">Add/Subtract</button>
            <button class="tab-btn" onclick="DateCalc.setMode('diff')" data-i18n="tab_diff">Date Difference</button>
        </div>

        <!-- Mode 1: Add/Subtract Days -->
        <div id="dc-mode-add" class="mode-box">
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_start">Start Date</label>
                <input type="date" id="dc-start-add" class="w-full p-2 border rounded focus:ring-2 focus:ring-cyan-500 outline-none">
            </div>

            <div class="flex gap-4 mb-4">
                <div class="w-1/3">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_op">Operation</label>
                    <select id="dc-op" class="w-full p-2 border rounded bg-white">
                        <option value="add" data-i18n="op_add">Add (+)</option>
                        <option value="sub" data-i18n="op_sub">Subtract (-)</option>
                    </select>
                </div>
                <div class="w-2/3">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_duration">Years / Months / Weeks / Days</label>
                    <div class="grid grid-cols-4 gap-2">
                        <input type="number" id="dc-y" class="p-2 border rounded text-center" placeholder="Y">
                        <input type="number" id="dc-m" class="p-2 border rounded text-center" placeholder="M">
                        <input type="number" id="dc-w" class="p-2 border rounded text-center" placeholder="W">
                        <input type="number" id="dc-d" class="p-2 border rounded text-center" placeholder="D">
                    </div>
                </div>
            </div>
            
            <button onclick="DateCalc.calcAdd()" class="w-full bg-cyan-600 text-white py-2 rounded font-bold hover:bg-cyan-700 transition" data-i18n="btn_calc">Calculate New Date</button>
            
            <div class="mt-4 p-4 bg-cyan-50 rounded text-center">
                <span class="text-gray-500 text-sm block" data-i18n="res_date">Result Date</span>
                <div id="res-add-date" class="text-2xl font-bold text-cyan-800">--</div>
            </div>
        </div>

        <!-- Mode 2: Date Difference -->
        <div id="dc-mode-diff" class="mode-box hidden">
             <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_start">Start Date</label>
                <input type="date" id="dc-start-diff" class="w-full p-2 border rounded focus:ring-2 focus:ring-cyan-500 outline-none">
            </div>
             <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_end">End Date</label>
                <input type="date" id="dc-end-diff" class="w-full p-2 border rounded focus:ring-2 focus:ring-cyan-500 outline-none">
            </div>

            <button onclick="DateCalc.calcDiff()" class="w-full bg-cyan-600 text-white py-2 rounded font-bold hover:bg-cyan-700 transition" data-i18n="btn_diff">Calculate Difference</button>

            <div class="mt-4 p-4 bg-cyan-50 rounded text-center">
                <span class="text-gray-500 text-sm block" data-i18n="res_diff">Difference</span>
                <div id="res-diff-days" class="text-2xl font-bold text-cyan-800 mb-1">--</div>
                <div id="res-diff-detail" class="text-sm text-gray-600"></div>
            </div>
        </div>

    </div>

    <script>
        const DateCalc = {
            i18n: {
                'en': {
                    title: 'üìÖ Date Calculator',
                    tab_add: 'Add/Subtract', tab_diff: 'Date Difference',
                    lbl_start: 'Start Date', lbl_end: 'End Date',
                    lbl_op: 'Operation', op_add: 'Add (+)', op_sub: 'Subtract (-)',
                    lbl_duration: 'Y / M / W / D',
                    btn_calc: 'Calculate New Date', btn_diff: 'Calculate Difference',
                    res_date: 'Result Date', res_diff: 'Difference',
                    txt_days: 'Days',
                    fmt_detail: '{y} years {m} months {d} days'
                },
                'zh-CN': {
                    title: 'üìÖ Êó•ÊúüËÆ°ÁÆóÂô®',
                    tab_add: 'Êó•ÊúüÊé®ÁÆó', tab_diff: 'Êó•ÊúüÂ∑Æ',
                    lbl_start: 'ÂºÄÂßãÊó•Êúü', lbl_end: 'ÁªìÊùüÊó•Êúü',
                    lbl_op: 'Êìç‰Ωú', op_add: 'Âä†‰∏ä (+)', op_sub: 'ÂáèÂéª (-)',
                    lbl_duration: 'Âπ¥ / Êúà / Âë® / Â§©',
                    btn_calc: 'ËÆ°ÁÆóÊñ∞Êó•Êúü', btn_diff: 'ËÆ°ÁÆóÂ§©Êï∞Â∑Æ',
                    res_date: 'ÁªìÊûúÊó•Êúü', res_diff: 'Áõ∏Â∑ÆÂ§©Êï∞',
                    txt_days: 'Â§©',
                    fmt_detail: '{y} Âπ¥ {m} ‰∏™Êúà {d} Â§©'
                },
                'zh-TW': {
                    title: 'üìÖ Êó•ÊúüË®àÁÆóÂô®',
                    tab_add: 'Êó•ÊúüÊé®ÁÆó', tab_diff: 'Êó•ÊúüÂ∑Æ',
                    lbl_start: 'ÈñãÂßãÊó•Êúü', lbl_end: 'ÁµêÊùüÊó•Êúü',
                    lbl_op: 'Êìç‰Ωú', op_add: 'Âä†‰∏ä (+)', op_sub: 'Ê∏õÂéª (-)',
                    lbl_duration: 'Âπ¥ / Êúà / ÈÄ± / Â§©',
                    btn_calc: 'Ë®àÁÆóÊñ∞Êó•Êúü', btn_diff: 'Ë®àÁÆóÂ§©Êï∏Â∑Æ',
                    res_date: 'ÁµêÊûúÊó•Êúü', res_diff: 'Áõ∏Â∑ÆÂ§©Êï∏',
                    txt_days: 'Â§©',
                    fmt_detail: '{y} Âπ¥ {m} ÂÄãÊúà {d} Â§©'
                },
                'ja': {
                    title: 'üìÖ Êó•‰ªòË®àÁÆó',
                    tab_add: 'Êó•‰ªò„ÅÆÂä†Ê∏õ', tab_diff: 'Êó•Êï∞Ë®àÁÆó',
                    lbl_start: 'ÈñãÂßãÊó•', lbl_end: 'ÁµÇ‰∫ÜÊó•',
                    lbl_op: 'Êìç‰Ωú', op_add: 'Ë∂≥„Åô (+)', op_sub: 'Âºï„Åè (-)',
                    lbl_duration: 'Âπ¥ / Êúà / ÈÄ± / Êó•',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã', btn_diff: 'Â∑ÆÂàÜ„ÇíË®àÁÆó',
                    res_date: 'ÁµêÊûú', res_diff: 'ÊúüÈñì',
                    txt_days: 'Êó•',
                    fmt_detail: '{y} Âπ¥ {m} „É∂Êúà {d} Êó•'
                },
                'ru': {
                    title: 'üìÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–∞—Ç',
                    tab_add: '–ü—Ä–∏–±–∞–≤–∏—Ç—å/–í—ã—á–µ—Å—Ç—å', tab_diff: '–†–∞–∑–Ω–∏—Ü–∞ –¥–∞—Ç',
                    lbl_start: '–ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞', lbl_end: '–ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞',
                    lbl_op: '–î–µ–π—Å—Ç–≤–∏–µ', op_add: '–ü—Ä–∏–±–∞–≤–∏—Ç—å (+)', op_sub: '–í—ã—á–µ—Å—Ç—å (-)',
                    lbl_duration: '–ì / –ú / –ù / –î',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å', btn_diff: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É',
                    res_date: '–î–∞—Ç–∞', res_diff: '–†–∞–∑–Ω–∏—Ü–∞',
                    txt_days: '–¥–Ω–µ–π',
                    fmt_detail: '{y} –ª–µ—Ç {m} –º–µ—Å. {d} –¥–Ω.'
                },
                'es': {
                    title: 'üìÖ Calculadora de Fechas',
                    tab_add: 'Sumar/Restar', tab_diff: 'Diferencia',
                    lbl_start: 'Fecha Inicial', lbl_end: 'Fecha Final',
                    lbl_op: 'Operaci√≥n', op_add: 'Sumar (+)', op_sub: 'Restar (-)',
                    lbl_duration: 'A / M / S / D',
                    btn_calc: 'Calcular Fecha', btn_diff: 'Calcular Diferencia',
                    res_date: 'Fecha Resultado', res_diff: 'Diferencia',
                    txt_days: 'D√≠as',
                    fmt_detail: '{y} a√±os {m} meses {d} d√≠as'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('dc-lang').value;
                const texts = DateCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="date_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) el.innerText = texts[key];
                });
                // update options text
                const opts = document.querySelectorAll('#dc-op option');
                opts.forEach(op => {
                    const key = op.getAttribute('data-i18n');
                    if(texts[key]) op.text = texts[key];
                });
            },

            setMode: (mode) => {
                const btns = document.querySelectorAll('.tab-btn');
                btns[0].classList.toggle('active', mode === 'add');
                btns[1].classList.toggle('active', mode === 'diff');
                
                document.getElementById('dc-mode-add').classList.toggle('hidden', mode !== 'add');
                document.getElementById('dc-mode-diff').classList.toggle('hidden', mode !== 'diff');
            },

            calcAdd: () => {
                const startStr = document.getElementById('dc-start-add').value;
                if(!startStr) return;
                
                const d = new Date(startStr);
                const op = document.getElementById('dc-op').value === 'add' ? 1 : -1;
                
                const y = parseInt(document.getElementById('dc-y').value) || 0;
                const m = parseInt(document.getElementById('dc-m').value) || 0;
                const w = parseInt(document.getElementById('dc-w').value) || 0;
                const day = parseInt(document.getElementById('dc-d').value) || 0;

                // Logic: Add Years, then Months, then Days (Weeks*7 + Days)
                d.setFullYear(d.getFullYear() + (y * op));
                d.setMonth(d.getMonth() + (m * op));
                d.setDate(d.getDate() + ((w * 7 + day) * op));

                const lang = document.getElementById('dc-lang').value;
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const loc = lang === 'zh-CN' ? 'zh-CN' : (lang === 'en' ? 'en-US' : lang);
                
                document.getElementById('res-add-date').innerText = d.toLocaleDateString(loc, options);
            },

            calcDiff: () => {
                const sStr = document.getElementById('dc-start-diff').value;
                const eStr = document.getElementById('dc-end-diff').value;
                if(!sStr || !eStr) return;

                const start = new Date(sStr);
                const end = new Date(eStr);
                
                // Total days
                const diffTime = Math.abs(end - start);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 

                // Detail (YMD)
                // Simplified approach for display
                let d1 = new Date(Math.min(start, end));
                let d2 = new Date(Math.max(start, end));
                
                let years = d2.getFullYear() - d1.getFullYear();
                let months = d2.getMonth() - d1.getMonth();
                let days = d2.getDate() - d1.getDate();

                if (days < 0) {
                    months--;
                    const prev = new Date(d2.getFullYear(), d2.getMonth(), 0);
                    days += prev.getDate();
                }
                if (months < 0) {
                    years--;
                    months += 12;
                }

                const lang = document.getElementById('dc-lang').value;
                const txt = DateCalc.i18n[lang];

                document.getElementById('res-diff-days').innerText = diffDays + " " + txt.txt_days;
                
                const detail = txt.fmt_detail.replace('{y}', years).replace('{m}', months).replace('{d}', days);
                document.getElementById('res-diff-detail').innerText = detail;
            }
        };

        // Init
        document.getElementById('dc-start-add').valueAsDate = new Date();
        document.getElementById('dc-start-diff').valueAsDate = new Date();
        document.getElementById('dc-end-diff').valueAsDate = new Date(new Date().getTime() + 86400000);
    </script>
</body>
</html>