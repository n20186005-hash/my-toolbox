<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Definite Integral Calculator</title>
    
    <!-- 基础信息 -->
    <meta name="tool-id" content="definite_integral_calculator">
    <meta name="category" content="Math">
    <meta name="icon" content="∫ₐᵇ">
    
    <!-- 默认英文内容 -->
    <meta name="title" content="Definite Integral Calculator">
    <meta name="description" content="Calculate definite integrals of functions with specified limits step by step">
    
    <!-- 多语言配置 -->
    <meta name="lang-title-zh-CN" content="定积分计算器">
    <meta name="lang-description-zh-CN" content="按指定上下限逐步计算函数的定积分">
    
    <meta name="lang-title-zh-TW" content="定積分計算器">
    <meta name="lang-description-zh-TW" content="按指定上下限逐步計算函數的定積分">
    
    <meta name="lang-title-ja" content="定積分計算ツール">
    <meta name="lang-description-ja" content="指定された限界で関数の定積分を段階的に計算">
    
    <meta name="lang-title-ru" content="Калькулятор определенных интегралов">
    <meta name="lang-description-ru" content="Вычисление определенных интегралов функций с заданными пределами пошагово">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .calculation-result { margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 8px; }
        .form-group { margin-bottom: 15px; }
        .limits-group { display: flex; gap: 10px; }
        .limit-input { flex: 1; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        textarea { min-height: 80px; }
        .steps-container { margin-top: 15px; padding: 10px; background: white; border-radius: 4px; font-size: 0.9rem; }
        .step-item { margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        .step-item:last-child { border-bottom: none; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="definite_integral_calculator" 
         data-category="calculus" 
         data-title="Definite Integral Calculator" 
         data-icon="∫ₐᵇ">
        
        <!-- 语言选择器 -->
        <div class="absolute top-4 right-4">
            <select id="def-lang" onchange="DefiniteIntegralCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">∫ₐᵇ Definite Integral Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <!-- 函数输入 -->
            <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="function">Function f(x)</label>
                <textarea id="function-input" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. 2x + 3 or sin(x)"></textarea>
            </div>
            
            <!-- 变量选择 -->
            <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="variable">Variable of Integration</label>
                <select id="variable-select" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                    <option value="x" selected>x</option>
                    <option value="y">y</option>
                    <option value="t">t</option>
                    <option value="u">u</option>
                    <option value="v">v</option>
                </select>
            </div>
            
            <!-- 积分限 -->
            <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="limits">Integration Limits</label>
                <div class="limits-group">
                    <div class="limit-input">
                        <label class="block text-xs text-gray-500 mb-1" data-i18n="lower_limit">Lower Limit (a)</label>
                        <input type="number" id="lower-limit" step="any" value="0" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div class="limit-input">
                        <label class="block text-xs text-gray-500 mb-1" data-i18n="upper_limit">Upper Limit (b)</label>
                        <input type="number" id="upper-limit" step="any" value="1" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                </div>
            </div>
            
            <!-- 操作按钮 -->
            <div class="flex gap-2">
                <button onclick="DefiniteIntegralCalc.clearInput()" class="flex-1 bg-gray-600 text-white py-2 rounded font-bold hover:bg-gray-700 transition" data-i18n="clear">Clear</button>
                <button onclick="DefiniteIntegralCalc.calculate()" class="flex-2 bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition" data-i18n="calculate">Calculate Integral</button>
            </div>
        </div>

        <!-- 错误提示 -->
        <div id="def-error" class="text-sm text-red-600 mt-2 hidden mb-4"></div>
        
        <!-- 结果展示 -->
        <div id="def-results" class="hidden">
            <div class="text-sm text-gray-500 mb-2" data-i18n="result">Result</div>
            <div class="calculation-result">
                <div class="text-lg font-medium mb-3" id="main-result">∫₀¹(2x + 3)dx = 4</div>
                
                <div class="text-sm text-gray-500 mb-2" data-i18n="steps">Calculation Steps</div>
                <div class="steps-container" id="calculation-steps">
                    <!-- 计算步骤将在这里显示 -->
                </div>
            </div>
        </div>

        <!-- 说明信息 -->
        <div class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600">
            <p data-i18n="notes">Notes:</p>
            <ul class="list-disc list-inside mt-2 space-y-1" id="notes-list">
                <li data-i18n="note1">Use standard mathematical notation (e.g., x^2 for x squared, sin(x) for sine function)</li>
                <li data-i18n="note2">Supported functions: sin, cos, tan, cot, sec, csc, log, ln, exp, sqrt</li>
                <li data-i18n="note3">The definite integral calculates the area under the curve between the specified limits</li>
            </ul>
        </div>
    </div>

    <script>
        const DefiniteIntegralCalc = {
            // 多语言文本
            i18n: {
                'en': {
                    title: '∫ₐᵇ Definite Integral Calculator',
                    function: 'Function f(x)',
                    variable: 'Variable of Integration',
                    limits: 'Integration Limits',
                    lower_limit: 'Lower Limit (a)',
                    upper_limit: 'Upper Limit (b)',
                    clear: 'Clear',
                    calculate: 'Calculate Integral',
                    result: 'Result',
                    steps: 'Calculation Steps',
                    notes: 'Notes:',
                    note1: 'Use standard mathematical notation (e.g., x^2 for x squared, sin(x) for sine function)',
                    note2: 'Supported functions: sin, cos, tan, cot, sec, csc, log, ln, exp, sqrt',
                    note3: 'The definite integral calculates the area under the curve between the specified limits',
                    err_invalid_function: 'Please enter a valid function',
                    err_invalid_limits: 'Please enter valid limits'
                },
                'zh-CN': {
                    title: '∫ₐᵇ 定积分计算器',
                    function: '函数 f(x)',
                    variable: '积分变量',
                    limits: '积分限',
                    lower_limit: '下限 (a)',
                    upper_limit: '上限 (b)',
                    clear: '清除',
                    calculate: '计算积分',
                    result: '结果',
                    steps: '计算步骤',
                    notes: '说明：',
                    note1: '使用标准数学符号（例如，x^2 表示x的平方，sin(x)表示正弦函数）',
                    note2: '支持的函数：sin, cos, tan, cot, sec, csc, log, ln, exp, sqrt',
                    note3: '定积分计算指定区间内曲线下的面积',
                    err_invalid_function: '请输入有效的函数',
                    err_invalid_limits: '请输入有效的积分限'
                },
                'zh-TW': {
                    title: '∫ₐᵇ 定積分計算器',
                    function: '函數 f(x)',
                    variable: '積分變量',
                    limits: '積分限',
                    lower_limit: '下限 (a)',
                    upper_limit: '上限 (b)',
                    clear: '清除',
                    calculate: '計算積分',
                    result: '結果',
                    steps: '計算步驟',
                    notes: '說明：',
                    note1: '使用標準數學符號（例如，x^2 表示x的平方，sin(x)表示正弦函數）',
                    note2: '支持的函數：sin, cos, tan, cot, sec, csc, log, ln, exp, sqrt',
                    note3: '定積分計算指定區間內曲線下的面積',
                    err_invalid_function: '請輸入有效的函數',
                    err_invalid_limits: '請輸入有效的積分限'
                },
                'ja': {
                    title: '∫ₐᵇ 定積分計算ツール',
                    function: '関数 f(x)',
                    variable: '積分変数',
                    limits: '積分限界',
                    lower_limit: '下限 (a)',
                    upper_limit: '上限 (b)',
                    clear: 'クリア',
                    calculate: '積分を計算',
                    result: '結果',
                    steps: '計算手順',
                    notes: '注釈：',
                    note1: '標準的な数学表記を使用してください（例：x^2はxの2乗、sin(x)は正弦関数）',
                    note2: 'サポートされている関数：sin、cos、tan、cot、sec、csc、log、ln、exp、sqrt',
                    note3: '定積分は、指定された限界の間の曲線の下の面積を計算します',
                    err_invalid_function: '有効な関数を入力してください',
                    err_invalid_limits: '有効な積分限界を入力してください'
                },
                'ru': {
                    title: '∫ₐᵇ Калькулятор определенных интегралов',
                    function: 'Функция f(x)',
                    variable: 'Переменная интегрирования',
                    limits: 'Пределы интегрирования',
                    lower_limit: 'Нижний предел (a)',
                    upper_limit: 'Верхний предел (b)',
                    clear: 'Очистить',
                    calculate: 'Вычислить интеграл',
                    result: 'Результат',
                    steps: 'Шаги вычисления',
                    notes: 'Примечания:',
                    note1: 'Используйте стандартную математическую нотацию (например, x^2 для x в квадрате, sin(x) для синуса)',
                    note2: 'Поддерживаемые функции: sin, cos, tan, cot, sec, csc, log, ln, exp, sqrt',
                    note3: 'Определенный интеграл вычисляет площадь под кривой между заданными пределами',
                    err_invalid_function: 'Пожалуйста, введите действительную функцию',
                    err_invalid_limits: 'Пожалуйста, введите действительные пределы'
                }
            },
            
            // 初始化
            init: function() {
                const params = new URLSearchParams(window.location.search);
                const lang = params.get('lang');
                if (lang && this.i18n[lang]) {
                    document.getElementById('lang-selector').value = lang;
                    this.changeLang();
                    return;
                }
                // 初始化操作
            },
            
            // 计算定积分
            calculate: function() {
                const functionInput = document.getElementById('function-input').value.trim();
                const variable = document.getElementById('variable-select').value;
                const lowerLimit = parseFloat(document.getElementById('lower-limit').value);
                const upperLimit = parseFloat(document.getElementById('upper-limit').value);
                
                const errorEl = document.getElementById('def-error');
                const resultsEl = document.getElementById('def-results');
                
                // 验证输入
                if (!functionInput) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_invalid_function;
                    errorEl.classList.remove('hidden');
                    resultsEl.classList.add('hidden');
                    return;
                }
                
                if (isNaN(lowerLimit) || isNaN(upperLimit)) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_invalid_limits;
                    errorEl.classList.remove('hidden');
                    resultsEl.classList.add('hidden');
                    return;
                }
                
                // 清除错误
                errorEl.classList.add('hidden');
                
                // 这里应该有实际的积分计算逻辑
                // 以下是模拟结果
                const mainResultEl = document.getElementById('main-result');
                const stepsContainer = document.getElementById('calculation-steps');
                
                // 模拟结果 - 实际应用中应替换为真实计算
                mainResultEl.textContent = `∫${this.formatLimit(lowerLimit)}${this.formatLimit(upperLimit)}(${functionInput})d${variable} = ${this.simulateIntegral(functionInput, variable, lowerLimit, upperLimit)}`;
                
                // 模拟步骤
                stepsContainer.innerHTML = this.generateSampleSteps(functionInput, variable, lowerLimit, upperLimit);
                
                // 显示结果
                resultsEl.classList.remove('hidden');
            },
            
            // 格式化积分限显示
            formatLimit: function(value) {
                // 简单处理，实际应用中可能需要更复杂的格式化
                return `<sub>${value}</sub>`;
            },
            
            // 模拟积分计算 (实际应用中替换为真实计算)
            simulateIntegral: function(func, varName, lower, upper) {
                // 简单模拟几个常见函数的定积分
                if (func.includes('2' + varName) && func.includes('+ 3')) {
                    const result = (upper**2 + 3*upper) - (lower**2 + 3*lower);
                    return result.toFixed(4);
                } else if (func.includes('sin(') && func.includes(varName)) {
                    const result = (-Math.cos(upper)) - (-Math.cos(lower));
                    return result.toFixed(4);
                }
                return ((upper - lower) * 2).toFixed(4); // 默认占位符
            },
            
            // 生成示例计算步骤 (实际应用中替换为真实步骤)
            generateSampleSteps: function(func, varName, lower, upper) {
                const steps = [
                    `<div class="step-item"><strong>1.</strong> ${this.i18n[this.getCurrentLang()].note1}</div>`,
                    `<div class="step-item"><strong>2.</strong> ${this.i18n[this.getCurrentLang()].note2}</div>`,
                    `<div class="step-item"><strong>3.</strong> Calculate F(${upper}) - F(${lower}) where F is the antiderivative</div>`
                ];
                return steps.join('');
            },
            
            // 清除输入
            clearInput: function() {
                document.getElementById('function-input').value = '';
                document.getElementById('lower-limit').value = '0';
                document.getElementById('upper-limit').value = '1';
                document.getElementById('def-results').classList.add('hidden');
                document.getElementById('def-error').classList.add('hidden');
            },
            
            // 切换语言
            changeLang: function() {
                const lang = this.getCurrentLang();
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang][key]) {
                        el.textContent = this.i18n[lang][key];
                    }
                });
                
                // 如果有值，重新计算以更新结果语言
                if (document.getElementById('function-input').value) {
                    this.calculate();
                }
            },
            
            // 获取当前语言
            getCurrentLang: function() {
                return document.getElementById('def-lang').value;
            }
        };
        
        // 初始化计算器
        DefiniteIntegralCalc.init();
    </script>
</body>
</html>