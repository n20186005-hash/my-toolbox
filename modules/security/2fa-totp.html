<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="tool-id" content="2fa-totp">
    <meta name="category" content="security">
    <meta name="icon" content="ğŸ”’">
    <title>2FA åŒé‡éªŒè¯å¯†ç ç”Ÿæˆç®¡ç†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0fdf4; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 1000px; margin: 0 auto; position: relative; }
        .section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.9rem; color: #4b5563; margin-bottom: 4px; }
        input, select, textarea { width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem; }
        .result-box { padding: 15px; background-color: #f8fafc; border-radius: 6px; margin-top: 10px; font-family: monospace; font-size: 1.1rem; text-align: center; }
        .intro-section { margin-top: 30px; padding: 20px; background-color: #f8fafc; border-radius: 8px; font-size: 0.95rem; color: #475569; }
        button { background: #22c55e; color: white; border: none; padding: 10px 15px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background 0.3s; margin-right: 10px; }
        button:hover { background: #16a34a; }
        .copy-notification { position: fixed; bottom: 20px; right: 20px; background-color: #10b981; color: white; padding: 10px 20px; border-radius: 6px; opacity: 0; transition: opacity 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000; }
        .footer { margin-top: 30px; text-align: center; color: #6b7280; font-size: 0.9rem; }
        .timer { display: inline-block; margin-left: 10px; color: #6b7280; font-size: 0.9rem; }
    </style>
    <link rel="canonical" href="https://toolboxpro.top/modules/security/2fa-totp.html" />

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9279583389810634"
     crossorigin="anonymous"></script>

</head>
<body>
    <div class="tool-module">
        <div class="absolute top-4 right-4">
            <select id="lang-selector" onchange="Tool.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN" selected>ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-6 text-gray-800 border-b pb-2" data-i18n="title">ğŸ”’ 2FA åŒé‡éªŒè¯å¯†ç ç”Ÿæˆç®¡ç†</h2>

        <div class="space-y-6">
            <div class="section">
                <h3 class="text-lg font-semibold mb-4 text-gray-700" data-i18n="setup">è®¾ç½® 2FA å¯†é’¥</h3>
                <div class="form-group">
                    <label data-i18n="secret_key">å¯†é’¥ (Secret Key)</label>
                    <input type="text" id="secret-key" placeholder="è¾“å…¥2FAå¯†é’¥..." class="focus:ring-2 focus:ring-green-500 outline-none">
                </div>
                <div class="form-group">
                    <label data-i18n="account_name">è´¦æˆ·åç§° (å¯é€‰)</label>
                    <input type="text" id="account-name" placeholder="ä¾‹å¦‚ï¼šGoogleã€GitHub..." class="focus:ring-2 focus:ring-green-500 outline-none">
                </div>
                <button onclick="Tool.generateTotp()" data-i18n="generate_code">ç”ŸæˆéªŒè¯ç </button>
                <button onclick="Tool.copySecret()" data-i18n="copy_secret">å¤åˆ¶å¯†é’¥</button>
            </div>

            <div class="section">
                <h3 class="text-lg font-semibold mb-4 text-gray-700" data-i18n="current_code">å½“å‰éªŒè¯ç </h3>
                <div class="result-box" id="totp-result">---- ----</div>
                <div class="text-center mt-2">
                    <span class="timer" id="countdown">30s</span>
                </div>
                <div class="text-center mt-3">
                    <button onclick="Tool.copyCode()" data-i18n="copy_code">å¤åˆ¶éªŒè¯ç </button>
                </div>
            </div>

            <div class="intro-section">
                <h3 class="text-lg font-semibold mb-2 text-gray-800" data-i18n="intro_title">å…³äº 2FA åŒé‡éªŒè¯å·¥å…·</h3>
                <p data-i18n="intro_text">æœ¬å·¥å…·å¯ç”ŸæˆåŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç (TOTP)ï¼Œç”¨äºåŒé‡éªŒè¯(2FA)ã€‚è¾“å…¥æ‚¨çš„2FAå¯†é’¥å³å¯ç”ŸæˆéªŒè¯ç ï¼Œæ— éœ€å®‰è£…é¢å¤–åº”ç”¨ã€‚éªŒè¯ç æ¯30ç§’æ›´æ–°ä¸€æ¬¡ï¼Œæé«˜æ‚¨çš„è´¦æˆ·å®‰å…¨æ€§ã€‚</p>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>
            <span data-i18n="footer_prefix">æ›´å¤šå·¥å…·å¯è®¿é—®ï¼š</span>
            <a href="https://toolboxpro.top" target="_blank" class="text-green-600 hover:underline">toolboxpro.top</a>
        </p>
    </div>

    <div id="copy-notification" class="copy-notification" data-i18n="copied">å·²å¤åˆ¶ï¼</div>

    <script>
        const Tool = {
            i18n: {
                'en': {
                    title: 'ğŸ”’ 2FA Authentication Code Generator',
                    setup: 'Setup 2FA Secret',
                    'secret_key': 'Secret Key',
                    'account_name': 'Account Name (Optional)',
                    'generate_code': 'Generate Code',
                    'copy_secret': 'Copy Secret',
                    'current_code': 'Current Verification Code',
                    'copy_code': 'Copy Code',
                    'copied': 'Copied!',
                    'intro_title': 'About 2FA Authentication Tool',
                    'intro_text': 'This tool generates Time-based One-Time Passwords (TOTP) for two-factor authentication (2FA). Enter your 2FA secret to generate verification codes without installing additional applications. Codes update every 30 seconds, enhancing your account security.',
                    'footer_prefix': 'More tools at: ',
                    'search_placeholder': 'Enter 2FA secret...'
                },
                'zh-CN': {
                    title: 'ğŸ”’ 2FA åŒé‡éªŒè¯å¯†ç ç”Ÿæˆç®¡ç†',
                    setup: 'è®¾ç½® 2FA å¯†é’¥',
                    'secret_key': 'å¯†é’¥ (Secret Key)',
                    'account_name': 'è´¦æˆ·åç§° (å¯é€‰)',
                    'generate_code': 'ç”ŸæˆéªŒè¯ç ',
                    'copy_secret': 'å¤åˆ¶å¯†é’¥',
                    'current_code': 'å½“å‰éªŒè¯ç ',
                    'copy_code': 'å¤åˆ¶éªŒè¯ç ',
                    'copied': 'å·²å¤åˆ¶ï¼',
                    'intro_title': 'å…³äº 2FA åŒé‡éªŒè¯å·¥å…·',
                    'intro_text': 'æœ¬å·¥å…·å¯ç”ŸæˆåŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç (TOTP)ï¼Œç”¨äºåŒé‡éªŒè¯(2FA)ã€‚è¾“å…¥æ‚¨çš„2FAå¯†é’¥å³å¯ç”ŸæˆéªŒè¯ç ï¼Œæ— éœ€å®‰è£…é¢å¤–åº”ç”¨ã€‚éªŒè¯ç æ¯30ç§’æ›´æ–°ä¸€æ¬¡ï¼Œæé«˜æ‚¨çš„è´¦æˆ·å®‰å…¨æ€§ã€‚',
                    'footer_prefix': 'æ›´å¤šå·¥å…·å¯è®¿é—®ï¼š',
                    'search_placeholder': 'è¾“å…¥2FAå¯†é’¥...'
                },
                'zh-TW': {
                    title: 'ğŸ”’ 2FA é›™é‡é©—è­‰å¯†ç¢¼ç”Ÿæˆç®¡ç†',
                    setup: 'è¨­å®š 2FA é‡‘é‘°',
                    'secret_key': 'é‡‘é‘° (Secret Key)',
                    'account_name': 'å¸³æˆ¶åç¨± (å¯é¸)',
                    'generate_code': 'ç”Ÿæˆé©—è­‰ç¢¼',
                    'copy_secret': 'è¤‡è£½é‡‘é‘°',
                    'current_code': 'ç•¶å‰é©—è­‰ç¢¼',
                    'copy_code': 'è¤‡è£½é©—è­‰ç¢¼',
                    'copied': 'å·²è¤‡è£½ï¼',
                    'intro_title': 'é—œæ–¼ 2FA é›™é‡é©—è­‰å·¥å…·',
                    'intro_text': 'æœ¬å·¥å…·å¯ç”ŸæˆåŸºæ–¼æ™‚é–“çš„ä¸€æ¬¡æ€§å¯†ç¢¼(TOTP)ï¼Œç”¨æ–¼é›™é‡é©—è­‰(2FA)ã€‚è¼¸å…¥æ‚¨çš„2FAé‡‘é‘°å³å¯ç”Ÿæˆé©—è­‰ç¢¼ï¼Œç„¡éœ€å®‰è£é¡å¤–æ‡‰ç”¨ã€‚é©—è­‰ç¢¼æ¯30ç§’æ›´æ–°ä¸€æ¬¡ï¼Œæé«˜æ‚¨çš„å¸³æˆ¶å®‰å…¨æ€§ã€‚',
                    'footer_prefix': 'æ›´å¤šå·¥å…·å¯è¨ªå•ï¼š',
                    'search_placeholder': 'è¼¸å…¥2FAé‡‘é‘°...'
                },
                'ja': {
                    title: 'ğŸ”’ 2FA äºŒè¦ç´ èªè¨¼ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«',
                    setup: '2FAã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®è¨­å®š',
                    'secret_key': 'ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼',
                    'account_name': 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰',
                    'generate_code': 'ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ',
                    'copy_secret': 'ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ã‚³ãƒ”ãƒ¼',
                    'current_code': 'ç¾åœ¨ã®èªè¨¼ã‚³ãƒ¼ãƒ‰',
                    'copy_code': 'ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼',
                    'copied': 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼',
                    'intro_title': '2FAäºŒè¦ç´ èªè¨¼ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦',
                    'intro_text': 'ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€äºŒè¦ç´ èªè¨¼(2FA)ã«ä½¿ç”¨ã™ã‚‹æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰(TOTP)ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚2FAã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã€è¿½åŠ ã®ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚³ãƒ¼ãƒ‰ã¯30ç§’ã”ã¨ã«æ›´æ–°ã•ã‚Œã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å¼·åŒ–ã—ã¾ã™ã€‚',
                    'footer_prefix': 'ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«ï¼š',
                    'search_placeholder': '2FAã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å…¥åŠ›...'
                },
                'ru': {
                    title: 'ğŸ”’ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ ĞºĞ¾Ğ´Ğ° 2FA Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸',
                    setup: 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑĞµĞºÑ€ĞµÑ‚Ğ° 2FA',
                    'secret_key': 'Ğ¡ĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡',
                    'account_name': 'Ğ˜Ğ¼Ñ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)',
                    'generate_code': 'Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´',
                    'copy_secret': 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞºÑ€ĞµÑ‚',
                    'current_code': 'Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´',
                    'copy_code': 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´',
                    'copied': 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!',
                    'intro_title': 'Ğ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğµ Ğ´Ğ»Ñ Ğ´Ğ²ÑƒÑ…Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ½Ğ¾Ğ¹ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸',
                    'intro_text': 'Ğ­Ñ‚Ğ¾Ñ‚ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¾Ğ´Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ğ¸ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ (TOTP) Ğ´Ğ»Ñ Ğ´Ğ²ÑƒÑ…Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ½Ğ¾Ğ¹ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ (2FA). Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ²Ğ°Ñˆ ÑĞµĞºÑ€ĞµÑ‚ 2FA, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ğ±ĞµĞ· ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹. ĞšĞ¾Ğ´Ñ‹ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞºÑƒĞ½Ğ´, Ğ¿Ğ¾Ğ²Ñ‹ÑˆĞ°Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ²Ğ°ÑˆĞ¸Ñ… Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ².',
                    'footer_prefix': 'Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²: ',
                    'search_placeholder': 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞµĞºÑ€ĞµÑ‚ 2FA...'
                }
            },

            timer: null,
            currentSecret: '',

            init: function() {
                // ä»URLè·å–è¯­è¨€å‚æ•°
                let lang = 'zh-CN';
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    lang = urlParams.get('lang') || 'zh-CN';
                } catch (e) {
                    console.log('Unable to access URL params:', e);
                }
                
                // è®¾ç½®è¯­è¨€é€‰æ‹©å™¨
                document.getElementById('lang-selector').value = lang;
                
                // åˆå§‹åŒ–ç¿»è¯‘
                this.changeLang();
            },

            changeLang: function() {
                const lang = document.getElementById('lang-selector').value;
                
                // æ›´æ–°URLå‚æ•°
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    urlParams.set('lang', lang);
                    window.history.replaceState(null, null, '?' + urlParams.toString());
                } catch (e) {
                    console.warn('History API not supported in this environment');
                }
                
                // åº”ç”¨ç¿»è¯‘
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (this.i18n[lang] && this.i18n[lang][key]) {
                        element.textContent = this.i18n[lang][key];
                    }
                });
                
                // æ›´æ–°å ä½ç¬¦
                if(this.i18n[lang] && this.i18n[lang]['search_placeholder']) {
                    document.getElementById('secret-key').placeholder = this.i18n[lang]['search_placeholder'];
                    document.getElementById('account-name').placeholder = this.i18n[lang]['account_name_placeholder'] || "ä¾‹å¦‚ï¼šGoogleã€GitHub...";
                }
            },

            generateTotp: function() {
                const secret = document.getElementById('secret-key').value.trim();
                if (!secret) {
                    alert(this.i18n[this.getCurrentLang()]['error_empty_secret'] || 'è¯·è¾“å…¥å¯†é’¥');
                    return;
                }
                
                this.currentSecret = secret;
                this.updateTotp();
                
                // æ¸…é™¤ç°æœ‰å®šæ—¶å™¨å¹¶åˆ›å»ºæ–°çš„
                if (this.timer) clearInterval(this.timer);
                this.updateCountdown();
                this.timer = setInterval(() => {
                    this.updateCountdown();
                }, 1000);
            },

            updateTotp: function() {
                if (!this.currentSecret) return;
                
                try {
                    // ç®€åŒ–çš„TOTPç”Ÿæˆé€»è¾‘
                    const epoch = Math.floor(Date.now() / 1000);
                    const time = Math.floor(epoch / 30);
                    const code = this.generateTOTP(this.currentSecret, time);
                    document.getElementById('totp-result').textContent = code.substr(0, 4) + ' ' + code.substr(4, 4);
                } catch (e) {
                    console.error('Error generating TOTP:', e);
                    document.getElementById('totp-result').textContent = 'é”™è¯¯ç”Ÿæˆ';
                }
            },

            updateCountdown: function() {
                const epoch = Math.floor(Date.now() / 1000);
                const remaining = 30 - (epoch % 30);
                document.getElementById('countdown').textContent = remaining + 's';
                
                // æ¯30ç§’æ›´æ–°ä¸€æ¬¡éªŒè¯ç 
                if (remaining === 30) {
                    this.updateTotp();
                }
            },

            copyCode: function() {
                const codeElement = document.getElementById('totp-result');
                const code = codeElement.textContent.replace(' ', '');
                
                if (code && code !== '---- ----') {
                    navigator.clipboard.writeText(code).then(() => {
                        this.showNotification();
                    }).catch(() => {
                        // å¤‡é€‰å¤åˆ¶æ–¹æ³•
                        const textArea = document.createElement("textarea");
                        textArea.value = code;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        this.showNotification();
                    });
                }
            },

            copySecret: function() {
                const secret = document.getElementById('secret-key').value.trim();
                if (secret) {
                    navigator.clipboard.writeText(secret).then(() => {
                        this.showNotification();
                    }).catch(() => {
                        const textArea = document.createElement("textarea");
                        textArea.value = secret;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        this.showNotification();
                    });
                }
            },

            showNotification: function() {
                const notification = document.getElementById('copy-notification');
                notification.style.opacity = '1';
                setTimeout(() => {
                    notification.style.opacity = '0';
                }, 2000);
            },

            getCurrentLang: function() {
                return document.getElementById('lang-selector').value || 'zh-CN';
            },

            // ç®€åŒ–çš„TOTPç”Ÿæˆå®ç°
            generateTOTP: function(secret, time) {
                // å®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨æ›´å®Œå–„çš„åº“å¦‚speakeasy
                const key = this.base32ToHex(secret);
                const hexTime = this.decimalToHex(time, 16);
                
                // è®¡ç®—HMAC-SHA1
                const hmac = this.hmacSHA1(key, hexTime);
                
                // åŠ¨æ€æˆªæ–­
                const offset = hmac[hmac.length - 1] & 0xf;
                let otp = ((hmac[offset] & 0x7f) << 24) |
                          ((hmac[offset + 1] & 0xff) << 16) |
                          ((hmac[offset + 2] & 0xff) << 8) |
                          (hmac[offset + 3] & 0xff);
                
                // å–6ä½æ•°å­—
                otp = otp % 1000000;
                return otp.toString().padStart(6, '0');
            },

            // è¾…åŠ©å‡½æ•°ï¼šBase32è½¬16è¿›åˆ¶
            base32ToHex: function(base32) {
                const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
                let bits = '';
                let hex = '';
                
                base32 = base32.toUpperCase().replace(/=+$/, '');
                
                for (let i = 0; i < base32.length; i++) {
                    const val = alphabet.indexOf(base32[i]);
                    bits += val.toString(2).padStart(5, '0');
                }
                
                for (let i = 0; i + 8 <= bits.length; i += 8) {
                    const chunk = bits.substr(i, 8);
                    hex += parseInt(chunk, 2).toString(16).padStart(2, '0');
                }
                
                return hex;
            },

            // è¾…åŠ©å‡½æ•°ï¼šåè¿›åˆ¶è½¬æŒ‡å®šé•¿åº¦çš„16è¿›åˆ¶
            decimalToHex: function(decimal, length) {
                let hex = decimal.toString(16);
                return hex.padStart(length, '0').toUpperCase();
            },

            // ç®€åŒ–çš„HMAC-SHA1å®ç°
            hmacSHA1: function(keyHex, dataHex) {
                // å®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨Crypto API
                const key = Uint8Array.from(keyHex.match(/.{2}/g).map(byte => parseInt(byte, 16)));
                const data = Uint8Array.from(dataHex.match(/.{2}/g).map(byte => parseInt(byte, 16)));
                
                // æ­¤å¤„ä½¿ç”¨æµè§ˆå™¨å†…ç½®çš„Crypto API
                return window.crypto.subtle.importKey(
                    'raw', key, {name: 'HMAC', hash: 'SHA-1'}, false, ['sign']
                ).then(key => {
                    return window.crypto.subtle.sign('HMAC', key, data);
                }).then(signature => {
                    return Array.from(new Uint8Array(signature));
                });
            }
        };

        // åˆå§‹åŒ–å·¥å…·
        document.addEventListener('DOMContentLoaded', () => {
            Tool.init();
        });
    </script>

    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
    

    <div id="toolbox-seo-wrapper-unique-id" class="max-w-4xl mx-auto px-4"></div>
    <script src="/scripts/seo-loader.js"></script>

</body>
</html>