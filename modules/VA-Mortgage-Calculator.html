<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VA Mortgage Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f4ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="va_calc" 
         data-category="finance" 
         data-title="VA Mortgage Calculator" 
         data-icon="üè†">
        
        <div class="absolute top-4 right-4">
            <select id="va-lang" onchange="VACalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">üè† VA Mortgage Calculator</h2>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_price">Home Price</label>
                <div class="relative">
                    <span class="absolute left-2 top-2 text-gray-400">$</span>
                    <input type="number" id="va-price" class="w-full pl-5 p-2 border rounded focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="300000">
                </div>
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_down">Down Payment</label>
                <div class="relative">
                    <span class="absolute left-2 top-2 text-gray-400">$</span>
                    <input type="number" id="va-down" class="w-full pl-5 p-2 border rounded focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="0" value="0">
                </div>
            </div>
        </div>

        <div class="grid grid-cols-3 gap-3 mb-6">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_fee">VA Fee (%)</label>
                <input type="number" id="va-fee" class="w-full p-2 border rounded focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="2.15" value="2.15">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_term">Term (Years)</label>
                <input type="number" id="va-term" class="w-full p-2 border rounded focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="30" value="30">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_rate">Rate (%)</label>
                <input type="number" id="va-rate" class="w-full p-2 border rounded focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="6.5">
            </div>
        </div>

        <button onclick="VACalc.calc()" class="w-full bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700 transition mb-6" data-i18n="btn_calc">Calculate Payment</button>

        <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-100">
            <div class="flex justify-between items-center mb-2 border-b border-indigo-200 pb-2">
                <span class="text-gray-600 text-sm" data-i18n="res_monthly">Monthly P&I</span>
                <div id="va-monthly" class="text-2xl font-bold text-indigo-800">$ --</div>
            </div>
            <div class="flex justify-between items-center text-xs text-gray-500">
                <span data-i18n="res_loan_amt">Total Loan (w/ Fee)</span>
                <span id="va-total-loan" class="font-bold text-gray-700">--</span>
            </div>
        </div>
        
        <p class="text-xs text-gray-400 mt-3 text-center" data-i18n="note">VA Funding Fee is financed into the loan.</p>
    </div>

    <script>
        const VACalc = {
            i18n: {
                'en': {
                    title: 'üè† VA Mortgage Calculator',
                    lbl_price: 'Home Price', lbl_down: 'Down Payment',
                    lbl_fee: 'VA Funding Fee (%)', lbl_term: 'Term (Years)', lbl_rate: 'Interest Rate (%)',
                    btn_calc: 'Calculate Payment',
                    res_monthly: 'Monthly P&I', res_loan_amt: 'Total Loan Amount (w/ Fee)',
                    note: 'VA Funding Fee is typically financed into the loan.'
                },
                'zh-CN': {
                    title: 'üè† VA ÈÄÄ‰ºçÂÜõ‰∫∫Ë¥∑Ê¨æËÆ°ÁÆó',
                    lbl_price: 'ÊàøÂ±ã‰ª∑Ê†º', lbl_down: 'È¶ñ‰ªòÈáëÈ¢ù',
                    lbl_fee: 'VA ËµÑÈáëË¥πÁéá (%)', lbl_term: 'Ë¥∑Ê¨æÂπ¥Èôê', lbl_rate: 'Âπ¥Âà©Áéá (%)',
                    btn_calc: 'ËÆ°ÁÆóÊúà‰æõ',
                    res_monthly: 'ÊØèÊúàÊú¨ÊÅØ', res_loan_amt: 'Ë¥∑Ê¨æÊÄªÈ¢ù (Âê´ËµÑÈáëË¥π)',
                    note: 'VA ËµÑÈáëË¥πÈÄöÂ∏∏‰ºöËÆ°ÂÖ•Ë¥∑Ê¨æÊÄªÈ¢ù‰∏≠ËøõË°åÂàÜÊúü„ÄÇ'
                },
                'zh-TW': {
                    title: 'üè† VA ÈÄÄ‰ºçËªç‰∫∫Ë≤∏Ê¨æË®àÁÆó',
                    lbl_price: 'ÊàøÂ±ãÂÉπÊ†º', lbl_down: 'È¶ñ‰ªòÈáëÈ°ç',
                    lbl_fee: 'VA Ë≥áÈáëË≤ªÁéá (%)', lbl_term: 'Ë≤∏Ê¨æÂπ¥Èôê', lbl_rate: 'Âπ¥Âà©Áéá (%)',
                    btn_calc: 'Ë®àÁÆóÊúà‰æõ',
                    res_monthly: 'ÊØèÊúàÊú¨ÊÅØ', res_loan_amt: 'Ë≤∏Ê¨æÁ∏ΩÈ°ç (Âê´Ë≥áÈáëË≤ª)',
                    note: 'VA Ë≥áÈáëË≤ªÈÄöÂ∏∏ÊúÉË®àÂÖ•Ë≤∏Ê¨æÁ∏ΩÈ°ç‰∏≠ÈÄ≤Ë°åÂàÜÊúü„ÄÇ'
                },
                'ja': {
                    title: 'üè† VA„É≠„Éº„É≥Ë®àÁÆó (ÈÄÄÂΩπËªç‰∫∫)',
                    lbl_price: '‰ΩèÂÆÖ‰æ°Ê†º', lbl_down: 'È†≠Èáë',
                    lbl_fee: 'VAÊâãÊï∞Êñô (%)', lbl_term: 'ËøîÊ∏àÊúüÈñì (Âπ¥)', lbl_rate: 'ÈáëÂà© (%)',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã',
                    res_monthly: 'Êúà„ÄÖ„ÅÆÊîØÊâï„ÅÑ', res_loan_amt: 'ÂÄüÂÖ•Á∑èÈ°ç (ÊâãÊï∞ÊñôËæº)',
                    note: 'VAÊâãÊï∞Êñô„ÅØÈÄöÂ∏∏„ÄÅ„É≠„Éº„É≥ÈáëÈ°ç„Å´Âä†ÁÆó„Åï„Çå„Åæ„Åô„ÄÇ'
                },
                'ru': {
                    title: 'üè† –ò–ø–æ—Ç–µ–∫–∞ VA (–í–µ—Ç–µ—Ä–∞–Ω—Å–∫–∞—è)',
                    lbl_price: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∂–∏–ª—å—è', lbl_down: '–ü–µ—Ä–≤. –≤–∑–Ω–æ—Å',
                    lbl_fee: '–°–±–æ—Ä VA (%)', lbl_term: '–°—Ä–æ–∫ (–ª–µ—Ç)', lbl_rate: '–°—Ç–∞–≤–∫–∞ (%)',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                    res_monthly: '–ï–∂–µ–º–µ—Å. –ø–ª–∞—Ç–µ–∂', res_loan_amt: '–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ (+—Å–±–æ—Ä)',
                    note: '–°–±–æ—Ä VA –æ–±—ã—á–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å—É–º–º—É –∫—Ä–µ–¥–∏—Ç–∞.'
                },
                'es': {
                    title: 'üè† Hipoteca VA',
                    lbl_price: 'Precio de Casa', lbl_down: 'Pago Inicial',
                    lbl_fee: 'Tarifa VA (%)', lbl_term: 'Plazo (A√±os)', lbl_rate: 'Tasa (%)',
                    btn_calc: 'Calcular',
                    res_monthly: 'Pago Mensual', res_loan_amt: 'Monto Total (+Tarifa)',
                    note: 'La tarifa VA se suele financiar en el pr√©stamo.'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('va-lang').value;
                const texts = VACalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="va_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) el.innerText = texts[key];
                });
            },

            calc: () => {
                const price = parseFloat(document.getElementById('va-price').value);
                const down = parseFloat(document.getElementById('va-down').value) || 0;
                const feeRate = parseFloat(document.getElementById('va-fee').value) || 0;
                const years = parseFloat(document.getElementById('va-term').value);
                const rateAnnual = parseFloat(document.getElementById('va-rate').value);

                if (isNaN(price) || isNaN(years) || isNaN(rateAnnual)) return;

                const baseLoan = Math.max(0, price - down);
                const fundingFee = baseLoan * (feeRate / 100);
                const totalLoan = baseLoan + fundingFee;

                const r = rateAnnual / 100 / 12;
                const n = years * 12;

                let monthly = 0;
                if (r === 0) {
                    monthly = totalLoan / n;
                } else {
                    monthly = totalLoan * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
                }

                const fmt = (n) => n.toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 });

                document.getElementById('va-monthly').innerText = fmt(monthly);
                document.getElementById('va-total-loan').innerText = fmt(totalLoan);
            }
        };
    </script>
</body>
</html>