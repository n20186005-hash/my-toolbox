<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Macro Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0fdf4; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .macro-bar { transition: width 0.5s; height: 8px; border-radius: 4px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="macro_calc" 
         data-category="health" 
         data-title="Macro Calculator" 
         data-icon="ü•ó">
        
        <div class="absolute top-4 right-4">
            <select id="mc-lang" onchange="MacroCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ü•ó Macro Calculator</h2>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_cal">Daily Calories</label>
                <input type="number" id="mc-cals" class="w-full p-2 border rounded focus:ring-1 focus:ring-green-500 outline-none" placeholder="2000" value="2000" oninput="MacroCalc.calc()">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_goal">Goal</label>
                <select id="mc-goal" class="w-full p-2 border rounded bg-white text-sm" onchange="MacroCalc.calc()">
                    <option value="balanced" data-i18n="opt_bal">Balanced</option>
                    <option value="low_carb" data-i18n="opt_low">Low Carb</option>
                    <option value="high_pro" data-i18n="opt_high">High Protein</option>
                    <option value="keto" data-i18n="opt_keto">Keto</option>
                </select>
            </div>
        </div>

        <button onclick="MacroCalc.calc()" class="w-full bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition mb-6" data-i18n="btn_calc">Calculate Macros</button>

        <div class="bg-green-50 p-4 rounded-lg border border-green-100">
            <!-- Protein -->
            <div class="mb-3">
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-bold text-gray-700" data-i18n="res_pro">Protein</span>
                    <span id="val-pro" class="font-bold text-green-700">-- g</span>
                </div>
                <div class="w-full bg-green-200 rounded-full h-2">
                    <div id="bar-pro" class="bg-green-600 h-2 rounded-full" style="width: 30%"></div>
                </div>
                <div class="text-xs text-gray-500 mt-1 text-right"><span id="pct-pro">30</span>%</div>
            </div>

            <!-- Carbs -->
            <div class="mb-3">
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-bold text-gray-700" data-i18n="res_carb">Carbs</span>
                    <span id="val-carb" class="font-bold text-orange-600">-- g</span>
                </div>
                <div class="w-full bg-orange-200 rounded-full h-2">
                    <div id="bar-carb" class="bg-orange-500 h-2 rounded-full" style="width: 40%"></div>
                </div>
                <div class="text-xs text-gray-500 mt-1 text-right"><span id="pct-carb">40</span>%</div>
            </div>

            <!-- Fat -->
            <div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="font-bold text-gray-700" data-i18n="res_fat">Fat</span>
                    <span id="val-fat" class="font-bold text-yellow-600">-- g</span>
                </div>
                <div class="w-full bg-yellow-200 rounded-full h-2">
                    <div id="bar-fat" class="bg-yellow-500 h-2 rounded-full" style="width: 30%"></div>
                </div>
                <div class="text-xs text-gray-500 mt-1 text-right"><span id="pct-fat">30</span>%</div>
            </div>
        </div>
    </div>

    <script>
        const MacroCalc = {
            i18n: {
                'en': {
                    title: 'ü•ó Macro Calculator',
                    lbl_cal: 'Daily Calories', lbl_goal: 'Diet Goal',
                    opt_bal: 'Balanced (40/30/30)', opt_low: 'Low Carb (20/40/40)',
                    opt_high: 'High Protein (30/50/20)', opt_keto: 'Keto (5/25/70)',
                    btn_calc: 'Calculate Macros',
                    res_pro: 'Protein', res_carb: 'Carbs', res_fat: 'Fat'
                },
                'zh-CN': {
                    title: 'ü•ó ÂÆèÈáèËê•ÂÖªÁ¥†ËÆ°ÁÆóÂô®',
                    lbl_cal: 'ÊØèÊó•ÁÉ≠Èáè (kcal)', lbl_goal: 'È•ÆÈ£üÁõÆÊ†á',
                    opt_bal: 'ÂùáË°°È•ÆÈ£ü', opt_low: '‰ΩéÁ¢≥Ê∞¥',
                    opt_high: 'È´òËõãÁôΩ', opt_keto: 'ÁîüÈÖÆÈ•ÆÈ£ü',
                    btn_calc: 'ËÆ°ÁÆóËê•ÂÖªÈÖçÊØî',
                    res_pro: 'ËõãÁôΩË¥®', res_carb: 'Á¢≥Ê∞¥ÂåñÂêàÁâ©', res_fat: 'ËÑÇËÇ™'
                },
                'zh-TW': {
                    title: 'ü•ó ÂÆèÈáèÁáüÈ§äÁ¥†Ë®àÁÆóÂô®',
                    lbl_cal: 'ÊØèÊó•ÁÜ±Èáè (kcal)', lbl_goal: 'È£≤È£üÁõÆÊ®ô',
                    opt_bal: 'ÂùáË°°È£≤È£ü', opt_low: '‰ΩéÁ¢≥Ê∞¥',
                    opt_high: 'È´òËõãÁôΩ', opt_keto: 'ÁîüÈÖÆÈ£≤È£ü',
                    btn_calc: 'Ë®àÁÆóÁáüÈ§äÈÖçÊØî',
                    res_pro: 'ËõãÁôΩË≥™', res_carb: 'Á¢≥Ê∞¥ÂåñÂêàÁâ©', res_fat: 'ËÑÇËÇ™'
                },
                'ja': {
                    title: 'ü•ó PFC„Éê„É©„É≥„ÇπË®àÁÆó',
                    lbl_cal: 'ÊëÇÂèñ„Ç´„É≠„É™„Éº', lbl_goal: 'ÁõÆÊ®ô',
                    opt_bal: '„Éê„É©„É≥„ÇπÈáçË¶ñ', opt_low: '‰ΩéÁ≥ñË≥™',
                    opt_high: 'È´ò„Çø„É≥„Éë„ÇØ', opt_keto: '„Ç±„Éà„Ç∏„Çß„Éã„ÉÉ„ÇØ',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã',
                    res_pro: '„Çø„É≥„Éë„ÇØË≥™ (P)', res_carb: 'ÁÇ≠Ê∞¥ÂåñÁâ© (C)', res_fat: 'ËÑÇË≥™ (F)'
                },
                'ru': {
                    title: 'ü•ó –ë–ñ–£ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä',
                    lbl_cal: '–ö–∞–ª–æ—Ä–∏–∏ –≤ –¥–µ–Ω—å', lbl_goal: '–¶–µ–ª—å',
                    opt_bal: '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ', opt_low: '–ù–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω–æ–µ',
                    opt_high: '–í—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤–æ–µ', opt_keto: '–ö–µ—Ç–æ-–¥–∏–µ—Ç–∞',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                    res_pro: '–ë–µ–ª–∫–∏', res_carb: '–£–≥–ª–µ–≤–æ–¥—ã', res_fat: '–ñ–∏—Ä—ã'
                },
                'es': {
                    title: 'ü•ó Calculadora de Macros',
                    lbl_cal: 'Calor√≠as Diarias', lbl_goal: 'Meta',
                    opt_bal: 'Balanceado', opt_low: 'Bajo en Carbos',
                    opt_high: 'Alto en Prote√≠na', opt_keto: 'Keto',
                    btn_calc: 'Calcular',
                    res_pro: 'Prote√≠na', res_carb: 'Carbohidratos', res_fat: 'Grasa'
                }
            },

            // Preset ratios (Carb, Protein, Fat)
            presets: {
                balanced: { c: 40, p: 30, f: 30 },
                low_carb: { c: 20, p: 40, f: 40 },
                high_pro: { c: 30, p: 50, f: 20 }, // Aggressive high protein
                keto:     { c: 5,  p: 25, f: 70 }
            },

            changeLang: () => {
                const lang = document.getElementById('mc-lang').value;
                const texts = MacroCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="macro_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) {
                        if(el.tagName === 'OPTION') el.text = texts[key];
                        else el.innerText = texts[key];
                    }
                });
            },

            calc: () => {
                const cals = parseFloat(document.getElementById('mc-cals').value);
                const goal = document.getElementById('mc-goal').value;
                
                if (isNaN(cals)) return;

                const ratio = MacroCalc.presets[goal];
                
                // 1g Carbs = 4 kcal, 1g Protein = 4 kcal, 1g Fat = 9 kcal
                const gCarb = Math.round((cals * (ratio.c / 100)) / 4);
                const gPro = Math.round((cals * (ratio.p / 100)) / 4);
                const gFat = Math.round((cals * (ratio.f / 100)) / 9);

                document.getElementById('val-pro').innerText = gPro + " g";
                document.getElementById('val-carb').innerText = gCarb + " g";
                document.getElementById('val-fat').innerText = gFat + " g";

                document.getElementById('pct-pro').innerText = ratio.p;
                document.getElementById('pct-carb').innerText = ratio.c;
                document.getElementById('pct-fat').innerText = ratio.f;

                document.getElementById('bar-pro').style.width = ratio.p + "%";
                document.getElementById('bar-carb').style.width = ratio.c + "%";
                document.getElementById('bar-fat').style.width = ratio.f + "%";
            }
        };
        
        MacroCalc.calc();
    </script>
</body>
</html>