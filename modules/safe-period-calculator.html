<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe Period Calculator</title>
    
    <!-- Âü∫Á°Ä‰ø°ÊÅØ -->
    <meta name="tool-id" content="safe_period_calc">
    <meta name="category" content="health">
    <meta name="icon" content="üìÖ">
    
    <!-- ÈªòËÆ§Ëã±ÊñáÂÜÖÂÆπ -->
    <meta name="title" content="Safe Period Calculator">
    <meta name="description" content="Calculate your safe period based on menstrual cycle.">
    
    <!-- Â§öËØ≠Ë®ÄÈÖçÁΩÆ -->
    <meta name="lang-title-zh-CN" content="ÂÆâÂÖ®ÊúüËÆ°ÁÆóÂô®">
    <meta name="lang-description-zh-CN" content="Ê†πÊçÆÊúàÁªèÂë®ÊúüËÆ°ÁÆóÊÇ®ÁöÑÂÆâÂÖ®Êúü„ÄÇ">
    
    <meta name="lang-title-zh-TW" content="ÂÆâÂÖ®ÊúüË®àÁÆóÂô®">
    <meta name="lang-description-zh-TW" content="Ê†πÊìöÊúàÁ∂ìÂë®ÊúüË®àÁÆóÊÇ®ÁöÑÂÆâÂÖ®Êúü„ÄÇ">
    
    <meta name="lang-title-ja" content="ÈÅøÂ¶äÊúüÈñìË®àÁÆó„ÉÑ„Éº„É´">
    <meta name="lang-description-ja" content="ÊúàÁµåÂë®Êúü„Å´Âü∫„Å•„ÅÑ„Å¶ÈÅøÂ¶äÊúüÈñì„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ">
    
    <meta name="lang-title-ru" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞">
    <meta name="lang-description-ru" content="–í—ã—á–∏—Å–ª–∏—Ç–µ –≤–∞—à –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.">
    
    <meta name="lang-title-es" content="Calculadora de per√≠odo seguro">
    <meta name="lang-description-es" content="Calcula tu per√≠odo seguro seg√∫n el ciclo menstrual.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0fdf4; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .input-group { margin-bottom: 16px; }
        .result-card { transition: all 0.3s ease; }
        .period-label { display: inline-block; padding: 4px 8px; border-radius: 4px; margin: 2px; }
        .safe { background-color: #dcfce7; color: #166534; }
        .unsafe { background-color: #fee2e2; color: #991b1b; }
        .intro-section { margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 8px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="safe_period_calc" 
         data-category="health" 
         data-title="Safe Period Calculator" 
         data-icon="üìÖ">
        
        <!-- ËØ≠Ë®ÄÈÄâÊã©Âô® -->
        <div class="absolute top-4 right-4">
            <select id="period-lang" onchange="SafePeriodCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-6 text-gray-800 border-b pb-2" data-i18n="title">üìÖ Safe Period Calculator</h2>
        
        <div class="space-y-6">
            <!-- ËæìÂÖ•Âå∫Âüü -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="input-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="last_period_label">First Day of Last Menstruation</label>
                    <input type="date" id="last-period-date" 
                           class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                
                <div class="input-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="cycle_length_label">Average Cycle Length (days)</label>
                    <input type="number" id="cycle-length" min="21" max="35" value="28" 
                           class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                
                <div class="input-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="period_length_label">Menstruation Duration (days)</label>
                    <input type="number" id="period-length" min="3" max="7" value="5" 
                           class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>
            
            <button onclick="SafePeriodCalc.calculate()" 
                    class="w-full bg-blue-600 text-white py-3 rounded font-bold hover:bg-blue-700 transition" 
                    data-i18n="btn_calculate">Calculate Safe Period</button>
            
            <!-- ÁªìÊûúÂå∫Âüü -->
            <div class="bg-blue-50 p-6 rounded-lg border border-blue-100 result-card">
                <div class="text-sm text-gray-500 mb-2" data-i18n="next_period_label">Predicted Next Menstruation</div>
                <div id="next-period" class="text-xl font-bold text-blue-800 mb-4">--</div>
                
                <div class="text-sm text-gray-500 mb-2" data-i18n="ovulation_label">Predicted Ovulation Period</div>
                <div id="ovulation-period" class="text-xl font-bold text-blue-800 mb-4">--</div>
                
                <div class="text-sm text-gray-500 mb-2" data-i18n="safe_period_label">Calculated Safe Period</div>
                <div id="safe-period" class="text-xl font-bold text-blue-800 mb-4">--</div>
                
                <div class="flex flex-wrap mt-4">
                    <div id="calendar-days" class="w-full grid grid-cols-7 gap-1 text-center text-sm"></div>
                </div>
            </div>
            
            <!-- ‰ªãÁªçÈÉ®ÂàÜ -->
            <div class="intro-section">
                <h3 class="font-medium text-gray-800 mb-2" data-i18n="intro_title">About Safe Period Calculation</h3>
                <p class="text-sm text-gray-600" data-i18n="intro_text">The safe period is a natural contraceptive method based on the menstrual cycle. It is most effective for women with regular cycles. This calculator provides an estimate only and should not be used as the sole method of contraception.</p>
            </div>
        </div>
    </div>

    <script>
        const SafePeriodCalc = {
            i18n: {
                'en': {
                    title: 'üìÖ Safe Period Calculator',
                    last_period_label: 'First Day of Last Menstruation',
                    cycle_length_label: 'Average Cycle Length (days)',
                    period_length_label: 'Menstruation Duration (days)',
                    btn_calculate: 'Calculate Safe Period',
                    next_period_label: 'Predicted Next Menstruation',
                    ovulation_label: 'Predicted Ovulation Period',
                    safe_period_label: 'Calculated Safe Period',
                    safe: 'Safe',
                    unsafe: 'Unsafe',
                    menstrual: 'Menstrual',
                    intro_title: 'About Safe Period Calculation',
                    intro_text: 'The safe period is a natural contraceptive method based on the menstrual cycle. It is most effective for women with regular cycles. This calculator provides an estimate only and should not be used as the sole method of contraception.'
                },
                'zh-CN': {
                    title: 'üìÖ ÂÆâÂÖ®ÊúüËÆ°ÁÆóÂô®',
                    last_period_label: '‰∏äÊ¨°ÊúàÁªèÁ¨¨‰∏ÄÂ§©',
                    cycle_length_label: 'Âπ≥ÂùáÂë®ÊúüÈïøÂ∫¶ÔºàÂ§©Ôºâ',
                    period_length_label: 'ÁªèÊúüÊåÅÁª≠Êó∂Èó¥ÔºàÂ§©Ôºâ',
                    btn_calculate: 'ËÆ°ÁÆóÂÆâÂÖ®Êúü',
                    next_period_label: 'È¢ÑËÆ°‰∏ãÊ¨°ÊúàÁªè',
                    ovulation_label: 'È¢ÑËÆ°ÊéíÂçµÊúü',
                    safe_period_label: 'ËÆ°ÁÆóÁöÑÂÆâÂÖ®Êúü',
                    safe: 'ÂÆâÂÖ®',
                    unsafe: '‰∏çÂÆâÂÖ®',
                    menstrual: 'ÁªèÊúü',
                    intro_title: 'ÂÖ≥‰∫éÂÆâÂÖ®ÊúüËÆ°ÁÆó',
                    intro_text: 'ÂÆâÂÖ®ÊúüÊòØÂü∫‰∫éÊúàÁªèÂë®ÊúüÁöÑËá™ÁÑ∂ÈÅøÂ≠ïÊñπÊ≥ïÔºåÂØπÂë®ÊúüËßÑÂæãÁöÑÂ•≥ÊÄßÊúÄÊúâÊïà„ÄÇÊú¨ËÆ°ÁÆóÂô®‰ªÖÊèê‰æõ‰º∞ÁÆóÔºå‰∏çÂ∫î‰Ωú‰∏∫ÂîØ‰∏ÄÁöÑÈÅøÂ≠ïÊñπÊ≥ï„ÄÇ'
                },
                'zh-TW': {
                    title: 'üìÖ ÂÆâÂÖ®ÊúüË®àÁÆóÂô®',
                    last_period_label: '‰∏äÊ¨°ÊúàÁ∂ìÁ¨¨‰∏ÄÂ§©',
                    cycle_length_label: 'Âπ≥ÂùáÈÄ±ÊúüÈï∑Â∫¶ÔºàÂ§©Ôºâ',
                    period_length_label: 'Á∂ìÊúüÊåÅÁ∫åÊôÇÈñìÔºàÂ§©Ôºâ',
                    btn_calculate: 'Ë®àÁÆóÂÆâÂÖ®Êúü',
                    next_period_label: 'È†êË®à‰∏ãÊ¨°ÊúàÁ∂ì',
                    ovulation_label: 'È†êË®àÊéíÂçµÊúü',
                    safe_period_label: 'Ë®àÁÆóÁöÑÂÆâÂÖ®Êúü',
                    safe: 'ÂÆâÂÖ®',
                    unsafe: '‰∏çÂÆâÂÖ®',
                    menstrual: 'Á∂ìÊúü',
                    intro_title: 'ÈóúÊñºÂÆâÂÖ®ÊúüË®àÁÆó',
                    intro_text: 'ÂÆâÂÖ®ÊúüÊòØÂü∫ÊñºÊúàÁ∂ìÈÄ±ÊúüÁöÑËá™ÁÑ∂ÈÅøÂ≠ïÊñπÊ≥ïÔºåÂ∞çÈÄ±ÊúüË¶èÂæãÁöÑÂ•≥ÊÄßÊúÄÊúâÊïà„ÄÇÊú¨Ë®àÁÆóÂô®ÂÉÖÊèê‰æõ‰º∞ÁÆóÔºå‰∏çÊáâ‰ΩúÁÇ∫ÂîØ‰∏ÄÁöÑÈÅøÂ≠ïÊñπÊ≥ï„ÄÇ'
                },
                'ja': {
                    title: 'üìÖ ÈÅøÂ¶äÊúüÈñìË®àÁÆó„ÉÑ„Éº„É´',
                    last_period_label: 'ÂâçÂõûÊúàÁµå„ÅÆÂàùÊó•',
                    cycle_length_label: 'Âπ≥ÂùáÂë®ÊúüÈï∑ÔºàÊó•Ôºâ',
                    period_length_label: 'ÊúàÁµåÊåÅÁ∂öÊúüÈñìÔºàÊó•Ôºâ',
                    btn_calculate: 'ÈÅøÂ¶äÊúüÈñì„ÇíË®àÁÆó',
                    next_period_label: 'Ê¨°ÂõûÊúàÁµå‰∫àÊ∏¨',
                    ovulation_label: 'ÊéíÂçµ‰∫àÊ∏¨ÊúüÈñì',
                    safe_period_label: 'Ë®àÁÆó„Åï„Çå„ÅüÈÅøÂ¶äÊúüÈñì',
                    safe: 'ÂÆâÂÖ®',
                    unsafe: '‰∏çÂÆâÂÖ®',
                    menstrual: 'ÊúàÁµåÊúüÈñì',
                    intro_title: 'ÈÅøÂ¶äÊúüÈñìË®àÁÆó„Å´„Å§„ÅÑ„Å¶',
                    intro_text: 'ÈÅøÂ¶äÊúüÈñì„ÅØÊúàÁµåÂë®Êúü„Å´Âü∫„Å•„ÅèËá™ÁÑ∂ÈÅøÂ¶äÊ≥ï„Åß„ÄÅÂë®Êúü„ÅåË¶èÂâáÁöÑ„Å™Â•≥ÊÄß„Å´ÊúÄ„ÇÇÂäπÊûúÁöÑ„Åß„Åô„ÄÇ„Åì„ÅÆË®àÁÆóÊ©ü„ÅØÊ¶ÇÁÆó„ÇíÊèê‰æõ„Åô„Çã„ÇÇ„ÅÆ„Åß„ÄÅÈÅøÂ¶ä„ÅÆÂîØ‰∏Ä„ÅÆÊñπÊ≥ï„Å®„Åó„Å¶‰ΩøÁî®„Åô„Åπ„Åç„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ'
                },
                'ru': {
                    title: 'üìÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞',
                    last_period_label: '–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–∏',
                    cycle_length_label: '–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∞ (–¥–Ω–µ–π)',
                    period_length_label: '–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–∏ (–¥–Ω–µ–π)',
                    btn_calculate: '–í—ã—á–∏—Å–ª–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–∏–æ–¥',
                    next_period_label: '–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è —Å–ª–µ–¥—É—é—â–∞—è –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏—è',
                    ovulation_label: '–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –æ–≤—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥',
                    safe_period_label: '–í—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–∏–æ–¥',
                    safe: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ',
                    unsafe: '–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ',
                    menstrual: '–ú–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏—è',
                    intro_title: '–û –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞',
                    intro_text: '–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ‚Äî —ç—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–∞—Ü–µ–ø—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–º —Ü–∏–∫–ª–µ. –û–Ω –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∂–µ–Ω—â–∏–Ω —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏. –≠—Ç–æ—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∫—É –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–∞—Ü–µ–ø—Ü–∏–∏.'
                },
                'es': {
                    title: 'üìÖ Calculadora de per√≠odo seguro',
                    last_period_label: 'Primer d√≠a de la √∫ltima menstruaci√≥n',
                    cycle_length_label: 'Duraci√≥n promedio del ciclo (d√≠as)',
                    period_length_label: 'Duraci√≥n de la menstruaci√≥n (d√≠as)',
                    btn_calculate: 'Calcular per√≠odo seguro',
                    next_period_label: 'Pr√≥xima menstruaci√≥n predicha',
                    ovulation_label: 'Periodo de ovulaci√≥n predicho',
                    safe_period_label: 'Periodo seguro calculado',
                    safe: 'Seguro',
                    unsafe: 'No seguro',
                    menstrual: 'Menstruaci√≥n',
                    intro_title: 'Acerca del c√°lculo del per√≠odo seguro',
                    intro_text: 'El per√≠odo seguro es un m√©todo anticonceptivo natural basado en el ciclo menstrual. Es m√°s eficaz para mujeres con ciclos regulares. Esta calculadora solo proporciona una estimaci√≥n y no debe usarse como √∫nico m√©todo de anticoncepci√≥n.'
                }
            },

            init: () => {
                // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫30Â§©Ââç
                const defaultDate = new Date();
                defaultDate.setDate(defaultDate.getDate() - 30);
                document.getElementById('last-period-date').valueAsDate = defaultDate;
            },
            
            calculate: () => {
                const lastPeriodDate = new Date(document.getElementById('last-period-date').value);
                const cycleLength = parseInt(document.getElementById('cycle-length').value) || 28;
                const periodLength = parseInt(document.getElementById('period-length').value) || 5;
                
                if (isNaN(lastPeriodDate.getTime())) {
                    alert('Please select a valid date');
                    return;
                }
                
                // ËÆ°ÁÆó‰∏ãÊ¨°ÊúàÁªèÊó•Êúü
                const nextPeriodDate = new Date(lastPeriodDate);
                nextPeriodDate.setDate(nextPeriodDate.getDate() + cycleLength);
                
                // ËÆ°ÁÆóÊéíÂçµÊúüÔºà‰∏ãÊ¨°ÊúàÁªèÂâç14Â§©Ôºâ
                const ovulationDate = new Date(nextPeriodDate);
                ovulationDate.setDate(ovulationDate.getDate() - 14);
                
                // ÊéíÂçµÊúüÂâçÂêéÂêÑ3Â§©‰∏∫Âç±Èô©Êúü
                const unsafeStart = new Date(ovulationDate);
                unsafeStart.setDate(unsafeStart.getDate() - 3);
                const unsafeEnd = new Date(ovulationDate);
                unsafeEnd.setDate(unsafeEnd.getDate() + 3);
                
                // ËÆ°ÁÆóÂÆâÂÖ®ÊúüÔºàÊúàÁªèÊúüÈó¥ÂíåÊéíÂçµÂç±Èô©Êúü‰πãÂ§ñÔºâ
                const safeStart1 = new Date(lastPeriodDate);
                const safeEnd1 = new Date(lastPeriodDate);
                safeEnd1.setDate(safeEnd1.getDate() + periodLength - 1);
                
                const safeStart2 = new Date(unsafeEnd);
                safeStart2.setDate(safeStart2.getDate() + 1);
                const safeEnd2 = new Date(nextPeriodDate);
                safeEnd2.setDate(safeEnd2.getDate() - 1);
                
                // Êõ¥Êñ∞ÁªìÊûúÊòæÁ§∫
                const formatDate = (date) => {
                    return date.toLocaleDateString([document.getElementById('period-lang').value], {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                };
                
                document.getElementById('next-period').textContent = formatDate(nextPeriodDate);
                document.getElementById('ovulation-period').textContent = `${formatDate(unsafeStart)} - ${formatDate(unsafeEnd)}`;
                
                let safePeriodText = '';
                if (safeStart1 <= safeEnd1) {
                    safePeriodText += `${formatDate(safeStart1)} - ${formatDate(safeEnd1)}`;
                }
                if (safeStart2 <= safeEnd2) {
                    safePeriodText += (safePeriodText ? '; ' : '') + `${formatDate(safeStart2)} - ${formatDate(safeEnd2)}`;
                }
                document.getElementById('safe-period').textContent = safePeriodText;
                
                // ÁîüÊàêÊó•ÂéÜËßÜÂõæ
                SafePeriodCalc.generateCalendar(lastPeriodDate, cycleLength, periodLength, unsafeStart, unsafeEnd);
            },
            
            generateCalendar: (lastPeriod, cycleLength, periodLength, unsafeStart, unsafeEnd) => {
                const calendarDays = document.getElementById('calendar-days');
                calendarDays.innerHTML = '';
                
                const startDate = new Date(lastPeriod);
                const endDate = new Date(lastPeriod);
                endDate.setDate(endDate.getDate() + cycleLength);
                
                const currentDate = new Date(startDate);
                const lang = document.getElementById('period-lang').value;
                const texts = SafePeriodCalc.i18n[lang];
                
                while (currentDate <= endDate) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'p-2 border rounded';
                    
                    // Ê†ºÂºèÂåñÊòæÁ§∫Êó•ÊúüÔºà‰ªÖÊó•Ôºâ
                    dayEl.textContent = currentDate.getDate();
                    
                    // Âà§Êñ≠Êó•ÊúüÁ±ªÂûã
                    const isMenstrual = currentDate <= new Date(lastPeriod.getTime() + (periodLength - 1) * 86400000);
                    const isUnsafe = currentDate >= unsafeStart && currentDate <= unsafeEnd;
                    
                    if (isMenstrual) {
                        dayEl.classList.add('period-label', 'menstrual');
                        dayEl.title = texts.menstrual;
                    } else if (isUnsafe) {
                        dayEl.classList.add('period-label', 'unsafe');
                        dayEl.title = texts.unsafe;
                    } else {
                        dayEl.classList.add('period-label', 'safe');
                        dayEl.title = texts.safe;
                    }
                    
                    calendarDays.appendChild(dayEl);
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            },
            
            changeLang: () => {
                const lang = document.getElementById('period-lang').value;
                const texts = SafePeriodCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="safe_period_calc"] [data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) {
                        el.innerText = texts[key];
                    }
                });
                
                // Â¶ÇÊûúÂ∑≤ÊúâËÆ°ÁÆóÁªìÊûúÔºåÈáçÊñ∞ËÆ°ÁÆó‰ª•Êõ¥Êñ∞Êó•ÊúüÊ†ºÂºè
                if (document.getElementById('next-period').textContent !== '--') {
                    SafePeriodCalc.calculate();
                }
            }
        };

        document.addEventListener('DOMContentLoaded', SafePeriodCalc.init);
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('period-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    SafePeriodCalc.changeLang();
                }
            }
        });
    </script>

</body>
</html>