<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Time Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #fff7ed; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="time_calc" 
         data-category="date" 
         data-title="Time Calculator" 
         data-icon="⏰">
        
        <div class="absolute top-4 right-4">
            <select id="tc-lang" onchange="TimeCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">簡體中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
                <option value="es">Español</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">⏰ Time Calculator</h2>
        
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_start">Start Time</label>
            <input type="time" id="tc-start" class="w-full p-2 border rounded focus:ring-2 focus:ring-orange-500 outline-none" value="12:00">
        </div>

        <div class="flex gap-4 mb-4">
            <div class="w-1/3">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_op">Operation</label>
                <select id="tc-op" class="w-full p-2 border rounded bg-white">
                    <option value="add" data-i18n="op_add">Add (+)</option>
                    <option value="sub" data-i18n="op_sub">Subtract (-)</option>
                </select>
            </div>
            <div class="w-2/3">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="lbl_duration">Hours / Minutes / Seconds</label>
                <div class="grid grid-cols-3 gap-2">
                    <input type="number" id="tc-h" class="p-2 border rounded text-center" placeholder="Hr">
                    <input type="number" id="tc-m" class="p-2 border rounded text-center" placeholder="Min">
                    <input type="number" id="tc-s" class="p-2 border rounded text-center" placeholder="Sec">
                </div>
            </div>
        </div>

        <button onclick="TimeCalc.calc()" class="w-full bg-orange-500 text-white py-2 rounded font-bold hover:bg-orange-600 transition mb-6" data-i18n="btn_calc">Calculate New Time</button>

        <div class="bg-orange-50 p-4 rounded-lg border border-orange-100 text-center">
            <span class="text-gray-500 text-sm block" data-i18n="res_time">Result Time</span>
            <div id="tc-result" class="text-3xl font-bold text-orange-800 mt-1">--</div>
            <div id="tc-note" class="text-xs text-gray-500 mt-1 h-4"></div>
        </div>
    </div>

    <script>
        const TimeCalc = {
            i18n: {
                'en': {
                    title: '⏰ Time Calculator',
                    lbl_start: 'Start Time',
                    lbl_op: 'Operation', op_add: 'Add (+)', op_sub: 'Subtract (-)',
                    lbl_duration: 'Hours / Minutes / Seconds',
                    btn_calc: 'Calculate New Time',
                    res_time: 'Result Time',
                    note_next: 'Next Day', note_prev: 'Previous Day'
                },
                'zh-CN': {
                    title: '⏰ 时间计算器',
                    lbl_start: '开始时间',
                    lbl_op: '操作', op_add: '加上 (+)', op_sub: '减去 (-)',
                    lbl_duration: '时 / 分 / 秒',
                    btn_calc: '计算新时间',
                    res_time: '结果时间',
                    note_next: '次日', note_prev: '前一日'
                },
                'zh-TW': {
                    title: '⏰ 時間計算器',
                    lbl_start: '開始時間',
                    lbl_op: '操作', op_add: '加上 (+)', op_sub: '減去 (-)',
                    lbl_duration: '時 / 分 / 秒',
                    btn_calc: '計算新時間',
                    res_time: '結果時間',
                    note_next: '次日', note_prev: '前一日'
                },
                'ja': {
                    title: '⏰ 時間計算',
                    lbl_start: '開始時間',
                    lbl_op: '操作', op_add: '足す (+)', op_sub: '引く (-)',
                    lbl_duration: '時 / 分 / 秒',
                    btn_calc: '計算する',
                    res_time: '計算結果',
                    note_next: '翌日', note_prev: '前日'
                },
                'ru': {
                    title: '⏰ Калькулятор времени',
                    lbl_start: 'Время начала',
                    lbl_op: 'Действие', op_add: 'Прибавить (+)', op_sub: 'Вычесть (-)',
                    lbl_duration: 'Часы / Минуты / Секунды',
                    btn_calc: 'Рассчитать',
                    res_time: 'Результат',
                    note_next: 'След. день', note_prev: 'Пред. день'
                },
                'es': {
                    title: '⏰ Calculadora de Tiempo',
                    lbl_start: 'Hora de Inicio',
                    lbl_op: 'Operación', op_add: 'Sumar (+)', op_sub: 'Restar (-)',
                    lbl_duration: 'Horas / Minutos / Segundos',
                    btn_calc: 'Calcular',
                    res_time: 'Resultado',
                    note_next: 'Día Siguiente', note_prev: 'Día Anterior'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('tc-lang').value;
                const texts = TimeCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="time_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) el.innerText = texts[key];
                });
                const opts = document.querySelectorAll('#tc-op option');
                opts.forEach(op => {
                    const key = op.getAttribute('data-i18n');
                    if(texts[key]) op.text = texts[key];
                });
            },

            calc: () => {
                const timeStr = document.getElementById('tc-start').value;
                if (!timeStr) return;

                const parts = timeStr.split(':');
                let h = parseInt(parts[0]);
                let m = parseInt(parts[1]);
                
                const dh = parseInt(document.getElementById('tc-h').value) || 0;
                const dm = parseInt(document.getElementById('tc-m').value) || 0;
                const ds = parseInt(document.getElementById('tc-s').value) || 0;
                
                const op = document.getElementById('tc-op').value === 'add' ? 1 : -1;

                // Normalize start to seconds
                let totalSec = (h * 3600) + (m * 60);
                
                // Add duration in seconds
                let diffSec = (dh * 3600) + (dm * 60) + ds;
                
                let finalSec = totalSec + (diffSec * op);
                
                // Handle day overflow/underflow
                const secondsInDay = 86400;
                let dayShift = 0;
                
                if (finalSec >= secondsInDay) {
                    dayShift = Math.floor(finalSec / secondsInDay);
                    finalSec = finalSec % secondsInDay;
                } else if (finalSec < 0) {
                    dayShift = Math.floor(finalSec / secondsInDay); // -1 for prev day
                    finalSec = (finalSec % secondsInDay + secondsInDay) % secondsInDay;
                }

                // Convert back to HH:MM:SS
                let rh = Math.floor(finalSec / 3600);
                let rm = Math.floor((finalSec % 3600) / 60);
                let rs = finalSec % 60;

                const pad = (n) => n < 10 ? '0'+n : n;
                
                document.getElementById('tc-result').innerText = `${pad(rh)}:${pad(rm)}:${pad(rs)}`;
                
                const lang = document.getElementById('tc-lang').value;
                const txt = TimeCalc.i18n[lang];
                let note = "";
                
                if (dayShift > 0) note = `(+${dayShift} ${txt.note_next || 'Day'})`;
                else if (dayShift < 0) note = `(${dayShift} ${txt.note_prev || 'Day'})`;
                
                document.getElementById('tc-note').innerText = note;
            }
        };
    </script>
</body>
</html>