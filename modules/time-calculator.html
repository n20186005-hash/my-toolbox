<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Calculator</title>
    
    <!-- 基础信息 -->
    <meta name="tool-id" content="time_calc">
    <meta name="category" content="utilities">
    <meta name="icon" content="⏰">
    
    <!-- 默认英文内容 -->
    <meta name="title" content="Time Calculator">
    <meta name="description" content="Calculate time differences and durations.">
    
    <!-- 多语言配置 -->
    <meta name="lang-title-zh-CN" content="时间计算器">
    <meta name="lang-description-zh-CN" content="计算时间差和持续时间。">
    
    <meta name="lang-title-zh-TW" content="時間計算器">
    <meta name="lang-description-zh-TW" content="計算時間差和持續時間。">
    
    <meta name="lang-title-ja" content="時間計算ツール">
    <meta name="lang-description-ja" content="時間の差と期間を計算します。">
    
    <meta name="lang-title-ru" content="Калькулятор времени">
    <meta name="lang-description-ru" content="Вычислите разницу во времени и длительность.">
    
    <meta name="lang-title-es" content="Calculadora de Tiempo">
    <meta name="lang-description-es" content="Calcule diferencias de tiempo y duraciones.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .time-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
        .input-group { margin-bottom: 12px; }
        label { display: block; margin-bottom: 4px; font-medium text-gray-700; }
        input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="time_calc" 
         data-category="utilities" 
         data-title="Time Calculator" 
         data-icon="⏰">
        
        <!-- 语言选择器 -->
        <div class="absolute top-4 right-4">
            <select id="time-lang" onchange="TimeCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
                <option value="es">Español</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">⏰ Time Calculator</h2>
        
        <div class="space-y-4">
            <div class="time-inputs">
                <div>
                    <div class="input-group">
                        <label data-i18n="start_time">Start Time</label>
                        <input type="time" id="start-time" class="focus:ring-2 focus:ring-blue-500 outline-none" value="00:00">
                    </div>
                    <div class="input-group">
                        <label data-i18n="start_date">Start Date (optional)</label>
                        <input type="date" id="start-date" class="focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                </div>
                
                <div>
                    <div class="input-group">
                        <label data-i18n="end_time">End Time</label>
                        <input type="time" id="end-time" class="focus:ring-2 focus:ring-blue-500 outline-none" value="00:00">
                    </div>
                    <div class="input-group">
                        <label data-i18n="end_date">End Date (optional)</label>
                        <input type="date" id="end-date" class="focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                </div>
            </div>
            
            <button onclick="TimeCalc.calc()" class="w-full bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700 transition mb-6" data-i18n="btn_calc">Calculate Difference</button>

            <div class="bg-blue-50 p-6 rounded-lg border border-blue-100">
                <div class="text-sm text-gray-500 mb-2" data-i18n="result_label">Time Difference</div>
                <div id="time-result" class="text-2xl font-bold text-blue-800">--</div>
                <div class="grid grid-cols-2 gap-4 mt-4 text-sm">
                    <div>
                        <span class="text-gray-600" data-i18n="days">Days:</span>
                        <span id="diff-days" class="font-medium">0</span>
                    </div>
                    <div>
                        <span class="text-gray-600" data-i18n="hours">Hours:</span>
                        <span id="diff-hours" class="font-medium">0</span>
                    </div>
                    <div>
                        <span class="text-gray-600" data-i18n="minutes">Minutes:</span>
                        <span id="diff-minutes" class="font-medium">0</span>
                    </div>
                    <div>
                        <span class="text-gray-600" data-i18n="seconds">Seconds:</span>
                        <span id="diff-seconds" class="font-medium">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const TimeCalc = {
            i18n: {
                'en': {
                    title: '⏰ Time Calculator',
                    start_time: 'Start Time',
                    start_date: 'Start Date (optional)',
                    end_time: 'End Time',
                    end_date: 'End Date (optional)',
                    btn_calc: 'Calculate Difference',
                    result_label: 'Time Difference',
                    days: 'Days:',
                    hours: 'Hours:',
                    minutes: 'Minutes:',
                    seconds: 'Seconds:',
                    err_invalid: 'Please enter valid times'
                },
                'zh-CN': {
                    title: '⏰ 时间计算器',
                    start_time: '开始时间',
                    start_date: '开始日期（可选）',
                    end_time: '结束时间',
                    end_date: '结束日期（可选）',
                    btn_calc: '计算时间差',
                    result_label: '时间差',
                    days: '天：',
                    hours: '小时：',
                    minutes: '分钟：',
                    seconds: '秒：',
                    err_invalid: '请输入有效的时间'
                },
                'zh-TW': {
                    title: '⏰ 時間計算器',
                    start_time: '開始時間',
                    start_date: '開始日期（可選）',
                    end_time: '結束時間',
                    end_date: '結束日期（可選）',
                    btn_calc: '計算時間差',
                    result_label: '時間差',
                    days: '天：',
                    hours: '小時：',
                    minutes: '分鐘：',
                    seconds: '秒：',
                    err_invalid: '請輸入有效的時間'
                },
                'ja': {
                    title: '⏰ 時間計算ツール',
                    start_time: '開始時間',
                    start_date: '開始日（オプション）',
                    end_time: '終了時間',
                    end_date: '終了日（オプション）',
                    btn_calc: '差分を計算',
                    result_label: '時間の差分',
                    days: '日：',
                    hours: '時間：',
                    minutes: '分：',
                    seconds: '秒：',
                    err_invalid: '有効な時間を入力してください'
                },
                'ru': {
                    title: '⏰ Калькулятор времени',
                    start_time: 'Начальное время',
                    start_date: 'Начальная дата (опционально)',
                    end_time: 'Конечное время',
                    end_date: 'Конечная дата (опционально)',
                    btn_calc: 'Вычислить разницу',
                    result_label: 'Разница во времени',
                    days: 'Дни:',
                    hours: 'Часы:',
                    minutes: 'Минуты:',
                    seconds: 'Секунды:',
                    err_invalid: 'Пожалуйста, введите действительное время'
                },
                'es': {
                    title: '⏰ Calculadora de Tiempo',
                    start_time: 'Hora de inicio',
                    start_date: 'Fecha de inicio (opcional)',
                    end_time: 'Hora de finalización',
                    end_date: 'Fecha de finalización (opcional)',
                    btn_calc: 'Calcular diferencia',
                    result_label: 'Diferencia de tiempo',
                    days: 'Días:',
                    hours: 'Horas:',
                    minutes: 'Minutos:',
                    seconds: 'Segundos:',
                    err_invalid: 'Por favor, ingrese horas válidas'
                }
            },

            init: () => {},

            changeLang: () => {
                const lang = document.getElementById('time-lang').value;
                const texts = TimeCalc.i18n[lang];
                document.querySelectorAll('[data-id="time_calc"] [data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
            },

            calc: () => {
                const lang = document.getElementById('time-lang').value;
                const texts = TimeCalc.i18n[lang];
                
                const startDate = document.getElementById('start-date').value;
                const startTime = document.getElementById('start-time').value;
                const endDate = document.getElementById('end-date').value;
                const endTime = document.getElementById('end-time').value;

                // 设置默认日期（如果未提供）
                const defaultDate = new Date().toISOString().split('T')[0];
                const start = new Date(`${startDate || defaultDate}T${startTime}`);
                const end = new Date(`${endDate || defaultDate}T${endTime}`);

                if (isNaN(start.getTime()) || isNaN(end.getTime())) {
                    document.getElementById('time-result').innerText = texts.err_invalid;
                    document.getElementById('time-result').className = "text-xl font-bold text-red-600";
                    return;
                }

                // 计算时间差（毫秒）
                const diffMs = Math.abs(end - start);
                
                // 转换为天、时、分、秒
                const seconds = Math.floor(diffMs / 1000) % 60;
                const minutes = Math.floor(diffMs / (1000 * 60)) % 60;
                const hours = Math.floor(diffMs / (1000 * 60 * 60)) % 24;
                const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));

                // 格式化结果
                const resultText = `${days}d ${hours}h ${minutes}m ${seconds}s`;
                
                // 更新UI
                document.getElementById('time-result').innerText = resultText;
                document.getElementById('time-result').className = "text-2xl font-bold text-blue-800";
                document.getElementById('diff-days').innerText = days;
                document.getElementById('diff-hours').innerText = hours;
                document.getElementById('diff-minutes').innerText = minutes;
                document.getElementById('diff-seconds').innerText = seconds;
            }
        };

        document.addEventListener('DOMContentLoaded', TimeCalc.init);
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('time-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    TimeCalc.changeLang();
                }
            }
        });
    </script>

</body>
</html>