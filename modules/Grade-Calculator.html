<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="grade_calc">
    <meta name="category" content="education">
    <meta name="icon" content="ğŸ“š">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ -->
    <meta name="title" content="Grade Calculator">
    <meta name="description" content="Calculate your overall course grade based on weighted assignments.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="æˆç»©è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="æ ¹æ®åŠ æƒä½œä¸šè®¡ç®—ä½ çš„æ•´ä½“è¯¾ç¨‹æˆç»©ã€‚">
    
    <meta name="lang-title-zh-TW" content="æˆç¸¾è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="æ ¹æ“šåŠ æ¬Šä½œæ¥­è¨ˆç®—ä½ çš„æ•´é«”èª²ç¨‹æˆç¸¾ã€‚">
    
    <meta name="lang-title-ja" content="æˆç¸¾è¨ˆç®—ãƒ„ãƒ¼ãƒ«">
    <meta name="lang-description-ja" content="åŠ é‡å¹³å‡ã®èª²é¡Œã«åŸºã¥ã„ã¦ç·åˆçš„ãªã‚³ãƒ¼ã‚¹æˆç¸¾ã‚’è¨ˆç®—ã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¾Ñ†ĞµĞ½Ğ¾Ğº">
    <meta name="lang-description-ru" content="Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚Ğµ Ğ¾Ğ±Ñ‰ÑƒÑ Ğ¾Ñ†ĞµĞ½ĞºÑƒ Ğ·Ğ° ĞºÑƒÑ€Ñ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ğ·Ğ²ĞµÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹.">
    
    <meta name="lang-title-es" content="Calculadora de Calificaciones">
    <meta name="lang-description-es" content="Calcula tu calificaciÃ³n general del curso segÃºn las tareas ponderadas.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .assignment-row { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr auto; gap: 8px; align-items: center; margin-bottom: 8px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="grade_calc" 
         data-category="education" 
         data-title="Grade Calculator" 
         data-icon="ğŸ“š">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="grade-lang" onchange="GradeCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                <option value="es">EspaÃ±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ğŸ“š Grade Calculator</h2>
        
        <div class="space-y-4">
            <div id="assignments-container">
                <div class="assignment-row font-medium text-gray-700">
                    <div data-i18n="assignment_label">Assignment</div>
                    <div data-i18n="score_label">Score</div>
                    <div data-i18n="max_score_label">Max Score</div>
                    <div data-i18n="weight_label">Weight (%)</div>
                    <div></div>
                </div>
                
                <!-- ä½œä¸šè¡Œ1 -->
                <div class="assignment-row" id="assignment-1">
                    <input type="text" class="assignment-name p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. Midterm">
                    <input type="number" class="assignment-score p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="0" value="85">
                    <input type="number" class="assignment-max p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="1" value="100">
                    <input type="number" class="assignment-weight p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="0" max="100" value="30">
                    <button onclick="GradeCalc.removeAssignment(1)" class="text-red-500 hover:text-red-700" disabled>Ã—</button>
                </div>
            </div>
            
            <button onclick="GradeCalc.addAssignment()" class="w-full bg-gray-200 text-gray-800 py-2 rounded font-medium hover:bg-gray-300 transition mb-4" data-i18n="add_assignment">Add Another Assignment</button>
            
            <div class="bg-gray-50 p-4 rounded-lg border border-gray-100 mb-4">
                <div class="flex justify-between items-center">
                    <label class="text-sm font-medium text-gray-700" data-i18n="desired_label">Desired Final Grade:</label>
                    <div class="flex items-center">
                        <input type="number" id="desired-grade" class="p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none w-20" min="0" max="100" value="90">
                        <span class="ml-2 text-gray-600">%</span>
                    </div>
                </div>
            </div>
            
            <button onclick="GradeCalc.calc()" class="w-full bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700 transition mb-6" data-i18n="btn_calc">Calculate Grade</button>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-blue-50 p-6 rounded-lg border border-blue-100 text-center">
                    <div class="text-sm text-gray-500 mb-2" data-i18n="current_label">Current Grade</div>
                    <div id="current-grade" class="text-3xl font-bold text-blue-800">--</div>
                    <div class="text-sm text-gray-600 mt-2" data-i18n="current_desc">Based on completed assignments</div>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg border border-green-100 text-center">
                    <div class="text-sm text-gray-500 mb-2" data-i18n="needed_label">Needed on Remaining</div>
                    <div id="needed-grade" class="text-3xl font-bold text-green-800">--</div>
                    <div class="text-sm text-gray-600 mt-2" data-i18n="needed_desc">To reach desired grade</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const GradeCalc = {
            assignmentCount: 1,
            
            i18n: {
                'en': {
                    title: 'ğŸ“š Grade Calculator',
                    assignment_label: 'Assignment',
                    score_label: 'Score',
                    max_score_label: 'Max Score',
                    weight_label: 'Weight (%)',
                    add_assignment: 'Add Another Assignment',
                    desired_label: 'Desired Final Grade:',
                    btn_calc: 'Calculate Grade',
                    current_label: 'Current Grade',
                    current_desc: 'Based on completed assignments',
                    needed_label: 'Needed on Remaining',
                    needed_desc: 'To reach desired grade',
                    err_no_data: 'Please enter assignment data',
                    percent: '%'
                },
                'zh-CN': {
                    title: 'ğŸ“š æˆç»©è®¡ç®—å™¨',
                    assignment_label: 'ä½œä¸š',
                    score_label: 'å¾—åˆ†',
                    max_score_label: 'æ»¡åˆ†',
                    weight_label: 'æƒé‡ (%)',
                    add_assignment: 'æ·»åŠ å¦ä¸€é¡¹ä½œä¸š',
                    desired_label: 'æœŸæœ›æœ€ç»ˆæˆç»©ï¼š',
                    btn_calc: 'è®¡ç®—æˆç»©',
                    current_label: 'å½“å‰æˆç»©',
                    current_desc: 'åŸºäºå·²å®Œæˆçš„ä½œä¸š',
                    needed_label: 'å‰©ä½™ä½œä¸šæ‰€éœ€åˆ†æ•°',
                    needed_desc: 'ä»¥è¾¾åˆ°æœŸæœ›æˆç»©',
                    err_no_data: 'è¯·è¾“å…¥ä½œä¸šæ•°æ®',
                    percent: '%'
                },
                'zh-TW': {
                    title: 'ğŸ“š æˆç¸¾è¨ˆç®—å™¨',
                    assignment_label: 'ä½œæ¥­',
                    score_label: 'å¾—åˆ†',
                    max_score_label: 'æ»¿åˆ†',
                    weight_label: 'æ¬Šé‡ (%)',
                    add_assignment: 'æ·»åŠ å¦ä¸€é …ä½œæ¥­',
                    desired_label: 'æœŸæœ›æœ€çµ‚æˆç¸¾ï¼š',
                    btn_calc: 'è¨ˆç®—æˆç¸¾',
                    current_label: 'ç•¶å‰æˆç¸¾',
                    current_desc: 'åŸºæ–¼å·²å®Œæˆçš„ä½œæ¥­',
                    needed_label: 'å‰©é¤˜ä½œæ¥­æ‰€éœ€åˆ†æ•¸',
                    needed_desc: 'ä»¥é”åˆ°æœŸæœ›æˆç¸¾',
                    err_no_data: 'è«‹è¼¸å…¥ä½œæ¥­æ•¸æ“š',
                    percent: '%'
                },
                'ja': {
                    title: 'ğŸ“š æˆç¸¾è¨ˆç®—ãƒ„ãƒ¼ãƒ«',
                    assignment_label: 'èª²é¡Œ',
                    score_label: 'å¾—ç‚¹',
                    max_score_label: 'æº€ç‚¹',
                    weight_label: 'ã‚¦ã‚§ã‚¤ãƒˆ (%)',
                    add_assignment: 'åˆ¥ã®èª²é¡Œã‚’è¿½åŠ ',
                    desired_label: 'ç›®æ¨™ã®æœ€çµ‚æˆç¸¾ï¼š',
                    btn_calc: 'æˆç¸¾ã‚’è¨ˆç®—',
                    current_label: 'ç¾åœ¨ã®æˆç¸¾',
                    current_desc: 'å®Œäº†ã—ãŸèª²é¡Œã«åŸºã¥ã',
                    needed_label: 'æ®‹ã‚Šã®èª²é¡Œã§å¿…è¦ãªå¾—ç‚¹',
                    needed_desc: 'ç›®æ¨™ã®æˆç¸¾ã‚’é”æˆã™ã‚‹ãŸã‚',
                    err_no_data: 'èª²é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
                    percent: '%'
                },
                'ru': {
                    title: 'ğŸ“š ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¾Ñ†ĞµĞ½Ğ¾Ğº',
                    assignment_label: 'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ',
                    score_label: 'Ğ‘Ğ°Ğ»Ğ»Ñ‹',
                    max_score_label: 'ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²',
                    weight_label: 'Ğ’ĞµÑ (%)',
                    add_assignment: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ',
                    desired_label: 'Ğ–ĞµĞ»Ğ°ĞµĞ¼Ğ°Ñ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ°ï¼š',
                    btn_calc: 'Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¾Ñ†ĞµĞ½ĞºÑƒ',
                    current_label: 'Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ°',
                    current_desc: 'ĞĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹',
                    needed_label: 'ĞÑƒĞ¶Ğ½Ğ¾ Ğ½Ğ° Ğ¾ÑÑ‚Ğ°Ğ²ÑˆĞ¸Ñ…ÑÑ',
                    needed_desc: 'Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ´Ğ¾ÑÑ‚Ğ¸Ñ‡ÑŒ Ğ¶ĞµĞ»Ğ°ĞµĞ¼Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸',
                    err_no_data: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸ÑÑ…',
                    percent: '%'
                },
                'es': {
                    title: 'ğŸ“š Calculadora de Calificaciones',
                    assignment_label: 'Tarea',
                    score_label: 'PuntuaciÃ³n',
                    max_score_label: 'PuntuaciÃ³n mÃ¡xima',
                    weight_label: 'Peso (%)',
                    add_assignment: 'Agregar otra tarea',
                    desired_label: 'CalificaciÃ³n final deseadaï¼š',
                    btn_calc: 'Calcular calificaciÃ³n',
                    current_label: 'CalificaciÃ³n actual',
                    current_desc: 'Basado en tareas completadas',
                    needed_label: 'Necesario en el resto',
                    needed_desc: 'Para alcanzar la calificaciÃ³n deseada',
                    err_no_data: 'Por favor, ingrese datos de la tarea',
                    percent: '%'
                }
            },

            init: () => {
                // åˆå§‹è®¾ç½®å·²åœ¨HTMLä¸­
            },

            addAssignment: () => {
                GradeCalc.assignmentCount++;
                const container = document.getElementById('assignments-container');
                
                const newAssignment = document.createElement('div');
                newAssignment.className = 'assignment-row';
                newAssignment.id = `assignment-${GradeCalc.assignmentCount}`;
                newAssignment.innerHTML = `
                    <input type="text" class="assignment-name p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="${GradeCalc.getPlaceholderText()}">
                    <input type="number" class="assignment-score p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="0" value="85">
                    <input type="number" class="assignment-max p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="1" value="100">
                    <input type="number" class="assignment-weight p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" min="0" max="100" value="${30 / GradeCalc.assignmentCount}">
                    <button onclick="GradeCalc.removeAssignment(${GradeCalc.assignmentCount})" class="text-red-500 hover:text-red-700">Ã—</button>
                `;
                
                container.appendChild(newAssignment);
                
                // å¯ç”¨ç¬¬ä¸€è¡Œçš„åˆ é™¤æŒ‰é’®ï¼ˆå¦‚æœæœ‰å¤šä¸ªä½œä¸šï¼‰
                if (GradeCalc.assignmentCount > 1) {
                    document.querySelector('#assignment-1 button').disabled = false;
                }
            },
            
            getPlaceholderText: () => {
                const lang = document.getElementById('grade-lang').value;
                switch(lang) {
                    case 'zh-CN': return 'ä¾‹å¦‚ï¼šæœŸä¸­è€ƒè¯•';
                    case 'zh-TW': return 'ä¾‹å¦‚ï¼šæœŸä¸­è€ƒè©¦';
                    case 'ja': return 'ä¾‹ï¼šä¸­é–“è©¦é¨“';
                    case 'ru': return 'Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: ĞŸÑ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½';
                    case 'es': return 'ej: Examen parcial';
                    default: return 'e.g. Midterm';
                }
            },

            removeAssignment: (id) => {
                const assignment = document.getElementById(`assignment-${id}`);
                if (assignment) assignment.remove();
                
                GradeCalc.assignmentCount--;
                
                // å¦‚æœåªå‰©ä¸€ä¸ªä½œä¸šï¼Œç¦ç”¨åˆ é™¤æŒ‰é’®
                if (GradeCalc.assignmentCount === 1) {
                    document.querySelector('#assignment-1 button').disabled = true;
                }
            },

            changeLang: () => {
                const lang = document.getElementById('grade-lang').value;
                const texts = GradeCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="grade_calc"] [data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
                
                // æ›´æ–°å ä½ç¬¦
                document.querySelectorAll('.assignment-name').forEach(input => {
                    input.placeholder = GradeCalc.getPlaceholderText();
                });

                if (document.getElementById('current-grade').innerText !== '--') {
                    GradeCalc.calc();
                }
            },

            calc: () => {
                const lang = document.getElementById('grade-lang').value;
                const texts = GradeCalc.i18n[lang];
                
                const assignments = document.querySelectorAll('.assignment-row');
                let totalPoints = 0;
                let totalWeight = 0;
                let hasData = false;
                
                assignments.forEach((assignment, index) => {
                    // è·³è¿‡æ ‡é¢˜è¡Œ
                    if (index === 0) return;
                    
                    const score = parseFloat(assignment.querySelector('.assignment-score').value);
                    const max = parseFloat(assignment.querySelector('.assignment-max').value);
                    const weight = parseFloat(assignment.querySelector('.assignment-weight').value);
                    
                    if (!isNaN(score) && !isNaN(max) && !isNaN(weight) && max > 0 && weight > 0) {
                        // è®¡ç®—è¯¥ä½œä¸šçš„åŠ æƒåˆ†æ•°
                        const percentage = score / max;
                        totalPoints += percentage * weight;
                        totalWeight += weight;
                        hasData = true;
                    }
                });
                
                const currentEl = document.getElementById('current-grade');
                const neededEl = document.getElementById('needed-grade');
                const desiredGrade = parseFloat(document.getElementById('desired-grade').value) || 0;
                
                if (!hasData) {
                    currentEl.innerText = texts.err_no_data;
                    currentEl.className = "text-xl font-bold text-red-600";
                    neededEl.innerText = '--';
                    neededEl.className = "text-3xl font-bold text-green-800";
                    return;
                }
                
                // è®¡ç®—å½“å‰æˆç»©
                const currentGrade = (totalPoints / totalWeight) * 100;
                currentEl.className = "text-3xl font-bold text-blue-800";
                currentEl.innerText = currentGrade.toFixed(1) + texts.percent;
                
                // è®¡ç®—å‰©ä½™æƒé‡
                const remainingWeight = 100 - totalWeight;
                
                // è®¡ç®—éœ€è¦çš„åˆ†æ•°
                if (remainingWeight <= 0) {
                    neededEl.innerText = '-';
                } else {
                    // å…¬å¼ï¼š(å½“å‰å¾—åˆ† + (éœ€è¦çš„åˆ†æ•° Ã— å‰©ä½™æƒé‡)) / 100 = æœŸæœ›æˆç»©
                    const neededScore = ((desiredGrade * 100) - totalPoints) / remainingWeight * 100;
                    const displayScore = neededScore > 100 ? 100 : neededScore < 0 ? 0 : neededScore;
                    
                    neededEl.className = "text-3xl font-bold text-green-800";
                    neededEl.innerText = displayScore.toFixed(1) + texts.percent;
                    
                    // å¦‚æœéœ€è¦è¶…è¿‡100%ï¼Œæ˜¾ç¤ºçº¢è‰²
                    if (neededScore > 100) {
                        neededEl.className = "text-3xl font-bold text-red-600";
                    }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', GradeCalc.init);
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('grade-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    GradeCalc.changeLang();
                }
            }
        });
    </script>

</body>
</html>