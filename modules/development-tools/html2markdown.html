<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="category" content="Development Tools">
    <title>HTMLè½¬MarkDown</title>
    <!-- ä½¿ç”¨ data URI ä½œç‚º favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ”„</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Turndown ç”¨æ–¼ HTML -> MD -->
    <script src="https://cdn.jsdelivr.net/npm/turndown@7.1.2/dist/turndown.js"></script>
    <!-- å¼•å…¥ Marked ç”¨æ–¼ MD -> HTML (æ–°å¢) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        body { padding: 20px; background: #f0fdf4; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 900px; margin: 0 auto; position: relative; }
        .section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.9rem; color: #4b5563; margin-bottom: 4px; }
        textarea, select { width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 1rem; }
        textarea { min-height: 200px; resize: vertical; font-family: monospace; }
        .result-stats { display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #a7f3d0; flex-wrap: wrap; gap: 10px;}
        .stat-label { color: #1e3a8a; font-size: 0.9rem;}
        .stat-value { font-weight: 600; color: #065f46; margin-left: 5px;}
        .intro-section { margin-top: 30px; padding: 20px; background-color: #f8fafc; border-radius: 8px; font-size: 0.95rem; color: #475569; }
        .options-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        button { padding: 10px 15px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background 0.3s; border: none; }
        .btn-primary { background: #22c55e; color: white; }
        .btn-primary:hover { background: #16a34a; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-danger:hover { background: #dc2626; }
        .direction-tabs { display: flex; margin-bottom: 15px; border: 1px solid #d1d5db; border-radius: 6px; overflow: hidden; }
        .direction-tab { flex: 1; padding: 10px; text-align: center; cursor: pointer; background: #f3f4f6; transition: all 0.3s; }
        .direction-tab.active { background: #22c55e; color: white; }
    </style>
    <link rel="canonical" href="https://toolboxpro.top/modules/development-tools/html2markdown.html" />
</head>
<body>
    <div class="tool-module" id="html2markdown-tool">
        <!-- Language Selector -->
        <div class="absolute top-4 right-4">
            <select id="lang-selector" onchange="Html2Markdown.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN" selected>ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-6 text-gray-800 border-b pb-2" data-i18n="title">ğŸ”„ HTMLè½¬MarkDown</h2>

        <div class="space-y-6">
            <!-- Direction Selection -->
            <div class="direction-tabs">
                <div class="direction-tab active" id="dir_html2md" onclick="Html2Markdown.setDirection('html2md')" data-i18n="html_to_md">HTML â†’ MarkDown</div>
                <div class="direction-tab" id="dir_md2html" onclick="Html2Markdown.setDirection('md2html')" data-i18n="md_to_html">MarkDown â†’ HTML</div>
            </div>

            <!-- Input Section -->
            <div class="section">
                <h3 class="text-lg font-semibold mb-4 text-gray-700" id="input_label" data-i18n="input_html">è¾“å…¥HTML</h3>
                <div class="form-group">
                    <textarea id="input_content" placeholder="è¯·è¾“å…¥HTMLä»£ç ..." class="focus:ring-2 focus:ring-green-500 outline-none"></textarea>
                </div>

                <div class="flex gap-4">
                    <button onclick="Html2Markdown.convert()" class="flex-1 btn-primary" data-i18n="btn_convert">è½¬æ¢</button>
                    <button onclick="Html2Markdown.clearAll()" class="flex-1 btn-danger" data-i18n="btn_clear">æ¸…ç©ºæ‰€æœ‰</button>
                </div>
            </div>

            <!-- Results -->
            <div class="summary-section mt-8">
                <h3 class="text-lg font-semibold mb-4 text-gray-700" id="result_label" data-i18n="result_md">MarkDownç»“æœ</h3>
                
                <div class="result-stats">
                    <div>
                        <span class="stat-label" data-i18n="char_count">å­—ç¬¦æ•°ï¼š</span>
                        <span class="stat-value" id="char_count">0</span>
                    </div>
                    <div>
                        <span class="stat-label" data-i18n="process_time">è½¬æ¢è€—æ—¶ï¼š</span>
                        <span class="stat-value" id="process_time">0ms</span>
                    </div>
                </div>
                <div class="form-group">
                    <label id="result_content_label" data-i18n="result_md_text">MarkDownæ–‡æœ¬</label>
                    <textarea id="result_content" readonly class="focus:ring-2 focus:ring-green-500 outline-none bg-gray-50 text-gray-700" placeholder="è½¬æ¢åçš„MarkDownå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                </div>
                <button onclick="Html2Markdown.copyResult()" class="w-full mt-2 bg-blue-600 text-white py-3 rounded font-medium hover:bg-blue-700 transition shadow-md" data-i18n="btn_copy">å¤åˆ¶ç»“æœ</button>
            </div>

            <!-- Intro -->
            <div class="intro-section">
                <h3 class="text-lg font-semibold mb-2 text-gray-800" data-i18n="intro_title">å…³äºHTMLä¸MarkDownäº’è½¬å·¥å…·</h3>
                <p data-i18n="intro_text">æœ¬å·¥å…·æ”¯æŒHTMLä¸MarkDownæ ¼å¼çš„ç›¸äº’è½¬æ¢ã€‚å¯å°†HTMLæ ‡ç­¾è½¬æ¢ä¸ºç®€æ´çš„MarkDownè¯­æ³•ï¼Œä¹Ÿèƒ½å°†MarkDownæ–‡æœ¬è¿˜åŸä¸ºå¯¹åº”çš„HTMLä»£ç ã€‚é€‚ç”¨äºå†…å®¹åˆ›ä½œè€…ã€åšå®¢ä½œè€…å’Œéœ€è¦åœ¨ä¸åŒæ ¼å¼é—´è½¬æ¢æ–‡æ¡£çš„ç”¨æˆ·ï¼Œä¿æŒå†…å®¹ç»“æ„å’Œæ ¼å¼çš„ä¸€è‡´æ€§ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        const Html2Markdown = {
            direction: 'html2md', // é»˜è®¤æ–¹å‘: htmlåˆ°markdown
            turndownService: null,

            i18n: {
                'en': {
                    title: 'ğŸ”„ HTML to MarkDown',
                    html_to_md: 'HTML â†’ MarkDown',
                    md_to_html: 'MarkDown â†’ HTML',
                    input_html: 'Input HTML',
                    input_md: 'Input MarkDown',
                    btn_convert: 'Convert',
                    btn_clear: 'Clear All',
                    result_md: 'MarkDown Result',
                    result_html: 'HTML Result',
                    result_md_text: 'MarkDown Text',
                    result_html_text: 'HTML Code',
                    char_count: 'Character Count:',
                    process_time: 'Conversion Time:',
                    btn_copy: 'Copy Result',
                    intro_title: 'About HTML-MarkDown Converter',
                    intro_text: 'This tool supports mutual conversion between HTML and MarkDown formats. It can convert HTML tags to concise MarkDown syntax, and also restore MarkDown text to corresponding HTML code. Suitable for content creators, bloggers and users who need to convert documents between different formats while maintaining content structure and format consistency.',
                    please_enter_content: 'Please enter some content first',
                    conversion_error: 'Conversion error',
                    copied: 'Copied!'
                },
                'zh-CN': {
                    title: 'ğŸ”„ HTMLè½¬MarkDown',
                    html_to_md: 'HTML â†’ MarkDown',
                    md_to_html: 'MarkDown â†’ HTML',
                    input_html: 'è¾“å…¥HTML',
                    input_md: 'è¾“å…¥MarkDown',
                    btn_convert: 'è½¬æ¢',
                    btn_clear: 'æ¸…ç©ºæ‰€æœ‰',
                    result_md: 'MarkDownç»“æœ',
                    result_html: 'HTMLç»“æœ',
                    result_md_text: 'MarkDownæ–‡æœ¬',
                    result_html_text: 'HTMLä»£ç ',
                    char_count: 'å­—ç¬¦æ•°ï¼š',
                    process_time: 'è½¬æ¢è€—æ—¶ï¼š',
                    btn_copy: 'å¤åˆ¶ç»“æœ',
                    intro_title: 'å…³äºHTMLä¸MarkDownäº’è½¬å·¥å…·',
                    intro_text: 'æœ¬å·¥å…·æ”¯æŒHTMLä¸MarkDownæ ¼å¼çš„ç›¸äº’è½¬æ¢ã€‚å¯å°†HTMLæ ‡ç­¾è½¬æ¢ä¸ºç®€æ´çš„MarkDownè¯­æ³•ï¼Œä¹Ÿèƒ½å°†MarkDownæ–‡æœ¬è¿˜åŸä¸ºå¯¹åº”çš„HTMLä»£ç ã€‚é€‚ç”¨äºå†…å®¹åˆ›ä½œè€…ã€åšå®¢ä½œè€…å’Œéœ€è¦åœ¨ä¸åŒæ ¼å¼é—´è½¬æ¢æ–‡æ¡£çš„ç”¨æˆ·ï¼Œä¿æŒå†…å®¹ç»“æ„å’Œæ ¼å¼çš„ä¸€è‡´æ€§ã€‚',
                    please_enter_content: 'è¯·å…ˆè¾“å…¥å†…å®¹',
                    conversion_error: 'è½¬æ¢é”™è¯¯',
                    copied: 'å·²å¤åˆ¶ï¼'
                },
                'zh-TW': {
                    title: 'ğŸ”„ HTMLè½‰MarkDown',
                    html_to_md: 'HTML â†’ MarkDown',
                    md_to_html: 'MarkDown â†’ HTML',
                    input_html: 'è¼¸å…¥HTML',
                    input_md: 'è¼¸å…¥MarkDown',
                    btn_convert: 'è½‰æ›',
                    btn_clear: 'æ¸…ç©ºæ‰€æœ‰',
                    result_md: 'MarkDownçµæœ',
                    result_html: 'HTMLçµæœ',
                    result_md_text: 'MarkDownæ–‡æœ¬',
                    result_html_text: 'HTMLä»£ç¢¼',
                    char_count: 'å­—ç¬¦æ•¸ï¼š',
                    process_time: 'è½‰æ›è€—æ™‚ï¼š',
                    btn_copy: 'è¤‡è£½çµæœ',
                    intro_title: 'é—œæ–¼HTMLèˆ‡MarkDownäº’è½‰å·¥å…·',
                    intro_text: 'æœ¬å·¥å…·æ”¯æŒHTMLèˆ‡MarkDownæ ¼å¼çš„ç›¸äº’è½‰æ›ã€‚å¯å°‡HTMLæ¨™ç±¤è½‰æ›ç‚ºç°¡æ½”çš„MarkDownèªæ³•ï¼Œä¹Ÿèƒ½å°‡MarkDownæ–‡æœ¬é‚„åŸç‚ºå°æ‡‰çš„HTMLä»£ç¢¼ã€‚é©ç”¨æ–¼å…§å®¹å‰µä½œè€…ã€åšå®¢ä½œè€…å’Œéœ€è¦åœ¨ä¸åŒæ ¼å¼é–“è½‰æ›æ–‡æª”çš„ç”¨æˆ¶ï¼Œä¿æŒå…§å®¹çµæ§‹å’Œæ ¼å¼çš„ä¸€è‡´æ€§ã€‚',
                    please_enter_content: 'è«‹å…ˆè¼¸å…¥å…§å®¹',
                    conversion_error: 'è½‰æ›éŒ¯èª¤',
                    copied: 'å·²è¤‡è£½ï¼'
                },
                'ja': {
                    title: 'ğŸ”„ HTMLã‹ã‚‰MarkDownã¸',
                    html_to_md: 'HTML â†’ MarkDown',
                    md_to_html: 'MarkDown â†’ HTML',
                    input_html: 'HTMLã‚’å…¥åŠ›',
                    input_md: 'MarkDownã‚’å…¥åŠ›',
                    btn_convert: 'å¤‰æ›',
                    btn_clear: 'ã™ã¹ã¦ã‚¯ãƒªã‚¢',
                    result_md: 'MarkDownçµæœ',
                    result_html: 'HTMLçµæœ',
                    result_md_text: 'MarkDownãƒ†ã‚­ã‚¹ãƒˆ',
                    result_html_text: 'HTMLã‚³ãƒ¼ãƒ‰',
                    char_count: 'æ–‡å­—æ•°ï¼š',
                    process_time: 'å¤‰æ›æ™‚é–“ï¼š',
                    btn_copy: 'çµæœã‚’ã‚³ãƒ”ãƒ¼',
                    intro_title: 'HTMLã¨MarkDownã®ç›¸äº’å¤‰æ›ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦',
                    intro_text: 'ã“ã®ãƒ„ãƒ¼ãƒ«ã¯HTMLã¨MarkDownå½¢å¼ã®ç›¸äº’å¤‰æ›ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚HTMLã‚¿ã‚°ã‚’ç°¡æ½”ãªMarkDownæ§‹æ–‡ã«å¤‰æ›ã—ãŸã‚Šã€MarkDownãƒ†ã‚­ã‚¹ãƒˆã‚’å¯¾å¿œã™ã‚‹HTMLã‚³ãƒ¼ãƒ‰ã«å¾©å…ƒã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¯ãƒªã‚¨ãƒ¼ã‚¿ãƒ¼ã€ãƒ–ãƒ­ã‚¬ãƒ¼ã€ãŠã‚ˆã³ã•ã¾ã–ã¾ãªå½¢å¼é–“ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©ã—ã¦ãŠã‚Šã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ§‹é€ ã¨å½¢å¼ã®ä¸€è²«æ€§ã‚’ç¶­æŒã—ã¾ã™ã€‚',
                    please_enter_content: 'ã¾ãšã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
                    conversion_error: 'å¤‰æ›ã‚¨ãƒ©ãƒ¼',
                    copied: 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼'
                },
                'ru': {
                    title: 'ğŸ”„ HTML Ğ² MarkDown',
                    html_to_md: 'HTML â†’ MarkDown',
                    md_to_html: 'MarkDown â†’ HTML',
                    input_html: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ HTML',
                    input_md: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ MarkDown',
                    btn_convert: 'ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
                    btn_clear: 'ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ',
                    result_md: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ MarkDown',
                    result_html: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ HTML',
                    result_md_text: 'Ğ¢ĞµĞºÑÑ‚ MarkDown',
                    result_html_text: 'ĞšĞ¾Ğ´ HTML',
                    char_count: 'ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²:',
                    process_time: 'Ğ’Ñ€ĞµĞ¼Ñ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:',
                    btn_copy: 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                    intro_title: 'Ğ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ĞµÑ€Ğµ HTML-MarkDown',
                    intro_text: 'Ğ­Ñ‚Ğ¾Ñ‚ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¾Ğ² HTML Ğ¸ MarkDown. ĞĞ½ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ HTML-Ñ‚ĞµĞ³Ğ¸ Ğ² Ğ»Ğ°ĞºĞ¾Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ MarkDown, Ğ° Ñ‚Ğ°ĞºĞ¶Ğµ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚ MarkDown Ğ² ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ HTML-ĞºĞ¾Ğ´. ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚- ĞºÑ€ĞµĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ², Ğ±Ğ»Ğ¾Ğ³ĞµÑ€Ğ¾Ğ² Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¼ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ğ¼Ğ¸, ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾.',
                    please_enter_content: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚',
                    conversion_error: 'ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ',
                    copied: 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!'
                }
            },

            init: function() {
                // ä»URLè·å–è¯­è¨€å‚æ•° (åŠ å…¥éŒ¯èª¤è™•ç†ä»¥é˜²æ­¢åœ¨æŸäº›ç’°å¢ƒä¸‹å´©æ½°)
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    const lang = urlParams.get('lang');
                    if (lang && this.i18n[lang]) {
                        document.getElementById('lang-selector').value = lang;
                    }
                } catch (e) {
                    console.log('Cannot access URL parameters:', e);
                }
                
                this.changeLang();
                
                // åˆå§‹åŒ–Markdownè§£æå™¨
                this.initParsers();
                
                // ç›‘å¬è¾“å…¥å˜åŒ–æ›´æ–°å­—ç¬¦æ•°
                document.getElementById('input_content').addEventListener('input', () => {
                    this.updateCharCount();
                });
            },

            initParsers: function() {
                // é…ç½®TurndownæœåŠ¡ (HTML -> MD)
                if (typeof TurndownService !== 'undefined') {
                    this.turndownService = new TurndownService({
                        headingStyle: 'atx',
                        bulletListMarker: '-',
                        codeBlockStyle: 'fenced'
                    });
                } else {
                    console.error('TurndownService is not loaded');
                }

                // Marked (MD -> HTML) ä¸éœ€è¦é¢å¤–åˆå§‹åŒ–ï¼Œç›´æ¥ä½¿ç”¨ marked.parse()
            },

            setDirection: function(direction) {
                this.direction = direction;
                
                // æ›´æ–°æ ‡ç­¾çŠ¶æ€
                document.getElementById('dir_html2md').classList.remove('active');
                document.getElementById('dir_md2html').classList.remove('active');
                document.getElementById(`dir_${direction}`).classList.add('active');
                
                // æ›´æ–°æ ‡ç­¾æ–‡æœ¬
                const inputLabel = document.getElementById('input_label');
                const resultLabel = document.getElementById('result_label');
                const resultContentLabel = document.getElementById('result_content_label');
                const lang = document.getElementById('lang-selector').value;
                
                if (direction === 'html2md') {
                    inputLabel.textContent = this.i18n[lang]['input_html'];
                    resultLabel.textContent = this.i18n[lang]['result_md'];
                    resultContentLabel.textContent = this.i18n[lang]['result_md_text'];
                    document.getElementById('input_content').placeholder = this.i18n[lang]['input_html'] + '...';
                    document.getElementById('result_content').placeholder = this.i18n[lang]['result_md_text'] + '...';
                } else {
                    inputLabel.textContent = this.i18n[lang]['input_md'];
                    resultLabel.textContent = this.i18n[lang]['result_html'];
                    resultContentLabel.textContent = this.i18n[lang]['result_html_text'];
                    document.getElementById('input_content').placeholder = this.i18n[lang]['input_md'] + '...';
                    document.getElementById('result_content').placeholder = this.i18n[lang]['result_html_text'] + '...';
                }
                
                // æ¸…ç©ºå†…å®¹
                this.clearAll();
            },

            changeLang: function() {
                const lang = document.getElementById('lang-selector').value;
                const elements = document.querySelectorAll('[data-i18n]');
                
                // æ›´æ–°é¡µé¢æ–‡æœ¬
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang][key]) {
                        el.textContent = this.i18n[lang][key];
                    }
                });
                
                // æ›´æ–°æ–¹å‘ç›¸å…³æ–‡æœ¬
                this.setDirection(this.direction);
                
                // æ›´æ–°é¡µé¢æ ‡é¢˜
                document.title = this.i18n[lang]['title'];
                
                // æ›´æ–°URLå‚æ•° - ä½¿ç”¨ try-catch åŒ…è£¹ä»¥é˜²æ­¢ SecurityError
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    urlParams.set('lang', lang);
                    window.history.replaceState(null, '', `${window.location.pathname}?${urlParams}`);
                } catch (e) {
                    console.warn('Sandbox environment: history.replaceState is not available. URL language parameter not updated.');
                }
            },

            convert: function() {
                const input = document.getElementById('input_content').value.trim();
                const lang = document.getElementById('lang-selector').value;
                
                if (!input) {
                    alert(this.i18n[lang]['please_enter_content']);
                    return;
                }

                try {
                    const start = performance.now();
                    let result;
                    
                    if (this.direction === 'html2md') {
                        // HTMLè½¬Markdown
                        if (this.turndownService) {
                            result = this.turndownService.turndown(input);
                        } else {
                            throw new Error('Turndown service not initialized');
                        }
                    } else {
                        // Markdownè½¬HTML (ä½¿ç”¨ marked åº“)
                        if (typeof marked !== 'undefined') {
                            // breaks: true å…è®¸å›è½¦æ¢è¡Œï¼Œgfm: true å¯ç”¨ GitHub é£æ ¼ Markdown
                            result = marked.parse(input, { breaks: true, gfm: true });
                        } else {
                            throw new Error('Marked library not loaded');
                        }
                    }
                    
                    const end = performance.now();
                    
                    document.getElementById('result_content').value = result;
                    document.getElementById('process_time').textContent = `${Math.round(end - start)}ms`;
                    this.updateCharCount();
                } catch (e) {
                    console.error(e);
                    alert(`${this.i18n[lang]['conversion_error']}: ${e.message}`);
                }
            },

            clearAll: function() {
                document.getElementById('input_content').value = '';
                document.getElementById('result_content').value = '';
                document.getElementById('char_count').textContent = '0';
                document.getElementById('process_time').textContent = '0ms';
            },

            copyResult: function() {
                const result = document.getElementById('result_content');
                if (!result.value) return;
                
                result.select();
                try {
                    document.execCommand('copy');
                    alert(this.i18n[document.getElementById('lang-selector').value]['copied']);
                } catch (err) {
                    console.error('Copy failed', err);
                }
            },

            updateCharCount: function() {
                const result = document.getElementById('result_content').value;
                document.getElementById('char_count').textContent = result.length.toString();
            }
        };

        // åˆå§‹åŒ–å·¥å…·
        document.addEventListener('DOMContentLoaded', () => {
            Html2Markdown.init();
        });
    </script>

    <div id="related-tools-container"></div>
    <script src="/scripts/related.js"></script>
    
</body>

</html>
