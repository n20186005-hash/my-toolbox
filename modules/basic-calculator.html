<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Calculator</title>
    
    <!-- 基础信息 -->
    <meta name="tool-id" content="basic_calc">
    <meta name="category" content="Math">
    <meta name="icon" content="➕➖✖️➗">
    
    <!-- 默认英文内容 -->
    <meta name="title" content="Basic Calculator">
    <meta name="description" content="Perform basic arithmetic operations: addition, subtraction, multiplication, and division.">
    
    <!-- 多语言配置 -->
    <meta name="lang-title-zh-CN" content="基本计算器">
    <meta name="lang-description-zh-CN" content="执行基本算术运算：加、减、乘、除。">
    
    <meta name="lang-title-zh-TW" content="基本計算器">
    <meta name="lang-description-zh-TW" content="執行基本算術運算：加、減、乘、除。">
    
    <meta name="lang-title-ja" content="基本計算ツール">
    <meta name="lang-description-ja" content="基本的な算術演算（足し算、引き算、掛け算、割り算）を実行します。">
    
    <meta name="lang-title-ru" content="Базовый калькулятор">
    <meta name="lang-description-ru" content="Выполняйте базовые арифметические операции: сложение, вычитание, умножение и деление.">
    
    <meta name="lang-title-es" content="Calculadora Básica">
    <meta name="lang-description-es" content="Realice operaciones aritméticas básicas: suma, resta, multiplicación y división.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; margin: 0 auto; position: relative; }
        .calc-display { min-height: 60px; margin-bottom: 10px; padding: 10px; background-color: #f8fafc; border-radius: 5px; text-align: right; font-size: 24px; overflow-x: auto; }
        .calc-buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .calc-btn { padding: 15px; font-size: 18px; border: none; border-radius: 5px; cursor: pointer; transition: all 0.2s; }
        .calc-btn-number { background-color: #e2e8f0; }
        .calc-btn-number:hover { background-color: #cbd5e1; }
        .calc-btn-operator { background-color: #94a3b8; color: white; }
        .calc-btn-operator:hover { background-color: #64748b; }
        .calc-btn-clear { background-color: #f87171; color: white; }
        .calc-btn-clear:hover { background-color: #ef4444; }
        .calc-btn-equals { background-color: #4ade80; grid-column: span 2; }
        .calc-btn-equals:hover { background-color: #22c55e; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="basic_calc" 
         data-category="math" 
         data-title="Basic Calculator" 
         data-icon="➕➖✖️➗">
        
        <!-- 语言选择器 -->
        <div class="absolute top-4 right-4">
            <select id="bc-lang" onchange="BasicCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
                <option value="es">Español</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">➕➖✖️➗ Basic Calculator</h2>
        
        <div class="calc-display" id="bc-display">0</div>
        
        <div class="calc-buttons">
            <button class="calc-btn calc-btn-clear" onclick="BasicCalc.clear()" data-i18n="btn_clear">C</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('±')" data-i18n="btn_negate">±</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('%')">%</button>
            <button class="calc-btn calc-btn-operator" onclick="BasicCalc.setOperator('/')">÷</button>
            
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('7')">7</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('8')">8</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('9')">9</button>
            <button class="calc-btn calc-btn-operator" onclick="BasicCalc.setOperator('*')">×</button>
            
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('4')">4</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('5')">5</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('6')">6</button>
            <button class="calc-btn calc-btn-operator" onclick="BasicCalc.setOperator('-')">−</button>
            
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('1')">1</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('2')">2</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('3')">3</button>
            <button class="calc-btn calc-btn-operator" onclick="BasicCalc.setOperator('+')">+</button>
            
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('0')">0</button>
            <button class="calc-btn calc-btn-number" onclick="BasicCalc.append('.')">.</button>
            <button class="calc-btn calc-btn-equals" onclick="BasicCalc.calculate()" data-i18n="btn_equals">=</button>
        </div>
    </div>

    <script>
        const BasicCalc = {
            i18n: {
                'en': {
                    title: '➕➖✖️➗ Basic Calculator',
                    btn_clear: 'C',
                    btn_negate: '±',
                    btn_equals: '=',
                    err_invalid: 'Error',
                    err_div_zero: 'Division by zero'
                },
                'zh-CN': {
                    title: '➕➖✖️➗ 基本计算器',
                    btn_clear: '清除',
                    btn_negate: '正负',
                    btn_equals: '等于',
                    err_invalid: '错误',
                    err_div_zero: '除以零错误'
                },
                'zh-TW': {
                    title: '➕➖✖️➗ 基本計算器',
                    btn_clear: '清除',
                    btn_negate: '正負',
                    btn_equals: '等於',
                    err_invalid: '錯誤',
                    err_div_zero: '除以零錯誤'
                },
                'ja': {
                    title: '➕➖✖️➗ 基本計算ツール',
                    btn_clear: 'クリア',
                    btn_negate: '±',
                    btn_equals: '＝',
                    err_invalid: 'エラー',
                    err_div_zero: 'ゼロによる除算'
                },
                'ru': {
                    title: '➕➖✖️➗ Базовый калькулятор',
                    btn_clear: 'С',
                    btn_negate: '±',
                    btn_equals: '=',
                    err_invalid: 'Ошибка',
                    err_div_zero: 'Деление на ноль'
                },
                'es': {
                    title: '➕➖✖️➗ Calculadora Básica',
                    btn_clear: 'C',
                    btn_negate: '±',
                    btn_equals: '=',
                    err_invalid: 'Error',
                    err_div_zero: 'División por cero'
                }
            },

            // 计算器状态
            state: {
                currentValue: '0',
                previousValue: null,
                operator: null,
                resetOnNextInput: false
            },

            // 更新显示
            updateDisplay: () => {
                const display = document.getElementById('bc-display');
                display.innerText = BasicCalc.state.currentValue;
            },

            // 清除所有
            clear: () => {
                BasicCalc.state = {
                    currentValue: '0',
                    previousValue: null,
                    operator: null,
                    resetOnNextInput: false
                };
                BasicCalc.updateDisplay();
            },

            // 追加数字或小数点
            append: (value) => {
                const state = BasicCalc.state;
                
                // 处理正负号
                if (value === '±') {
                    state.currentValue = (parseFloat(state.currentValue) * -1).toString();
                    BasicCalc.updateDisplay();
                    return;
                }
                
                // 处理百分比
                if (value === '%') {
                    state.currentValue = (parseFloat(state.currentValue) / 100).toString();
                    BasicCalc.updateDisplay();
                    return;
                }
                
                // 如果需要重置显示
                if (state.resetOnNextInput) {
                    state.currentValue = '0';
                    state.resetOnNextInput = false;
                }
                
                // 处理小数点
                if (value === '.') {
                    if (!state.currentValue.includes('.')) {
                        state.currentValue += '.';
                    }
                    BasicCalc.updateDisplay();
                    return;
                }
                
                // 处理数字
                if (state.currentValue === '0') {
                    state.currentValue = value;
                } else {
                    state.currentValue += value;
                }
                
                BasicCalc.updateDisplay();
            },

            // 设置运算符
            setOperator: (operator) => {
                const state = BasicCalc.state;
                
                // 如果已经有运算符，则先计算
                if (state.operator && state.previousValue !== null) {
                    BasicCalc.calculate();
                }
                
                // 保存当前值和运算符
                state.previousValue = state.currentValue;
                state.operator = operator;
                state.resetOnNextInput = true;
            },

            // 计算结果
            calculate: () => {
                const state = BasicCalc.state;
                const texts = BasicCalc.i18n[document.getElementById('bc-lang').value];
                
                if (!state.operator || state.previousValue === null) {
                    return;
                }
                
                const num1 = parseFloat(state.previousValue);
                const num2 = parseFloat(state.currentValue);
                let result;
                
                try {
                    switch (state.operator) {
                        case '+':
                            result = num1 + num2;
                            break;
                        case '-':
                            result = num1 - num2;
                            break;
                        case '*':
                            result = num1 * num2;
                            break;
                        case '/':
                            if (num2 === 0) {
                                throw new Error('division by zero');
                            }
                            result = num1 / num2;
                            break;
                        default:
                            throw new Error('invalid operator');
                    }
                    
                    // 处理大数字显示
                    if (result.toString().length > 10) {
                        result = result.toExponential(6);
                    } else if (Number.isInteger(result)) {
                        result = result.toString();
                    } else {
                        // 限制小数位数
                        result = result.toFixed(6).replace(/\.?0+$/, '');
                    }
                    
                    state.currentValue = result;
                    state.previousValue = null;
                    state.operator = null;
                    state.resetOnNextInput = true;
                } catch (error) {
                    if (error.message === 'division by zero') {
                        state.currentValue = texts.err_div_zero;
                    } else {
                        state.currentValue = texts.err_invalid;
                    }
                    state.previousValue = null;
                    state.operator = null;
                    state.resetOnNextInput = true;
                }
                
                BasicCalc.updateDisplay();
            },

            changeLang: () => {
                const lang = document.getElementById('bc-lang').value;
                const texts = BasicCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="basic_calc"] [data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
            }
        };

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 自动匹配浏览器语言
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) {
                targetLang = 'ja';
            } else if (userLang.startsWith('ru')) {
                targetLang = 'ru';
            } else if (userLang.startsWith('es')) {
                targetLang = 'es';
            }
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('bc-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    BasicCalc.changeLang();
                }
            }
        });
    </script>

</body>

</html>
