<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample Size Calculator</title>
    
    <!-- Âü∫Á°Ä‰ø°ÊÅØ -->
    <meta name="tool-id" content="sample_size_calculator">
    <meta name="category" content="statistics">
    <meta name="icon" content="üìä">
    
    <!-- ÈªòËÆ§Ëã±ÊñáÂÜÖÂÆπ -->
    <meta name="title" content="Sample Size Calculator">
    <meta name="description" content="Calculate required sample size for surveys and statistical studies based on confidence level and margin of error.">
    
    <!-- Â§öËØ≠Ë®ÄÈÖçÁΩÆ -->
    <meta name="lang-title-zh-CN" content="Ê†∑Êú¨ÈáèËÆ°ÁÆóÂô®">
    <meta name="lang-description-zh-CN" content="Ê†πÊçÆÁΩÆ‰ø°Ê∞¥Âπ≥ÂíåËØØÂ∑ÆËåÉÂõ¥ËÆ°ÁÆóË∞ÉÊü•ÂíåÁªüËÆ°Á†îÁ©∂ÊâÄÈúÄÁöÑÊ†∑Êú¨Èáè„ÄÇ">
    
    <meta name="lang-title-zh-TW" content="Ê®£Êú¨ÈáèË®àÁÆóÂô®">
    <meta name="lang-description-zh-TW" content="Ê†πÊìö‰ø°Ë≥¥Ê∞¥Âπ≥ÂíåË™§Â∑ÆÁØÑÂúçË®àÁÆóË™øÊü•ÂíåÁµ±Ë®àÁ†îÁ©∂ÊâÄÈúÄÁöÑÊ®£Êú¨Èáè„ÄÇ">
    
    <meta name="lang-title-ja" content="Ê®ôÊú¨Êï∞Ë®àÁÆó„ÉÑ„Éº„É´">
    <meta name="lang-description-ja" content="‰ø°È†ºÊ∞¥Ê∫ñ„Å®Ë™§Â∑ÆÁØÑÂõ≤„Å´Âü∫„Å•„ÅÑ„Å¶„ÄÅË™øÊüª„Å®Áµ±Ë®àÁ†îÁ©∂„Å´ÂøÖË¶Å„Å™Ê®ôÊú¨Êï∞„ÇíË®àÁÆó„Åó„Åæ„Åô„ÄÇ">
    
    <meta name="lang-title-ru" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –≤—ã–±–æ—Ä–∫–∏">
    <meta name="lang-description-ru" content="–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –æ–ø—Ä–æ—Å–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è –∏ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ—à–∏–±–∫–∏.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .result-container { word-break: break-all; }
        .result-box { background: #e8f4f8; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: center; }
        .formula-box { background: #f8fafc; padding: 10px; border-radius: 6px; font-family: monospace; margin: 10px 0; }
        .input-group { display: flex; flex-wrap: wrap; gap: 10px; margin: 10px 0; }
        .input-item { flex: 1; min-width: 150px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="sample_size_calculator" 
         data-category="statistics" 
         data-title="Sample Size Calculator" 
         data-icon="üìä">
        
        <!-- ËØ≠Ë®ÄÈÄâÊã©Âô® -->
        <div class="absolute top-4 right-4">
            <select id="sample-lang" onchange="SampleSizeCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">üìä Sample Size Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <!-- ÊÄª‰ΩìÂ§ßÂ∞èËæìÂÖ• -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="population_size">Population Size</label>
                <input type="number" id="pop-size" step="1" min="1" value="10000" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                <div class="text-xs text-gray-500 mt-1" data-i18n="pop_note">Total number of people/items in the population</div>
            </div>
            
            <!-- ÁΩÆ‰ø°Ê∞¥Âπ≥ÈÄâÊã© -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="confidence_level">Confidence Level</label>
                <select id="confidence-level" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                    <option value="90">90%</option>
                    <option value="95" selected>95%</option>
                    <option value="99">99%</option>
                </select>
            </div>
            
            <!-- ËØØÂ∑ÆËåÉÂõ¥ËæìÂÖ• -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="margin_error">Margin of Error (%)</label>
                <input type="number" id="margin-error" step="0.1" min="0.1" max="50" value="5" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
            </div>
            
            <!-- È¢ÑÊúüÊØî‰æãËæìÂÖ• -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="expected_proportion">Expected Proportion (%)</label>
                <input type="number" id="expected-prop" step="1" min="0" max="100" value="50" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
                <div class="text-xs text-gray-500 mt-1" data-i18n="prop_note">Use 50% if unsure (maximizes sample size)</div>
            </div>

            <!-- ËÆ°ÁÆóÊåâÈíÆ -->
            <button onclick="SampleSizeCalc.calculate()" class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" data-i18n="calculate">Calculate Sample Size</button>
        </div>
        
        <!-- ÁªìÊûúÂ±ïÁ§∫Âå∫Âüü -->
        <div class="result-container mt-6 pt-4 border-t">
            <h3 class="text-lg font-semibold mb-3 text-gray-700" data-i18n="result">Results</h3>
            <div class="result-box" id="sample-result">
                <div data-i18n="result_placeholder">Sample size result will be shown here</div>
            </div>
            
            <div class="formula-box mt-4" id="sample-formula">
                <div data-i18n="formula_placeholder">Formula used: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤</div>
            </div>
        </div>
    </div>

    <script>
        const SampleSizeCalc = {
            // Â§öËØ≠Ë®ÄÊñáÊú¨Êò†Â∞Ñ
            translations: {
                en: {
                    title: "üìä Sample Size Calculator",
                    population_size: "Population Size",
                    pop_note: "Total number of people/items in the population",
                    confidence_level: "Confidence Level",
                    margin_error: "Margin of Error (%)",
                    expected_proportion: "Expected Proportion (%)",
                    prop_note: "Use 50% if unsure (maximizes sample size)",
                    calculate: "Calculate Sample Size",
                    result: "Results",
                    result_placeholder: "Sample size result will be shown here",
                    formula_placeholder: "Formula used: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤",
                    required_sample: "Required Sample Size",
                    error: "Error",
                    invalid_input: "Please enter valid values"
                },
                "zh-CN": {
                    title: "üìä Ê†∑Êú¨ÈáèËÆ°ÁÆóÂô®",
                    population_size: "ÊÄª‰ΩìÂ§ßÂ∞è",
                    pop_note: "ÊÄª‰Ωì‰∏≠ÁöÑÊÄª‰∫∫Êï∞/È°πÁõÆÊï∞",
                    confidence_level: "ÁΩÆ‰ø°Ê∞¥Âπ≥",
                    margin_error: "ËØØÂ∑ÆËåÉÂõ¥ (%)",
                    expected_proportion: "È¢ÑÊúüÊØî‰æã (%)",
                    prop_note: "‰∏çÁ°ÆÂÆöÊó∂‰ΩøÁî®50%Ôºà‰ºöÂæóÂà∞ÊúÄÂ§ßÊ†∑Êú¨ÈáèÔºâ",
                    calculate: "ËÆ°ÁÆóÊ†∑Êú¨Èáè",
                    result: "ÁªìÊûú",
                    result_placeholder: "Ê†∑Êú¨ÈáèÁªìÊûúÂ∞ÜÊòæÁ§∫Âú®ËøôÈáå",
                    formula_placeholder: "‰ΩøÁî®ÁöÑÂÖ¨Âºè: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤",
                    required_sample: "ÊâÄÈúÄÊ†∑Êú¨Èáè",
                    error: "ÈîôËØØ",
                    invalid_input: "ËØ∑ËæìÂÖ•ÊúâÊïàÂÄº"
                },
                "zh-TW": {
                    title: "üìä Ê®£Êú¨ÈáèË®àÁÆóÂô®",
                    population_size: "Á∏ΩÈ´îÂ§ßÂ∞è",
                    pop_note: "Á∏ΩÈ´î‰∏≠ÁöÑÁ∏Ω‰∫∫Êï∏/È†ÖÁõÆÊï∏",
                    confidence_level: "‰ø°Ë≥¥Ê∞¥Âπ≥",
                    margin_error: "Ë™§Â∑ÆÁØÑÂúç (%)",
                    expected_proportion: "È†êÊúüÊØî‰æã (%)",
                    prop_note: "‰∏çÁ¢∫ÂÆöÊôÇ‰ΩøÁî®50%ÔºàÊúÉÂæóÂà∞ÊúÄÂ§ßÊ®£Êú¨ÈáèÔºâ",
                    calculate: "Ë®àÁÆóÊ®£Êú¨Èáè",
                    result: "ÁµêÊûú",
                    result_placeholder: "Ê®£Êú¨ÈáèÁµêÊûúÂ∞áÈ°ØÁ§∫Âú®ÈÄôË£°",
                    formula_placeholder: "‰ΩøÁî®ÁöÑÂÖ¨Âºè: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤",
                    required_sample: "ÊâÄÈúÄÊ®£Êú¨Èáè",
                    error: "ÈåØË™§",
                    invalid_input: "Ë´ãËº∏ÂÖ•ÊúâÊïàÂÄº"
                },
                ja: {
                    title: "üìä Ê®ôÊú¨Êï∞Ë®àÁÆó„ÉÑ„Éº„É´",
                    population_size: "ÊØçÈõÜÂõ£„Çµ„Ç§„Ç∫",
                    pop_note: "ÊØçÈõÜÂõ£„ÅÆÁ∑è‰∫∫Êï∞/È†ÖÁõÆÊï∞",
                    confidence_level: "‰ø°È†ºÊ∞¥Ê∫ñ",
                    margin_error: "Ë™§Â∑ÆÁØÑÂõ≤ (%)",
                    expected_proportion: "‰∫àÊÉ≥„Åï„Çå„ÇãÂâ≤Âêà (%)",
                    prop_note: "‰∏çÊòé„ÅÆÂ†¥Âêà„ÅØ50%„Çí‰ΩøÁî®ÔºàÊúÄÂ§ßÊ®ôÊú¨Êï∞„Å´„Å™„Çä„Åæ„ÅôÔºâ",
                    calculate: "Ê®ôÊú¨Êï∞„ÇíË®àÁÆó",
                    result: "ÁµêÊûú",
                    result_placeholder: "Ê®ôÊú¨Êï∞„ÅÆÁµêÊûú„ÅØ„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô",
                    formula_placeholder: "‰ΩøÁî®„Åï„Çå„ÅüÂÖ¨Âºè: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤",
                    required_sample: "ÂøÖË¶Å„Å™Ê®ôÊú¨Êï∞",
                    error: "„Ç®„É©„Éº",
                    invalid_input: "ÊúâÂäπ„Å™ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
                },
                ru: {
                    title: "üìä –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –≤—ã–±–æ—Ä–∫–∏",
                    population_size: "–†–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏",
                    pop_note: "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π/—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏",
                    confidence_level: "–£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è",
                    margin_error: "–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å (%)",
                    expected_proportion: "–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è (%)",
                    prop_note: "–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 50% (–º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏)",
                    calculate: "–í—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏",
                    result: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã",
                    result_placeholder: "–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–∑–º–µ—Ä–∞ –≤—ã–±–æ—Ä–∫–∏ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –∑–¥–µ—Å—å",
                    formula_placeholder: "–ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ñ–æ—Ä–º—É–ª–∞: n = (Z¬≤ √ó p √ó (1-p)) / e¬≤",
                    required_sample: "–¢—Ä–µ–±—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏",
                    error: "–û—à–∏–±–∫–∞",
                    invalid_input: "–í–≤–µ–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è"
                }
            },

            // ZÂàÜÊï∞Êò†Â∞ÑË°®ÔºàÂØπÂ∫î‰∏çÂêåÁΩÆ‰ø°Ê∞¥Âπ≥Ôºâ
            zScores: {
                90: 1.645,
                95: 1.96,
                99: 2.576
            },

            // ÂàùÂßãÂåñ
            init: function() {
                const params = new URLSearchParams(window.location.search);
                const lang = params.get('lang');
                if (lang && this.i18n[lang]) {
                    document.getElementById('lang-selector').value = lang;
                    this.changeLang();
                    return;
                }
                // ÂàùÂßãÂåñÊìç‰Ωú
            },

            // ÂàáÊç¢ËØ≠Ë®Ä
            changeLang: function() {
                const lang = document.getElementById('sample-lang').value;
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.translations[lang] && this.translations[lang][key]) {
                        el.textContent = this.translations[lang][key];
                    }
                });
            },

            // ËÆ°ÁÆóÊ†∑Êú¨Èáè
            calculate: function() {
                const resultEl = document.getElementById('sample-result');
                const formulaEl = document.getElementById('sample-formula');
                const lang = document.getElementById('sample-lang').value;
                
                // Ëé∑ÂèñËæìÂÖ•ÂÄº
                const popSize = parseInt(document.getElementById('pop-size').value);
                const confidenceLevel = parseFloat(document.getElementById('confidence-level').value);
                const marginError = parseFloat(document.getElementById('margin-error').value) / 100; // ËΩ¨Êç¢‰∏∫Â∞èÊï∞
                const expectedProp = parseFloat(document.getElementById('expected-prop').value) / 100; // ËΩ¨Êç¢‰∏∫Â∞èÊï∞
                
                // È™åËØÅËæìÂÖ•
                if (isNaN(popSize) || isNaN(confidenceLevel) || isNaN(marginError) || isNaN(expectedProp) ||
                    popSize <= 0 || marginError <= 0 || marginError >= 1 || expectedProp < 0 || expectedProp > 1) {
                    resultEl.innerHTML = `<span class="text-red-600">${this.translations[lang].error}: ${this.translations[lang].invalid_input}</span>`;
                    formulaEl.textContent = '';
                    return;
                }
                
                // Ëé∑ÂèñZÂàÜÊï∞
                const zScore = this.zScores[confidenceLevel];
                
                // ËÆ°ÁÆóÊ†∑Êú¨ÈáèÔºà‰∏çËÄÉËôëÊúâÈôêÊÄª‰ΩìÊ†°Ê≠£Ôºâ
                let sampleSize = (zScore * zScore * expectedProp * (1 - expectedProp)) / (marginError * marginError);
                
                // Â∫îÁî®ÊúâÈôêÊÄª‰ΩìÊ†°Ê≠£ÔºàÂΩìÊ†∑Êú¨ÈáèË∂ÖËøáÊÄª‰ΩìÁöÑ5%Êó∂Ôºâ
                if (sampleSize / popSize > 0.05) {
                    sampleSize = sampleSize / (1 + (sampleSize / popSize));
                }
                
                // Âêë‰∏äÂèñÊï¥ÔºàÊ†∑Êú¨ÈáèÂøÖÈ°ª‰∏∫Êï¥Êï∞Ôºâ
                sampleSize = Math.ceil(sampleSize);
                
                // Á°Æ‰øùÊ†∑Êú¨Èáè‰∏çË∂ÖËøáÊÄª‰ΩìÂ§ßÂ∞è
                if (sampleSize > popSize) {
                    sampleSize = popSize;
                }
                
                // Êõ¥Êñ∞ÁªìÊûúÂíåÂÖ¨Âºè
                resultEl.innerHTML = `<strong>${this.translations[lang].required_sample}:</strong> ${sampleSize}`;
                
                // ÊòæÁ§∫ÂÖ¨Âºè
                const formulaText = `n = (Z¬≤ √ó p √ó (1-p)) / e¬≤ = (${zScore}¬≤ √ó ${expectedProp} √ó ${(1-expectedProp).toFixed(2)}) / ${marginError}¬≤ ‚âà ${sampleSize}`;
                formulaEl.textContent = formulaText;
            }
        };

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            SampleSizeCalc.init();
        });
    </script>
</body>
</html>