<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Target Heart Rate Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #fff1f2; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .zone-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #fecdd3; font-size: 0.85rem; }
        .zone-row:last-child { border-bottom: none; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="hr_calc" 
         data-category="health" 
         data-title="Target Heart Rate Calculator" 
         data-icon="❤️">
        
        <div class="absolute top-4 right-4">
            <select id="hr-lang" onchange="HeartRate.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">簡體中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
                <option value="es">Español</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">❤️ Target Heart Rate</h2>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_age">Age</label>
                <input type="number" id="hr-age" class="w-full p-2 border rounded focus:ring-1 focus:ring-pink-500 outline-none" placeholder="30" value="30" oninput="HeartRate.calc()">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_rest">Resting HR (Opt.)</label>
                <input type="number" id="hr-rest" class="w-full p-2 border rounded focus:ring-1 focus:ring-pink-500 outline-none" placeholder="70" oninput="HeartRate.calc()">
            </div>
        </div>

        <div class="bg-pink-50 p-4 rounded-lg border border-pink-100 mb-2">
            <div class="text-center mb-3">
                <span class="text-xs text-gray-500 uppercase" data-i18n="res_max">Max Heart Rate</span>
                <div id="hr-max" class="text-2xl font-bold text-pink-700">-- bpm</div>
            </div>
            
            <div class="space-y-1">
                <div class="zone-row">
                    <span class="text-gray-700 font-medium" data-i18n="z_mod">Moderate (50-60%)</span>
                    <span id="val-z1" class="font-bold text-gray-800">--</span>
                </div>
                <div class="zone-row">
                    <span class="text-gray-700 font-medium" data-i18n="z_fat">Weight Control (60-70%)</span>
                    <span id="val-z2" class="font-bold text-green-700">--</span>
                </div>
                <div class="zone-row">
                    <span class="text-gray-700 font-medium" data-i18n="z_aero">Aerobic (70-80%)</span>
                    <span id="val-z3" class="font-bold text-orange-600">--</span>
                </div>
                <div class="zone-row">
                    <span class="text-gray-700 font-medium" data-i18n="z_ana">Anaerobic (80-90%)</span>
                    <span id="val-z4" class="font-bold text-red-600">--</span>
                </div>
                <div class="zone-row">
                    <span class="text-gray-700 font-medium" data-i18n="z_max">VO2 Max (90-100%)</span>
                    <span id="val-z5" class="font-bold text-purple-700">--</span>
                </div>
            </div>
        </div>
        
        <div class="text-xs text-center text-gray-400" id="hr-method">Method: Standard (220-Age)</div>
    </div>

    <script>
        const HeartRate = {
            i18n: {
                'en': {
                    title: '❤️ Target Heart Rate',
                    lbl_age: 'Age', lbl_rest: 'Resting HR (Optional)',
                    res_max: 'Max Heart Rate',
                    z_mod: 'Moderate (Warm up)', z_fat: 'Fat Burn (Weight Control)',
                    z_aero: 'Aerobic (Cardio)', z_ana: 'Anaerobic (Hardcore)', z_max: 'VO2 Max (Maximum)',
                    m_std: 'Method: Standard (220-Age)', m_kar: 'Method: Karvonen (More Accurate)'
                },
                'zh-CN': {
                    title: '❤️ 目标心率计算器',
                    lbl_age: '年龄', lbl_rest: '静息心率 (可选)',
                    res_max: '最大心率',
                    z_mod: '热身/恢复 (50-60%)', z_fat: '燃脂/减重 (60-70%)',
                    z_aero: '有氧耐力 (70-80%)', z_ana: '无氧耐力 (80-90%)', z_max: '极限衝刺 (90-100%)',
                    m_std: '计算方法: 标准公式 (220-年龄)', m_kar: '计算方法: 卡瓦南公式 (更精准)'
                },
                'zh-TW': {
                    title: '❤️ 目標心率計算器',
                    lbl_age: '年齡', lbl_rest: '靜息心率 (可選)',
                    res_max: '最大心率',
                    z_mod: '熱身/恢復 (50-60%)', z_fat: '燃脂/減重 (60-70%)',
                    z_aero: '有氧耐力 (70-80%)', z_ana: '無氧耐力 (80-90%)', z_max: '極限衝刺 (90-100%)',
                    m_std: '計算方法: 標準公式 (220-年齡)', m_kar: '計算方法: 卡瓦南公式 (更精準)'
                },
                'ja': {
                    title: '❤️ 目標心拍数計算',
                    lbl_age: '年齢', lbl_rest: '安静時心拍数 (任意)',
                    res_max: '最大心拍数',
                    z_mod: 'ウォーミングアップ', z_fat: '脂肪燃焼',
                    z_aero: '有酸素運動 (持久力)', z_ana: '無酸素運動 (筋力)', z_max: '最大強度 (瞬発力)',
                    m_std: '計算式: 標準 (220-年齢)', m_kar: '計算式: カルボーネン法 (高精度)'
                },
                'ru': {
                    title: '❤️ Целевой пульс',
                    lbl_age: 'Возраст', lbl_rest: 'Пульс в покое (Опц.)',
                    res_max: 'Макс. пульс',
                    z_mod: 'Разминка', z_fat: 'Сжигание жира',
                    z_aero: 'Аэробная', z_ana: 'Анаэробная', z_max: 'Максимальная',
                    m_std: 'Метод: Стандартный', m_kar: 'Метод: Карвонена'
                },
                'es': {
                    title: '❤️ Frecuencia Cardíaca',
                    lbl_age: 'Edad', lbl_rest: 'Pulso en reposo (Opc.)',
                    res_max: 'Frecuencia Máxima',
                    z_mod: 'Moderado', z_fat: 'Control de Peso',
                    z_aero: 'Aeróbico', z_ana: 'Anaeróbico', z_max: 'Máximo',
                    m_std: 'Método: Estándar', m_kar: 'Método: Karvonen'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('hr-lang').value;
                const texts = HeartRate.i18n[lang];
                const elements = document.querySelectorAll('[data-id="hr_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });
                HeartRate.calc(); // refresh method text
            },

            calc: () => {
                const age = parseFloat(document.getElementById('hr-age').value);
                const resting = parseFloat(document.getElementById('hr-rest').value);
                const hasResting = !isNaN(resting);

                if (!age) return;

                const maxHR = 220 - age;
                document.getElementById('hr-max').innerText = maxHR + " bpm";

                // Function to calculate range based on method
                const getRange = (pctMin, pctMax) => {
                    let min, max;
                    if (hasResting) {
                        // Karvonen Formula: Target = ((Max - Rest) * %) + Rest
                        const hrr = maxHR - resting;
                        min = Math.round((hrr * pctMin) + resting);
                        max = Math.round((hrr * pctMax) + resting);
                    } else {
                        // Standard: Target = Max * %
                        min = Math.round(maxHR * pctMin);
                        max = Math.round(maxHR * pctMax);
                    }
                    return `${min} - ${max} bpm`;
                };

                document.getElementById('val-z1').innerText = getRange(0.50, 0.60);
                document.getElementById('val-z2').innerText = getRange(0.60, 0.70);
                document.getElementById('val-z3').innerText = getRange(0.70, 0.80);
                document.getElementById('val-z4').innerText = getRange(0.80, 0.90);
                document.getElementById('val-z5').innerText = getRange(0.90, 1.00);

                const lang = document.getElementById('hr-lang').value;
                const txt = HeartRate.i18n[lang];
                document.getElementById('hr-method').innerText = hasResting ? txt.m_kar : txt.m_std;
            }
        };
        
        HeartRate.calc();
    </script>
</body>
</html>