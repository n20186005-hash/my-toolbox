<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Carbohydrate Calculator Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #fff7ed; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="carb_calc" 
         data-category="health" 
         data-title="Carbohydrate Calculator" 
         data-icon="üçû">
        
        <div class="absolute top-4 right-4">
            <select id="cc-lang" onchange="CarbCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en">English</option>
                <option value="zh-CN">Á∞°È´î‰∏≠Êñá</option>
                <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="ja">Êó•Êú¨Ë™û</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">üçû Carbohydrate Calculator</h2>

        <div class="grid grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_age">Age</label>
                <input type="number" id="cc-age" class="w-full p-2 border rounded focus:ring-1 focus:ring-orange-500 outline-none" placeholder="30" value="30">
            </div>
            <div>
                <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_gender">Gender</label>
                <select id="cc-gender" class="w-full p-2 border rounded bg-white text-sm">
                    <option value="male" data-i18n="g_male">Male</option>
                    <option value="female" data-i18n="g_female">Female</option>
                </select>
            </div>
        </div>

        <div class="mb-6">
            <label class="block text-xs text-gray-500 mb-1" data-i18n="lbl_activity">Activity Level</label>
            <select id="cc-activity" class="w-full p-2 border rounded bg-white text-sm">
                <option value="1.2" data-i18n="act_sed">Sedentary (No exercise)</option>
                <option value="1.375" data-i18n="act_light">Light (1-3 days/wk)</option>
                <option value="1.55" data-i18n="act_mod">Moderate (3-5 days/wk)</option>
                <option value="1.725" data-i18n="act_act">Active (6-7 days/wk)</option>
                <option value="1.9" data-i18n="act_very">Very Active (Physical job)</option>
            </select>
        </div>

        <button onclick="CarbCalc.calc()" class="w-full bg-orange-500 text-white py-2 rounded font-bold hover:bg-orange-600 transition mb-6" data-i18n="btn_calc">Calculate Needs</button>

        <div class="bg-orange-50 p-4 rounded-lg border border-orange-100">
            <div class="flex justify-between items-center mb-2 border-b border-orange-200 pb-2">
                <span class="text-sm text-gray-600" data-i18n="res_std">Standard (45-65%)</span>
                <div id="res-std-val" class="font-bold text-orange-800">-- g</div>
            </div>
            <div class="flex justify-between items-center mb-2 border-b border-orange-200 pb-2">
                <span class="text-sm text-gray-600" data-i18n="res_low">Low Carb (10-25%)</span>
                <div id="res-low-val" class="font-bold text-green-700">-- g</div>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600" data-i18n="res_keto">Keto (5-10%)</span>
                <div id="res-keto-val" class="font-bold text-purple-700">-- g</div>
            </div>
        </div>
    </div>

    <script>
        const CarbCalc = {
            i18n: {
                'en': {
                    title: 'üçû Carbohydrate Calculator',
                    lbl_age: 'Age', lbl_gender: 'Gender',
                    g_male: 'Male', g_female: 'Female',
                    lbl_activity: 'Activity Level',
                    act_sed: 'Sedentary', act_light: 'Light Active',
                    act_mod: 'Moderate Active', act_act: 'Very Active', act_very: 'Extra Active',
                    btn_calc: 'Calculate Needs',
                    res_std: 'Standard (45-65%)',
                    res_low: 'Low Carb (10-25%)',
                    res_keto: 'Keto (5-10%)'
                },
                'zh-CN': {
                    title: 'üçû Á¢≥Ê∞¥ÂåñÂêàÁâ©ËÆ°ÁÆóÂô®',
                    lbl_age: 'Âπ¥ÈæÑ', lbl_gender: 'ÊÄßÂà´',
                    g_male: 'Áî∑ÊÄß', g_female: 'Â•≥ÊÄß',
                    lbl_activity: 'Ê¥ªÂä®Âº∫Â∫¶',
                    act_sed: '‰πÖÂùê‰∏çÂä®', act_light: 'ËΩªÂ∫¶Ê¥ªÂä®',
                    act_mod: '‰∏≠Â∫¶Ê¥ªÂä®', act_act: 'È´òÂ∫¶Ê¥ªÂä®', act_very: 'ÊûÅÂ∫¶Ê¥ªË∑É',
                    btn_calc: 'ËÆ°ÁÆóÈúÄÊ±Ç',
                    res_std: 'Ê†áÂáÜÈ•ÆÈ£ü (45-65%)',
                    res_low: '‰ΩéÁ¢≥Ê∞¥ (10-25%)',
                    res_keto: 'ÁîüÈÖÆ (5-10%)'
                },
                'zh-TW': {
                    title: 'üçû Á¢≥Ê∞¥ÂåñÂêàÁâ©Ë®àÁÆóÂô®',
                    lbl_age: 'Âπ¥ÈΩ°', lbl_gender: 'ÊÄßÂà•',
                    g_male: 'Áî∑ÊÄß', g_female: 'Â•≥ÊÄß',
                    lbl_activity: 'Ê¥ªÂãïÂº∑Â∫¶',
                    act_sed: '‰πÖÂùê‰∏çÂãï', act_light: 'ËºïÂ∫¶Ê¥ªÂãï',
                    act_mod: '‰∏≠Â∫¶Ê¥ªÂãï', act_act: 'È´òÂ∫¶Ê¥ªÂãï', act_very: 'Ê•µÂ∫¶Ê¥ªË∫ç',
                    btn_calc: 'Ë®àÁÆóÈúÄÊ±Ç',
                    res_std: 'Ê®ôÊ∫ñÈ£≤È£ü (45-65%)',
                    res_low: '‰ΩéÁ¢≥Ê∞¥ (10-25%)',
                    res_keto: 'ÁîüÈÖÆ (5-10%)'
                },
                'ja': {
                    title: 'üçû ÁÇ≠Ê∞¥ÂåñÁâ©Ë®àÁÆó',
                    lbl_age: 'Âπ¥ÈΩ¢', lbl_gender: 'ÊÄßÂà•',
                    g_male: 'Áî∑ÊÄß', g_female: 'Â•≥ÊÄß',
                    lbl_activity: 'Ê¥ªÂãï„É¨„Éô„É´',
                    act_sed: 'ÈÅãÂãï„Å™„Åó', act_light: 'ËªΩ„ÅÑÈÅãÂãï',
                    act_mod: '‰∏≠Á®ãÂ∫¶„ÅÆÈÅãÂãï', act_act: 'Ê¥ªÁô∫„Å™ÈÅãÂãï', act_very: 'ÈùûÂ∏∏„Å´Ê¥ªÁô∫',
                    btn_calc: 'Ë®àÁÆó„Åô„Çã',
                    res_std: 'Ê®ôÊ∫ñ (45-65%)',
                    res_low: '‰ΩéÁ≥ñË≥™ (10-25%)',
                    res_keto: '„Ç±„Éà (5-10%)'
                },
                'ru': {
                    title: 'üçû –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É–≥–ª–µ–≤–æ–¥–æ–≤',
                    lbl_age: '–í–æ–∑—Ä–∞—Å—Ç', lbl_gender: '–ü–æ–ª',
                    g_male: '–ú—É–∂—Å–∫–æ–π', g_female: '–ñ–µ–Ω—Å–∫–∏–π',
                    lbl_activity: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
                    act_sed: '–°–∏–¥—è—á–∏–π', act_light: '–õ—ë–≥–∫–∞—è',
                    act_mod: '–°—Ä–µ–¥–Ω—è—è', act_act: '–í—ã—Å–æ–∫–∞—è', act_very: '–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è',
                    btn_calc: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                    res_std: '–ù–æ—Ä–º–∞ (45-65%)',
                    res_low: '–ù–∏–∑–∫–æ—É–≥–ª–µ–≤. (10-25%)',
                    res_keto: '–ö–µ—Ç–æ (5-10%)'
                },
                'es': {
                    title: 'üçû Calculadora de Carbohidratos',
                    lbl_age: 'Edad', lbl_gender: 'G√©nero',
                    g_male: 'Hombre', g_female: 'Mujer',
                    lbl_activity: 'Nivel de Actividad',
                    act_sed: 'Sedentario', act_light: 'Ligero',
                    act_mod: 'Moderado', act_act: 'Activo', act_very: 'Muy Activo',
                    btn_calc: 'Calcular',
                    res_std: 'Est√°ndar (45-65%)',
                    res_low: 'Bajo en Carbos (10-25%)',
                    res_keto: 'Keto (5-10%)'
                }
            },

            changeLang: () => {
                const lang = document.getElementById('cc-lang').value;
                const texts = CarbCalc.i18n[lang];
                const elements = document.querySelectorAll('[data-id="carb_calc"] [data-i18n]');
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) {
                        if(el.tagName === 'OPTION') el.text = texts[key];
                        else el.innerText = texts[key];
                    }
                });
            },

            calc: () => {
                // Simplified Mifflin-St Jeor Estimation (Assume Average Weight/Height if not provided to keep module simple)
                // Using Average: Male 175cm/80kg, Female 162cm/65kg for estimation
                const gender = document.getElementById('cc-gender').value;
                const age = parseFloat(document.getElementById('cc-age').value) || 30;
                const activity = parseFloat(document.getElementById('cc-activity').value);

                let bmr = 0;
                if (gender === 'male') {
                    bmr = 10 * 80 + 6.25 * 175 - 5 * age + 5; // ~1800 base
                } else {
                    bmr = 10 * 65 + 6.25 * 162 - 5 * age - 161; // ~1400 base
                }

                const tdee = bmr * activity;

                // 1g Carb = 4 kcal
                const calcRange = (pctMin, pctMax) => {
                    const min = Math.round((tdee * (pctMin/100)) / 4);
                    const max = Math.round((tdee * (pctMax/100)) / 4);
                    return `${min}-${max} g`;
                };

                document.getElementById('res-std-val').innerText = calcRange(45, 65);
                document.getElementById('res-low-val').innerText = calcRange(10, 25);
                document.getElementById('res-keto-val').innerText = calcRange(5, 10);
            }
        };
        
        CarbCalc.calc();
    </script>
</body>
</html>