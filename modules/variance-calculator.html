<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variance & Standard Deviation Calculator</title>
    
    <!-- 基础信息 -->
    <meta name="tool-id" content="variance_calculator">
    <meta name="category" content="Math">
    <meta name="icon" content="σ">
    
    <!-- 默认英文内容 -->
    <meta name="title" content="Variance & Standard Deviation Calculator">
    <meta name="description" content="Calculate variance and standard deviation for a set of numbers.">
    
    <!-- 多语言配置 -->
    <meta name="lang-title-zh-CN" content="方差/标准差计算器">
    <meta name="lang-description-zh-CN" content="计算一组数字的方差和标准差。">
    
    <meta name="lang-title-zh-TW" content="方差/標準差計算器">
    <meta name="lang-description-zh-TW" content="計算一組數字的方差和標準差。">
    
    <meta name="lang-title-ja" content="分散＆標準偏差計算機">
    <meta name="lang-description-ja" content="一連の数値の分散と標準偏差を計算します。">
    
    <meta name="lang-title-ru" content="Калькулятор дисперсии и стандартного отклонения">
    <meta name="lang-description-ru" content="Вычислите дисперсию и стандартное отклонение для набора чисел.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        .result { background-color: #fef3c7; border: 1px solid #f59e0b; color: #92400e; padding: 10px; border-radius: 5px; margin-top: 10px; }
        .info { background-color: #eff8ff; border: 1px solid #3b82f6; color: #1e40af; padding: 10px; border-radius: 5px; margin-top: 10px; }
        .data-points { display: flex; flex-wrap: gap-2; margin-bottom: 10px; }
        .data-point { flex: 1; min-width: 60px; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="variance_calculator" 
         data-category="math" 
         data-title="Variance & Standard Deviation Calculator" 
         data-icon="σ">
        
        <!-- 语言选择器 -->
        <div class="absolute top-4 right-4">
            <select id="variance-lang" onchange="VarianceCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">σ Variance & Standard Deviation Calculator</h2>
        
        <div class="grid grid-cols-1 gap-4 mb-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="data_points">Data Points (separated by commas or spaces)</label>
                <textarea id="data-input" class="w-full p-2 border rounded focus:ring-2 focus:ring-purple-500 outline-none" rows="3" placeholder="e.g. 1, 2, 3, 4, 5">1, 2, 3, 4, 5</textarea>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="calculation_type">Calculation Type</label>
                <div class="flex gap-4">
                    <label class="inline-flex items-center">
                        <input type="radio" name="variance-type" value="sample" checked class="text-purple-600 focus:ring-purple-500">
                        <span data-i18n="sample">Sample (divide by n-1)</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="variance-type" value="population" class="text-purple-600 focus:ring-purple-500">
                        <span data-i18n="population">Population (divide by n)</span>
                    </label>
                </div>
            </div>
        </div>

        <button onclick="VarianceCalc.calc()" class="w-full bg-purple-600 text-white py-2 rounded font-bold hover:bg-purple-700 transition mb-6" data-i18n="btn_calc">Calculate</button>

        <div class="bg-purple-50 p-6 rounded-lg border border-purple-100">
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <div class="text-sm text-gray-500 mb-2" data-i18n="mean">Mean</div>
                    <div id="result-mean" class="text-xl font-bold text-purple-800">--</div>
                </div>
                <div>
                    <div class="text-sm text-gray-500 mb-2" data-i18n="variance">Variance</div>
                    <div id="result-variance" class="text-xl font-bold text-purple-800">--</div>
                </div>
                <div>
                    <div class="text-sm text-gray-500 mb-2" data-i18n="std_deviation">Standard Deviation</div>
                    <div id="result-std-dev" class="text-xl font-bold text-purple-800">--</div>
                </div>
                <div>
                    <div class="text-sm text-gray-500 mb-2" data-i18n="count">Count</div>
                    <div id="result-count" class="text-xl font-bold text-purple-800">--</div>
                </div>
            </div>
            
            <div class="text-sm text-gray-500 mb-2 mt-6" data-i18n="formula">Formula Used</div>
            <div id="variance-formula" class="text-sm text-purple-700">--</div>
            
            <div class="info text-sm mt-4" data-i18n="info_text">Variance measures how far each number in the set is from the mean. Standard deviation is the square root of the variance.</div>
        </div>
    </div>

    <script>
        const VarianceCalc = {
            i18n: {
                'en': {
                    title: 'σ Variance & Standard Deviation Calculator',
                    data_points: 'Data Points (separated by commas or spaces)',
                    calculation_type: 'Calculation Type',
                    sample: 'Sample (divide by n-1)',
                    population: 'Population (divide by n)',
                    btn_calc: 'Calculate',
                    mean: 'Mean',
                    variance: 'Variance',
                    std_deviation: 'Standard Deviation',
                    count: 'Count',
                    formula: 'Formula Used',
                    info_text: 'Variance measures how far each number in the set is from the mean. Standard deviation is the square root of the variance.',
                    err_invalid: 'Please enter valid numbers',
                    err_insufficient: 'Please enter at least 2 data points',
                    formulas: {
                        sample: 'Sample variance = Σ(x-μ)²/(n-1), Std Dev = √variance',
                        population: 'Population variance = Σ(x-μ)²/n, Std Dev = √variance'
                    }
                },
                'zh-CN': {
                    title: 'σ 方差/标准差计算器',
                    data_points: '数据点（用逗号或空格分隔）',
                    calculation_type: '计算类型',
                    sample: '样本（除以n-1）',
                    population: '总体（除以n）',
                    btn_calc: '计算',
                    mean: '平均值',
                    variance: '方差',
                    std_deviation: '标准差',
                    count: '数量',
                    formula: '使用公式',
                    info_text: '方差衡量集合中每个数字与平均值的偏离程度。标准差是方差的平方根。',
                    err_invalid: '请输入有效的数字',
                    err_insufficient: '请至少输入2个数据点',
                    formulas: {
                        sample: '样本方差 = Σ(x-μ)²/(n-1)，标准差 = √方差',
                        population: '总体方差 = Σ(x-μ)²/n，标准差 = √方差'
                    }
                },
                'zh-TW': {
                    title: 'σ 方差/標準差計算器',
                    data_points: '數據點（用逗號或空格分隔）',
                    calculation_type: '計算類型',
                    sample: '樣本（除以n-1）',
                    population: '總體（除以n）',
                    btn_calc: '計算',
                    mean: '平均值',
                    variance: '方差',
                    std_deviation: '標準差',
                    count: '數量',
                    formula: '使用公式',
                    info_text: '方差衡量集合中每個數字與平均值的偏離程度。標準差是方差的平方根。',
                    err_invalid: '請輸入有效的數字',
                    err_insufficient: '請至少輸入2個數據點',
                    formulas: {
                        sample: '樣本方差 = Σ(x-μ)²/(n-1)，標準差 = √方差',
                        population: '總體方差 = Σ(x-μ)²/n，標準差 = √方差'
                    }
                },
                'ja': {
                    title: 'σ 分散＆標準偏差計算機',
                    data_points: 'データポイント（カンマまたはスペースで区切る）',
                    calculation_type: '計算タイプ',
                    sample: '標本（n-1で割る）',
                    population: '母集団（nで割る）',
                    btn_calc: '計算',
                    mean: '平均',
                    variance: '分散',
                    std_deviation: '標準偏差',
                    count: '個数',
                    formula: '使用した公式',
                    info_text: '分散は、セット内の各数値が平均からどれだけ離れているかを測定します。標準偏差は分散の平方根です。',
                    err_invalid: '有効な数値を入力してください',
                    err_insufficient: '少なくとも2つのデータポイントを入力してください',
                    formulas: {
                        sample: '標本分散 = Σ(x-μ)²/(n-1)、標準偏差 = √分散',
                        population: '母分散 = Σ(x-μ)²/n、標準偏差 = √分散'
                    }
                },
                'ru': {
                    title: 'σ Калькулятор дисперсии и стандартного отклонения',
                    data_points: 'Датасеты (разделенные запятыми или пробелами)',
                    calculation_type: 'Тип вычисления',
                    sample: 'Выборка (делить на n-1)',
                    population: 'Население (делить на n)',
                    btn_calc: 'Вычислить',
                    mean: 'Среднее значение',
                    variance: 'Дисперсия',
                    std_deviation: 'Стандартное отклонение',
                    count: 'Количество',
                    formula: 'Используемая формула',
                    info_text: 'Дисперсия измеряет, насколько каждое число в наборе отличается от среднего значения. Стандартное отклонение — это квадратный корень из дисперсии.',
                    err_invalid: 'Пожалуйста, введите действительные числа',
                    err_insufficient: 'Пожалуйста, введите как минимум 2 данных точки',
                    formulas: {
                        sample: 'Дисперсия выборки = Σ(x-μ)²/(n-1), Стандартное отклонение = √дисперсии',
                        population: 'Дисперсия населения = Σ(x-μ)²/n, Стандартное отклонение = √дисперсии'
                    }
                }
            },

            init: function() {
                const params = new URLSearchParams(window.location.search);
                const lang = params.get('lang');
                if (lang && this.i18n[lang]) {
                    document.getElementById('lang-selector').value = lang;
                    this.changeLang();
                    return;
                }
                this.changeLang();
            },

            changeLang: function() {
                const lang = document.getElementById('variance-lang').value;
                const elements = document.querySelectorAll('[data-i18n]');
                
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang] && this.i18n[lang][key]) {
                        el.textContent = this.i18n[lang][key];
                    }
                });
            },

            calc: function() {
                const lang = document.getElementById('variance-lang').value;
                const dataInput = document.getElementById('data-input').value;
                const calcType = document.querySelector('input[name="variance-type"]:checked').value;
                
                // 解析数据点
                const dataPoints = dataInput
                    .split(/[,\s]+/)
                    .map(num => parseFloat(num))
                    .filter(num => !isNaN(num));
                
                // 验证数据
                if (dataPoints.length < 2) {
                    alert(this.i18n[lang].err_insufficient);
                    return;
                }
                
                // 计算平均值
                const mean = dataPoints.reduce((sum, num) => sum + num, 0) / dataPoints.length;
                
                // 计算方差
                const squaredDiffs = dataPoints.map(num => Math.pow(num - mean, 2));
                const variance = squaredDiffs.reduce((sum, diff) => sum + diff, 0) / 
                                (calcType === 'sample' ? dataPoints.length - 1 : dataPoints.length);
                
                // 计算标准差
                const stdDev = Math.sqrt(variance);
                
                // 显示结果
                document.getElementById('result-mean').textContent = mean.toFixed(6);
                document.getElementById('result-variance').textContent = variance.toFixed(6);
                document.getElementById('result-std-dev').textContent = stdDev.toFixed(6);
                document.getElementById('result-count').textContent = dataPoints.length;
                document.getElementById('variance-formula').textContent = this.i18n[lang].formulas[calcType];
            }
        };

        // 初始化计算器
        document.addEventListener('DOMContentLoaded', () => {
            VarianceCalc.init();
        });
    </script>
</body>

</html>
