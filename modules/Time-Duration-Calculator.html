<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Duration Calculator</title>
    
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <meta name="tool-id" content="time_duration_calc">
    <meta name="category" content="Date & Time">
    <meta name="icon" content="â°">
    
    <!-- é»˜è®¤è‹±æ–‡å†…å®¹ (ä¾›å®¿ä¸»ç¯å¢ƒè¯»å–) -->
    <meta name="title" content="Time Duration Calculator">
    <meta name="description" content="Calculate the duration between two times or add/subtract time from a specific time.">
    
    <!-- å¤šè¯­è¨€é…ç½® -->
    <meta name="lang-title-zh-CN" content="æ—¶é—´é—´éš”è®¡ç®—å™¨">
    <meta name="lang-description-zh-CN" content="è®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„æŒç»­æ—¶é—´ï¼Œæˆ–å¯¹æ—¶é—´è¿›è¡ŒåŠ å‡è®¡ç®—ã€‚">
    
    <meta name="lang-title-zh-TW" content="æ™‚é–“é–“éš”è¨ˆç®—å™¨">
    <meta name="lang-description-zh-TW" content="è¨ˆç®—å…©å€‹æ™‚é–“é»ä¹‹é–“çš„æŒçºŒæ™‚é–“ï¼Œæˆ–å°æ™‚é–“é€²è¡ŒåŠ æ¸›è¨ˆç®—ã€‚">
    
    <meta name="lang-title-ja" content="æ™‚é–“è¨ˆç®—ï¼ˆæ™‚é–“å·®ãƒ»åŠ ç®—æ¸›ç®—ï¼‰">
    <meta name="lang-description-ja" content="2ã¤ã®æ™‚åˆ»ã®é–“éš”ã‚’è¨ˆç®—ã—ãŸã‚Šã€æ™‚åˆ»ã«æ™‚é–“ã‚’åŠ ç®—/æ¸›ç®—ã—ãŸã‚Šã—ã¾ã™ã€‚">
    
    <meta name="lang-title-ru" content="ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸">
    <meta name="lang-description-ru" content="Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ´Ğ²ÑƒĞ¼Ñ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¸Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ/Ğ²Ñ‹Ñ‡Ñ‚Ğ¸Ñ‚Ğµ Ğ²Ñ€ĞµĞ¼Ñ.">
    
    <meta name="lang-title-es" content="Calculadora de DuraciÃ³n">
    <meta name="lang-description-es" content="Calcula la duraciÃ³n entre dos horas o suma/resta tiempo a una hora especÃ­fica.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* æ¨¡æ‹Ÿä¸»ç¨‹åºç¯å¢ƒæ ·å¼ */
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; position: relative; }
        
        /* ç®€å•çš„ Tab åˆ‡æ¢åŠ¨ç”» */
        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .tab-btn.active { color: #7c3aed; border-bottom-color: #7c3aed; background-color: #f5f3ff; }
    </style>
</head>
<body>

    <!-- ================================================================= -->
    <!-- ğŸ”´ åŒºåŸŸ 1ï¼šHTML ç§¯æœ¨ (å¤åˆ¶åˆ° tools-wrapper) -->
    <!-- ================================================================= -->
    
    <div class="tool-module active" 
         data-id="time_duration_calc" 
         data-category="date_time" 
         data-title="Time Duration Calculator" 
         data-icon="â°">
        
        <!-- è¯­è¨€é€‰æ‹©å™¨ -->
        <div class="absolute top-4 right-4">
            <select id="td-lang" onchange="TimeDurationCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                <option value="es">EspaÃ±ol</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800" data-i18n="title">â° Time Duration Calculator</h2>

        <!-- Tab å¯¼èˆª -->
        <div class="flex border-b border-gray-200 mb-6">
            <button onclick="TimeDurationCalc.switchTab('duration')" id="tab-btn-duration" class="tab-btn active flex-1 py-2 text-sm font-medium text-violet-600 border-b-2 border-violet-600 focus:outline-none hover:text-violet-800 transition">
                <span data-i18n="tab_duration">Duration Between</span>
            </button>
            <button onclick="TimeDurationCalc.switchTab('addsub')" id="tab-btn-addsub" class="tab-btn flex-1 py-2 text-sm font-medium text-gray-500 border-b-2 border-transparent focus:outline-none hover:text-gray-700 transition">
                <span data-i18n="tab_addsub">Add/Subtract Time</span>
            </button>
        </div>
        
        <!-- æ¨¡å¼ 1: è®¡ç®—æ—¶é—´é—´éš” -->
        <div id="tab-duration" class="tab-content active">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="start_time">Start Time</label>
                    <input type="time" id="td-start" step="1" class="w-full p-2 border rounded focus:ring-2 focus:ring-violet-500 outline-none text-gray-700 bg-white">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="end_time">End Time</label>
                    <input type="time" id="td-end" step="1" class="w-full p-2 border rounded focus:ring-2 focus:ring-violet-500 outline-none text-gray-700 bg-white">
                </div>
            </div>
            
            <button onclick="TimeDurationCalc.calcDuration()" class="w-full bg-violet-600 text-white py-2 rounded font-bold hover:bg-violet-700 transition mb-6" data-i18n="btn_calc">Calculate</button>

            <div class="bg-violet-50 p-4 rounded-lg border border-violet-100 text-center">
                <div class="text-sm text-gray-500 mb-1" data-i18n="result_duration">Time Duration</div>
                <div id="td-res-duration" class="text-3xl font-bold text-violet-800 mb-1">--</div>
                <div id="td-res-detail" class="text-sm text-gray-600 mt-2"></div>
            </div>
        </div>

        <!-- æ¨¡å¼ 2: æ—¶é—´åŠ å‡ -->
        <div id="tab-addsub" class="tab-content">
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="start_time">Start Time</label>
                <input type="time" id="td-as-start" step="1" class="w-full p-2 border rounded focus:ring-2 focus:ring-green-500 outline-none text-gray-700 bg-white">
            </div>

            <div class="flex gap-2 mb-4">
                <div class="flex-1">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="operation">Operation</label>
                    <div class="flex bg-gray-100 rounded p-1">
                        <label class="flex-1 text-center cursor-pointer">
                            <input type="radio" name="td-op" value="add" checked class="hidden peer" onchange="TimeDurationCalc.toggleOpStyle()">
                            <span class="block py-1 rounded text-sm peer-checked:bg-white peer-checked:text-green-600 peer-checked:shadow transition" data-i18n="op_add">Add (+)</span>
                        </label>
                        <label class="flex-1 text-center cursor-pointer">
                            <input type="radio" name="td-op" value="sub" class="hidden peer" onchange="TimeDurationCalc.toggleOpStyle()">
                            <span class="block py-1 rounded text-sm peer-checked:bg-white peer-checked:text-red-600 peer-checked:shadow transition" data-i18n="op_sub">Subtract (-)</span>
                        </label>
                    </div>
                </div>
            </div>

            <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="duration_to_add">Duration</label>
            <div class="grid grid-cols-3 gap-2 mb-4">
                <div>
                    <label class="block text-xs text-gray-500 mb-1" data-i18n="hours">Hours</label>
                    <input type="number" id="td-add-h" class="w-full p-2 border rounded outline-none focus:ring-1 focus:ring-gray-400" placeholder="0" min="0">
                </div>
                <div>
                    <label class="block text-xs text-gray-500 mb-1" data-i18n="minutes">Minutes</label>
                    <input type="number" id="td-add-m" class="w-full p-2 border rounded outline-none focus:ring-1 focus:ring-gray-400" placeholder="0" min="0">
                </div>
                <div>
                    <label class="block text-xs text-gray-500 mb-1" data-i18n="seconds">Seconds</label>
                    <input type="number" id="td-add-s" class="w-full p-2 border rounded outline-none focus:ring-1 focus:ring-gray-400" placeholder="0" min="0">
                </div>
            </div>

            <button onclick="TimeDurationCalc.calcAddSub()" id="btn-td-calc" class="w-full bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition mb-6" data-i18n="btn_calc">Calculate</button>

            <div class="bg-green-50 p-4 rounded-lg border border-green-100 text-center">
                <div class="text-sm text-gray-500 mb-1" data-i18n="result_time">Result Time</div>
                <div id="td-res-time" class="text-3xl font-bold text-green-800">--</div>
                <div id="td-res-note" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

    </div>

    <!-- ================================================================= -->
    <!-- ğŸ”´ åŒºåŸŸ 1 ç»“æŸ -->
    <!-- ================================================================= -->


    <!-- ================================================================= -->
    <!-- ğŸ”´ åŒºåŸŸ 2ï¼šJS ç§¯æœ¨ (å¤åˆ¶åˆ° script æ ‡ç­¾ä¸­) -->
    <!-- ================================================================= -->
    <script>
        const TimeDurationCalc = {
            i18n: {
                'en': {
                    title: 'â° Time Duration Calculator',
                    tab_duration: 'Duration Between',
                    tab_addsub: 'Add / Subtract Time',
                    start_time: 'Start Time',
                    end_time: 'End Time',
                    btn_calc: 'Calculate',
                    result_duration: 'Total Duration',
                    result_time: 'Result Time',
                    operation: 'Operation',
                    op_add: 'Add (+)',
                    op_sub: 'Subtract (-)',
                    duration_to_add: 'Duration',
                    hours: 'Hours',
                    minutes: 'Minutes',
                    seconds: 'Seconds',
                    h: 'h', m: 'm', s: 's',
                    next_day: 'Next Day',
                    prev_day: 'Previous Day',
                    same_day: 'Same Day'
                },
                'zh-CN': {
                    title: 'â° æ—¶é—´é—´éš”è®¡ç®—å™¨',
                    tab_duration: 'è®¡ç®—æ—¶é—´é—´éš”',
                    tab_addsub: 'æ—¶é—´åŠ å‡',
                    start_time: 'å¼€å§‹æ—¶é—´',
                    end_time: 'ç»“æŸæ—¶é—´',
                    btn_calc: 'è®¡ç®—',
                    result_duration: 'æ€»æŒç»­æ—¶é—´',
                    result_time: 'ç»“æœæ—¶é—´',
                    operation: 'æ“ä½œ',
                    op_add: 'åŠ ä¸Š (+)',
                    op_sub: 'å‡å» (-)',
                    duration_to_add: 'æ—¶é•¿',
                    hours: 'å°æ—¶',
                    minutes: 'åˆ†é’Ÿ',
                    seconds: 'ç§’',
                    h: 'å°æ—¶', m: 'åˆ†', s: 'ç§’',
                    next_day: 'æ¬¡æ—¥',
                    prev_day: 'å‰ä¸€æ—¥',
                    same_day: 'å½“æ—¥'
                },
                'zh-TW': {
                    title: 'â° æ™‚é–“é–“éš”è¨ˆç®—å™¨',
                    tab_duration: 'è¨ˆç®—æ™‚é–“é–“éš”',
                    tab_addsub: 'æ™‚é–“åŠ æ¸›',
                    start_time: 'é–‹å§‹æ™‚é–“',
                    end_time: 'çµæŸæ™‚é–“',
                    btn_calc: 'è¨ˆç®—',
                    result_duration: 'ç¸½æŒçºŒæ™‚é–“',
                    result_time: 'çµæœæ™‚é–“',
                    operation: 'æ“ä½œ',
                    op_add: 'åŠ ä¸Š (+)',
                    op_sub: 'æ¸›å» (-)',
                    duration_to_add: 'æ™‚é•·',
                    hours: 'å°æ™‚',
                    minutes: 'åˆ†é˜',
                    seconds: 'ç§’',
                    h: 'å°æ™‚', m: 'åˆ†', s: 'ç§’',
                    next_day: 'æ¬¡æ—¥',
                    prev_day: 'å‰ä¸€æ—¥',
                    same_day: 'ç•¶æ—¥'
                },
                'ja': {
                    title: 'â° æ™‚é–“è¨ˆç®—',
                    tab_duration: 'æ™‚é–“é–“éš”',
                    tab_addsub: 'æ™‚é–“ã®åŠ ç®—/æ¸›ç®—',
                    start_time: 'é–‹å§‹æ™‚åˆ»',
                    end_time: 'çµ‚äº†æ™‚åˆ»',
                    btn_calc: 'è¨ˆç®—ã™ã‚‹',
                    result_duration: 'çµŒéæ™‚é–“',
                    result_time: 'è¨ˆç®—çµæœ',
                    operation: 'æ“ä½œ',
                    op_add: 'åŠ ç®— (+)',
                    op_sub: 'æ¸›ç®— (-)',
                    duration_to_add: 'æ™‚é–“',
                    hours: 'æ™‚é–“',
                    minutes: 'åˆ†',
                    seconds: 'ç§’',
                    h: 'æ™‚é–“', m: 'åˆ†', s: 'ç§’',
                    next_day: 'ç¿Œæ—¥',
                    prev_day: 'å‰æ—¥',
                    same_day: 'åŒæ—¥'
                },
                'ru': {
                    title: 'â° ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸',
                    tab_duration: 'Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸',
                    tab_addsub: 'ĞŸÑ€Ğ¸Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ / Ğ’Ñ‹Ñ‡ĞµÑÑ‚ÑŒ',
                    start_time: 'ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ',
                    end_time: 'ĞšĞ¾Ğ½ĞµÑ‡Ğ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ',
                    btn_calc: 'Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ',
                    result_duration: 'ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ',
                    result_time: 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',
                    operation: 'Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ',
                    op_add: 'ĞŸÑ€Ğ¸Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ (+)',
                    op_sub: 'Ğ’Ñ‹Ñ‡ĞµÑÑ‚ÑŒ (-)',
                    duration_to_add: 'Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ',
                    hours: 'Ğ§Ğ°ÑÑ‹',
                    minutes: 'ĞœĞ¸Ğ½ÑƒÑ‚Ñ‹',
                    seconds: 'Ğ¡ĞµĞºÑƒĞ½Ğ´Ñ‹',
                    h: 'Ñ‡', m: 'Ğ¼Ğ¸Ğ½', s: 'ÑĞµĞº',
                    next_day: 'Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ',
                    prev_day: 'ĞŸÑ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ',
                    same_day: 'Ğ¢Ğ¾Ñ‚ Ğ¶Ğµ Ğ´ĞµĞ½ÑŒ'
                },
                'es': {
                    title: 'â° Calculadora de DuraciÃ³n',
                    tab_duration: 'DuraciÃ³n entre horas',
                    tab_addsub: 'Sumar / Restar',
                    start_time: 'Hora de inicio',
                    end_time: 'Hora final',
                    btn_calc: 'Calcular',
                    result_duration: 'DuraciÃ³n total',
                    result_time: 'Hora resultante',
                    operation: 'OperaciÃ³n',
                    op_add: 'Sumar (+)',
                    op_sub: 'Restar (-)',
                    duration_to_add: 'DuraciÃ³n',
                    hours: 'Horas',
                    minutes: 'Minutos',
                    seconds: 'Segundos',
                    h: 'h', m: 'm', s: 's',
                    next_day: 'DÃ­a siguiente',
                    prev_day: 'DÃ­a anterior',
                    same_day: 'Mismo dÃ­a'
                }
            },

            init: () => {
                // è®¾ç½®é»˜è®¤æ—¶é—´ä¸ºå½“å‰æ—¶é—´
                const now = new Date();
                const timeStr = now.toTimeString().split(' ')[0]; // HH:MM:SS format
                document.getElementById('td-start').value = timeStr;
                document.getElementById('td-end').value = timeStr;
                document.getElementById('td-as-start').value = timeStr;
            },

            switchTab: (tabName) => {
                // Hide all contents
                document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.tab-btn').forEach(el => {
                    el.classList.remove('active', 'text-violet-600', 'border-violet-600', 'bg-violet-50');
                    el.classList.add('text-gray-500', 'border-transparent');
                });

                // Show target
                document.getElementById(`tab-${tabName}`).classList.add('active');
                
                // Style button
                const btn = document.getElementById(`tab-btn-${tabName}`);
                btn.classList.add('active', 'text-violet-600', 'border-violet-600');
                btn.classList.remove('text-gray-500', 'border-transparent');
            },

            changeLang: () => {
                const lang = document.getElementById('td-lang').value;
                const texts = TimeDurationCalc.i18n[lang];
                
                document.querySelectorAll('[data-id="time_duration_calc"] [data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (texts[key]) el.innerText = texts[key];
                });

                // Re-calc if results exist
                if (document.getElementById('td-res-duration').innerText !== '--') TimeDurationCalc.calcDuration();
                if (document.getElementById('td-res-time').innerText !== '--') TimeDurationCalc.calcAddSub();
            },

            toggleOpStyle: () => {
                const isAdd = document.querySelector('input[name="td-op"]:checked').value === 'add';
                const btn = document.getElementById('btn-td-calc');
                
                if (isAdd) {
                    btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                    btn.classList.add('bg-green-600', 'hover:bg-green-700');
                } else {
                    btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                    btn.classList.add('bg-red-600', 'hover:bg-red-700');
                }
            },

            // è¾…åŠ©ï¼šå°† "HH:MM:SS" è½¬ä¸ºç§’æ•°
            timeToSeconds: (timeStr) => {
                if (!timeStr) return 0;
                const parts = timeStr.split(':');
                const h = parseInt(parts[0]) || 0;
                const m = parseInt(parts[1]) || 0;
                // æœ‰äº›æµè§ˆå™¨ time input åªè¿”å› HH:MMï¼Œæœ‰äº›è¿”å› HH:MM:SS
                const s = parts.length > 2 ? (parseInt(parts[2]) || 0) : 0;
                return h * 3600 + m * 60 + s;
            },

            // è¾…åŠ©ï¼šå°†ç§’æ•°è½¬ä¸º "HH:MM:SS"
            secondsToTimeStr: (totalSeconds) => {
                let s = totalSeconds % 60;
                let m = Math.floor(totalSeconds / 60) % 60;
                let h = Math.floor(totalSeconds / 3600);
                
                // è¡¥é›¶
                const pad = (num) => num.toString().padStart(2, '0');
                return `${pad(h)}:${pad(m)}:${pad(s)}`;
            },

            calcDuration: () => {
                const startStr = document.getElementById('td-start').value;
                const endStr = document.getElementById('td-end').value;
                const lang = document.getElementById('td-lang').value;
                const texts = TimeDurationCalc.i18n[lang];

                if (!startStr || !endStr) return;

                let t1 = TimeDurationCalc.timeToSeconds(startStr);
                let t2 = TimeDurationCalc.timeToSeconds(endStr);

                // å¦‚æœç»“æŸæ—¶é—´å°äºå¼€å§‹æ—¶é—´ï¼Œé€šå¸¸æ„å‘³ç€è·¨è¶Šäº†åˆå¤œ (ä¾‹å¦‚ 23:00 åˆ° 01:00)
                // åœ¨ç®€å•æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å‡è®¾å®ƒè·¨è¶Šåˆ°äº†ç¬¬äºŒå¤©
                let diff = t2 - t1;
                let note = "";

                if (diff < 0) {
                    diff += 24 * 3600; // åŠ ä¸€å¤©
                    note = `(${texts.next_day})`;
                }

                const h = Math.floor(diff / 3600);
                const m = Math.floor((diff % 3600) / 60);
                const s = diff % 60;

                // æ˜¾ç¤ºæ ¼å¼
                let resultStr = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                let detailStr = `${h} ${texts.h} ${m} ${texts.m} ${s} ${texts.s}`;

                if (note) detailStr += ` ${note}`;

                document.getElementById('td-res-duration').innerText = resultStr;
                document.getElementById('td-res-detail').innerText = detailStr;
            },

            calcAddSub: () => {
                const startStr = document.getElementById('td-as-start').value;
                const op = document.querySelector('input[name="td-op"]:checked').value;
                const addH = parseInt(document.getElementById('td-add-h').value) || 0;
                const addM = parseInt(document.getElementById('td-add-m').value) || 0;
                const addS = parseInt(document.getElementById('td-add-s').value) || 0;
                const lang = document.getElementById('td-lang').value;
                const texts = TimeDurationCalc.i18n[lang];

                if (!startStr) return;

                let currentSeconds = TimeDurationCalc.timeToSeconds(startStr);
                const addSeconds = addH * 3600 + addM * 60 + addS;

                let finalSeconds;
                if (op === 'add') {
                    finalSeconds = currentSeconds + addSeconds;
                } else {
                    finalSeconds = currentSeconds - addSeconds;
                }

                // å¤„ç†è·¨å¤©é€»è¾‘
                const daySeconds = 24 * 3600;
                let dayShift = 0;

                // å¦‚æœç»“æœæ˜¯è´Ÿæ•° (ä¾‹å¦‚ 01:00 å‡å» 2å°æ—¶)
                if (finalSeconds < 0) {
                    // å‘ä¸‹å–æ•´è®¡ç®—è·¨è¶Šäº†å‡ å¤©
                    dayShift = Math.floor(finalSeconds / daySeconds); 
                    // å°† finalSeconds ä¿®æ­£ä¸ºæ­£æ•°æ—¶é—´ (0 - 86399)
                    finalSeconds = finalSeconds - (dayShift * daySeconds);
                } else if (finalSeconds >= daySeconds) {
                    dayShift = Math.floor(finalSeconds / daySeconds);
                    finalSeconds = finalSeconds % daySeconds;
                }

                const resultTimeStr = TimeDurationCalc.secondsToTimeStr(finalSeconds);

                document.getElementById('td-res-time').innerText = resultTimeStr;

                let noteText = "";
                if (dayShift === 0) noteText = texts.same_day;
                else if (dayShift === 1) noteText = `+1 (${texts.next_day})`;
                else if (dayShift === -1) noteText = `-1 (${texts.prev_day})`;
                else if (dayShift > 0) noteText = `+${dayShift} (${texts.next_day})`;
                else noteText = `${dayShift} (${texts.prev_day})`;

                document.getElementById('td-res-note').innerText = noteText;
            }
        };

        document.addEventListener('DOMContentLoaded', TimeDurationCalc.init);
    </script>
    <!-- ================================================================= -->
    <!-- ğŸ”´ åŒºåŸŸ 2 ç»“æŸ -->
    <!-- ================================================================= -->

    <!-- å®¿ä¸»ç¯å¢ƒè¯­è¨€è‡ªé€‚åº”è„šæœ¬ -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userLang = navigator.language || navigator.userLanguage;
            let targetLang = 'en'; 
            if (userLang.startsWith('zh')) {
                targetLang = userLang.includes('TW') || userLang.includes('HK') ? 'zh-TW' : 'zh-CN';
            } else if (userLang.startsWith('ja')) targetLang = 'ja';
            else if (userLang.startsWith('ru')) targetLang = 'ru';
            else if (userLang.startsWith('es')) targetLang = 'es';
            
            if (targetLang !== 'en') {
                const langSelect = document.getElementById('td-lang');
                if(langSelect) {
                    langSelect.value = targetLang;
                    TimeDurationCalc.changeLang();
                }
            }
        });
    </script>

</body>
</html>