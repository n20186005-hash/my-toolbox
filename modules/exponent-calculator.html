<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponent Calculator</title>
    
    <!-- 基础信息 -->
    <meta name="tool-id" content="exponent_calc">
    <meta name="category" content="Math">
    <meta name="icon" content="ⁿ">
    
    <!-- 默认英文内容 -->
    <meta name="title" content="Exponent Calculator">
    <meta name="description" content="Calculate the result of a number raised to a power, including positive, negative, and fractional exponents.">
    
    <!-- 多语言配置 -->
    <meta name="lang-title-zh-CN" content="指数计算器">
    <meta name="lang-description-zh-CN" content="计算一个数的幂运算结果，包括正指数、负指数和分数指数。">
    
    <meta name="lang-title-zh-TW" content="指數計算器">
    <meta name="lang-description-zh-TW" content="計算一個數的冪運算結果，包括正指數、負指數和分數指數。">
    
    <meta name="lang-title-ja" content="べき乗計算ツール">
    <meta name="lang-description-ja" content="正の指数、負の指数、分数指数を含む、べき乗の計算を行います。">
    
    <meta name="lang-title-ru" content="Калькулятор степеней">
    <meta name="lang-description-ru" content="Вычислите результат возведения числа в степень, включая положительные, отрицательные и дробные показатели степени.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { padding: 20px; background: #f0f9ff; font-family: sans-serif; }
        .tool-module { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; position: relative; }
        .calculation-display { font-size: 1.5rem; text-align: center; margin: 20px 0; padding: 15px; background: #f8fafc; border-radius: 8px; }
        .result-card { background: #e8f4f8; padding: 20px; border-radius: 8px; margin: 20px 0; text-align: center; }
        .result-value { font-size: 2rem; font-weight: bold; color: #1e40af; margin: 10px 0; }
        .input-group { margin-bottom: 15px; }
        .history-list { max-height: 150px; overflow-y: auto; margin-top: 10px; }
        .history-item { padding: 5px; border-bottom: 1px solid #e2e8f0; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div class="tool-module active" 
         data-id="exponent_calc" 
         data-category="mathematics" 
         data-title="Exponent Calculator" 
         data-icon="ⁿ">
        
        <!-- 语言选择器 -->
        <div class="absolute top-4 right-4">
            <select id="exponent-lang" onchange="ExponentCalc.changeLang()" class="text-xs border border-gray-300 rounded p-1 bg-gray-50 text-gray-600 focus:outline-none">
                <option value="en" selected>English</option>
                <option value="zh-CN">简体中文</option>
                <option value="zh-TW">繁體中文</option>
                <option value="ja">日本語</option>
                <option value="ru">Русский</option>
            </select>
        </div>

        <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2" data-i18n="title">ⁿ Exponent Calculator</h2>
        
        <div class="space-y-4 mb-6">
            <!-- 底数输入 -->
            <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="base">Base (a)</label>
                <input type="number" id="base" step="any" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. 2">
            </div>
            
            <!-- 指数输入 -->
            <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="exponent">Exponent (n)</label>
                <input type="number" id="exponent" step="any" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="e.g. 3 for square, 0.5 for square root">
            </div>
            
            <!-- 精度选择 -->
            <div class="input-group">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="precision">Precision (decimal places)</label>
                <input type="number" id="exponent-precision" min="0" max="10" value="6" class="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none">
            </div>
            
            <!-- 计算显示 -->
            <div class="calculation-display" id="calculation-display">aⁿ</div>
            
            <!-- 操作按钮 -->
            <div class="flex gap-2">
                <button onclick="ExponentCalc.loadExamples()" class="flex-1 bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700 transition" data-i18n="load_examples">Load Examples</button>
                <button onclick="ExponentCalc.clearInputs()" class="flex-1 bg-gray-600 text-white py-2 rounded font-bold hover:bg-gray-700 transition" data-i18n="clear">Clear</button>
                <button onclick="ExponentCalc.calculate()" class="flex-2 bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition" data-i18n="calculate">Calculate Result</button>
            </div>
            
            <!-- 计算历史 -->
            <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="history">Calculation History</label>
                <div class="history-list bg-gray-50 p-2 rounded" id="calculation-history">
                    <div class="text-gray-500 text-sm" data-i18n="history_empty">No calculations yet</div>
                </div>
            </div>
        </div>

        <!-- 错误提示 -->
        <div id="exponent-error" class="text-sm text-red-600 mt-2 hidden mb-4"></div>
        
        <!-- 结果展示 -->
        <div id="exponent-results" class="hidden">
            <div class="result-card">
                <div class="text-sm text-gray-500" data-i18n="result">Result</div>
                <div class="result-value" id="result-value">--</div>
                <div class="text-sm text-gray-600 mt-2" id="formula-explanation"></div>
            </div>
            
            <div class="mt-4 p-3 bg-gray-50 rounded-lg text-sm">
                <div data-i18n="result_details">Result Details:</div>
                <div id="result-details" class="mt-2 space-y-1"></div>
            </div>
        </div>

        <!-- 说明信息 -->
        <div class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600">
            <p data-i18n="notes">Notes:</p>
            <ul class="list-disc list-inside mt-2 space-y-1" data-i18n="notes_list">
                <li>aⁿ means multiplying 'a' by itself 'n' times</li>
                <li>Negative exponents: a⁻ⁿ = 1/aⁿ</li>
                <li>Fractional exponents: a^(m/n) = n√(aᵐ)</li>
                <li>Special case: Any number to the power of 0 is 1</li>
                <li>Special case: Any number to the power of 1 is the number itself</li>
            </ul>
        </div>
    </div>

    <script>
        const ExponentCalc = {
            calculationHistory: [],
            
            i18n: {
                'en': {
                    title: 'ⁿ Exponent Calculator',
                    base: 'Base (a)',
                    exponent: 'Exponent (n)',
                    precision: 'Precision (decimal places)',
                    load_examples: 'Load Examples',
                    clear: 'Clear',
                    calculate: 'Calculate Result',
                    history: 'Calculation History',
                    history_empty: 'No calculations yet',
                    result: 'Result',
                    result_details: 'Result Details:',
                    notes: 'Notes:',
                    notes_list: `
                        <li>aⁿ means multiplying 'a' by itself 'n' times</li>
                        <li>Negative exponents: a⁻ⁿ = 1/aⁿ</li>
                        <li>Fractional exponents: a^(m/n) = n√(aᵐ)</li>
                        <li>Special case: Any number to the power of 0 is 1</li>
                        <li>Special case: Any number to the power of 1 is the number itself</li>
                    `,
                    err_invalid_input: 'Please enter valid numbers for base and exponent',
                    formula_explanation_integer: '{{base}} raised to the power of {{exponent}} equals {{result}}',
                    formula_explanation_negative: '{{base}} raised to the power of {{exponent}} (negative exponent) equals 1/{{base}}^ {{positiveExponent}} = {{result}}',
                    formula_explanation_fraction: '{{base}} raised to the power of {{exponent}} (fractional exponent) equals the {{denominator}}th root of {{base}}^ {{numerator}} = {{result}}',
                    details_base: 'Base: {{value}}',
                    details_exponent: 'Exponent: {{value}}',
                    details_calculation: 'Calculation: {{base}}^ {{exponent}} = {{result}}'
                },
                'zh-CN': {
                    title: 'ⁿ 指数计算器',
                    base: '底数 (a)',
                    exponent: '指数 (n)',
                    precision: '精度（小数位数）',
                    load_examples: '加载示例',
                    clear: '清除',
                    calculate: '计算结果',
                    history: '计算历史',
                    history_empty: '暂无计算记录',
                    result: '结果',
                    result_details: '结果详情：',
                    notes: '说明：',
                    notes_list: `
                        <li>aⁿ 表示将 'a' 自乘 'n' 次</li>
                        <li>负指数：a⁻ⁿ = 1/aⁿ</li>
                        <li>分数指数：a^(m/n) = n√(aᵐ)</li>
                        <li>特殊情况：任何数的0次方等于1</li>
                        <li>特殊情况：任何数的1次方等于其本身</li>
                    `,
                    err_invalid_input: '请为底数和指数输入有效的数字',
                    formula_explanation_integer: '{{base}}的{{exponent}}次方等于{{result}}',
                    formula_explanation_negative: '{{base}}的{{exponent}}次方（负指数）等于1/{{base}}^ {{positiveExponent}} = {{result}}',
                    formula_explanation_fraction: '{{base}}的{{exponent}}次方（分数指数）等于{{base}}的{{numerator}}次方开{{denominator}}次方根 = {{result}}',
                    details_base: '底数：{{value}}',
                    details_exponent: '指数：{{value}}',
                    details_calculation: '计算式：{{base}}^ {{exponent}} = {{result}}'
                },
                'zh-TW': {
                    title: 'ⁿ 指數計算器',
                    base: '底數 (a)',
                    exponent: '指數 (n)',
                    precision: '精度（小數位數）',
                    load_examples: '加載示例',
                    clear: '清除',
                    calculate: '計算結果',
                    history: '計算歷史',
                    history_empty: '暫無計算記錄',
                    result: '結果',
                    result_details: '結果詳情：',
                    notes: '說明：',
                    notes_list: `
                        <li>aⁿ 表示將 'a' 自乘 'n' 次</li>
                        <li>負指數：a⁻ⁿ = 1/aⁿ</li>
                        <li>分數指數：a^(m/n) = n√(aᵐ)</li>
                        <li>特殊情況：任何數的0次方等於1</li>
                        <li>特殊情況：任何數的1次方等於其本身</li>
                    `,
                    err_invalid_input: '請為底數和指數輸入有效的數字',
                    formula_explanation_integer: '{{base}}的{{exponent}}次方等於{{result}}',
                    formula_explanation_negative: '{{base}}的{{exponent}}次方（負指數）等於1/{{base}}^ {{positiveExponent}} = {{result}}',
                    formula_explanation_fraction: '{{base}}的{{exponent}}次方（分數指數）等於{{base}}的{{numerator}}次方開{{denominator}}次方根 = {{result}}',
                    details_base: '底數：{{value}}',
                    details_exponent: '指數：{{value}}',
                    details_calculation: '計算式：{{base}}^ {{exponent}} = {{result}}'
                },
                'ja': {
                    title: 'ⁿ べき乗計算ツール',
                    base: '基数 (a)',
                    exponent: '指数 (n)',
                    precision: '精度（小数桁数）',
                    load_examples: '例を読み込む',
                    clear: 'クリア',
                    calculate: '結果を計算',
                    history: '計算履歴',
                    history_empty: 'まだ計算がありません',
                    result: '結果',
                    result_details: '結果の詳細：',
                    notes: '注意事項：',
                    notes_list: `
                        <li>aⁿ は、'a' を 'n' 回自分自身で掛け算することを意味します</li>
                        <li>負の指数：a⁻ⁿ = 1/aⁿ</li>
                        <li>分数指数：a^(m/n) = n√(aᵐ)</li>
                        <li>特殊な場合：0乗はどの数でも1になります</li>
                        <li>特殊な場合：1乗は数値そのものになります</li>
                    `,
                    err_invalid_input: '基数と指数に有効な数値を入力してください',
                    formula_explanation_integer: '{{base}}の{{exponent}}乗は{{result}}に等しい',
                    formula_explanation_negative: '{{base}}の{{exponent}}乗（負の指数）は1/{{base}}^ {{positiveExponent}} = {{result}}に等しい',
                    formula_explanation_fraction: '{{base}}の{{exponent}}乗（分数指数）は{{base}}の{{numerator}}乗の{{denominator}}乗根 = {{result}}に等しい',
                    details_base: '基数：{{value}}',
                    details_exponent: '指数：{{value}}',
                    details_calculation: '計算式：{{base}}^ {{exponent}} = {{result}}'
                },
                'ru': {
                    title: 'ⁿ Калькулятор степеней',
                    base: 'Основание (a)',
                    exponent: 'Показатель степени (n)',
                    precision: 'Точность (знаков после запятой)',
                    load_examples: 'Загрузить примеры',
                    clear: 'Очистить',
                    calculate: 'Вычислить результат',
                    history: 'История вычислений',
                    history_empty: 'Еще нет вычислений',
                    result: 'Результат',
                    result_details: 'Детали результата:',
                    notes: 'Примечания:',
                    notes_list: `
                        <li>aⁿ означает умножение 'a' на себя 'n' раз</li>
                        <li>Отрицательные показатели степени: a⁻ⁿ = 1/aⁿ</li>
                        <li>Дробные показатели степени: a^(m/n) = n√(aᵐ)</li>
                        <li>Специальный случай: Любое число в нулевой степени равно 1</li>
                        <li>Специальный случай: Любое число в первой степени равно самому себе</li>
                    `,
                    err_invalid_input: 'Введите действительные числа для основания и показателя степени',
                    formula_explanation_integer: '{{base}} в степени {{exponent}} равно {{result}}',
                    formula_explanation_negative: '{{base}} в степени {{exponent}} (отрицательный показатель) равно 1/{{base}}^ {{positiveExponent}} = {{result}}',
                    formula_explanation_fraction: '{{base}} в степени {{exponent}} (дробный показатель) равно {{denominator}}-й корень из {{base}}^ {{numerator}} = {{result}}',
                    details_base: 'Основание: {{value}}',
                    details_exponent: 'Показатель степени: {{value}}',
                    details_calculation: 'Вычисление: {{base}}^ {{exponent}} = {{result}}'
                }
            },
            
            init: function() {
                // 监听输入变化，更新计算表达式显示
                document.getElementById('base').addEventListener('input', () => this.updateCalculationDisplay());
                document.getElementById('exponent').addEventListener('input', () => this.updateCalculationDisplay());
                this.changeLang();
            },
            
            updateCalculationDisplay: function() {
                const base = document.getElementById('base').value || 'a';
                const exponent = document.getElementById('exponent').value || 'n';
                document.getElementById('calculation-display').textContent = `${base}^${exponent}`;
            },
            
            loadExamples: function() {
                // 显示示例选项
                const examples = [
                    {base: 2, exponent: 3, desc: '2³ = 8'},
                    {base: 5, exponent: -2, desc: '5⁻² = 0.04'},
                    {base: 16, exponent: 0.5, desc: '16⁰·⁵ = 4'},
                    {base: 2, exponent: 10, desc: '2¹⁰ = 1024'},
                    {base: 10, exponent: 3, desc: '10³ = 1000'}
                ];
                
                let exampleHTML = this.i18n[this.getCurrentLang()].load_examples + ': ';
                examples.forEach((ex, index) => {
                    exampleHTML += `<button class="mx-1 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 rounded" onclick="ExponentCalc.setExample(${ex.base}, ${ex.exponent})">${ex.desc}</button>`;
                });
                
                alert(exampleHTML);
            },
            
            setExample: function(base, exponent) {
                document.getElementById('base').value = base;
                document.getElementById('exponent').value = exponent;
                this.updateCalculationDisplay();
            },
            
            clearInputs: function() {
                document.getElementById('base').value = '';
                document.getElementById('exponent').value = '';
                document.getElementById('exponent-results').classList.add('hidden');
                document.getElementById('exponent-error').classList.add('hidden');
                this.updateCalculationDisplay();
            },
            
            calculate: function() {
                const errorEl = document.getElementById('exponent-error');
                errorEl.classList.add('hidden');
                
                // 获取输入值
                const base = parseFloat(document.getElementById('base').value);
                const exponent = parseFloat(document.getElementById('exponent').value);
                const precision = parseInt(document.getElementById('exponent-precision').value) || 6;
                
                // 验证输入
                if (isNaN(base) || isNaN(exponent)) {
                    errorEl.textContent = this.i18n[this.getCurrentLang()].err_invalid_input;
                    errorEl.classList.remove('hidden');
                    return;
                }
                
                // 计算结果
                let result;
                try {
                    result = Math.pow(base, exponent);
                } catch (e) {
                    errorEl.textContent = e.message;
                    errorEl.classList.remove('hidden');
                    return;
                }
                
                // 格式化结果
                const formattedBase = base.toFixed(precision);
                const formattedExponent = exponent.toFixed(precision);
                const formattedResult = this.formatNumber(result, precision);
                
                // 更新结果UI
                document.getElementById('result-value').textContent = formattedResult;
                
                // 更新公式解释
                let explanation = '';
                const lang = this.getCurrentLang();
                
                if (exponent < 0) {
                    const positiveExponent = Math.abs(exponent);
                    explanation = this.i18n[lang].formula_explanation_negative
                        .replace('{{base}}', formattedBase)
                        .replace('{{exponent}}', formattedExponent)
                        .replace('{{positiveExponent}}', positiveExponent.toFixed(precision))
                        .replace('{{result}}', formattedResult);
                } else if (!this.isInteger(exponent)) {
                    // 处理分数指数
                    const [numerator, denominator] = this.fractionalParts(exponent);
                    explanation = this.i18n[lang].formula_explanation_fraction
                        .replace('{{base}}', formattedBase)
                        .replace('{{exponent}}', formattedExponent)
                        .replace('{{numerator}}', numerator)
                        .replace('{{denominator}}', denominator)
                        .replace('{{result}}', formattedResult);
                } else {
                    explanation = this.i18n[lang].formula_explanation_integer
                        .replace('{{base}}', formattedBase)
                        .replace('{{exponent}}', formattedExponent)
                        .replace('{{result}}', formattedResult);
                }
                
                document.getElementById('formula-explanation').textContent = explanation;
                
                // 更新详情
                const detailsEl = document.getElementById('result-details');
                detailsEl.innerHTML = '';
                
                detailsEl.innerHTML += this.i18n[lang].details_base.replace('{{value}}', formattedBase);
                detailsEl.innerHTML += '<br>';
                detailsEl.innerHTML += this.i18n[lang].details_exponent.replace('{{value}}', formattedExponent);
                detailsEl.innerHTML += '<br>';
                detailsEl.innerHTML += this.i18n[lang].details_calculation
                    .replace('{{base}}', formattedBase)
                    .replace('{{exponent}}', formattedExponent)
                    .replace('{{result}}', formattedResult);
                
                // 添加到历史记录
                this.addToHistory(formattedBase, formattedExponent, formattedResult);
                
                // 显示结果
                document.getElementById('exponent-results').classList.remove('hidden');
            },
            
            formatNumber: function(num, precision) {
                // 处理非常大和非常小的数字
                if (Math.abs(num) > 1e10 || Math.abs(num) < 1e-10) {
                    return num.toExponential(precision);
                }
                return num.toFixed(precision).replace(/\.?0+$/, '');
            },
            
            isInteger: function(num) {
                return num % 1 === 0;
            },
            
            fractionalParts: function(num) {
                // 将小数转换为近似分数
                const tolerance = 1e-6;
                let numerator = num;
                let denominator = 1;
                
                // 简化分数
                while (Math.abs(numerator - Math.round(numerator)) > tolerance) {
                    numerator *= 10;
                    denominator *= 10;
                }
                
                numerator = Math.round(numerator);
                
                // 计算最大公约数
                const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
                const commonDivisor = gcd(numerator, denominator);
                
                return [numerator / commonDivisor, denominator / commonDivisor];
            },
            
            addToHistory: function(base, exponent, result) {
                const entry = {
                    base,
                    exponent,
                    result,
                    timestamp: new Date()
                };
                
                this.calculationHistory.unshift(entry);
                if (this.calculationHistory.length > 10) {
                    this.calculationHistory.pop();
                }
                
                this.updateHistoryDisplay();
            },
            
            updateHistoryDisplay: function() {
                const historyEl = document.getElementById('calculation-history');
                
                if (this.calculationHistory.length === 0) {
                    historyEl.innerHTML = `<div class="text-gray-500 text-sm" data-i18n="history_empty">${this.i18n[this.getCurrentLang()].history_empty}</div>`;
                    return;
                }
                
                let historyHTML = '';
                this.calculationHistory.forEach(entry => {
                    historyHTML += `<div class="history-item">${entry.base}^${entry.exponent} = ${entry.result}</div>`;
                });
                
                historyEl.innerHTML = historyHTML;
            },
            
            getCurrentLang: function() {
                return document.getElementById('exponent-lang').value;
            },
            
            changeLang: function() {
                const lang = this.getCurrentLang();
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (this.i18n[lang] && this.i18n[lang][key]) {
                        el.innerHTML = this.i18n[lang][key];
                    }
                });
                this.updateHistoryDisplay();
            }
        };
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            ExponentCalc.init();
        });
    </script>
</body>

</html>
