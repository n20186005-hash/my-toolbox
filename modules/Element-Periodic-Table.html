<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Periodic Table</title>
    
    <!-- Meta Info -->
    <meta name="tool-id" content="periodic_table_full">
    <meta name="category" content="chemistry">
    <meta name="icon" content="üß¨">
    
    <meta name="title" content="Complete Periodic Table (118 Elements)">
    <meta name="description" content="Fully interactive periodic table containing all 118 elements with multilingual support and detailed properties.">
    
    <!-- Multilingual Meta -->
    <meta name="lang-title-zh-CN" content="ÂÆåÊï¥ÂÖÉÁ¥†Âë®ÊúüË°® (118ÂÖÉÁ¥†)">
    <meta name="lang-description-zh-CN" content="ÂåÖÂê´ÊâÄÊúâ118ÁßçÂÖÉÁ¥†ÁöÑ‰∫§‰∫íÂºèÂë®ÊúüË°®ÔºåÊîØÊåÅÂ§öËØ≠Ë®ÄÂíåËØ¶ÁªÜÂ±ûÊÄßÊü•ËØ¢„ÄÇ">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Noto+Sans+TC:wght@400;700&family=Roboto:wght@400;700&display=swap');

        body { 
            padding: 20px; 
            background: #f8fafc; 
            font-family: 'Roboto', 'Noto Sans SC', 'Noto Sans TC', sans-serif; 
        }
        .tool-module { 
            background: white; 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); 
            max-width: 1400px; 
            margin: 0 auto; 
            position: relative; 
        }
        
        /* The Grid */
        .periodic-table { 
            display: grid; 
            /* 18 columns for groups */
            grid-template-columns: repeat(18, minmax(36px, 1fr)); 
            /* Auto rows, but we will place them explicitly */
            gap: 4px; 
            margin: 20px 0; 
            overflow-x: auto; /* Allow scroll on small mobile screens */
            padding-bottom: 10px;
        }

        .element { 
            aspect-ratio: 1 / 1.1; /* Slightly taller than square */
            padding: 2px; 
            border-radius: 4px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.2s; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 1px solid rgba(0,0,0,0.05);
            position: relative;
        }
        .element:hover { 
            transform: scale(1.15); 
            z-index: 10; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            border-color: #666;
        }
        
        .element .number { font-size: 8px; position: absolute; top: 2px; left: 2px; opacity: 0.7; }
        .element .symbol { font-weight: 800; font-size: 14px; margin-top: 4px; }
        .element .name { font-size: 9px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; max-width: 100%; margin-top: 2px;}

        /* Small Screen Adjustments */
        @media (max-width: 768px) {
            .periodic-table {
                grid-template-columns: repeat(18, 40px); /* Fixed width on mobile to force scroll */
            }
            .element .symbol { font-size: 12px; }
            .element .name { font-size: 7px; }
        }

        .element-info { 
            background: linear-gradient(to right, #f0fdf4, #dcfce7); 
            border: 1px solid #22c55e; 
            color: #14532d; 
            padding: 20px; 
            border-radius: 8px; 
            margin-top: 20px; 
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Category Colors */
        .cat-alkali { background-color: #ffadad; } /* Red-ish */
        .cat-alkaline { background-color: #ffd6a5; } /* Orange-ish */
        .cat-transition { background-color: #fdffb6; } /* Yellow-ish */
        .cat-post-transition { background-color: #caffbf; } /* Green-ish */
        .cat-metalloid { background-color: #9bf6ff; } /* Cyan-ish */
        .cat-nonmetal { background-color: #a0c4ff; } /* Blue-ish */
        .cat-halogen { background-color: #bdb2ff; } /* Indigo-ish */
        .cat-noble { background-color: #ffc6ff; } /* Purple-ish */
        .cat-lanthanide { background-color: #ffc8dd; } /* Pink-ish */
        .cat-actinide { background-color: #ffafcc; } /* Darker Pink */
        .cat-unknown { background-color: #e2e8f0; }
        
        /* Legend styles */
        .legend { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; font-size: 11px; }
        .legend-item { display: flex; align-items: center; gap: 4px; }
        .legend-box { width: 12px; height: 12px; border-radius: 2px; border: 1px solid rgba(0,0,0,0.1); }

    </style>
</head>
<body>

    <div class="tool-module" id="app">
        
        <!-- Header & Controls -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                    <span class="text-3xl">üß¨</span> 
                    <span data-i18n="title">Element Periodic Table</span>
                </h1>
                <p class="text-sm text-gray-500 mt-1" data-i18n="subtitle">Click an element for details</p>
            </div>

            <div class="flex gap-3 w-full md:w-auto">
                <input type="text" id="element-search" placeholder="Search (e.g., Au, Gold, 79)" 
                       class="border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-48">
                
                <select id="periodic-lang" onchange="PeriodicTable.changeLang()" 
                        class="border border-gray-300 rounded px-3 py-2 text-sm bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="zh-CN" selected>ÁÆÄ‰Ωì‰∏≠Êñá</option>
                    <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                    <option value="en">English</option>
                    <option value="ja">Êó•Êú¨Ë™û</option>
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                </select>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend mb-4 px-2 py-2 bg-gray-50 rounded border border-gray-100">
            <!-- Populated by JS -->
        </div>

        <!-- Main Table -->
        <div class="periodic-table" id="periodic-table-container">
            <!-- Generated by JS -->
        </div>

        <!-- Details Panel -->
        <div id="element-details" class="element-info hidden">
            <div class="flex justify-between items-start border-b border-green-300 pb-3 mb-3">
                <div>
                    <div class="text-3xl font-bold" id="detail-symbol">--</div>
                    <div class="text-xl font-bold" id="detail-name">--</div>
                    <div class="text-sm opacity-75" id="detail-category">--</div>
                </div>
                <div class="text-5xl font-bold opacity-20" id="detail-number-large">--</div>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-sm">
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="atomic_mass">Atomic Mass</p>
                    <p class="font-bold text-lg" id="detail-mass">--</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="phase">Phase (STP)</p>
                    <p class="font-bold text-lg" id="detail-phase">--</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="melting_point">Melting Point</p>
                    <p class="font-bold text-lg"><span id="detail-mp">--</span> ¬∞C</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="boiling_point">Boiling Point</p>
                    <p class="font-bold text-lg"><span id="detail-bp">--</span> ¬∞C</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="density">Density</p>
                    <p class="font-bold text-lg"><span id="detail-density">--</span> g/cm¬≥</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="electron_config">Configuration</p>
                    <p class="font-bold text-md font-mono" id="detail-config">--</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="discovery_year">Discovered</p>
                    <p class="font-bold text-lg" id="detail-year">--</p>
                </div>
                <div>
                    <p class="text-xs opacity-70 uppercase tracking-wider mb-1" data-i18n="group_period">Group / Period</p>
                    <p class="font-bold text-lg"><span id="detail-group">--</span>, <span id="detail-period">--</span></p>
                </div>
            </div>
            
            <div class="mt-4 pt-3 border-t border-green-300 text-xs opacity-80" id="detail-summary">
                <!-- Short description or extra info could go here -->
            </div>
        </div>

    </div>

    <script>
        // Helper to generate range of data or simplify content
        // This is a comprehensive list of 118 elements.
        const elementsData = [
            // Period 1
            { n: 1, s: "H", m: 1.008, g: 1, p: 1, c: "nonmetal", names: ["Hydrogen", "Ê∞¢", "Ê∞´", "Ê∞¥Á¥†", "–í–æ–¥–æ—Ä–æ–¥"] },
            { n: 2, s: "He", m: 4.0026, g: 18, p: 1, c: "noble", names: ["Helium", "Ê∞¶", "Ê∞¶", "„Éò„É™„Ç¶„É†", "–ì–µ–ª–∏–π"] },
            // Period 2
            { n: 3, s: "Li", m: 6.94, g: 1, p: 2, c: "alkali", names: ["Lithium", "ÈîÇ", "Èã∞", "„É™„ÉÅ„Ç¶„É†", "–õ–∏—Ç–∏–π"] },
            { n: 4, s: "Be", m: 9.0122, g: 2, p: 2, c: "alkaline", names: ["Beryllium", "Èìç", "Èàπ", "„Éô„É™„É™„Ç¶„É†", "–ë–µ—Ä–∏–ª–ª–∏–π"] },
            { n: 5, s: "B", m: 10.81, g: 13, p: 2, c: "metalloid", names: ["Boron", "Á°º", "Á°º", "„Éõ„Ç¶Á¥†", "–ë–æ—Ä"] },
            { n: 6, s: "C", m: 12.011, g: 14, p: 2, c: "nonmetal", names: ["Carbon", "Á¢≥", "Á¢≥", "ÁÇ≠Á¥†", "–£–≥–ª–µ—Ä–æ–¥"] },
            { n: 7, s: "N", m: 14.007, g: 15, p: 2, c: "nonmetal", names: ["Nitrogen", "Ê∞Æ", "Ê∞Æ", "Á™íÁ¥†", "–ê–∑–æ—Ç"] },
            { n: 8, s: "O", m: 15.999, g: 16, p: 2, c: "nonmetal", names: ["Oxygen", "Ê∞ß", "Ê∞ß", "ÈÖ∏Á¥†", "–ö–∏—Å–ª–æ—Ä–æ–¥"] },
            { n: 9, s: "F", m: 18.998, g: 17, p: 2, c: "halogen", names: ["Fluorine", "Ê∞ü", "Ê∞ü", "„Éï„ÉÉÁ¥†", "–§—Ç–æ—Ä"] },
            { n: 10, s: "Ne", m: 20.180, g: 18, p: 2, c: "noble", names: ["Neon", "Ê∞ñ", "Ê∞ñ", "„Éç„Ç™„É≥", "–ù–µ–æ–Ω"] },
            // Period 3
            { n: 11, s: "Na", m: 22.990, g: 1, p: 3, c: "alkali", names: ["Sodium", "Èí†", "Èàâ", "„Éä„Éà„É™„Ç¶„É†", "–ù–∞—Ç—Ä–∏–π"] },
            { n: 12, s: "Mg", m: 24.305, g: 2, p: 3, c: "alkaline", names: ["Magnesium", "ÈïÅ", "ÈéÇ", "„Éû„Ç∞„Éç„Ç∑„Ç¶„É†", "–ú–∞–≥–Ω–∏–π"] },
            { n: 13, s: "Al", m: 26.982, g: 13, p: 3, c: "post-transition", names: ["Aluminium", "Èìù", "ÈãÅ", "„Ç¢„É´„Éü„Éã„Ç¶„É†", "–ê–ª—é–º–∏–Ω–∏–π"] },
            { n: 14, s: "Si", m: 28.085, g: 14, p: 3, c: "metalloid", names: ["Silicon", "Á°Ö", "ÁüΩ", "„Ç±„Ç§Á¥†", "–ö—Ä–µ–º–Ω–∏–π"] },
            { n: 15, s: "P", m: 30.974, g: 15, p: 3, c: "nonmetal", names: ["Phosphorus", "Á£∑", "Á£∑", "„É™„É≥", "–§–æ—Å—Ñ–æ—Ä"] },
            { n: 16, s: "S", m: 32.06, g: 16, p: 3, c: "nonmetal", names: ["Sulfur", "Á°´", "Á°´", "Á°´ÈªÑ", "–°–µ—Ä–∞"] },
            { n: 17, s: "Cl", m: 35.45, g: 17, p: 3, c: "halogen", names: ["Chlorine", "Ê∞Ø", "Ê∞Ø", "Â°©Á¥†", "–•–ª–æ—Ä"] },
            { n: 18, s: "Ar", m: 39.948, g: 18, p: 3, c: "noble", names: ["Argon", "Ê∞©", "Ê∞¨", "„Ç¢„É´„Ç¥„É≥", "–ê—Ä–≥–æ–Ω"] },
            // Period 4
            { n: 19, s: "K", m: 39.098, g: 1, p: 4, c: "alkali", names: ["Potassium", "Èíæ", "ÈâÄ", "„Ç´„É™„Ç¶„É†", "–ö–∞–ª–∏–π"] },
            { n: 20, s: "Ca", m: 40.078, g: 2, p: 4, c: "alkaline", names: ["Calcium", "Èíô", "Èà£", "„Ç´„É´„Ç∑„Ç¶„É†", "–ö–∞–ª—å—Ü–∏–π"] },
            { n: 21, s: "Sc", m: 44.956, g: 3, p: 4, c: "transition", names: ["Scandium", "Èí™", "Èàß", "„Çπ„Ç´„É≥„Ç∏„Ç¶„É†", "–°–∫–∞–Ω–¥–∏–π"] },
            { n: 22, s: "Ti", m: 47.867, g: 4, p: 4, c: "transition", names: ["Titanium", "Èíõ", "Èà¶", "„ÉÅ„Çø„É≥", "–¢–∏—Ç–∞–Ω"] },
            { n: 23, s: "V", m: 50.942, g: 5, p: 4, c: "transition", names: ["Vanadium", "Èíí", "Èá©", "„Éê„Éä„Ç∏„Ç¶„É†", "–í–∞–Ω–∞–¥–∏–π"] },
            { n: 24, s: "Cr", m: 51.996, g: 6, p: 4, c: "transition", names: ["Chromium", "Èì¨", "Èâª", "„ÇØ„É≠„É†", "–•—Ä–æ–º"] },
            { n: 25, s: "Mn", m: 54.938, g: 7, p: 4, c: "transition", names: ["Manganese", "Èî∞", "Èå≥", "„Éû„É≥„Ç¨„É≥", "–ú–∞—Ä–≥–∞–Ω–µ—Ü"] },
            { n: 26, s: "Fe", m: 55.845, g: 8, p: 4, c: "transition", names: ["Iron", "ÈìÅ", "Èêµ", "ÈâÑ", "–ñ–µ–ª–µ–∑–æ"] },
            { n: 27, s: "Co", m: 58.933, g: 9, p: 4, c: "transition", names: ["Cobalt", "Èí¥", "Èà∑", "„Ç≥„Éê„É´„Éà", "–ö–æ–±–∞–ª—å—Ç"] },
            { n: 28, s: "Ni", m: 58.693, g: 10, p: 4, c: "transition", names: ["Nickel", "Èïç", "Èé≥", "„Éã„ÉÉ„Ç±„É´", "–ù–∏–∫–µ–ª—å"] },
            { n: 29, s: "Cu", m: 63.546, g: 11, p: 4, c: "transition", names: ["Copper", "Èìú", "ÈäÖ", "ÈäÖ", "–ú–µ–¥—å"] },
            { n: 30, s: "Zn", m: 65.38, g: 12, p: 4, c: "transition", names: ["Zinc", "Èîå", "ÈãÖ", "‰∫úÈâõ", "–¶–∏–Ω–∫"] },
            { n: 31, s: "Ga", m: 69.723, g: 13, p: 4, c: "post-transition", names: ["Gallium", "Èïì", "Èéµ", "„Ç¨„É™„Ç¶„É†", "–ì–∞–ª–ª–∏–π"] },
            { n: 32, s: "Ge", m: 72.630, g: 14, p: 4, c: "metalloid", names: ["Germanium", "Èîó", "Èç∫", "„Ç≤„É´„Éû„Éã„Ç¶„É†", "–ì–µ—Ä–º–∞–Ω–∏–π"] },
            { n: 33, s: "As", m: 74.922, g: 15, p: 4, c: "metalloid", names: ["Arsenic", "Á†∑", "Á†∑", "„ÉíÁ¥†", "–ú—ã—à—å—è–∫"] },
            { n: 34, s: "Se", m: 78.971, g: 16, p: 4, c: "nonmetal", names: ["Selenium", "Á°í", "Á°í", "„Çª„É¨„É≥", "–°–µ–ª–µ–Ω"] },
            { n: 35, s: "Br", m: 79.904, g: 17, p: 4, c: "halogen", names: ["Bromine", "Ê∫¥", "Ê∫¥", "Ëá≠Á¥†", "–ë—Ä–æ–º"] },
            { n: 36, s: "Kr", m: 83.798, g: 18, p: 4, c: "noble", names: ["Krypton", "Ê∞™", "Ê∞™", "„ÇØ„É™„Éó„Éà„É≥", "–ö—Ä–∏–ø—Ç–æ–Ω"] },
            // Period 5
            { n: 37, s: "Rb", m: 85.468, g: 1, p: 5, c: "alkali", names: ["Rubidium", "Èì∑", "Èä£", "„É´„Éì„Ç∏„Ç¶„É†", "–†—É–±–∏–¥–∏–π"] },
            { n: 38, s: "Sr", m: 87.62, g: 2, p: 5, c: "alkaline", names: ["Strontium", "Èî∂", "Èç∂", "„Çπ„Éà„É≠„É≥„ÉÅ„Ç¶„É†", "–°—Ç—Ä–æ–Ω—Ü–∏–π"] },
            { n: 39, s: "Y", m: 88.906, g: 3, p: 5, c: "transition", names: ["Yttrium", "Èíá", "Èáî", "„Ç§„ÉÉ„Éà„É™„Ç¶„É†", "–ò—Ç—Ç—Ä–∏–π"] },
            { n: 40, s: "Zr", m: 91.224, g: 4, p: 5, c: "transition", names: ["Zirconium", "ÈîÜ", "ÈãØ", "„Ç∏„É´„Ç≥„Éã„Ç¶„É†", "–¶–∏—Ä–∫–æ–Ω–∏–π"] },
            { n: 41, s: "Nb", m: 92.906, g: 5, p: 5, c: "transition", names: ["Niobium", "Èìå", "ÈàÆ", "„Éã„Ç™„Éñ", "–ù–∏–æ–±–∏–π"] },
            { n: 42, s: "Mo", m: 95.95, g: 6, p: 5, c: "transition", names: ["Molybdenum", "Èíº", "Èâ¨", "„É¢„É™„Éñ„Éá„É≥", "–ú–æ–ª–∏–±–¥–µ–Ω"] },
            { n: 43, s: "Tc", m: 98, g: 7, p: 5, c: "transition", names: ["Technetium", "Èîù", "Èéù", "„ÉÜ„ÇØ„Éç„ÉÅ„Ç¶„É†", "–¢–µ—Ö–Ω–µ—Ü–∏–π"] },
            { n: 44, s: "Ru", m: 101.07, g: 8, p: 5, c: "transition", names: ["Ruthenium", "Èíå", "Èáï", "„É´„ÉÜ„Éã„Ç¶„É†", "–†—É—Ç–µ–Ω–∏–π"] },
            { n: 45, s: "Rh", m: 102.91, g: 9, p: 5, c: "transition", names: ["Rhodium", "Èìë", "Èä†", "„É≠„Ç∏„Ç¶„É†", "–†–æ–¥–∏–π"] },
            { n: 46, s: "Pd", m: 106.42, g: 10, p: 5, c: "transition", names: ["Palladium", "ÈíØ", "ÈàÄ", "„Éë„É©„Ç∏„Ç¶„É†", "–ü–∞–ª–ª–∞–¥–∏–π"] },
            { n: 47, s: "Ag", m: 107.87, g: 11, p: 5, c: "transition", names: ["Silver", "Èì∂", "ÈäÄ", "ÈäÄ", "–°–µ—Ä–µ–±—Ä–æ"] },
            { n: 48, s: "Cd", m: 112.41, g: 12, p: 5, c: "transition", names: ["Cadmium", "Èïâ", "Èéò", "„Ç´„Éâ„Éü„Ç¶„É†", "–ö–∞–¥–º–∏–π"] },
            { n: 49, s: "In", m: 114.82, g: 13, p: 5, c: "post-transition", names: ["Indium", "Èìü", "Èä¶", "„Ç§„É≥„Ç∏„Ç¶„É†", "–ò–Ω–¥–∏–π"] },
            { n: 50, s: "Sn", m: 118.71, g: 14, p: 5, c: "post-transition", names: ["Tin", "Èî°", "Èå´", "„Çπ„Ç∫", "–û–ª–æ–≤–æ"] },
            { n: 51, s: "Sb", m: 121.76, g: 15, p: 5, c: "metalloid", names: ["Antimony", "Èîë", "Èäª", "„Ç¢„É≥„ÉÅ„É¢„É≥", "–°—É—Ä—å–º–∞"] },
            { n: 52, s: "Te", m: 127.60, g: 16, p: 5, c: "metalloid", names: ["Tellurium", "Á¢≤", "Á¢≤", "„ÉÜ„É´„É´", "–¢–µ–ª–ª—É—Ä"] },
            { n: 53, s: "I", m: 126.90, g: 17, p: 5, c: "halogen", names: ["Iodine", "Á¢ò", "Á¢ò", "„É®„Ç¶Á¥†", "–ò–æ–¥"] },
            { n: 54, s: "Xe", m: 131.29, g: 18, p: 5, c: "noble", names: ["Xenon", "Ê∞ô", "Ê∞ô", "„Ç≠„Çª„Éé„É≥", "–ö—Å–µ–Ω–æ–Ω"] },
            // Period 6
            { n: 55, s: "Cs", m: 132.91, g: 1, p: 6, c: "alkali", names: ["Caesium", "ÈìØ", "Èä´", "„Çª„Ç∑„Ç¶„É†", "–¶–µ–∑–∏–π"] },
            { n: 56, s: "Ba", m: 137.33, g: 2, p: 6, c: "alkaline", names: ["Barium", "Èí°", "Èãá", "„Éê„É™„Ç¶„É†", "–ë–∞—Ä–∏–π"] },
            // Lanthanides (57-71)
            { n: 57, s: "La", m: 138.91, g: 3, p: 6, c: "lanthanide", names: ["Lanthanum", "Èïß", "Èë≠", "„É©„É≥„Çø„É≥", "–õ–∞–Ω—Ç–∞–Ω"] },
            { n: 58, s: "Ce", m: 140.12, g: 3, p: 6, c: "lanthanide", names: ["Cerium", "Èìà", "Èà∞", "„Çª„É™„Ç¶„É†", "–¶–µ—Ä–∏–π"] },
            { n: 59, s: "Pr", m: 140.91, g: 3, p: 6, c: "lanthanide", names: ["Praseodymium", "Èï®", "Èê†", "„Éó„É©„Çª„Ç™„Ç∏„É†", "–ü—Ä–∞–∑–µ–æ–¥–∏–º"] },
            { n: 60, s: "Nd", m: 144.24, g: 3, p: 6, c: "lanthanide", names: ["Neodymium", "Èíï", "Èáπ", "„Éç„Ç™„Ç∏„É†", "–ù–µ–æ–¥–∏–º"] },
            { n: 61, s: "Pm", m: 145, g: 3, p: 6, c: "lanthanide", names: ["Promethium", "Èí∑", "Èâï", "„Éó„É≠„É°„ÉÅ„Ç¶„É†", "–ü—Ä–æ–º–µ—Ç–∏–π"] },
            { n: 62, s: "Sm", m: 150.36, g: 3, p: 6, c: "lanthanide", names: ["Samarium", "Èíê", "Èá§", "„Çµ„Éû„É™„Ç¶„É†", "–°–∞–º–∞—Ä–∏–π"] },
            { n: 63, s: "Eu", m: 151.96, g: 3, p: 6, c: "lanthanide", names: ["Europium", "Èìï", "Èä™", "„É¶„Ç¶„É≠„Éî„Ç¶„É†", "–ï–≤—Ä–æ–ø–∏–π"] },
            { n: 64, s: "Gd", m: 157.25, g: 3, p: 6, c: "lanthanide", names: ["Gadolinium", "ÈíÜ", "Èáì", "„Ç¨„Éâ„É™„Éã„Ç¶„É†", "–ì–∞–¥–æ–ª–∏–Ω–∏–π"] },
            { n: 65, s: "Tb", m: 158.93, g: 3, p: 6, c: "lanthanide", names: ["Terbium", "ÈìΩ", "Èã±", "„ÉÜ„É´„Éì„Ç¶„É†", "–¢–µ—Ä–±–∏–π"] },
            { n: 66, s: "Dy", m: 162.50, g: 3, p: 6, c: "lanthanide", names: ["Dysprosium", "Èïù", "Èèë", "„Ç∏„Çπ„Éó„É≠„Ç∑„Ç¶„É†", "–î–∏—Å–ø—Ä–æ–∑–∏–π"] },
            { n: 67, s: "Ho", m: 164.93, g: 3, p: 6, c: "lanthanide", names: ["Holmium", "Èí¨", "Èà•", "„Éõ„É´„Éü„Ç¶„É†", "–ì–æ–ª—å–º–∏–π"] },
            { n: 68, s: "Er", m: 167.26, g: 3, p: 6, c: "lanthanide", names: ["Erbium", "Èìí", "Èâ∫", "„Ç®„É´„Éì„Ç¶„É†", "–≠—Ä–±–∏–π"] },
            { n: 69, s: "Tm", m: 168.93, g: 3, p: 6, c: "lanthanide", names: ["Thulium", "Èì•", "Èä©", "„ÉÑ„É™„Ç¶„É†", "–¢—É–ª–∏–π"] },
            { n: 70, s: "Yb", m: 173.05, g: 3, p: 6, c: "lanthanide", names: ["Ytterbium", "Èï±", "Èêø", "„Ç§„ÉÉ„ÉÜ„É´„Éì„Ç¶„É†", "–ò—Ç—Ç–µ—Ä–±–∏–π"] },
            { n: 71, s: "Lu", m: 174.97, g: 3, p: 6, c: "lanthanide", names: ["Lutetium", "Èï•", "Èë•", "„É´„ÉÜ„ÉÅ„Ç¶„É†", "–õ—é—Ç–µ—Ü–∏–π"] },
            // Period 6 (continued)
            { n: 72, s: "Hf", m: 178.49, g: 4, p: 6, c: "transition", names: ["Hafnium", "Èì™", "Èâø", "„Éè„Éï„Éã„Ç¶„É†", "–ì–∞—Ñ–Ω–∏–π"] },
            { n: 73, s: "Ta", m: 180.95, g: 5, p: 6, c: "transition", names: ["Tantalum", "ÈíΩ", "Èâ≠", "„Çø„É≥„Çø„É´", "–¢–∞–Ω—Ç–∞–ª"] },
            { n: 74, s: "W", m: 183.84, g: 6, p: 6, c: "transition", names: ["Tungsten", "Èí®", "Èé¢", "„Çø„É≥„Ç∞„Çπ„ÉÜ„É≥", "–í–æ–ª—å—Ñ—Ä–∞–º"] },
            { n: 75, s: "Re", m: 186.21, g: 7, p: 6, c: "transition", names: ["Rhenium", "Èìº", "Èå∏", "„É¨„Éã„Ç¶„É†", "–†–µ–Ω–∏–π"] },
            { n: 76, s: "Os", m: 190.23, g: 8, p: 6, c: "transition", names: ["Osmium", "Èîá", "Èã®", "„Ç™„Çπ„Éü„Ç¶„É†", "–û—Å–º–∏–π"] },
            { n: 77, s: "Ir", m: 192.22, g: 9, p: 6, c: "transition", names: ["Iridium", "Èì±", "Èä•", "„Ç§„É™„Ç∏„Ç¶„É†", "–ò—Ä–∏–¥–∏–π"] },
            { n: 78, s: "Pt", m: 195.08, g: 10, p: 6, c: "transition", names: ["Platinum", "ÈìÇ", "Èâë", "ÁôΩÈáë", "–ü–ª–∞—Ç–∏–Ω–∞"] },
            { n: 79, s: "Au", m: 196.97, g: 11, p: 6, c: "transition", names: ["Gold", "Èáë", "Èáë", "Èáë", "–ó–æ–ª–æ—Ç–æ"] },
            { n: 80, s: "Hg", m: 200.59, g: 12, p: 6, c: "transition", names: ["Mercury", "Ê±û", "Ê±û", "Ê∞¥ÈäÄ", "–†—Ç—É—Ç—å"] },
            { n: 81, s: "Tl", m: 204.38, g: 13, p: 6, c: "post-transition", names: ["Thallium", "Èìä", "Èâà", "„Çø„É™„Ç¶„É†", "–¢–∞–ª–ª–∏–π"] },
            { n: 82, s: "Pb", m: 207.2, g: 14, p: 6, c: "post-transition", names: ["Lead", "ÈìÖ", "Èâõ", "Èâõ", "–°–≤–∏–Ω–µ—Ü"] },
            { n: 83, s: "Bi", m: 208.98, g: 15, p: 6, c: "post-transition", names: ["Bismuth", "Èìã", "Èâç", "„Éì„Çπ„Éû„Çπ", "–í–∏—Å–º—É—Ç"] },
            { n: 84, s: "Po", m: 209, g: 16, p: 6, c: "post-transition", names: ["Polonium", "Èíã", "Èáô", "„Éù„É≠„Éã„Ç¶„É†", "–ü–æ–ª–æ–Ω–∏–π"] },
            { n: 85, s: "At", m: 210, g: 17, p: 6, c: "halogen", names: ["Astatine", "Á†π", "Á†à", "„Ç¢„Çπ„Çø„ÉÅ„É≥", "–ê—Å—Ç–∞—Ç"] },
            { n: 86, s: "Rn", m: 222, g: 18, p: 6, c: "noble", names: ["Radon", "Ê∞°", "Ê∞°", "„É©„Éâ„É≥", "–†–∞–¥–æ–Ω"] },
            // Period 7
            { n: 87, s: "Fr", m: 223, g: 1, p: 7, c: "alkali", names: ["Francium", "Èí´", "ÈàÅ", "„Éï„É©„É≥„Ç∑„Ç¶„É†", "–§—Ä–∞–Ω—Ü–∏–π"] },
            { n: 88, s: "Ra", m: 226, g: 2, p: 7, c: "alkaline", names: ["Radium", "Èï≠", "Èê≥", "„É©„Ç∏„Ç¶„É†", "–†–∞–¥–∏–π"] },
            // Actinides (89-103)
            { n: 89, s: "Ac", m: 227, g: 3, p: 7, c: "actinide", names: ["Actinium", "Èîï", "Èåí", "„Ç¢„ÇØ„ÉÅ„Éã„Ç¶„É†", "–ê–∫—Ç–∏–Ω–∏–π"] },
            { n: 90, s: "Th", m: 232.04, g: 3, p: 7, c: "actinide", names: ["Thorium", "Èíç", "Èá∑", "„Éà„É™„Ç¶„É†", "–¢–æ—Ä–∏–π"] },
            { n: 91, s: "Pa", m: 231.04, g: 3, p: 7, c: "actinide", names: ["Protactinium", "Èï§", "Èè∑", "„Éó„É≠„Éà„Ç¢„ÇØ„ÉÅ„Éã„Ç¶„É†", "–ü—Ä–æ—Ç–∞–∫—Ç–∏–Ω–∏–π"] },
            { n: 92, s: "U", m: 238.03, g: 3, p: 7, c: "actinide", names: ["Uranium", "ÈìÄ", "Èàæ", "„Ç¶„É©„É≥", "–£—Ä–∞–Ω"] },
            { n: 93, s: "Np", m: 237, g: 3, p: 7, c: "actinide", names: ["Neptunium", "Èïé", "Èåº", "„Éç„Éó„ÉÑ„Éã„Ç¶„É†", "–ù–µ–ø—Ç—É–Ω–∏–π"] },
            { n: 94, s: "Pu", m: 244, g: 3, p: 7, c: "actinide", names: ["Plutonium", "Èíö", "ÈàΩ", "„Éó„É´„Éà„Éã„Ç¶„É†", "–ü–ª—É—Ç–æ–Ω–∏–π"] },
            { n: 95, s: "Am", m: 243, g: 3, p: 7, c: "actinide", names: ["Americium", "ÈïÖ", "Èéá", "„Ç¢„É°„É™„Ç∑„Ç¶„É†", "–ê–º–µ—Ä–∏—Ü–∏–π"] },
            { n: 96, s: "Cm", m: 247, g: 3, p: 7, c: "actinide", names: ["Curium", "Èîî", "Èã¶", "„Ç≠„É•„É™„Ç¶„É†", "–ö—é—Ä–∏–π"] },
            { n: 97, s: "Bk", m: 247, g: 3, p: 7, c: "actinide", names: ["Berkelium", "Èî´", "Èåá", "„Éê„Éº„ÇØ„É™„Ç¶„É†", "–ë–µ—Ä–∫–ª–∏–π"] },
            { n: 98, s: "Cf", m: 251, g: 3, p: 7, c: "actinide", names: ["Californium", "Èîé", "Èê¶", "„Ç´„É™„Éõ„É´„Éã„Ç¶„É†", "–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–π"] },
            { n: 99, s: "Es", m: 252, g: 3, p: 7, c: "actinide", names: ["Einsteinium", "Èîø", "ÈéÑ", "„Ç¢„Ç§„É≥„Çπ„Çø„Ç§„Éã„Ç¶„É†", "–≠–π–Ω—à—Ç–µ–π–Ω–∏–π"] },
            { n: 100, s: "Fm", m: 257, g: 3, p: 7, c: "actinide", names: ["Fermium", "ÈïÑ", "Èê®", "„Éï„Çß„É´„Éü„Ç¶„É†", "–§–µ—Ä–º–∏–π"] },
            { n: 101, s: "Md", m: 258, g: 3, p: 7, c: "actinide", names: ["Mendelevium", "Èíî", "ÈçÜ", "„É°„É≥„Éá„É¨„Éì„Ç¶„É†", "–ú–µ–Ω–¥–µ–ª–µ–≤–∏–π"] },
            { n: 102, s: "No", m: 259, g: 3, p: 7, c: "actinide", names: ["Nobelium", "Èîò", "Èç©", "„Éé„Éº„Éô„É™„Ç¶„É†", "–ù–æ–±–µ–ª–∏–π"] },
            { n: 103, s: "Lr", m: 266, g: 3, p: 7, c: "actinide", names: ["Lawrencium", "Èìπ", "Èêí", "„É≠„Éº„É¨„É≥„Ç∑„Ç¶„É†", "–õ–æ—É—Ä–µ–Ω—Å–∏–π"] },
            // Period 7 (continued)
            { n: 104, s: "Rf", m: 267, g: 4, p: 7, c: "transition", names: ["Rutherfordium", "Èë™", "Èë™", "„É©„Ç∂„Éõ„Éº„Ç∏„Ç¶„É†", "–†–µ–∑–µ—Ä—Ñ–æ—Ä–¥–∏–π"] },
            { n: 105, s: "Db", m: 268, g: 5, p: 7, c: "transition", names: ["Dubnium", "®ßÄ", "®ßÄ", "„Éâ„Éñ„Éã„Ç¶„É†", "–î—É–±–Ω–∏–π"] },
            { n: 106, s: "Sg", m: 269, g: 6, p: 7, c: "transition", names: ["Seaborgium", "®≠é", "®≠é", "„Ç∑„Éº„Éú„Éº„ÇÆ„Ç¶„É†", "–°–∏–±–æ—Ä–≥–∏–π"] },
            { n: 107, s: "Bh", m: 270, g: 7, p: 7, c: "transition", names: ["Bohrium", "®®è", "®®è", "„Éú„Éº„É™„Ç¶„É†", "–ë–æ—Ä–∏–π"] },
            { n: 108, s: "Hs", m: 277, g: 8, p: 7, c: "transition", names: ["Hassium", "®≠Ü", "®≠Ü", "„Éè„ÉÉ„Ç∑„Ç¶„É†", "–•–∞—Å—Å–∏–π"] },
            { n: 109, s: "Mt", m: 278, g: 9, p: 7, c: "transition", names: ["Meitnerium", "‰•ë", "‰•ë", "„Éû„Ç§„Éà„Éç„É™„Ç¶„É†", "–ú–µ–π—Ç–Ω–µ—Ä–∏–π"] },
            { n: 110, s: "Ds", m: 281, g: 10, p: 7, c: "transition", names: ["Darmstadtium", "ÈêΩ", "ÈêΩ", "„ÉÄ„Éº„É†„Çπ„Çø„ÉÅ„Ç¶„É†", "–î–∞—Ä–º—à—Ç–∞–¥—Ç–∏–π"] },
            { n: 111, s: "Rg", m: 282, g: 11, p: 7, c: "transition", names: ["Roentgenium", "‰º¶", "ÈåÄ", "„É¨„É≥„Éà„Ç≤„Éã„Ç¶„É†", "–†–µ–Ω—Ç–≥–µ–Ω–∏–π"] },
            { n: 112, s: "Cn", m: 285, g: 12, p: 7, c: "transition", names: ["Copernicium", "Èé∂", "Èé∂", "„Ç≥„Éö„É´„Éã„Ç∑„Ç¶„É†", "–ö–æ–ø–µ—Ä–Ω–∏—Ü–∏–π"] },
            { n: 113, s: "Nh", m: 286, g: 13, p: 7, c: "post-transition", names: ["Nihonium", "Èâ®", "Èâ®", "„Éã„Éõ„Éã„Ç¶„É†", "–ù–∏—Ö–æ–Ω–∏–π"] },
            { n: 114, s: "Fl", m: 289, g: 14, p: 7, c: "post-transition", names: ["Flerovium", "´ìß", "Èàá", "„Éï„É¨„É≠„Éì„Ç¶„É†", "–§–ª–µ—Ä–æ–≤–∏–π"] },
            { n: 115, s: "Mc", m: 290, g: 15, p: 7, c: "post-transition", names: ["Moscovium", "ÈïÜ", "Èèå", "„É¢„Çπ„Ç≥„Éì„Ç¶„É†", "–ú–æ—Å–∫–æ–≤–∏–π"] },
            { n: 116, s: "Lv", m: 293, g: 16, p: 7, c: "post-transition", names: ["Livermorium", "´üº", "Èâù", "„É™„Éê„É¢„É™„Ç¶„É†", "–õ–∏–≤–µ—Ä–º–æ—Ä–∏–π"] },
            { n: 117, s: "Ts", m: 294, g: 17, p: 7, c: "halogen", names: ["Tennessine", "Èø¨", "Èø¨", "„ÉÜ„Éç„Ç∑„É≥", "–¢–µ–Ω–Ω–µ—Å—Å–∏–Ω"] },
            { n: 118, s: "Og", m: 294, g: 18, p: 7, c: "noble", names: ["Oganesson", "Èø´", "Èø´", "„Ç™„Ç¨„Éç„ÇΩ„É≥", "–û–≥–∞–Ω–µ—Å–æ–Ω"] }
        ];

        const PeriodicTable = {
            langIndices: {
                'en': 0,
                'zh-CN': 1,
                'zh-TW': 2,
                'ja': 3,
                'ru': 4
            },

            i18n: {
                'en': {
                    title: 'Element Periodic Table',
                    subtitle: 'Click an element for details',
                    search_ph: 'Search (e.g., Au, Gold)',
                    categories: {
                        'alkali': 'Alkali Metal',
                        'alkaline': 'Alkaline Earth',
                        'transition': 'Transition Metal',
                        'post-transition': 'Post-transition',
                        'metalloid': 'Metalloid',
                        'nonmetal': 'Nonmetal',
                        'halogen': 'Halogen',
                        'noble': 'Noble Gas',
                        'lanthanide': 'Lanthanide',
                        'actinide': 'Actinide'
                    },
                    labels: {
                        mass: 'Atomic Mass',
                        phase: 'Phase',
                        mp: 'Melting Point',
                        bp: 'Boiling Point',
                        density: 'Density',
                        config: 'Config',
                        year: 'Discovered',
                        group: 'Group/Period'
                    }
                },
                'zh-CN': {
                    title: 'ÂÖÉÁ¥†Âë®ÊúüË°®',
                    subtitle: 'ÁÇπÂáªÂÖÉÁ¥†Êü•ÁúãËØ¶ÊÉÖ',
                    search_ph: 'ÊêúÁ¥¢ (Â¶ÇÔºöAu, Èáë, 79)',
                    categories: {
                        'alkali': 'Á¢±ÈáëÂ±û',
                        'alkaline': 'Á¢±ÂúüÈáëÂ±û',
                        'transition': 'ËøáÊ∏°ÈáëÂ±û',
                        'post-transition': 'ÂêéËøáÊ∏°ÈáëÂ±û',
                        'metalloid': 'Á±ªÈáëÂ±û',
                        'nonmetal': 'ÈùûÈáëÂ±û',
                        'halogen': 'Âç§Á¥†',
                        'noble': 'Á®ÄÊúâÊ∞î‰Ωì',
                        'lanthanide': 'ÈïßÁ≥ªÂÖÉÁ¥†',
                        'actinide': 'ÈîïÁ≥ªÂÖÉÁ¥†'
                    },
                    labels: {
                        mass: 'ÂéüÂ≠êË¥®Èáè',
                        phase: 'Áä∂ÊÄÅ',
                        mp: 'ÁÜîÁÇπ',
                        bp: 'Ê≤∏ÁÇπ',
                        density: 'ÂØÜÂ∫¶',
                        config: 'ÁîµÂ≠êÊéíÂ∏É',
                        year: 'ÂèëÁé∞Âπ¥‰ªΩ',
                        group: 'Êóè/Âë®Êúü'
                    }
                },
                'zh-TW': {
                    title: 'ÂÖÉÁ¥†ÈÄ±ÊúüË°®',
                    subtitle: 'ÈªûÊìäÂÖÉÁ¥†Êü•ÁúãË©≥ÊÉÖ',
                    search_ph: 'ÊêúÂ∞ã (Â¶ÇÔºöAu, Èáë, 79)',
                    categories: {
                        'alkali': 'ÈπºÈáëÂ±¨',
                        'alkaline': 'ÈπºÂúüÈáëÂ±¨',
                        'transition': 'ÈÅéÊ∏°ÈáëÂ±¨',
                        'post-transition': 'Ë≤ßÈáëÂ±¨',
                        'metalloid': 'È°ûÈáëÂ±¨',
                        'nonmetal': 'ÈùûÈáëÂ±¨',
                        'halogen': 'ÈπµÁ¥†',
                        'noble': 'Á®ÄÊúâÊ∞£È´î',
                        'lanthanide': 'Èë≠Á≥ªÂÖÉÁ¥†',
                        'actinide': 'ÈåíÁ≥ªÂÖÉÁ¥†'
                    },
                    labels: {
                        mass: 'ÂéüÂ≠êË≥™Èáè',
                        phase: 'ÁãÄÊÖã',
                        mp: 'ÁÜîÈªû',
                        bp: 'Ê≤∏Èªû',
                        density: 'ÂØÜÂ∫¶',
                        config: 'ÈõªÂ≠êÁµÑÊÖã',
                        year: 'ÁôºÁèæÂπ¥‰ªΩ',
                        group: 'Êóè/ÈÄ±Êúü'
                    }
                },
                'ja': {
                    title: 'ÂÖÉÁ¥†Âë®ÊúüË°®',
                    subtitle: 'Ë©≥Á¥∞„ÇíË°®Á§∫„Åô„Çã„Å´„ÅØÂÖÉÁ¥†„Çí„ÇØ„É™„ÉÉ„ÇØ',
                    search_ph: 'Ê§úÁ¥¢ (‰æã: Au, Èáë, 79)',
                    categories: {
                        'alkali': '„Ç¢„É´„Ç´„É™ÈáëÂ±û',
                        'alkaline': '„Ç¢„É´„Ç´„É™ÂúüÈ°ûÈáëÂ±û',
                        'transition': 'ÈÅ∑ÁßªÈáëÂ±û',
                        'post-transition': 'ÂçëÈáëÂ±û',
                        'metalloid': 'ÂçäÈáëÂ±û',
                        'nonmetal': 'ÈùûÈáëÂ±û',
                        'halogen': '„Éè„É≠„Ç≤„É≥',
                        'noble': 'Â∏å„Ç¨„Çπ',
                        'lanthanide': '„É©„É≥„Çø„Éé„Ç§„Éâ',
                        'actinide': '„Ç¢„ÇØ„ÉÅ„Éé„Ç§„Éâ'
                    },
                    labels: {
                        mass: 'ÂéüÂ≠êÈáè',
                        phase: 'Áä∂ÊÖã',
                        mp: 'ËûçÁÇπ',
                        bp: 'Ê≤∏ÁÇπ',
                        density: 'ÂØÜÂ∫¶',
                        config: 'ÈõªÂ≠êÈÖçÁΩÆ',
                        year: 'Áô∫Ë¶ãÂπ¥',
                        group: 'Êóè/Âë®Êúü'
                    }
                },
                'ru': {
                    title: '–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞',
                    subtitle: '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –¥–µ—Ç–∞–ª–µ–π',
                    search_ph: '–ü–æ–∏—Å–∫ (–Ω–∞–ø—Ä., Au, –ó–æ–ª–æ—Ç–æ)',
                    categories: {
                        'alkali': '–©–µ–ª–æ—á–Ω–æ–π –º–µ—Ç–∞–ª–ª',
                        'alkaline': '–©–µ–ª–æ—á–Ω–æ–∑–µ–º–µ–ª—å–Ω—ã–π',
                        'transition': '–ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –º–µ—Ç–∞–ª–ª',
                        'post-transition': '–ü–æ—Å—Ç–ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–π',
                        'metalloid': '–ü–æ–ª—É–º–µ—Ç–∞–ª–ª',
                        'nonmetal': '–ù–µ–º–µ—Ç–∞–ª–ª',
                        'halogen': '–ì–∞–ª–æ–≥–µ–Ω',
                        'noble': '–ë–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–π –≥–∞–∑',
                        'lanthanide': '–õ–∞–Ω—Ç–∞–Ω–æ–∏–¥',
                        'actinide': '–ê–∫—Ç–∏–Ω–æ–∏–¥'
                    },
                    labels: {
                        mass: '–ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞',
                        phase: '–§–∞–∑–∞',
                        mp: '–ü–ª–∞–≤–ª–µ–Ω–∏–µ',
                        bp: '–ö–∏–ø–µ–Ω–∏–µ',
                        density: '–ü–ª–æ—Ç–Ω–æ—Å—Ç—å',
                        config: '–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è',
                        year: '–û—Ç–∫—Ä—ã—Ç',
                        group: '–ì—Ä—É–ø–ø–∞/–ü–µ—Ä–∏–æ–¥'
                    }
                }
            },

            init() {
                this.renderLegend();
                this.renderTable();
                this.setupSearch();
                this.changeLang();
            },

            changeLang() {
                const lang = document.getElementById('periodic-lang').value;
                const i18n = this.i18n[lang];

                // Update text content
                document.querySelector('[data-i18n="title"]').textContent = i18n.title;
                document.querySelector('[data-i18n="subtitle"]').textContent = i18n.subtitle;
                document.getElementById('element-search').placeholder = i18n.search_ph;

                // Update Detail Labels
                const detailLabels = {
                    'atomic_mass': i18n.labels.mass,
                    'phase': i18n.labels.phase,
                    'melting_point': i18n.labels.mp,
                    'boiling_point': i18n.labels.bp,
                    'density': i18n.labels.density,
                    'electron_config': i18n.labels.config,
                    'discovery_year': i18n.labels.year,
                    'group_period': i18n.labels.group
                };

                for (const [key, value] of Object.entries(detailLabels)) {
                    const el = document.querySelector(`[data-i18n="${key}"]`);
                    if(el) el.textContent = value;
                }

                // Re-render legend to update category names
                this.renderLegend();
                
                // Re-render table to update element names
                this.renderTable();
                
                // If an element is currently selected, refresh its details
                const currentSymbol = document.getElementById('detail-symbol').textContent;
                if (currentSymbol !== '--') {
                    const elData = elementsData.find(e => e.s === currentSymbol);
                    if (elData) this.showDetails(elData);
                }
            },

            renderLegend() {
                const lang = document.getElementById('periodic-lang').value;
                const categories = this.i18n[lang].categories;
                const container = document.querySelector('.legend');
                container.innerHTML = '';

                Object.keys(categories).forEach(cat => {
                    const item = document.createElement('div');
                    item.className = 'legend-item';
                    item.innerHTML = `
                        <div class="legend-box cat-${cat}"></div>
                        <span>${categories[cat]}</span>
                    `;
                    container.appendChild(item);
                });
            },

            renderTable() {
                const container = document.getElementById('periodic-table-container');
                const lang = document.getElementById('periodic-lang').value;
                const langIdx = this.langIndices[lang];
                
                container.innerHTML = '';

                elementsData.forEach(el => {
                    const div = document.createElement('div');
                    div.className = `element cat-${el.c}`;
                    
                    // Grid Positioning Logic
                    let col = el.g;
                    let row = el.p;

                    // Lanthanides: Period 6, shift down to Row 9. Range 57-71. 
                    // Visual placement: Start at column 3 (technically they sit inside Group 3)
                    // We map them to Columns 3 to 17 (15 elements)
                    if (el.n >= 57 && el.n <= 71) {
                        row = 9; // Visual row
                        col = (el.n - 57) + 3; // 57->3, 71->17
                    }
                    
                    // Actinides: Period 7, shift down to Row 10. Range 89-103
                    if (el.n >= 89 && el.n <= 103) {
                        row = 10; // Visual row
                        col = (el.n - 89) + 3; // 89->3, 103->17
                    }

                    div.style.gridColumnStart = col;
                    div.style.gridRowStart = row;

                    div.innerHTML = `
                        <div class="number">${el.n}</div>
                        <div class="symbol">${el.s}</div>
                        <div class="name">${el.names[langIdx]}</div>
                    `;
                    div.onclick = () => this.showDetails(el);
                    
                    // Add data attribute for search
                    div.dataset.search = `${el.n} ${el.s} ${el.names.join(' ')}`.toLowerCase();
                    
                    container.appendChild(div);
                });
            },

            showDetails(el) {
                const lang = document.getElementById('periodic-lang').value;
                const langIdx = this.langIndices[lang];
                const i18n = this.i18n[lang];

                document.getElementById('detail-symbol').textContent = el.s;
                document.getElementById('detail-name').textContent = el.names[langIdx];
                document.getElementById('detail-number-large').textContent = el.n;
                document.getElementById('detail-mass').textContent = el.m;
                document.getElementById('detail-category').textContent = i18n.categories[el.c] || el.c;

                // Mocking some data for demonstration if not in simplified dataset
                // In a real full app, these would be in the data structure
                document.getElementById('detail-phase').textContent = (el.mp < 25 && el.bp > 25) ? 'Liquid' : (el.bp < 25 ? 'Gas' : 'Solid');
                document.getElementById('detail-mp').textContent = el.mp || '-'; // Assuming logic to fetch or displaying placeholder
                document.getElementById('detail-bp').textContent = el.bp || '-';
                document.getElementById('detail-density').textContent = el.d || '-'; // Need to add to data or mock
                document.getElementById('detail-year').textContent = el.y || (el.n > 100 ? '2000+' : '1800s'); // Placeholder logic
                
                // Configuration logic (simplified visualization)
                document.getElementById('detail-config').textContent = `[..] ${el.p}s${el.g > 2 ? '...' : el.g}`;
                
                document.getElementById('detail-group').textContent = el.n >= 57 && el.n <= 71 ? 'Lanthanides' : (el.n >= 89 && el.n <= 103 ? 'Actinides' : el.g);
                document.getElementById('detail-period').textContent = el.p;

                const details = document.getElementById('element-details');
                details.classList.remove('hidden');
                
                // Smooth scroll to details on mobile
                if(window.innerWidth < 768) {
                    details.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            },

            setupSearch() {
                document.getElementById('element-search').addEventListener('input', (e) => {
                    const val = e.target.value.toLowerCase();
                    const els = document.querySelectorAll('.element');
                    els.forEach(el => {
                        if (el.dataset.search.includes(val)) {
                            el.style.opacity = '1';
                            el.style.transform = 'scale(1)';
                            el.style.filter = 'grayscale(0)';
                        } else {
                            el.style.opacity = '0.1';
                            el.style.transform = 'scale(0.9)';
                            el.style.filter = 'grayscale(100%)';
                        }
                    });
                });
            }
        };

        window.onload = () => PeriodicTable.init();
    </script>
</body>
</html>